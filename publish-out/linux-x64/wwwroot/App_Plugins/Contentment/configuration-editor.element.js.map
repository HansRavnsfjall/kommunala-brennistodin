{"version":3,"file":"configuration-editor.element.js","sources":["../../../../Umbraco.Community.Contentment.Client/src/property-editor-ui/configuration-editor/configuration-editor.element.ts"],"sourcesContent":["// SPDX-License-Identifier: MPL-2.0\r\n// Copyright Â© 2024 Lee Kelleher\r\n\r\nimport { parseBoolean, parseInt } from '../../utils/index.js';\r\nimport { CONTENTMENT_CONFIGURATION_EDITOR_SELECTION_MODAL } from './configuration-editor-selection-modal.element.js';\r\nimport { CONTENTMENT_CONFIGURATION_EDITOR_WORKSPACE_MODAL } from './configuration-editor-workspace-modal.element.js';\r\nimport type {\r\n\tContentmentConfigurationEditorModel,\r\n\tContentmentConfigurationEditorValue,\r\n\tContentmentListItem,\r\n} from '../types.js';\r\nimport { customElement, html, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { umbConfirmModal, UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport type { UUIModalSidebarSize } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { UmbPropertyEditorUiElement } from '@umbraco-cms/backoffice/property-editor';\r\n\r\nimport '../../extensions/display-mode/display-mode-ui.element.js';\r\n\r\n@customElement('contentment-property-editor-ui-configuration-editor')\r\nexport class ContentmentPropertyEditorUIConfigurationEditorElement\r\n\textends UmbLitElement\r\n\timplements UmbPropertyEditorUiElement\r\n{\r\n\t#allowEditLookup = new Set<string>();\r\n\r\n\t#buttonLabelKey: string = 'general_add';\r\n\r\n\t#canEdit = (item: ContentmentListItem) => this.#allowEditLookup.has(item.value);\r\n\r\n\t#config?: UmbPropertyEditorUiElement['config'];\r\n\r\n\t#configurationType?: string;\r\n\r\n\t#disableSorting = false;\r\n\r\n\t#lookup: Record<string, ContentmentConfigurationEditorModel> = {};\r\n\r\n\t#maxItems = Infinity;\r\n\r\n\t#modalManager?: typeof UMB_MODAL_MANAGER_CONTEXT.TYPE;\r\n\r\n\t#uiAlias: string = 'Umb.Contentment.DisplayMode.List';\r\n\r\n\t@state()\r\n\tprivate _initialized = false;\r\n\r\n\t@state()\r\n\tprivate _items?: Array<ContentmentListItem>;\r\n\r\n\tprotected models?: Array<ContentmentConfigurationEditorModel>;\r\n\r\n\t@property({ type: Array })\r\n\tpublic value?: Array<ContentmentConfigurationEditorValue>;\r\n\r\n\tpublic set config(config: UmbPropertyEditorUiElement['config']) {\r\n\t\tif (!config) return;\r\n\r\n\t\tthis.#config = config;\r\n\r\n\t\tthis.#buttonLabelKey = config.getValueByAlias('addButtonLabelKey') ?? 'general_choose';\r\n\t\tthis.#configurationType = config.getValueByAlias('configurationType');\r\n\t\tthis.#maxItems = parseInt(config.getValueByAlias('maxItems')) || Infinity;\r\n\t\tthis.#disableSorting = this.#maxItems === 1 ? true : parseBoolean(config.getValueByAlias('disableSorting'));\r\n\t\tthis.#uiAlias = config.getValueByAlias('uiAlias') ?? 'Umb.Contentment.DisplayMode.List';\r\n\r\n\t\t// enableFilter\r\n\t\t// help\r\n\r\n\t\tthis.models = config.getValueByAlias('items');\r\n\r\n\t\tif (this.models) {\r\n\t\t\tthis.populateModelLookup();\r\n\t\t} else {\r\n\t\t\tthis.getModels();\r\n\t\t}\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_MODAL_MANAGER_CONTEXT, (modalManager) => {\r\n\t\t\tthis.#modalManager = modalManager;\r\n\t\t});\r\n\t}\r\n\r\n\tprotected getModels() {\r\n\t\tif (this.models || !this.#configurationType) return;\r\n\r\n\t\tthis.observe(umbExtensionsRegistry.byType(this.#configurationType), (manifests) => {\r\n\t\t\tthis.models = manifests\r\n\t\t\t\t.map((manifest: any) => ({\r\n\t\t\t\t\t...manifest.meta,\r\n\t\t\t\t\tkey: manifest.meta?.key ?? manifest.alias,\r\n\t\t\t\t\tname: manifest.meta?.name ?? manifest.name,\r\n\t\t\t\t\toverlaySize: (manifest.meta?.overlaySize?.toLowerCase() as UUIModalSidebarSize) ?? 'small',\r\n\t\t\t\t}))\r\n\t\t\t\t.sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n\t\t\tthis.populateModelLookup();\r\n\t\t});\r\n\t}\r\n\r\n\t#getModelByKey(key: string): ContentmentConfigurationEditorModel | undefined {\r\n\t\treturn this.#lookup[key];\r\n\t}\r\n\r\n\tprotected populateModelLookup() {\r\n\t\tif (!this.models) return;\r\n\r\n\t\tthis.models.forEach((model) => {\r\n\t\t\tthis.#lookup[model.key] = model;\r\n\r\n\t\t\tif (model.fields?.length) {\r\n\t\t\t\tthis.#allowEditLookup.add(model.key);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.#populateItems();\r\n\t}\r\n\r\n\t#populateItems() {\r\n\t\tconst getItemValue = (\r\n\t\t\titem: ContentmentConfigurationEditorValue,\r\n\t\t\tmodel: ContentmentConfigurationEditorModel,\r\n\t\t\tkey: string\r\n\t\t) => {\r\n\t\t\tconst expression = model.expressions?.[key];\r\n\t\t\tif (expression && typeof expression === 'function') {\r\n\t\t\t\treturn expression(item.value);\r\n\t\t\t}\r\n\r\n\t\t\treturn model[key] ?? item.value[key];\r\n\t\t};\r\n\r\n\t\tconst items: Array<ContentmentListItem> = [];\r\n\r\n\t\tthis.value?.forEach((item) => {\r\n\t\t\tconst model = this.#getModelByKey(item.key);\r\n\t\t\tif (model) {\r\n\t\t\t\titems.push({\r\n\t\t\t\t\tname: getItemValue(item, model, 'name')?.toString() ?? item.key,\r\n\t\t\t\t\ticon: getItemValue(item, model, 'icon')?.toString(),\r\n\t\t\t\t\tdescription: getItemValue(item, model, 'description')?.toString(),\r\n\t\t\t\t\tvalue: item.key,\r\n\t\t\t\t\tcardStyle: getItemValue(item, model, 'cardStyle'),\r\n\t\t\t\t\ticonStyle: getItemValue(item, model, 'iconStyle'),\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._items = items;\r\n\r\n\t\tthis._initialized = true;\r\n\t}\r\n\r\n\t#setValue(value: ContentmentConfigurationEditorValue | undefined, index: number) {\r\n\t\tif (!value || index === -1) return;\r\n\r\n\t\tif (!this.value) {\r\n\t\t\tthis.value = [];\r\n\t\t}\r\n\r\n\t\tconst tmp = [...this.value];\r\n\t\ttmp[index] = value;\r\n\t\tthis.value = tmp;\r\n\r\n\t\tthis.#populateItems();\r\n\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\tasync #onAdd() {\r\n\t\tif (!this.#modalManager) return;\r\n\r\n\t\tif (this.models?.length === 1) {\r\n\t\t\tconst model = this.models[0];\r\n\r\n\t\t\tconst item = {\r\n\t\t\t\tkey: model.key,\r\n\t\t\t\tvalue: model.defaultValues ?? {},\r\n\t\t\t};\r\n\r\n\t\t\tconst modal = this.#modalManager.open(this, CONTENTMENT_CONFIGURATION_EDITOR_WORKSPACE_MODAL, {\r\n\t\t\t\tdata: { item, model },\r\n\t\t\t\tmodal: { size: model.overlaySize ?? 'medium' },\r\n\t\t\t});\r\n\r\n\t\t\tconst data = await modal.onSubmit().catch(() => undefined);\r\n\r\n\t\t\tthis.#setValue(data, this.value?.length ?? 0);\r\n\t\t} else {\r\n\t\t\tconst modal = this.#modalManager.open(this, CONTENTMENT_CONFIGURATION_EDITOR_SELECTION_MODAL, {\r\n\t\t\t\tdata: { items: this.models ?? [] },\r\n\t\t\t});\r\n\r\n\t\t\tconst data = await modal.onSubmit().catch(() => undefined);\r\n\r\n\t\t\tthis.#setValue(data, this.value?.length ?? 0);\r\n\t\t}\r\n\t}\r\n\r\n\tasync #onEdit(event: CustomEvent<{ item: ContentmentListItem; index: number }>) {\r\n\t\tif (!this.#modalManager || !this.#canEdit(event.detail.item)) return;\r\n\r\n\t\tconst model = this.#getModelByKey(event.detail.item.value);\r\n\t\tif (!model?.fields?.length) return;\r\n\r\n\t\tconst value = this.value?.[event.detail.index];\r\n\t\tif (!value) return;\r\n\r\n\t\tconst modal = this.#modalManager.open(this, CONTENTMENT_CONFIGURATION_EDITOR_WORKSPACE_MODAL, {\r\n\t\t\tdata: { item: value, model },\r\n\t\t\tmodal: { size: model.overlaySize ?? 'medium' },\r\n\t\t});\r\n\r\n\t\tconst data = await modal.onSubmit().catch(() => undefined);\r\n\r\n\t\tthis.#setValue(data, event.detail.index);\r\n\t}\r\n\r\n\tasync #onRemove(event: CustomEvent<{ item: ContentmentListItem; index: number }>) {\r\n\t\tif (!event.detail.item || !this.value || event.detail.index == -1) return;\r\n\r\n\t\tawait umbConfirmModal(this, {\r\n\t\t\tcolor: 'danger',\r\n\t\t\theadline: this.localize.term('contentment_removeItemHeadline', [event.detail.item.name]),\r\n\t\t\tcontent: this.localize.term('contentment_removeItemMessage'),\r\n\t\t\tconfirmLabel: this.localize.term('contentment_removeItemButton'),\r\n\t\t});\r\n\r\n\t\tconst items = [...this.value];\r\n\t\titems.splice(event.detail.index, 1);\r\n\t\tthis.value = items;\r\n\r\n\t\tthis.#populateItems();\r\n\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\t#onSort(event: CustomEvent<{ newIndex: number; oldIndex: number }>) {\r\n\t\tconst items = [...(this.value ?? [])];\r\n\t\titems.splice(event.detail.newIndex, 0, items.splice(event.detail.oldIndex, 1)[0]);\r\n\t\tthis.value = items;\r\n\r\n\t\tthis.#populateItems();\r\n\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this._initialized) return html`<uui-loader></uui-loader>`;\r\n\t\tif (!this.#uiAlias) return html`<lee-was-here></lee-was-here>`;\r\n\t\treturn html`\r\n\t\t\t<contentment-display-mode-ui\r\n\t\t\t\t?allowAdd=${!this.value || this.value.length < this.#maxItems}\r\n\t\t\t\t?allowRemove=${true}\r\n\t\t\t\t?allowSort=${!this.#disableSorting}\r\n\t\t\t\t.canEdit=${(item: ContentmentListItem) => this.#canEdit(item)}\r\n\t\t\t\t.addButtonLabelKey=${this.#buttonLabelKey}\r\n\t\t\t\t.config=${this.#config}\r\n\t\t\t\t.items=${this._items}\r\n\t\t\t\t.uiAlias=${this.#uiAlias}\r\n\t\t\t\t@add=${this.#onAdd}\r\n\t\t\t\t@edit=${this.#onEdit}\r\n\t\t\t\t@remove=${this.#onRemove}\r\n\t\t\t\t@sort=${this.#onSort}>\r\n\t\t\t</contentment-display-mode-ui>\r\n\t\t`;\r\n\t}\r\n}\r\n\r\nexport { ContentmentPropertyEditorUIConfigurationEditorElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'contentment-property-editor-ui-configuration-editor': ContentmentPropertyEditorUIConfigurationEditorElement;\r\n\t}\r\n}\r\n"],"names":["_allowEditLookup","_buttonLabelKey","_canEdit","_config","_configurationType","_disableSorting","_lookup","_maxItems","_modalManager","_uiAlias","_ContentmentPropertyEditorUIConfigurationEditorElement_instances","getModelByKey_fn","populateItems_fn","setValue_fn","onAdd_fn","onEdit_fn","onRemove_fn","onSort_fn","ContentmentPropertyEditorUIConfigurationEditorElement","UmbLitElement","__privateAdd","item","__privateGet","UMB_MODAL_MANAGER_CONTEXT","modalManager","__privateSet","config","parseInt","parseBoolean","umbExtensionsRegistry","manifests","manifest","_a","_b","_d","_c","a","b","model","__privateMethod","html","key","getItemValue","expression","items","value","index","tmp","UmbChangeEvent","data","CONTENTMENT_CONFIGURATION_EDITOR_WORKSPACE_MODAL","CONTENTMENT_CONFIGURATION_EDITOR_SELECTION_MODAL","event","umbConfirmModal","__decorateClass","state","property","customElement"],"mappings":"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"}