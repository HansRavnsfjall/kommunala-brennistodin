{"version":3,"file":"custom-component-list.element.js","sources":["../../../../Umbraco.Community.Contentment.Client/src/property-editor-ui/custom-component-list/custom-component-list.element.ts"],"sourcesContent":["// SPDX-License-Identifier: MPL-2.0\r\n// Copyright Â© 2025 Lee Kelleher\r\n\r\nimport type { ContentmentListItem, ContentmentDataListOption } from '../types.js';\r\nimport type { ContentmentDataListItemUiElement } from '../../extensions/types.js';\r\nimport {\r\n\tclassMap,\r\n\tcustomElement,\r\n\thtml,\r\n\tifDefined,\r\n\tnothing,\r\n\tproperty,\r\n\trepeat,\r\n\tstate,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { parseBoolean } from '../../utils/parse-boolean.function.js';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { createExtensionElement } from '@umbraco-cms/backoffice/extension-api';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport type { ManifestBase } from '@umbraco-cms/backoffice/extension-api';\r\nimport type { UmbPropertyEditorUiElement } from '@umbraco-cms/backoffice/property-editor';\r\nimport { ContentmentPropertyEditorUITemplatedListElement } from '../templated-list/templated-list.element.js';\r\n\r\n@customElement('contentment-property-editor-ui-custom-component-list')\r\nexport default class ContentmentPropertyEditorUICustomComponentListElement\r\n\textends UmbLitElement\r\n\timplements UmbPropertyEditorUiElement\r\n{\r\n\t#component?: string;\r\n\r\n\t@state()\r\n\tprivate _element?: ContentmentDataListItemUiElement;\r\n\r\n\t@state()\r\n\tprivate _enableMultiple = false;\r\n\r\n\t@state()\r\n\tprivate _flexDirection: 'row' | 'column' = 'column';\r\n\r\n\t@state()\r\n\tprivate _items: Array<ContentmentDataListOption> = [];\r\n\r\n\t@state()\r\n\tprivate _listStyles?: string;\r\n\r\n\t@state()\r\n\tprivate _listItemStyles?: string;\r\n\r\n\t@property({ type: Array })\r\n\tpublic set value(value: Array<string> | undefined) {\r\n\t\tthis.#value = value ?? [];\r\n\t}\r\n\tpublic get value(): Array<string> | undefined {\r\n\t\treturn this.#value;\r\n\t}\r\n\t#value?: Array<string> = [];\r\n\r\n\tpublic set config(config: UmbPropertyEditorUiElement['config']) {\r\n\t\tif (!config) return;\r\n\r\n\t\tconst defaultValue = config.getValueByAlias('defaultValue') ?? [];\r\n\t\tthis._enableMultiple = parseBoolean(config.getValueByAlias('enableMultiple'));\r\n\r\n\t\tconst components = config.getValueByAlias<Array<string>>('component') ?? [];\r\n\t\tthis.#component = components[0];\r\n\r\n\t\tthis._flexDirection = config.getValueByAlias('orientation') === 'horizontal' ? 'row' : 'column';\r\n\r\n\t\tthis._listStyles = config.getValueByAlias('listStyles');\r\n\t\tthis._listItemStyles = config.getValueByAlias('listItemStyles');\r\n\r\n\t\tconst items = config.getValueByAlias<Array<ContentmentListItem>>('items') ?? [];\r\n\t\tthis._items = items.map((item) => ({ ...item, selected: this.value?.includes(item.value) ?? false }));\r\n\r\n\t\tif (!this.value) {\r\n\t\t\tthis.value = this._enableMultiple && Array.isArray(defaultValue) ? defaultValue : [defaultValue];\r\n\t\t}\r\n\r\n\t\tthis.#observeComponent();\r\n\t}\r\n\r\n\t#observeComponent() {\r\n\t\tif (this.#component) {\r\n\t\t\tthis.observe(\r\n\t\t\t\tumbExtensionsRegistry.byTypeAndAlias('contentmentDataListItemUi', this.#component),\r\n\t\t\t\t(manifest) => {\r\n\t\t\t\t\tif (manifest) {\r\n\t\t\t\t\t\tthis.#getComponent(manifest);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.error(`Failed to find manifest for Contentment Data List Item UI alias: ${this.#component}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'_observeComponent'\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tasync #getComponent(manifest?: ManifestBase | null) {\r\n\t\tif (!manifest) return;\r\n\r\n\t\tconst element = await createExtensionElement(manifest);\r\n\r\n\t\tif (!element) {\r\n\t\t\tconsole.error(`Failed to create extension element for manifest: ${manifest}`);\r\n\t\t}\r\n\r\n\t\tthis._element = element;\r\n\t}\r\n\r\n\t#onClick(option: ContentmentDataListOption) {\r\n\t\toption.selected = !option.selected;\r\n\r\n\t\tconst values: Array<string> = [];\r\n\r\n\t\tthis._items.forEach((item) => {\r\n\t\t\tif (!this._enableMultiple) {\r\n\t\t\t\titem.selected = option.selected && item.value === option.value;\r\n\t\t\t}\r\n\r\n\t\t\tif (item.selected) {\r\n\t\t\t\tvalues?.push(item.value);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.value = values;\r\n\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this._element) return html`<lee-was-here></lee-was-here>`;\r\n\r\n\t\tif (!this._items?.length) {\r\n\t\t\treturn html`\r\n\t\t\t\t<contentment-info-box\r\n\t\t\t\t\tcompact\r\n\t\t\t\t\ttype=\"warning\"\r\n\t\t\t\t\ticon=\"icon-alert\"\r\n\t\t\t\t\theading=\"There are no items to display\"></contentment-info-box>\r\n\t\t\t`;\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<ul class=${this._flexDirection} style=${ifDefined(this._listStyles)}>\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis._items,\r\n\t\t\t\t\t(item) => item.value,\r\n\t\t\t\t\t(item) => this.#renderItem(item)\r\n\t\t\t\t)}\r\n\t\t\t</ul>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: ContentmentDataListOption) {\r\n\t\tif (!this._element) return nothing;\r\n\t\tconst element = this._element.cloneNode(true) as ContentmentDataListItemUiElement;\r\n\t\telement.item = item;\r\n\t\treturn html`\r\n\t\t\t<li class=${classMap({ selected: item.selected })} style=${ifDefined(this._listItemStyles)}>\r\n\t\t\t\t<button ?disabled=${item.disabled} @click=${() => this.#onClick(item)}>${element}</button>\r\n\t\t\t</li>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = ContentmentPropertyEditorUITemplatedListElement.styles;\r\n}\r\n\r\nexport { ContentmentPropertyEditorUICustomComponentListElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'contentment-property-editor-ui-custom-component-list': ContentmentPropertyEditorUICustomComponentListElement;\r\n\t}\r\n}\r\n"],"names":["_component","_value","_ContentmentPropertyEditorUICustomComponentListElement_instances","observeComponent_fn","getComponent_fn","onClick_fn","renderItem_fn","ContentmentPropertyEditorUICustomComponentListElement","UmbLitElement","__privateAdd","value","__privateSet","__privateGet","config","defaultValue","parseBoolean","components","items","item","_a","__privateMethod","html","ifDefined","repeat","umbExtensionsRegistry","manifest","element","createExtensionElement","option","values","UmbChangeEvent","nothing","classMap","ContentmentPropertyEditorUITemplatedListElement","__decorateClass","state","property","customElement"],"mappings":"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"}