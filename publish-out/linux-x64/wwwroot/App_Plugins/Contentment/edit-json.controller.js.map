{"version":3,"file":"edit-json.controller.js","sources":["../../../../Umbraco.Community.Contentment.Client/src/property-action/edit-json/edit-json.controller.ts"],"sourcesContent":["// SPDX-License-Identifier: MPL-2.0\r\n// Copyright Â© 2024 Lee Kelleher\r\n\r\nimport { UmbPropertyActionBase } from '@umbraco-cms/backoffice/property-action';\r\nimport { UMB_CODE_EDITOR_MODAL } from '@umbraco-cms/backoffice/code-editor';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_PROPERTY_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport type { MetaPropertyActionDefaultKind } from '@umbraco-cms/backoffice/property-action';\r\n\r\nexport class ContentmentPropertyActionEditJsonElement extends UmbPropertyActionBase<MetaPropertyActionDefaultKind> {\r\n\toverride async execute() {\r\n\t\tconst propertyContext = await this.getContext(UMB_PROPERTY_CONTEXT);\r\n\t\tif (!propertyContext) return;\r\n\r\n\t\tconst value = propertyContext.getValue();\r\n\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalManager) return;\r\n\t\tconst modal = modalManager.open(this, UMB_CODE_EDITOR_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\theadline: this.args.meta.label ?? 'Edit raw value',\r\n\t\t\t\tcontent: JSON.stringify(value, null, 2),\r\n\t\t\t\tlanguage: 'json',\r\n\t\t\t\tconfirmLabel: '#bulk_done',\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tconst data = await modal.onSubmit().catch(() => undefined);\r\n\t\tif (!data) return;\r\n\r\n\t\tconst json = JSON.parse(data.content);\r\n\t\tpropertyContext.setValue(json);\r\n\t}\r\n}\r\n\r\nexport { ContentmentPropertyActionEditJsonElement as api };\r\n"],"names":["ContentmentPropertyActionEditJsonElement","UmbPropertyActionBase","propertyContext","UMB_PROPERTY_CONTEXT","value","modalManager","UMB_MODAL_MANAGER_CONTEXT","data","UMB_CODE_EDITOR_MODAL","json"],"mappings":";;;;AASO,MAAMA,UAAiDC,EAAqD;AAAA,EAClH,MAAe,UAAU;AACxB,UAAMC,IAAkB,MAAM,KAAK,WAAWC,CAAoB;AAClE,QAAI,CAACD,EAAiB;AAEhB,UAAAE,IAAQF,EAAgB,SAAS,GAEjCG,IAAe,MAAM,KAAK,WAAWC,CAAyB;AACpE,QAAI,CAACD,EAAc;AAUnB,UAAME,IAAO,MATCF,EAAa,KAAK,MAAMG,GAAuB;AAAA,MAC5D,MAAM;AAAA,QACL,UAAU,KAAK,KAAK,KAAK,SAAS;AAAA,QAClC,SAAS,KAAK,UAAUJ,GAAO,MAAM,CAAC;AAAA,QACtC,UAAU;AAAA,QACV,cAAc;AAAA,MAAA;AAAA,IACf,CACA,EAEwB,WAAW,MAAM,MAAA;AAAA,KAAe;AACzD,QAAI,CAACG,EAAM;AAEX,UAAME,IAAO,KAAK,MAAMF,EAAK,OAAO;AACpC,IAAAL,EAAgB,SAASO,CAAI;AAAA,EAAA;AAE/B;"}