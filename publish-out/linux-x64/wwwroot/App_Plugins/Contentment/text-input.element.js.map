{"version":3,"file":"text-input.element.js","sources":["../../../../Umbraco.Community.Contentment.Client/src/property-editor-ui/text-input/text-input.element.ts"],"sourcesContent":["// SPDX-License-Identifier: MPL-2.0\r\n// Copyright Â© 2024 Lee Kelleher\r\n\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tifDefined,\r\n\tproperty,\r\n\trepeat,\r\n\tstate,\r\n\twhen,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { parseBoolean, parseInt } from '../../utils/index.js';\r\nimport { tryExecute } from '@umbraco-cms/backoffice/resources';\r\nimport { umbHttpClient } from '@umbraco-cms/backoffice/http-client';\r\nimport { DataListService } from '../../api/index.js';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UUIInputElement } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { ContentmentConfigurationEditorValue, ContentmentListItem } from '../types.js';\r\nimport type { InputType } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { UmbPropertyEditorUiElement } from '@umbraco-cms/backoffice/property-editor';\r\n\r\n@customElement('contentment-property-editor-ui-text-input')\r\nexport class ContentmentPropertyEditorUITextInputElement extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n\t@property()\r\n\tname?: string;\r\n\r\n\t@property()\r\n\tvalue?: string;\r\n\r\n\tpublic set config(config: UmbPropertyEditorUiElement['config']) {\r\n\t\tif (!config) return;\r\n\t\tthis._inputType = config.getValueByAlias<InputType>('inputType') ?? 'text';\r\n\t\tthis._placeholderText = config.getValueByAlias<string>('placeholderText');\r\n\t\tthis._dataSource = config.getValueByAlias<Array<ContentmentConfigurationEditorValue>>('dataSource')?.[0];\r\n\t\tthis._maxChars = parseInt(config.getValueByAlias('maxChars')) || 500;\r\n\t\tthis._autocomplete = parseBoolean(config.getValueByAlias('autocomplete'));\r\n\t\tthis._spellcheck = parseBoolean(config.getValueByAlias('spellcheck'));\r\n\t\tthis._prepend = config.getValueByAlias<string>('prepend');\r\n\t\tthis._append = config.getValueByAlias<string>('append');\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _dataSource?: ContentmentConfigurationEditorValue;\r\n\r\n\t@state()\r\n\tprivate _inputType: InputType = 'text';\r\n\r\n\t@state()\r\n\tprivate _items: Array<ContentmentListItem> = [];\r\n\r\n\t@state()\r\n\tprivate _maxChars = 500;\r\n\r\n\t@state()\r\n\tprivate _autocomplete = false;\r\n\r\n\t@state()\r\n\tprivate _spellcheck = false;\r\n\r\n\t@state()\r\n\tprivate _placeholderText?: string;\r\n\r\n\t@state()\r\n\tprivate _prepend?: string;\r\n\r\n\t@state()\r\n\tprivate _append?: string;\r\n\r\n\toverride async firstUpdated() {\r\n\t\tawait Promise.all([await this.#init().catch(() => undefined)]);\r\n\t}\r\n\r\n\tasync #init() {\r\n\t\tthis._items = await new Promise<Array<ContentmentListItem>>(async (resolve, reject) => {\r\n\t\t\tif (!this._dataSource) return reject();\r\n\r\n\t\t\tconst body = { dataSource: this._dataSource, listEditor: null };\r\n\r\n\t\t\tconst { data } = await tryExecute(this, DataListService.postDataListEditor({ client: umbHttpClient, body }));\r\n\r\n\t\t\tif (!data) return reject();\r\n\r\n\t\t\tconst items = (data.config?.find((x) => x.alias === 'items')?.value as Array<ContentmentListItem>) ?? [];\r\n\r\n\t\t\tresolve(items);\r\n\t\t});\r\n\t}\r\n\r\n\t#onInput(event: InputEvent & { target: HTMLInputElement }) {\r\n\t\t// TODO: [LK] `maxChars` validation + threshold warning message.\r\n\t\tthis.value = event.target.value;\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tconst hasItems = !!this._items?.length;\r\n\t\treturn html`\r\n\t\t\t${when(this._prepend, (icon) => html`<umb-icon class=\"prepend\" name=${icon}></umb-icon>`)}\r\n\t\t\t<input\r\n\t\t\t\ttype=${this._inputType}\r\n\t\t\t\tid=\"input\"\r\n\t\t\t\tautocomplete=${this._autocomplete ? 'on' : 'off'}\r\n\t\t\t\tlabel=${this.name ?? 'Text input'}\r\n\t\t\t\tlist=${ifDefined(hasItems ? 'items' : undefined)}\r\n\t\t\t\tmax=${this._maxChars}\r\n\t\t\t\tplaceholder=${ifDefined(this._placeholderText)}\r\n\t\t\t\t.value=${this.value ?? ''}\r\n\t\t\t\tspellcheck=${this._spellcheck ? 'true' : 'false'}\r\n\t\t\t\t@input=${this.#onInput} />\r\n\t\t\t${when(this._append, (icon) => html`<umb-icon class=\"append\" name=${icon}></umb-icon>`)}\r\n\t\t\t${when(\r\n\t\t\t\thasItems,\r\n\t\t\t\t() => html`\r\n\t\t\t\t\t<datalist id=\"items\">\r\n\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\tthis._items,\r\n\t\t\t\t\t\t\t(item) => item.value,\r\n\t\t\t\t\t\t\t(item) => html`<option label=${item.name} value=${item.value}></option>`\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</datalist>\r\n\t\t\t\t`\r\n\t\t\t)}\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUUIInputElement.styles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\tumb-icon {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tline-height: 1;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\tumb-icon.prepend {\r\n\t\t\t\tpadding-left: var(--uui-size-space-2);\r\n\t\t\t}\r\n\t\t\tumb-icon.append {\r\n\t\t\t\tpadding-right: var(--uui-size-space-2);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { ContentmentPropertyEditorUITextInputElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'contentment-property-editor-ui-text-input': ContentmentPropertyEditorUITextInputElement;\r\n\t}\r\n}\r\n"],"names":["_ContentmentPropertyEditorUITextInputElement_instances","init_fn","onInput_fn","ContentmentPropertyEditorUITextInputElement","UmbLitElement","__privateAdd","config","_a","parseInt","parseBoolean","__privateMethod","hasItems","html","when","icon","ifDefined","repeat","item","resolve","reject","body","data","tryExecute","DataListService","umbHttpClient","items","_b","x","event","UmbChangeEvent","UUIInputElement","css","__decorateClass","property","state","customElement"],"mappings":";;;;;;;;;;;;;;;8OAAAA,GAAAC,GAAAC;AAyBa,IAAAC,IAAN,cAA0DC,EAAoD;AAAA,EAA9G,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAL,CAAA,GAuBN,KAAQ,aAAwB,QAGhC,KAAQ,SAAqC,CAAC,GAG9C,KAAQ,YAAY,KAGpB,KAAQ,gBAAgB,IAGxB,KAAQ,cAAc;AAAA,EAAA;AAAA,EA5BtB,IAAW,OAAOM,GAA8C;;AAC/D,IAAKA,MACL,KAAK,aAAaA,EAAO,gBAA2B,WAAW,KAAK,QAC/D,KAAA,mBAAmBA,EAAO,gBAAwB,iBAAiB,GACxE,KAAK,eAAcC,IAAAD,EAAO,gBAA4D,YAAY,MAA/E,gBAAAC,EAAmF,IACtG,KAAK,YAAYC,EAASF,EAAO,gBAAgB,UAAU,CAAC,KAAK,KACjE,KAAK,gBAAgBG,EAAaH,EAAO,gBAAgB,cAAc,CAAC,GACxE,KAAK,cAAcG,EAAaH,EAAO,gBAAgB,YAAY,CAAC,GAC/D,KAAA,WAAWA,EAAO,gBAAwB,SAAS,GACnD,KAAA,UAAUA,EAAO,gBAAwB,QAAQ;AAAA,EAAA;AAAA,EA8BvD,MAAe,eAAe;AACvB,UAAA,QAAQ,IAAI,CAAC,MAAMI,EAAA,MAAKV,GAALC,CAAA,EAAA,KAAA,IAAA,EAAa,MAAM,MAAM;AAAA,KAAS,CAAC,CAAC;AAAA,EAAA;AAAA,EAyBrD,SAAS;;AACjB,UAAMU,IAAW,CAAC,GAACJ,IAAA,KAAK,WAAL,QAAAA,EAAa;AACzB,WAAAK;AAAA,KACJC,EAAK,KAAK,UAAU,CAACC,MAASF,mCAAsCE,CAAI,cAAc,CAAC;AAAA;AAAA,WAEjF,KAAK,UAAU;AAAA;AAAA,mBAEP,KAAK,gBAAgB,OAAO,KAAK;AAAA,YACxC,KAAK,QAAQ,YAAY;AAAA,WAC1BC,EAAUJ,IAAW,UAAU,MAAS,CAAC;AAAA,UAC1C,KAAK,SAAS;AAAA,kBACNI,EAAU,KAAK,gBAAgB,CAAC;AAAA,aACrC,KAAK,SAAS,EAAE;AAAA,iBACZ,KAAK,cAAc,SAAS,OAAO;AAAA,aACvCL,QAAKV,GAAQE,CAAA,CAAA;AAAA,KACrBW,EAAK,KAAK,SAAS,CAACC,MAASF,kCAAqCE,CAAI,cAAc,CAAC;AAAA,KACrFD;AAAA,MACDF;AAAA,MACA,MAAMC;AAAA;AAAA,QAEFI;AAAA,QACD,KAAK;AAAA,QACL,CAACC,MAASA,EAAK;AAAA,QACf,CAACA,MAASL,kBAAqBK,EAAK,IAAI,UAAUA,EAAK,KAAK;AAAA,MAC5D,CAAA;AAAA;AAAA;AAAA,IAGH,CAAA;AAAA;AAAA,EAAA;AA0BJ;AA7HOjB,IAAA,oBAAA,QAAA;AAkDAC,IAAK,iBAAG;AACb,OAAK,SAAS,MAAM,IAAI,QAAoC,OAAOiB,GAASC,MAAW;;AACtF,QAAI,CAAC,KAAK,YAAa,QAAOA,EAAO;AAErC,UAAMC,IAAO,EAAE,YAAY,KAAK,aAAa,YAAY,KAAK,GAExD,EAAE,MAAAC,EAAA,IAAS,MAAMC,EAAW,MAAMC,EAAgB,mBAAmB,EAAE,QAAQC,GAAe,MAAAJ,EAAM,CAAA,CAAC;AAEvG,QAAA,CAACC,EAAM,QAAOF,EAAO;AAEnB,UAAAM,MAASC,KAAAnB,IAAAc,EAAK,WAAL,gBAAAd,EAAa,KAAK,CAACoB,MAAMA,EAAE,UAAU,aAArC,gBAAAD,EAA+C,UAAwC,CAAC;AAEvG,IAAAR,EAAQO,CAAK;AAAA,EAAA,CACb;AACF;AAEAvB,IAAQ,SAAC0B,GAAkD;AAErD,OAAA,QAAQA,EAAM,OAAO,OACrB,KAAA,cAAc,IAAIC,GAAgB;AACxC;AAtEY1B,EAuGI,SAAS;AAAA,EACxB2B,EAAgB;AAAA,EAChBC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAmBD;AA1HAC,EAAA;AAAA,EADCC,EAAS;AAAA,GADE9B,EAEZ,WAAA,QAAA,CAAA;AAGA6B,EAAA;AAAA,EADCC,EAAS;AAAA,GAJE9B,EAKZ,WAAA,SAAA,CAAA;AAeQ6B,EAAA;AAAA,EADPE,EAAM;AAAA,GAnBK/B,EAoBJ,WAAA,eAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GAtBK/B,EAuBJ,WAAA,cAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GAzBK/B,EA0BJ,WAAA,UAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GA5BK/B,EA6BJ,WAAA,aAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GA/BK/B,EAgCJ,WAAA,iBAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GAlCK/B,EAmCJ,WAAA,eAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GArCK/B,EAsCJ,WAAA,oBAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GAxCK/B,EAyCJ,WAAA,YAAA,CAAA;AAGA6B,EAAA;AAAA,EADPE,EAAM;AAAA,GA3CK/B,EA4CJ,WAAA,WAAA,CAAA;AA5CIA,IAAN6B,EAAA;AAAA,EADNG,EAAc,2CAA2C;AAAA,GAC7ChC,CAAA;"}