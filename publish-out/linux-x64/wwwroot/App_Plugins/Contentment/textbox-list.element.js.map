{"version":3,"file":"textbox-list.element.js","sources":["../../../../Umbraco.Community.Contentment.Client/src/property-editor-ui/textbox-list/textbox-list.element.ts"],"sourcesContent":["// SPDX-License-Identifier: MPL-2.0\r\n// Copyright Â© 2024 Lee Kelleher\r\n\r\nimport { css, customElement, html, nothing, property, repeat, state, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { tryExecute } from '@umbraco-cms/backoffice/resources';\r\nimport { umbHttpClient } from '@umbraco-cms/backoffice/http-client';\r\nimport { DataListService } from '../../api/index.js';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport type { ContentmentConfigurationEditorValue, ContentmentListItem } from '../types.js';\r\nimport type { InputType, UUIInputEvent } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { UmbPropertyEditorUiElement } from '@umbraco-cms/backoffice/property-editor';\r\n\r\n@customElement('contentment-property-editor-ui-textbox-list')\r\nexport class ContentmentPropertyEditorUITextboxListElement extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n\t#inputTypes = ['color', 'email', 'number', 'password', 'tel', 'text', 'url'];\r\n\r\n\t@property()\r\n\tvalue?: Record<string, string>;\r\n\r\n\tpublic set config(config: UmbPropertyEditorUiElement['config']) {\r\n\t\tif (!config) return;\r\n\t\tthis._dataSource = config.getValueByAlias('dataSource');\r\n\t\tthis._defaultIcon = config.getValueByAlias<string>('defaultIcon');\r\n\r\n\t\tconst labelStyle = config.getValueByAlias('labelStyle') ?? 'both';\r\n\t\tthis._hideIcon = labelStyle === 'text';\r\n\t\tthis._hideLabel = labelStyle === 'icon';\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _dataSource?: Array<ContentmentConfigurationEditorValue>;\r\n\r\n\t@state()\r\n\tprivate _defaultIcon?: string;\r\n\r\n\t@state()\r\n\tprivate _hideIcon = false;\r\n\r\n\t@state()\r\n\tprivate _hideLabel = false;\r\n\r\n\t@state()\r\n\tprivate _items: Array<ContentmentListItem> = [];\r\n\r\n\toverride async firstUpdated() {\r\n\t\tawait Promise.all([await this.#init().catch(() => undefined)]);\r\n\t}\r\n\r\n\tasync #init() {\r\n\t\tthis._items = await new Promise<Array<ContentmentListItem>>(async (resolve, reject) => {\r\n\t\t\tif (!this._dataSource) return reject();\r\n\r\n\t\t\tconst body = { dataSource: this._dataSource[0], listEditor: null };\r\n\r\n\t\t\tconst { data } = await tryExecute(this, DataListService.postDataListEditor({ client: umbHttpClient, body }));\r\n\r\n\t\t\tif (!data) return reject();\r\n\r\n\t\t\tconst items = (data.config?.find((x) => x.alias === 'items')?.value as Array<ContentmentListItem>) ?? [];\r\n\r\n\t\t\tif (!this.value && items.length > 0) {\r\n\t\t\t\tthis.value = Object.fromEntries(items.map((item) => [item.value, '']));\r\n\t\t\t}\r\n\r\n\t\t\tresolve(items);\r\n\t\t});\r\n\t}\r\n\r\n\t#onInput(key: string, event: UUIInputEvent) {\r\n\t\tthis.value = { ...this.value, [key]: event.target.value as string };\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this._items?.length) return nothing;\r\n\t\treturn html`\r\n\t\t\t<div id=\"wrapper\">\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis._items,\r\n\t\t\t\t\t(item) => item.value,\r\n\t\t\t\t\t(item) => this.#renderItem(item)\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: ContentmentListItem) {\r\n\t\treturn html`\r\n\t\t\t<div class=\"item\">\r\n\t\t\t\t<uui-label for=\"item-${item.value}\" title=${item.value}>\r\n\t\t\t\t\t${when(!this._hideIcon, () => html`<umb-icon .name=${item.icon || this._defaultIcon}></umb-icon>`)}\r\n\t\t\t\t\t${when(!this._hideLabel, () => html`<span>${item.name}</span>`)}\r\n\t\t\t\t</uui-label>\r\n\t\t\t\t<uui-input\r\n\t\t\t\t\ttype=${this.#inputTypes.includes(item.value) ? (item.value as InputType) : 'text'}\r\n\t\t\t\t\tid=\"item-${item.value}\"\r\n\t\t\t\t\tlabel=${item.name}\r\n\t\t\t\t\t.value=${this.value?.[item.value] ?? ''}\r\n\t\t\t\t\t@input=${(event: UUIInputEvent) => this.#onInput(item.value, event)}></uui-input>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#wrapper {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: 1px;\r\n\t\t\t}\r\n\r\n\t\t\t.item {\r\n\t\t\t\tbackground-color: var(--uui-color-surface-alt);\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-6);\r\n\t\t\t\tpadding: var(--uui-size-3) var(--uui-size-6);\r\n\t\t\t}\r\n\r\n\t\t\tuui-label {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: 1rem;\r\n\t\t\t\tflex: 0.2;\r\n\t\t\t}\r\n\r\n\t\t\tuui-label:has(umb-icon):not(:has(span)) {\r\n\t\t\t\tflex: 0 0 var(--uui-size-6);\r\n\t\t\t}\r\n\r\n\t\t\tuui-label:has(span):not(:has(umb-icon)) {\r\n\t\t\t\tflex: 0.1;\r\n\t\t\t}\r\n\r\n\t\t\t.item > uui-input {\r\n\t\t\t\tflex: 1;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { ContentmentPropertyEditorUITextboxListElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'contentment-property-editor-ui-textbox-list': ContentmentPropertyEditorUITextboxListElement;\r\n\t}\r\n}\r\n"],"names":["_inputTypes","_ContentmentPropertyEditorUITextboxListElement_instances","init_fn","onInput_fn","renderItem_fn","ContentmentPropertyEditorUITextboxListElement","UmbLitElement","__privateAdd","config","labelStyle","__privateMethod","_a","html","repeat","item","nothing","resolve","reject","body","data","tryExecute","DataListService","umbHttpClient","items","_b","x","key","event","UmbChangeEvent","when","__privateGet","css","__decorateClass","property","state","customElement"],"mappings":"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"}