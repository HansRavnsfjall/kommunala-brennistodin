"use strict";(function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(o){for(var r=this;r;){if(r.matches(o))return r;r=r.parentElement}}),document.addEventListener("DOMContentLoaded",W);function W(){var o=document.getElementsByClassName("umbraco-forms-form-config");if(o.length>0){for(var r=[],i=0;i<o.length;i++){var l=o[i],d={formId:l.dataset.id,pageButtonConditions:JSON.parse(l.dataset.serializedPageButtonConditions),fieldSetConditions:JSON.parse(l.dataset.serializedFieldsetConditions),fieldConditions:JSON.parse(l.dataset.serializedFieldConditions),triggerConditionsCheckOn:l.dataset.triggerConditionsCheckOn,disableValidationDependencyCheck:l.dataset.disableValidationDependencyCheck==="true",recordValues:JSON.parse(l.dataset.serializedFieldsNotDisplayed),formElementHtmlIdPrefix:l.dataset.formElementHtmlIdPrefix,validationRules:l.dataset.serializedValidationRules?JSON.parse(l.dataset.serializedValidationRules):[]};r.push(d)}O(r,!0)}else typeof umbracoFormsCollection>"u"?document.addEventListener("umbracoFormLoaded",E):O(umbracoFormsCollection);var a=document.getElementById("umbraco-forms-form-submitted");if(a){var c=a.dataset.formClientId;_(c)}}function O(o,r){j(o);for(var i=0;i<o.length;i++)E({form:o[i]},r)}function E(o,r){for(var i=r?o.form:JSON.parse(decodeURI(o.form)),l=document.querySelectorAll(".umbraco-forms-form"),d=0;d<l.length;d++){var a=l[d];i.disableValidationDependencyCheck||z(a);var c=a.querySelector(".umbraco-forms-page"),n=new Y(c,i.pageButtonConditions,i.fieldSetConditions,i.fieldConditions,i.triggerConditionsCheckOn&&i.triggerConditionsCheckOn.length>0?i.triggerConditionsCheckOn:"change",i.recordValues,i.formElementHtmlIdPrefix);n.watch(),J(a)}}function _(o){document.onreadystatechange=function(){if(document.readyState=="complete"){var d=document.querySelectorAll(".field-validation-error"),a=document.querySelectorAll(".umbraco-forms-submitmessage"),c=document.querySelectorAll(".umbraco-forms-submitmessage-html"),n=document.getElementById("umbraco_form_"+o);d.length>0?r(d):a.length>0?i(a[0].parentElement):c.length>0?i(c[0]):n&&i(n)}};function r(d){for(var a=0,c=0;c<d.length;c++){var n=l(d[c]),h=n.getBoundingClientRect().top;0<h&&(h<a||a===0)&&(a=h)}a>0&&window.scrollTo(0,a)}function i(d){d.scrollIntoView({behavior:"auto",block:"start"})}function l(d){for(var a=d;a.tagName!=="BODY";){if(a.classList.contains("umbraco-forms-field"))return a;a=a.parentNode}return d}}function j(o){var r,i;if(window.aspnetValidation!==void 0){var l=new aspnetValidation.ValidationService,d=function(e,u){if(u.type.toLowerCase()==="checkbox"||u.type.toLowerCase()==="radio"){for(var f=u.form.querySelectorAll("input[name='"+u.name+"']"),m=0;m<f.length;m++)if(f[m].checked===!0)return!0;return!1}return!!e};l.addProvider("requiredcb",d),l.addProvider("required",d);var a=function(e,u,f){if(!e||!f.pattern)return!0;var m=new RegExp(f.pattern);return m.test(e)};l.addProvider("umbracoforms_regex",a);var c=function(e){return function(u,f,m){return f.offsetParent===null?!0:e(u,f,m)}};window.addEventListener("load",function(){for(var e in l.providers)l.providers[e]=c(l.providers[e])}),l.bootstrap(),window.umbracoFormsValidationService=l;var n=function(){this.form.elements.PreviousClicked.value="clicked"},h=document.querySelectorAll("[data-umb='prev-forms-form']");h.length===0&&(h=document.getElementsByClassName("prev cancel"));for(var t=0;t<h.length;t++)h[t].form.elements.PreviousClicked.value="",h[t].addEventListener("click",n,!1);r=U();for(let e=0;e<r.length;e++)i=r[e],i.addEventListener("click",function(u){u.preventDefault();var f=u.currentTarget.form,m=q(f,o);l.validateForm(f,b=>{var N=V(f,m,"aspnet-client-validation",l);if(b=b&&N,b){P(f);var I=f.querySelectorAll("[type=submit]:not(.cancel)");for(let g=0;g<I.length;g++)I[g].setAttribute("disabled","disabled")}})})}else if(typeof jQuery=="function"&&$.validator&&$.validator.unobtrusive){$.validator.setDefaults({ignore:":hidden"}),$.validator.unobtrusive.adapters.addBool("requiredcb","required"),$.validator.addMethod("umbracoforms_regex",function(e,u){var f=$(u).attr("data-regex"),m=$(u).val();return m.length===0?!0:m.match(f)}),$.validator.unobtrusive.adapters.addBool("regex","umbracoforms_regex"),r=U();for(let e=0;e<r.length;e++)i=r[e],i.addEventListener("click",function(u){u.preventDefault();var f=$(this).closest("form");M(f[0]);var m=f.validate(),b=q(f[0],o),N=f.valid(),I=V(f[0],b,"jquery",m);N&&I&&(P(f),this.setAttribute("disabled","disabled"))}.bind(i))}}function U(){return document.querySelectorAll(".umbraco-forms-form [type=submit]:not(.cancel)")}function q(o,r){var i=r.filter(a=>a.formId===o.FormId.value.replaceAll("-",""));if(i.length>0&&i[0].validationRules){var l=structuredClone(i[0].validationRules),d=new FormData(o);return l.map(a=>D(a,d))}return[]}function D(o,r){var i=o.rule;for(var l of r)i=i.replaceAll("{"+l[0]+"}",l[1]);return o.rule=i,o}function V(o,r,i,l){if(typeof jsonLogic>"u")return!0;for(var d=!0,a=0;a<r.length;a++){var c=r[a],n=/{({*[\w]*}*)}/;if(!c.rule.match(n)){var h;try{h=JSON.parse(c.rule)}catch{continue}var t=jsonLogic.apply(h);H(o,i,l,t,c),d=d&&t}}return d}function H(o,r,i,l,d){if(d.fieldId){var a=o[d.fieldId];if(a.length&&a.length>0&&(a=Array.from(a).filter(h=>h.id===d.fieldId)[0]),r==="aspnet-client-validation")if(l){var c=S(a,"error");c&&c.innerText===d.errorMessage&&i.removeError(a)}else i.addError(a,d.errorMessage);else if(r==="jquery"){var n=o.querySelector(".validation-summary-errors ul");if(l){var c=S(a,"error");c&&c.innerText===d.errorMessage&&(c.classList.remove("field-validation-error"),c.classList.add("field-validation-valid"),c.innerText=""),B(n,d.errorMessage)}else{var c=S(a,"valid");c&&(c.classList.remove("field-validation-valid"),c.classList.add("field-validation-error"),c.innerText=d.errorMessage),R(n,d.errorMessage)}}}}function S(o,r){return o.closest(".umbraco-forms-field-wrapper").querySelector(".field-validation-"+r)}function B(o,r){o&&o.querySelectorAll("li").forEach(i=>{i.innerText===r&&i.remove()})}function R(o,r){if(B(o,r),o){var i=document.createElement("li");i.appendChild(document.createTextNode(validationRule.errorMessage)),o.appendChild(i)}}function P(o){o.requestSubmit?o.requestSubmit():o.submit()}function z(o){var r=document.createElement("div");r.className="umbraco-forms missing-library",r.style.color="#fff",r.style.backgroundColor="#9d261d",r.style.padding="15px",r.style.margin="10px 0";var i="";if(o){var l=o.getElementsByClassName("umbraco-forms missing-library");if(l.length>0)return;var d=!1;(window.jQuery&&$&&$.validator!==void 0||window.aspnetValidation!==void 0)&&(d=!0),d===!1&&(i=i+"Umbraco Forms requires a validation framework to run, please read documentation for posible options."),i!==""&&(r.innerHTML=i+'<br/> <a href="https://docs.umbraco.com/umbraco-forms/developer/prepping-frontend" target="_blank" style="text-decoration:underline; color:#fff;">See Umbraco Forms Documentation</a>',o.insertBefore(r,o.childNodes[0]))}}function J(o){K(o)}function K(o){if("MutationObserver"in window){if(window.aspnetValidation!==void 0){var r=o.getElementsByTagName("form")[0],i=function(){M(r)};r.addEventListener("submit",i,!1)}var l=new MutationObserver(function(d){for(var a=0;a<d.length;a++){var c=d[a];if(c.target.className==="field-validation-error"){Q(c.target);break}}});l.observe(o,{attributes:!0,attributeFilter:["class"],childList:!1,characterData:!1,subtree:!0})}}function M(o){for(var r=o.getElementsByClassName("field-validation-error"),i=0;i<r.length;i++)r[i].className="field-validation-valid"}function Q(o){for(var r=o.previousElementSibling;r;){if(r.tagName.toLowerCase()==="input"||r.tagName.toLowerCase()==="textarea"||r.tagName.toLowerCase()==="select"){r.focus();break}if(r.classList.contains("radiobuttonlist")||r.classList.contains("checkboxlist")){for(var i=0;i<r.children.length;i++){var l=r.children[i];if(l.tagName.toLowerCase()==="input"){l.focus();break}}break}r=r.previousElementSibling}}function Y(o,r,i,l,d,a,c){var n={};n.form=o,n.pageButtonConditions=r,n.fieldsetConditions=i,n.fieldConditions=l,n.triggerConditionsCheckOn=d,n.values=a,n.formElementHtmlIdPrefix=c,n.dataTypes={};function h(t,e,u){var f=t.querySelectorAll("select");for(let g=0;g<f.length;g++){const s=f[g];e[s.getAttribute("id")]=s.value,u[s.getAttribute("id")]="select"}var m=t.querySelectorAll("textarea");for(let g=0;g<m.length;g++){const s=m[g];e[s.getAttribute("id")]=s.value,u[s.getAttribute("id")]="textarea"}var b=function(g){const s=g.getAttribute("id").split("_");return s.slice(0,s.length-1).join("_")},N=t.querySelectorAll("input[type=checkbox]");for(let g=0;g<N.length;g++){const s=N[g];if(s.getAttribute("id")!==n.formElementHtmlIdPrefix+s.getAttribute("name")){const C=b(s);e[C]=null,u[C]="checkbox"}else e[s.getAttribute("id")]=null,u[s.getAttribute("id")]="checkbox"}var I=t.querySelectorAll("input");for(let g=0;g<I.length;g++){const s=I[g];if((s.getAttribute("type")==="text"||s.getAttribute("type")==="number"||s.getAttribute("type")==="email"||s.getAttribute("type")==="url"||s.getAttribute("type")==="tel"||s.getAttribute("type")==="time"||s.getAttribute("type")==="date"||s.getAttribute("type")==="datetime-local"||s.getAttribute("type")==="hidden")&&(e[s.getAttribute("id")]=s.value,u[s.getAttribute("id")]="text"),s.getAttribute("type")==="radio"&&s.matches(":checked")){const C=b(s);e[C]=s.value,u[C]="radio"}if(s.getAttribute("type")==="checkbox")if(s.getAttribute("id")!==n.formElementHtmlIdPrefix+s.getAttribute("name")){const C=b(s);s.matches(":checked")&&(e[C]===null?e[C]=s.value:e[C]+=";;"+s.value)}else e[s.getAttribute("id")]=s.matches(":checked")?"true":"false"}}return n.operators={Is:function(t,e){if((t||"")===e)return!0;if(t==null)return e==t;e.toUpperCase()==="TRUE"||e.toUpperCase()==="ON"?e="true":(e.toUpperCase()==="FALSE"||e.toUpperCase()==="OFF")&&(e="false"),t==="true;;false"&&(t="true");var u=t.split(";;"),f=u.filter(function(m){return m===e});return f.length===u.length},IsNot:function(t,e,u){if(t==null)return e!=t;t==="true;;false"&&(t="true");var f=t.split(";;"),m=f.filter(function(b){return b===e});return u==="checkbox"&&(e.toUpperCase()==="TRUE"||e.toUpperCase()==="ON"?e="true":(e.toUpperCase()==="FALSE"||e.toUpperCase()==="OFF")&&(e="false")),(t||"")!==e&&m.length!=f.length},GreaterThen:function(t,e){return isNaN(t)||isNaN(e)?t>e:parseInt(t)>parseInt(e)},LessThen:function(t,e){return isNaN(t)||isNaN(e)?t<e:parseInt(t)<parseInt(e)},StartsWith:function(t,e){return t&&t.startsWith(e)},EndsWith:function(t,e){return t&&t.endsWith(e)},Contains:function(t,e){return t&&t.indexOf(e)>-1},ContainsIgnoreCase:function(t,e){return t&&e&&t.toUpperCase().indexOf(e.toUpperCase())>=0},StartsWithIgnoreCase:function(t,e){return t&&e&&t.toUpperCase().startsWith(e.toUpperCase())},EndsWithIgnoreCase:function(t,e){return t&&e&&t.toUpperCase().endsWith(e.toUpperCase())},NotContains:function(t,e){return!t||e&&t.indexOf(e)<0},NotStartsWith:function(t,e){return!t||e&&!t.startsWith(e)},NotEndsWith:function(t,e){return!t||e&&!t.endsWith(e)},NotContainsIgnoreCase:function(t,e){return!t||e&&t.toUpperCase().indexOf(e.toUpperCase())<0},NotStartsWithIgnoreCase:function(t,e){return!t||e&&!t.toUpperCase().startsWith(e.toUpperCase())},NotEndsWithIgnoreCase:function(t,e){return!t||e&&!t.toUpperCase().endsWith(e.toUpperCase())}},n.watch=function(){var t=n.form.querySelectorAll(".datepickerfield");for(let u=0;u<t.length;u++){const f=t[u];f.addEventListener("blur",function(){if(this.value===""){var m=this.getAttribute("id"),b=m+"_1";n.values[b]="",document.getElementById(b).value=""}h(n.form,n.values,n.dataTypes),n.run()}.bind(f))}var e=n.form.querySelectorAll("input, textarea, select");for(let u=0;u<e.length;u++){const f=e[u];f.addEventListener(n.triggerConditionsCheckOn,function(){h(n.form,n.values,n.dataTypes),n.run()}.bind(f))}h(n.form,n.values,n.dataTypes),n.run()},n.run=function(){var t,e,u,f,m={};function b(p){var v=n.values[n.formElementHtmlIdPrefix+p.field],k=n.operators[p.operator],A=v!==null&&k(v,p.value);return A}function N(p){var v=!0;return n.fieldConditions[p.field]&&(v=s(p.field,n.fieldConditions[p.field])),v?b(p):!1}function I(p,v){var k=v.logicType==="Any",A=v.logicType==="All",F={},L=!1,x=!0,y,w;if(v.rules.length===0)return!1;for(w=0;w<v.rules.length;w++){if(y=v.rules[w],p===y.field||p===y.fieldsetId)throw new Error("Field or fieldset "+p+" has a condition on itself.");F[y.fieldsetId]===void 0&&(n.fieldsetConditions[y.fieldsetId]?(F[y.fieldsetId]=s(y.fieldsetId,n.fieldsetConditions[y.fieldsetId]),F[y.fieldsetId]||(L=!0)):F[y.fieldsetId]=!0)}if(A&&L)return!1;for(w=0;w<v.rules.length&&(y=v.rules[w],F[y.fieldsetId]?x=N(v.rules[w]):x=!1,!(k&&x||A&&!x));w++);return x}function g(p,v){var k=v.actionType==="Show",A=m[p],F;A===void 0?(m[p]=k,F=m[p]=I(p,v)):F=A;var L=!(F^k);return L}function s(p,v){return v?g(p,v):!0}function C(p,v,k){var A=s(v,k);p&&(A?p.classList.remove("umbraco-forms-hidden"):p.classList.add("umbraco-forms-hidden"))}for(t in n.pageButtonConditions)if(Object.prototype.hasOwnProperty.call(n.pageButtonConditions,t)){var T=document.getElementById(t);T&&C(T.querySelector("input[name='__next'], button[name='__next'], input[data-form-navigate='next'], button[data-form-navigate='next']"),t,n.pageButtonConditions[t],"Page")}for(u in n.fieldsetConditions)Object.prototype.hasOwnProperty.call(n.fieldsetConditions,u)&&(e=n.formElementHtmlIdPrefix+u,C(document.getElementById(e),u,n.fieldsetConditions[u],"Fieldset"));for(f in n.fieldConditions)Object.prototype.hasOwnProperty.call(n.fieldConditions,f)&&(e=n.formElementHtmlIdPrefix+f,document.getElementById(e)&&C(document.getElementById(e).closest(".umbraco-forms-field"),f,n.fieldConditions[f],"Field"))},n}})();
