{"version":3,"file":"workspace-view-form-info.element.js","sources":["../../../../src/section/forms/workspace/views/info/workspace-view-form-info.element.ts"],"sourcesContent":["import { FORMS_FORM_WORKSPACE_CONTEXT } from \"../../form-workspace.context-token.js\";\nimport {\n  css,\n  html,\n  customElement,\n  state,\n  LitElement,\n  when,\n} from \"@umbraco-cms/backoffice/external/lit\";\nimport type { UmbWorkspaceViewElement } from \"@umbraco-cms/backoffice/workspace\";\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\nimport { FormService } from \"@umbraco-forms/generated\";\nimport type { RelationItemModel, FormDesign } from \"@umbraco-forms/generated\";\nimport { tryExecute } from \"@umbraco-cms/backoffice/resources\";\nimport { DateTimeOptions } from \"@umbraco-forms/entities\";\n\nconst elementName = \"workspace-view-form-info\";\n\n@customElement(elementName)\nexport class UmbWorkspaceViewFormInfoElement\n  extends UmbElementMixin(LitElement)\n  implements UmbWorkspaceViewElement\n{\n  #workspaceContext?: typeof FORMS_FORM_WORKSPACE_CONTEXT.TYPE;\n\n  @state()\n  _form?: FormDesign;\n\n  @state()\n  _relations: Array<RelationItemModel> = [];\n\n  constructor() {\n    super();\n\n    this.consumeContext(FORMS_FORM_WORKSPACE_CONTEXT, (instance) => {\n      this.#workspaceContext = instance;\n      this.#observeForm();\n    });\n  }\n\n  #observeForm() {\n    if (!this.#workspaceContext) return;\n\n    this.observe(this.#workspaceContext.data, async (form) => {\n      if (!form) return;\n      this._form = form;\n\n      if (!this.#workspaceContext?.getIsNew()) {\n        await this.#populateRelations(form.id);\n      }\n    });\n  }\n\n  async #populateRelations(id: string) {\n    const { data, error } = await tryExecute(\n      this,\n      FormService.getFormByIdRelations({ path: { id } }),\n    );\n    if (!error) {\n      this._relations = data.items;\n    }\n  }\n\n  render() {\n    return html`\n      <uui-box .headline=${this.localize.term(\"general_general\")}>\n        <umb-property-layout .label=${this.localize.term(\"general_id\")}>\n          <span slot=\"editor\">${this._form?.unique}</span>\n        </umb-property-layout>\n        ${when(\n          !this.#workspaceContext?.getIsNew(),\n          () => html`\n            <umb-property-layout\n              .label=${this.localize.term(\"content_createDate\")}\n            >\n              <umb-localize-date\n                slot=\"editor\"\n                .date=${this._form?.created}\n                .options=${DateTimeOptions}\n              ></umb-localize-date>\n            </umb-property-layout>\n            ${when(\n              this._form?.createdBy,\n              () => html`\n                <umb-property-layout\n                  .label=${this.localize.term(\"content_createBy\")}\n                >\n                  <div slot=\"editor\">${this._form?.createdByName}</div>\n                </umb-property-layout>\n              `,\n            )}\n            <umb-property-layout\n              .label=${this.localize.term(\"content_updateDate\")}\n            >\n              <umb-localize-date\n                slot=\"editor\"\n                .date=${this._form?.updated}\n                .options=${DateTimeOptions}\n              ></umb-localize-date>\n            </umb-property-layout>\n            ${when(\n              this._form?.updatedBy,\n              () => html`\n                <umb-property-layout\n                  .label=${this.localize.term(\"content_updatedBy\")}\n                >\n                  <div slot=\"editor\">${this._form?.updatedByName}</div>\n                </umb-property-layout>\n              `,\n            )}\n          `,\n        )}\n      </uui-box>\n      ${when(\n        !this.#workspaceContext?.getIsNew(),\n        () => html`\n          <uui-box\n            headline=${this.localize.term(\"formSettings_referencesTitle\")}\n          >\n            <uui-table>\n              <uui-table-head>\n                <uui-table-head-cell\n                  >${this.localize.term(\n                    \"general_nodeName\",\n                  )}</uui-table-head-cell\n                >\n                <uui-table-head-cell\n                  >${this.localize.term(\"general_status\")}</uui-table-head-cell\n                >\n                <uui-table-head-cell\n                  >${this.localize.term(\n                    \"general_typeName\",\n                  )}</uui-table-head-cell\n                >\n                <uui-table-head-cell\n                  >${this.localize.term(\"general_type\")}</uui-table-head-cell\n                >\n                <uui-table-head-cell\n                  >${this.localize.term(\n                    \"relationType_relation\",\n                  )}</uui-table-head-cell\n                >\n              </uui-table-head>\n              ${this._relations.map(\n                (relation) =>\n                  html`<uui-table-row>\n                    <uui-table-cell>${relation.nodeName}</uui-table-cell>\n                    <uui-table-cell\n                      >${this.localize.term(\n                        \"content_\" +\n                          (relation.nodePublished\n                            ? \"published\"\n                            : \"unpublished\"),\n                      )}</uui-table-cell\n                    >\n                    <uui-table-cell>${relation.contentTypeName}</uui-table-cell>\n                    <uui-table-cell>${relation.nodeType}</uui-table-cell>\n                    <uui-table-cell\n                      >${relation.relationTypeName}</uui-table-cell\n                    >\n                  </uui-table-row>`,\n              )}\n            </uui-table>\n          </uui-box>\n        `,\n      )}\n    `;\n  }\n\n  static styles = [\n    css`\n      :host {\n        display: block;\n        padding: var(--uui-size-layout-1);\n      }\n\n      uui-box + uui-box {\n        margin-top: var(--uui-size-layout-1);\n      }\n    `,\n  ];\n}\n\nexport default UmbWorkspaceViewFormInfoElement;\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [elementName]: UmbWorkspaceViewFormInfoElement;\n  }\n}\n"],"names":["_workspaceContext","_UmbWorkspaceViewFormInfoElement_instances","observeForm_fn","populateRelations_fn","elementName","UmbWorkspaceViewFormInfoElement","UmbElementMixin","LitElement","__privateAdd","FORMS_FORM_WORKSPACE_CONTEXT","instance","__privateSet","__privateMethod","html","_a","when","_b","__privateGet","DateTimeOptions","_c","_d","relation","form","id","data","error","tryExecute","FormService","css","__decorateClass","state","customElement","UmbWorkspaceViewFormInfoElement$1"],"mappings":"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"}