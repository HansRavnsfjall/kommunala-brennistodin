{"version":3,"file":"workspace-view-security-permissions-base.element.js","sources":["../../../../src/section/security/workspace/views/permissions/workspace-view-security-permissions-base.element.ts"],"sourcesContent":["import type { PackagePermissionsSecurityBase } from \"../../../entities.js\";\nimport type { FormsSecurityUserWorkspaceContext } from \"../../security-user-workspace.context.js\";\nimport type { FormsSecurityUserGroupWorkspaceContext } from \"../../security-user-group-workspace.context.js\";\nimport { UmbTextStyles } from \"@umbraco-cms/backoffice/style\";\nimport { css, html, LitElement } from \"@umbraco-cms/backoffice/external/lit\";\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\nimport type {\n  UserFormSecurity,\n  UserGroupFormSecurity,\n} from \"@umbraco-forms/generated\";\nimport type { FormsInputFolderElement } from \"@umbraco-forms/components\";\nimport type { UUIBooleanInputEvent } from \"@umbraco-cms/backoffice/external/uui\";\n\nexport abstract class UmbWorkspaceViewSecurityPermissionsBaseElement<\n  ContextType extends\n    | FormsSecurityUserWorkspaceContext\n    | FormsSecurityUserGroupWorkspaceContext,\n> extends UmbElementMixin(LitElement) {\n  workspaceContext?: ContextType;\n\n  abstract onPackagePermissionsChange(\n    e: UUIBooleanInputEvent,\n    key: keyof PackagePermissionsSecurityBase,\n  ): void;\n\n  abstract observeSecurityItem(): void;\n\n  constructor(contextAlias: string) {\n    super();\n\n    this.consumeContext(contextAlias, (instance) => {\n      this.workspaceContext = instance as ContextType;\n      this.observeSecurityItem();\n    });\n  }\n\n  renderSecurityTable(\n    formsSecurity: Array<UserFormSecurity | UserGroupFormSecurity>,\n  ) {\n    if (!this.workspaceContext) return;\n\n    return html`<uui-box\n      .headline=${this.localize.term(\"formSecurity_manageIndividualFormsLabel\")}\n    >\n      <umb-property-layout\n        alias=\"forms\"\n        .label=${this.localize.term(\"sections_forms\")}\n        .description=${this.localize.term(\n          \"formSecurity_manageIndividualFormsDescription\",\n        )}\n      >\n        <form-security-table\n          slot=\"editor\"\n          .records=${formsSecurity ?? []}\n          .set=${(formId: string, value: boolean) =>\n            this.workspaceContext?.setFormSecurityAccess(formId, value)}\n          .toggle=${(formId: string) =>\n            this.workspaceContext?.toggleFormSecurityAccess(formId)}\n        ></form-security-table>\n      </umb-property-layout>\n    </uui-box>`;\n  }\n\n  renderStartFolders(startFolderIds: Array<string>) {\n    if (!this.workspaceContext) return;\n\n    const onChange = (event: Event) => {\n      const target = event.target as FormsInputFolderElement;\n      this.workspaceContext?.setProperty(\"startFolderIds\", target.selection);\n      this.dispatchEvent(new CustomEvent(\"valueChange\"));\n    };\n\n    return html`<uui-box\n      .headline=${this.localize.term(\"formSecurity_startFolders\")}\n    >\n      <umb-property-layout\n        alias=\"startFolders\"\n        .label=${this.localize.term(\"formSecurity_selectNewStartFolders\")}\n        .description=${this.localize.term(\n          \"formSecurity_startFoldersDescription\",\n        )}\n      >\n        <forms-input-folder\n          .selection=${startFolderIds}\n          @change=${onChange}\n          slot=\"editor\"\n        ></forms-input-folder>\n      </umb-property-layout>\n    </uui-box>`;\n  }\n\n  renderToggles(security?: PackagePermissionsSecurityBase) {\n    if (!security) return;\n\n    return html`<uui-box\n      headline=${this.localize.term(\"formSecurity_packagePermissions\")}\n    >\n      <umb-property-layout\n        alias=\"manageForms\"\n        .label=${this.localize.term(\"formSecurity_manageFormsLabel\")}\n        .description=${this.localize.term(\n          \"formSecurity_manageFormsDescription\",\n        )}\n      >\n        <uui-toggle\n          slot=\"editor\"\n          ?checked=${security.manageForms}\n          @change=${(e: UUIBooleanInputEvent) =>\n            this.onPackagePermissionsChange(e, \"manageForms\")}\n        ></uui-toggle>\n      </umb-property-layout>\n      <umb-property-layout\n        alias=\"viewEntries\"\n        .label=${this.localize.term(\"formSecurity_viewEntriesLabel\")}\n        .description=${this.localize.term(\n          \"formSecurity_viewEntriesDescription\",\n        )}\n      >\n        <uui-toggle\n          slot=\"editor\"\n          ?checked=${security.viewEntries}\n          @change=${(e: UUIBooleanInputEvent) =>\n            this.onPackagePermissionsChange(e, \"viewEntries\")}\n        ></uui-toggle>\n      </umb-property-layout>\n      <umb-property-layout\n        alias=\"editEntries\"\n        .label=${this.localize.term(\"formSecurity_editEntriesLabel\")}\n        .description=${this.localize.term(\n          \"formSecurity_editEntriesDescription\",\n        )}\n      >\n        <uui-toggle\n          slot=\"editor\"\n          ?checked=${security.editEntries}\n          ?disabled=${!security.viewEntries}\n          @change=${(e: UUIBooleanInputEvent) =>\n            this.onPackagePermissionsChange(e, \"editEntries\")}\n        ></uui-toggle>\n      </umb-property-layout>\n      <umb-property-layout\n        alias=\"editEntries\"\n        .label=${this.localize.term(\"formSecurity_deleteEntriesLabel\")}\n        .description=${this.localize.term(\n          \"formSecurity_deleteEntriesDescription\",\n        )}\n      >\n        <uui-toggle\n          slot=\"editor\"\n          ?checked=${security.deleteEntries}\n          ?disabled=${!security.viewEntries}\n          @change=${(e: UUIBooleanInputEvent) =>\n            this.onPackagePermissionsChange(e, \"deleteEntries\")}\n        ></uui-toggle>\n      </umb-property-layout>\n      <umb-property-layout\n        alias=\"manageWorkflows\"\n        .label=${this.localize.term(\"formSecurity_manageWorkflowsLabel\")}\n        .description=${this.localize.term(\n          \"formSecurity_manageWorkflowsDescription\",\n        )}\n      >\n        <uui-toggle\n          slot=\"editor\"\n          ?checked=${security.manageWorkflows}\n          @change=${(e: UUIBooleanInputEvent) =>\n            this.onPackagePermissionsChange(e, \"manageWorkflows\")}\n        ></uui-toggle>\n      </umb-property-layout>\n      <umb-property-layout\n        alias=\"manageDatasources\"\n        .label=${this.localize.term(\"formSecurity_manageDatasourcesLabel\")}\n        .description=${this.localize.term(\n          \"formSecurity_manageDatasourcesDescription\",\n        )}\n      >\n        <uui-toggle\n          slot=\"editor\"\n          ?checked=${security.manageDataSources}\n          @change=${(e: UUIBooleanInputEvent) =>\n            this.onPackagePermissionsChange(e, \"manageDataSources\")}\n        ></uui-toggle>\n      </umb-property-layout>\n      <umb-property-layout\n        alias=\"managePrevalueSources\"\n        .label=${this.localize.term(\"formSecurity_managePrevalueSourcesLabel\")}\n        .description=${this.localize.term(\n          \"formSecurity_managePrevalueSourcesDescription\",\n        )}\n      >\n        <uui-toggle\n          slot=\"editor\"\n          ?checked=${security.managePreValueSources}\n          @change=${(e: UUIBooleanInputEvent) =>\n            this.onPackagePermissionsChange(e, \"managePreValueSources\")}\n        ></uui-toggle>\n      </umb-property-layout>\n    </uui-box>`;\n  }\n\n  static styles = [\n    UmbTextStyles,\n    css`\n      :host {\n        display: block;\n        padding: var(--uui-size-layout-1);\n      }\n\n      uui-box {\n        margin-bottom: var(--uui-size-6);\n      }\n    `,\n  ];\n}\n"],"names":["_UmbWorkspaceViewSecurityPermissionsBaseElement","UmbElementMixin","LitElement","contextAlias","instance","formsSecurity","html","formId","value","_a","startFolderIds","onChange","event","target","security","UmbTextStyles","css","UmbWorkspaceViewSecurityPermissionsBaseElement"],"mappings":"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"}