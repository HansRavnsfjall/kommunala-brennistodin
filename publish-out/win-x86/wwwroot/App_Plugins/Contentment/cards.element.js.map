{"version":3,"file":"cards.element.js","sources":["../../../../Umbraco.Community.Contentment.Client/src/extensions/display-mode/cards/cards.element.ts"],"sourcesContent":["// SPDX-License-Identifier: MPL-2.0\r\n// Copyright Â© 2025 Lee Kelleher\r\n\r\nimport { css, customElement, html, nothing, repeat, styleMap, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { ContentmentDisplayModeElement } from '../display-mode-base.element.js';\r\nimport type { ContentmentListItem } from '../../../property-editor-ui/types.js';\r\nimport type { SortableEvent } from '../../../external/sortablejs/index.js';\r\nimport type { StyleInfo } from '@umbraco-cms/backoffice/external/lit';\r\n\r\n@customElement('contentment-display-mode-cards')\r\nexport class ContentmentDisplayModeCardsElement extends ContentmentDisplayModeElement {\r\n\t#defaultIcon: string = 'icon-document';\r\n\r\n\t#onAdd(event: Event) {\r\n\t\tevent.stopPropagation();\r\n\t\tthis.dispatchEvent(new CustomEvent('add', { bubbles: true, detail: { listType: 'cards' } }));\r\n\t}\r\n\r\n\t#onEdit(event: Event, item: ContentmentListItem, index: number) {\r\n\t\tevent.stopPropagation();\r\n\t\tthis.dispatchEvent(new CustomEvent('edit', { bubbles: true, detail: { item, index } }));\r\n\t}\r\n\r\n\t#onRemove(event: Event, item: ContentmentListItem, index: number) {\r\n\t\tevent.stopPropagation();\r\n\t\tthis.dispatchEvent(new CustomEvent('remove', { bubbles: true, detail: { item, index } }));\r\n\t}\r\n\r\n\t#onSort(event: CustomEvent<SortableEvent>) {\r\n\t\tevent.stopPropagation();\r\n\t\tconst { newIndex, oldIndex } = event.detail;\r\n\t\tthis.dispatchEvent(new CustomEvent('sort', { bubbles: true, detail: { newIndex, oldIndex } }));\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<contentment-sortable-list\r\n\t\t\t\tclass=\"container\"\r\n\t\t\t\t?disabled=${!this.allowSort}\r\n\t\t\t\titem-selector=\"uui-card-media\"\r\n\t\t\t\t@sort-end=${this.#onSort}>\r\n\t\t\t\t${this.#renderItems()} ${this.#renderAddButton()}\r\n\t\t\t</contentment-sortable-list>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderAddButton() {\r\n\t\tif (!this.allowAdd) return nothing;\r\n\t\tconst label = this.localize.term(this.addButtonLabelKey ?? 'general_choose');\r\n\t\treturn html`\r\n\t\t\t<uui-button id=\"btn-add\" label=${label} look=\"placeholder\" @click=${this.#onAdd}>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<uui-icon name=\"icon-add\"></uui-icon>\r\n\t\t\t\t\t<span>${label}</span>\r\n\t\t\t\t</div>\r\n\t\t\t</uui-button>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItems() {\r\n\t\tif (!this.items) return;\r\n\t\treturn html`\r\n\t\t\t${repeat(\r\n\t\t\t\tthis.items,\r\n\t\t\t\t(item) => item.value,\r\n\t\t\t\t(item, index) => this.#renderItem(item, index)\r\n\t\t\t)}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: ContentmentListItem, index: number) {\r\n\t\tif (!item) return;\r\n\t\tconst cardStyle = (item.cardStyle as StyleInfo | null | undefined) ?? {};\r\n\t\tconst iconStyle = (item.iconStyle as StyleInfo | null | undefined) ?? {};\r\n\t\treturn html`\r\n\t\t\t<uui-card-media\r\n\t\t\t\tname=${item.name}\r\n\t\t\t\tdetail=${item.description ?? ''}\r\n\t\t\t\tstyle=${styleMap(cardStyle)}\r\n\t\t\t\t@open=${(event: Event) => this.#onEdit(event, item, index)}>\r\n\t\t\t\t${when(\r\n\t\t\t\t\titem.image,\r\n\t\t\t\t\t() => html`<img src=${item.image!} alt=\"\" />`,\r\n\t\t\t\t\t() => html`<umb-icon name=${item.icon ?? this.#defaultIcon} style=${styleMap(iconStyle)}></umb-icon>`\r\n\t\t\t\t)}\r\n\t\t\t\t${when(\r\n\t\t\t\t\tthis.allowEdit || this.allowRemove,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-action-bar slot=\"actions\">\r\n\t\t\t\t\t\t\t${when(\r\n\t\t\t\t\t\t\t\tthis.allowEdit,\r\n\t\t\t\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\t\t\tlabel=${this.localize.term('general_edit')}\r\n\t\t\t\t\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t@click=${(event: Event) => this.#onEdit(event, item, index)}>\r\n\t\t\t\t\t\t\t\t\t\t<uui-icon name=\"icon-edit\"></uui-icon>\r\n\t\t\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t${when(\r\n\t\t\t\t\t\t\t\tthis.allowRemove,\r\n\t\t\t\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\t\t\tlabel=${this.localize.term('general_remove')}\r\n\t\t\t\t\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\t\t\t\t\t@click=${(event: Event) => this.#onRemove(event, item, index)}>\r\n\t\t\t\t\t\t\t\t\t\t<uui-icon name=\"icon-trash\"></uui-icon>\r\n\t\t\t\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</uui-action-bar>\r\n\t\t\t\t\t`\r\n\t\t\t\t)}\r\n\t\t\t</uui-card-media>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tposition: relative;\r\n\t\t\t}\r\n\r\n\t\t\t/* TODO: [LK] Something strange is happening with the grid. The heights are all messed up! */\r\n\t\t\t.container {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tgrid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n\t\t\t\tgrid-template-rows: repeat(auto-fill, minmax(160px, 1fr));\r\n\t\t\t}\r\n\r\n\t\t\t#btn-add {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tmin-height: 174px;\r\n\r\n\t\t\t\t> div {\r\n\t\t\t\t\tdisplay: flex;\r\n\t\t\t\t\tflex-direction: column;\r\n\r\n\t\t\t\t\tline-height: 1.5;\r\n\t\t\t\t\tmargin: 0 var(--uui-size-6);\r\n\r\n\t\t\t\t\t> uui-icon {\r\n\t\t\t\t\t\tfont-size: var(--uui-size-8);\r\n\t\t\t\t\t\tmargin-bottom: var(--uui-size-4);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tuui-icon {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tmargin: 0 auto;\r\n\t\t\t}\r\n\r\n\t\t\tuui-card-media {\r\n\t\t\t\t&[drag-placeholder] {\r\n\t\t\t\t\topacity: 0.2;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tumb-icon {\r\n\t\t\t\t\tfont-size: var(--uui-size-8);\r\n\t\t\t\t\t/* HACK: To make the icon position appear vertically centred within the top half of the card. [LK] */\r\n\t\t\t\t\tpadding-bottom: var(--uui-size-12);\r\n\t\t\t\t\tmin-height: var(--uui-size-layout-6);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\timg {\r\n\t\t\t\tbackground-image: url('data:image/svg+xml;charset=utf-8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\" fill-opacity=\".1\"><path d=\"M50 0h50v50H50zM0 50h50v50H0z\"/></svg>');\r\n\t\t\t\tbackground-size: 10px 10px;\r\n\t\t\t\tbackground-repeat: repeat;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { ContentmentDisplayModeCardsElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'contentment-display-mode-cards': ContentmentDisplayModeCardsElement;\r\n\t}\r\n}\r\n"],"names":["_defaultIcon","_ContentmentDisplayModeCardsElement_instances","onAdd_fn","onEdit_fn","onRemove_fn","onSort_fn","renderAddButton_fn","renderItems_fn","renderItem_fn","ContentmentDisplayModeCardsElement","ContentmentDisplayModeElement","__privateAdd","html","__privateMethod","event","item","index","newIndex","oldIndex","nothing","label","repeat","cardStyle","iconStyle","styleMap","when","__privateGet","css","__decorateClass","customElement"],"mappings":"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"}