{"version":3,"file":"data-picker-modal.element.js","sources":["../../../../Umbraco.Community.Contentment.Client/src/property-editor-ui/data-picker/data-picker-modal.element.ts"],"sourcesContent":["// SPDX-License-Identifier: MPL-2.0\r\n// Copyright Â© 2024 Lee Kelleher\r\n\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tifDefined,\r\n\tnothing,\r\n\trepeat,\r\n\tstate,\r\n\twhen,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { debounce } from '@umbraco-cms/backoffice/utils';\r\nimport { tryExecute } from '@umbraco-cms/backoffice/resources';\r\nimport { umbFocus } from '@umbraco-cms/backoffice/lit-element';\r\nimport { umbHttpClient } from '@umbraco-cms/backoffice/http-client';\r\nimport { DataPickerService } from '../../api/sdk.gen.js';\r\nimport { UmbModalBaseElement, UmbModalToken } from '@umbraco-cms/backoffice/modal';\r\nimport {\r\n\tUMB_CONTENT_WORKSPACE_CONTEXT,\r\n\tUMB_PROPERTY_TYPE_BASED_PROPERTY_CONTEXT,\r\n} from '@umbraco-cms/backoffice/content';\r\nimport { UMB_PROPERTY_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport type { ContentmentListItem } from '../types.js';\r\nimport type { UUIInputEvent, UUIPaginationEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\ninterface ContentmentDataPickerModalData {\r\n\tallowDuplicates: boolean;\r\n\tdefaultIcon?: string;\r\n\tenableMultiple: boolean;\r\n\thideSearch: boolean;\r\n\tlistType: string;\r\n\tmaxItems: number;\r\n\tpageSize: number;\r\n\tvalue: Array<string>;\r\n}\r\n\r\ninterface ContentmentDataPickerModalValue {\r\n\tselection: Array<ContentmentListItem>;\r\n}\r\n\r\nexport const CONTENTMENT_DATA_PICKER_MODAL = new UmbModalToken<\r\n\tContentmentDataPickerModalData,\r\n\tContentmentDataPickerModalValue\r\n>('Umb.Contentment.Modal.DataPicker', {\r\n\tmodal: {\r\n\t\ttype: 'sidebar',\r\n\t\tsize: 'medium',\r\n\t},\r\n});\r\n\r\n@customElement('contentment-property-editor-ui-data-picker-modal')\r\nexport class ContentmentPropertyEditorUIDataPickerModalElement extends UmbModalBaseElement<\r\n\tContentmentDataPickerModalData,\r\n\tContentmentDataPickerModalValue\r\n> {\r\n\t@state()\r\n\tprivate _allowSubmit = false;\r\n\r\n\t@state()\r\n\tprivate _dataTypeKey?: string;\r\n\r\n\t@state()\r\n\tprivate _entityUnique?: string;\r\n\r\n\t@state()\r\n\tprivate _itemCount = 0;\r\n\r\n\t@state()\r\n\tprivate _items: Array<ContentmentListItem> = [];\r\n\r\n\t@state()\r\n\tprivate _loading = false;\r\n\r\n\t@state()\r\n\tprivate _pageNumber = 1;\r\n\r\n\t@state()\r\n\tprivate _propertyAlias?: string;\r\n\r\n\t@state()\r\n\tprivate _query = '';\r\n\r\n\t@state()\r\n\tprivate _totalPages = 0;\r\n\r\n\t@state()\r\n\tprivate _variantId?: string;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_CONTENT_WORKSPACE_CONTEXT, (contentWorkspaceContext) => {\r\n\t\t\tthis.observe(contentWorkspaceContext?.unique, (unique) => (this._entityUnique = unique || undefined));\r\n\t\t}).passContextAliasMatches();\r\n\r\n\t\tthis.consumeContext(UMB_PROPERTY_TYPE_BASED_PROPERTY_CONTEXT, (context) => {\r\n\t\t\tthis.observe(context?.dataType, (dataType) => (this._dataTypeKey = dataType?.unique));\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_PROPERTY_CONTEXT, (propertyContext) => {\r\n\t\t\tthis.observe(propertyContext?.alias, (alias) => (this._propertyAlias = alias));\r\n\t\t\tthis.observe(propertyContext?.variantId, (variantId) => (this._variantId = variantId?.toString() || 'invariant'));\r\n\t\t});\r\n\t}\r\n\r\n\toverride async firstUpdated() {\r\n\t\tthis.#requestItems();\r\n\t}\r\n\r\n\t#debouncedFilter = debounce((query: string) => {\r\n\t\tif (!this.data) return;\r\n\t\tthis._loading = true;\r\n\t\tthis._query = query;\r\n\t\tthis._pageNumber = 1;\r\n\t\tthis.#requestItems();\r\n\t}, 500);\r\n\r\n\t#onInput(event: UUIInputEvent) {\r\n\t\tthis.#debouncedFilter(event.target.value);\r\n\t}\r\n\r\n\t#onSelect(item: ContentmentListItem) {\r\n\t\tif (item.disabled) return;\r\n\r\n\t\tif (this.data?.enableMultiple) {\r\n\t\t\titem.selected = !item.selected;\r\n\t\t\tthis._itemCount = this._items.filter((x) => x.selected === true).length;\r\n\t\t\tthis._allowSubmit = this._itemCount > 0 && (this.data?.maxItems === 0 || this._itemCount <= this.data?.maxItems);\r\n\t\t} else {\r\n\t\t\tthis.value = { selection: [item] };\r\n\t\t\tthis._submitModal();\r\n\t\t}\r\n\t}\r\n\r\n\t#onPagination(event: UUIPaginationEvent) {\r\n\t\tthis._pageNumber = event.target.current;\r\n\t\tthis.#requestItems();\r\n\t}\r\n\r\n\t#onSubmit() {\r\n\t\tconst selection: Array<ContentmentListItem> = [];\r\n\r\n\t\tthis._items.forEach((item) => {\r\n\t\t\tif (item.selected) {\r\n\t\t\t\tdelete item.selected;\r\n\t\t\t\tselection.push(item);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.value = { selection };\r\n\r\n\t\tthis._submitModal();\r\n\t}\r\n\r\n\tasync #requestItems() {\r\n\t\tconst query = {\r\n\t\t\talias: this._propertyAlias,\r\n\t\t\tdataTypeKey: this._dataTypeKey,\r\n\t\t\tid: this._entityUnique,\r\n\t\t\tpageNumber: this._pageNumber,\r\n\t\t\tpageSize: this.data?.pageSize ?? 12,\r\n\t\t\tquery: this._query,\r\n\t\t\tvariant: this._variantId,\r\n\t\t};\r\n\r\n\t\tconst { data } = await tryExecute(this, DataPickerService.getDataPickerSearch({ client: umbHttpClient, query }));\r\n\r\n\t\tthis._items =\r\n\t\t\tdata?.items.map((item) => ({\r\n\t\t\t\t...item,\r\n\t\t\t\tname: item.name ?? item.value ?? '',\r\n\t\t\t\tvalue: item.value ?? '',\r\n\t\t\t})) ?? [];\r\n\r\n\t\tthis._loading = false;\r\n\t\tthis._totalPages = data?.total ?? 0;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=${this.localize.term('general_choose')}>\r\n\t\t\t\t${this.#renderFilter()} ${this.#renderInfo()} ${this.#renderItems()}\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=${this.localize.term('general_cancel')} @click=${this._rejectModal}></uui-button>\r\n\t\t\t\t\t${when(\r\n\t\t\t\t\t\tthis.data?.enableMultiple,\r\n\t\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\t\t\tlabel=${this.localize.term('buttons_select')}\r\n\t\t\t\t\t\t\t\t?disabled=${!this._allowSubmit}\r\n\t\t\t\t\t\t\t\t@click=${this.#onSubmit}></uui-button>\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderFilter() {\r\n\t\tif (this.data?.hideSearch) return nothing;\r\n\t\tconst label = this.localize.term('placeholders_filter');\r\n\t\treturn html`\r\n\t\t\t<uui-input\r\n\t\t\t\ttype=\"search\"\r\n\t\t\t\tid=\"filter\"\r\n\t\t\t\tautocomplete=\"off\"\r\n\t\t\t\tlabel=${label}\r\n\t\t\t\tplaceholder=${label}\r\n\t\t\t\t.value=${this._query}\r\n\t\t\t\t@input=${this.#onInput}\r\n\t\t\t\t${umbFocus()}>\r\n\t\t\t\t<uui-icon name=\"search\" slot=\"prepend\" id=\"filter-icon\"></uui-icon>\r\n\t\t\t</uui-input>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderInfo() {\r\n\t\tif (\r\n\t\t\t!this.data?.enableMultiple ||\r\n\t\t\tthis._itemCount === 0 ||\r\n\t\t\tthis.data?.maxItems === 0 ||\r\n\t\t\tthis._itemCount <= (this.data?.maxItems ?? Infinity)\r\n\t\t) {\r\n\t\t\treturn nothing;\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<contentment-info-box type=\"danger\">\r\n\t\t\t\t<span>\r\n\t\t\t\t\tToo many items selected, please unselect\r\n\t\t\t\t\t<strong>${this._itemCount - (this.data?.maxItems ?? 0)}</strong>\r\n\t\t\t\t\t${this._itemCount - (this.data?.maxItems ?? 0) === 1 ? 'item' : 'items'}.\r\n\t\t\t\t</span>\r\n\t\t\t</contentment-info-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItems() {\r\n\t\tif (this._loading) return html`<uui-loader></uui-loader>`;\r\n\t\tif (!this._totalPages) return this.#renderNoItems();\r\n\t\treturn html`\r\n\t\t\t${when(\r\n\t\t\t\t// HACK: [LK] Until I figure out how to render custom display modes in the modal.\r\n\t\t\t\tthis.data?.listType === 'cards',\r\n\t\t\t\t() => html`\r\n\t\t\t\t\t<section>\r\n\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\tthis._items,\r\n\t\t\t\t\t\t\t(item) => item.key,\r\n\t\t\t\t\t\t\t(item) => this.#renderItem(item)\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</section>\r\n\t\t\t\t`,\r\n\t\t\t\t() => html`\r\n\t\t\t\t\t<uui-box>\r\n\t\t\t\t\t\t<uui-ref-list>\r\n\t\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\t\tthis._items,\r\n\t\t\t\t\t\t\t\t(item) => item.key,\r\n\t\t\t\t\t\t\t\t(item) => this.#renderItem(item)\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</uui-ref-list>\r\n\t\t\t\t\t</uui-box>\r\n\t\t\t\t`\r\n\t\t\t)}\r\n\t\t\t${when(\r\n\t\t\t\tthis._totalPages > 1,\r\n\t\t\t\t() => html`\r\n\t\t\t\t\t<uui-pagination current=${this._pageNumber} total=${this._totalPages} @change=${this.#onPagination}>\r\n\t\t\t\t\t</uui-pagination>\r\n\t\t\t\t`\r\n\t\t\t)}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: ContentmentListItem) {\r\n\t\treturn when(\r\n\t\t\t// HACK: [LK] Until I figure out how to render custom display modes in the modal.\r\n\t\t\tthis.data?.listType === 'cards',\r\n\t\t\t() => html`\r\n\t\t\t\t<uui-card-media\r\n\t\t\t\t\tname=${item.name}\r\n\t\t\t\t\tdetail=${ifDefined(item.description ?? undefined)}\r\n\t\t\t\t\tselect-only\r\n\t\t\t\t\tselectable\r\n\t\t\t\t\t@selected=${() => this.#onSelect(item)}>\r\n\t\t\t\t\t${when(!item.image && item.icon, (_icon) => html`<umb-icon name=${_icon}></umb-icon>`)}\r\n\t\t\t\t\t${when(item.image, () => html`<img src=${item.image!} alt=\"\" />`)}\r\n\t\t\t\t</uui-card-media>\r\n\t\t\t`,\r\n\t\t\t() => html`\r\n\t\t\t\t<umb-ref-item\r\n\t\t\t\t\tname=${item.name}\r\n\t\t\t\t\tdetail=${ifDefined(item.description ?? undefined)}\r\n\t\t\t\t\ticon=${ifDefined(item.icon ?? this.data?.defaultIcon ?? 'icon-document')}\r\n\t\t\t\t\tselect-only\r\n\t\t\t\t\tselectable\r\n\t\t\t\t\t@selected=${() => this.#onSelect(item)}\r\n\t\t\t\t\t@deselected=${() => this.#onSelect(item)}>\r\n\t\t\t\t</umb-ref-item>\r\n\t\t\t`\r\n\t\t);\r\n\t}\r\n\r\n\t#renderNoItems() {\r\n\t\treturn html`\r\n\t\t\t<uui-box>\r\n\t\t\t\t<p>\r\n\t\t\t\t\t<umb-localize key=\"general_searchNoResult\">Sorry, we can not find what you are looking for.</umb-localize>\r\n\t\t\t\t</p>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#filter {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t#filter-icon {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tcolor: var(--uui-color-border);\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tpadding-left: var(--uui-size-space-2);\r\n\t\t\t}\r\n\r\n\t\t\tcontentment-info-box,\r\n\t\t\tuui-box {\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\tsection {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: var(--uui-size-space-3);\r\n\t\t\t\tgrid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\r\n\t\t\t\tgrid-template-rows: repeat(auto-fill, minmax(160px, 1fr));\r\n\t\t\t\tmargin-bottom: var(--uui-size-space-5);\r\n\r\n\t\t\t\tuui-card-media {\r\n\t\t\t\t\tmin-height: 160px;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport { ContentmentPropertyEditorUIDataPickerModalElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'contentment-property-editor-ui-data-picker-modal': ContentmentPropertyEditorUIDataPickerModalElement;\r\n\t}\r\n}\r\n"],"names":["_debouncedFilter","_ContentmentPropertyEditorUIDataPickerModalElement_instances","onInput_fn","onSelect_fn","onPagination_fn","onSubmit_fn","requestItems_fn","renderFilter_fn","renderInfo_fn","renderItems_fn","renderItem_fn","renderNoItems_fn","CONTENTMENT_DATA_PICKER_MODAL","UmbModalToken","ContentmentPropertyEditorUIDataPickerModalElement","UmbModalBaseElement","__privateAdd","debounce","query","__privateMethod","UMB_CONTENT_WORKSPACE_CONTEXT","contentWorkspaceContext","unique","UMB_PROPERTY_TYPE_BASED_PROPERTY_CONTEXT","context","dataType","UMB_PROPERTY_CONTEXT","propertyContext","alias","variantId","html","when","_a","event","__privateGet","item","x","_b","_c","selection","data","tryExecute","DataPickerService","umbHttpClient","nothing","label","umbFocus","_d","_e","repeat","ifDefined","_icon","css","__decorateClass","state","customElement"],"mappings":"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"}