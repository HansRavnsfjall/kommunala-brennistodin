{"version":3,"file":"default-pipeline-view-CzfxRtJj.js","sources":["../../../jumoo-processing-assets/src/pipeline/workspace/views/default-pipeline-view.ts"],"sourcesContent":["import {\r\n\tcustomElement,\r\n\thtml,\r\n\tnothing,\r\n\tstate,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { JUMOO_PROCESSING_PIPELINE_WORKSPACE } from '../pipeline-workspace.context';\r\nimport {\r\n\tJumooProcessingModalInfo,\r\n\tPipeline,\r\n\tPipelineContext,\r\n\tPipelineStatus,\r\n} from '@jumoo/processing';\r\nimport { UMB_MODAL_CONTEXT, UmbModalContext } from '@umbraco-cms/backoffice/modal';\r\n\r\n@customElement('jumpp-processing-pipeline-workspace-default-view')\r\nexport class JumooProcessingPipelineWorkspaceDefaultViewElement extends UmbLitElement {\r\n\tprivate readonly _pipelineContext: PipelineContext;\r\n\r\n\t@state()\r\n\tpipeline?: Pipeline;\r\n\r\n\t@state()\r\n\tprivate _isLastAction: boolean = false;\r\n\r\n\t@state()\r\n\tprivate _status: PipelineStatus | undefined;\r\n\r\n\t@state()\r\n\tprivate _isValid: boolean = true;\r\n\r\n\t@state()\r\n\tprivate headline: string = '';\r\n\r\n\t@state()\r\n\tprivate progressLabel: string = '';\r\n\r\n\t@state()\r\n\tprivate closeLabel: string = '';\r\n\r\n\t@state()\r\n\t_modalContext?: UmbModalContext;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis._pipelineContext = new PipelineContext(this);\r\n\r\n\t\tthis.consumeContext(JUMOO_PROCESSING_PIPELINE_WORKSPACE, (_context) => {\r\n\t\t\tif (!_context) return;\r\n\r\n\t\t\tthis.observe(_context.data, (data) => {\r\n\t\t\t\tthis.pipeline = data;\r\n\t\t\t\tthis.headline = this.pipeline?.alias ?? '';\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_MODAL_CONTEXT, (modalContext) => {\r\n\t\t\tthis._modalContext = modalContext;\r\n\t\t});\r\n\r\n\t\tthis.observe(this._pipelineContext.finalized, async (finalized) => {\r\n\t\t\tif (finalized) {\r\n\t\t\t\tif (this._modalContext) {\r\n\t\t\t\t\tthis._modalContext.reject();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconnectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\tthis.closeLabel = this.localize.term('general_close');\r\n\t\tthis.progressLabel = this.localize.term('jumooProc_process');\r\n\t}\r\n\r\n\t#onStatusChange(e: CustomEvent) {\r\n\t\tthis._status = e.detail.status;\r\n\t\tthis._isLastAction = e.detail.isLastAction;\r\n\t}\r\n\r\n\t#onSetValid(e: CustomEvent) {\r\n\t\tthis._isValid = e.detail.valid;\r\n\t}\r\n\r\n\tasync #onClose() {\r\n\t\tawait this._pipelineContext.triggerClose();\r\n\t}\r\n\r\n\t#onComplete() {\r\n\t\t// complete.\r\n\t}\r\n\r\n\t#onProcess() {\r\n\t\tthis._pipelineContext.triggerNext();\r\n\t}\r\n\r\n\t#onUpdateModal(modalUpdate: CustomEvent<JumooProcessingModalInfo>) {\r\n\t\tconsole.debug('pipeline-modal-update', modalUpdate);\r\n\r\n\t\tif (!modalUpdate.detail) return;\r\n\r\n\t\tif (modalUpdate.detail.headline) {\r\n\t\t\tthis.headline = modalUpdate.detail.headline;\r\n\t\t}\r\n\r\n\t\tif (modalUpdate.detail.progressLabel) {\r\n\t\t\tthis.progressLabel = modalUpdate.detail.progressLabel;\r\n\t\t}\r\n\r\n\t\tif (modalUpdate.detail.closeLabel) {\r\n\t\t\tthis.closeLabel = modalUpdate.detail.closeLabel;\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn html`<umb-body-layout .headline=${this.headline}>\r\n\t\t\t<jumoo-pipeline\r\n\t\t\t\t.pipelineId=${this.pipeline?.id}\r\n\t\t\t\t.setup=${this.pipeline?.options}\r\n\t\t\t\t.debug=${false}\r\n\t\t\t\t@pipeline-status=${this.#onStatusChange}\r\n\t\t\t\t@pipeline-valid=${this.#onSetValid}\r\n\t\t\t\t@pipeline-complete=${this.#onComplete}\r\n\t\t\t\t@pipeline-modal-update=${this.#onUpdateModal}></jumoo-pipeline>\r\n\t\t\t<div slot=\"actions\">${this.renderActions()}</div>\r\n\t\t</umb-body-layout>`;\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tconst actionButton =\r\n\t\t\tthis._status === PipelineStatus.WAITING && this._isValid && !this._isLastAction\r\n\t\t\t\t? html`<uui-button\r\n\t\t\t\t\t\t@click=${this.#onProcess}\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\t.label=${this.progressLabel}></uui-button>`\r\n\t\t\t\t: nothing;\r\n\r\n\t\tconst closeButton = html`<uui-button\r\n\t\t\t@click=${this.#onClose}\r\n\t\t\tcolor=\"default\"\r\n\t\t\tlook=\"default\"\r\n\t\t\tlabel=${this.closeLabel}></uui-button>`;\r\n\r\n\t\treturn html`${closeButton} ${actionButton}`;\r\n\t}\r\n}\r\n\r\nexport default JumooProcessingPipelineWorkspaceDefaultViewElement;\r\n"],"names":["_JumooProcessingPipelineWorkspaceDefaultViewElement_instances","onStatusChange_fn","onSetValid_fn","onClose_fn","onComplete_fn","onProcess_fn","onUpdateModal_fn","JumooProcessingPipelineWorkspaceDefaultViewElement","UmbLitElement","__privateAdd","PipelineContext","JUMOO_PROCESSING_PIPELINE_WORKSPACE","_context","data","UMB_MODAL_CONTEXT","modalContext","finalized","html","__privateMethod","actionButton","PipelineStatus","nothing","closeButton","modalUpdate","__decorateClass","state","customElement","JumooProcessingPipelineWorkspaceDefaultViewElement$1"],"mappings":"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"}