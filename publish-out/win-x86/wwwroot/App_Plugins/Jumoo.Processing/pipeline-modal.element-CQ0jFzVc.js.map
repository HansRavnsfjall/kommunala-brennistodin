{"version":3,"file":"pipeline-modal.element-CQ0jFzVc.js","sources":["../../../jumoo-processing-assets/src/pipeline/modal/pipeline-modal.element.ts"],"sourcesContent":["import {\r\n\tJUMOO_PROCESSING_MODAL_ALIAS,\r\n\tJumooProcessingModalData,\r\n\tJumooProcessingModalInfo,\r\n\tJumooProcessingModalResult,\r\n\tPipelineContext,\r\n\tPipelineStatus,\r\n} from '@jumoo/processing';\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tnothing,\r\n\tstate,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\n\r\n@customElement(JUMOO_PROCESSING_MODAL_ALIAS)\r\nexport class uSyncProcessingModal extends UmbModalBaseElement<\r\n\tJumooProcessingModalData,\r\n\tJumooProcessingModalResult\r\n> {\r\n\tprivate readonly _pipelineContext: PipelineContext;\r\n\r\n\t@state()\r\n\tprivate _status: PipelineStatus | undefined;\r\n\r\n\t@state()\r\n\tprivate _isValid: boolean = true;\r\n\r\n\t@state()\r\n\tprivate _isLastAction: boolean = false;\r\n\r\n\t@state()\r\n\tprivate headline: string = '';\r\n\r\n\t@state()\r\n\tprivate progressLabel: string = '';\r\n\r\n\t@state()\r\n\tprivate closeLabel: string = '';\r\n\r\n\t@state()\r\n\tprivate modalType: string = 'sidebar';\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._pipelineContext = new PipelineContext(this);\r\n\r\n\t\tthis.observe(this._pipelineContext.finalized, (finalized) => {\r\n\t\t\tif (finalized) {\r\n\t\t\t\tthis.modalContext?.reject();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tconnectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\tthis.modalType = this.modalContext?.type ?? 'sidebar';\r\n\r\n\t\tthis.headline = this.data?.headline ?? '';\r\n\t\tthis.progressLabel = this.data?.progressLabel ?? 'Process';\r\n\t\tthis.closeLabel = this.data?.closeLabel ?? 'Close';\r\n\t}\r\n\r\n\t#onStatusChange(e: CustomEvent) {\r\n\t\tthis._status = e.detail.status;\r\n\t\tthis._isLastAction = e.detail.isLastAction;\r\n\t}\r\n\r\n\t#onSetValid(e: CustomEvent) {\r\n\t\tthis._isValid = e.detail.valid;\r\n\t}\r\n\r\n\tasync #onClose() {\r\n\t\tawait this._pipelineContext.triggerClose();\r\n\t}\r\n\r\n\t#onComplete() {\r\n\t\t// complete.\r\n\t}\r\n\r\n\t#onUpdateModal(modalUpdate: CustomEvent<JumooProcessingModalInfo>) {\r\n\t\tconsole.debug('pipeline-modal-update', modalUpdate);\r\n\r\n\t\tif (!modalUpdate.detail) return;\r\n\r\n\t\tif (modalUpdate.detail.headline) {\r\n\t\t\tthis.headline = modalUpdate.detail.headline;\r\n\t\t}\r\n\r\n\t\tif (modalUpdate.detail.progressLabel) {\r\n\t\t\tthis.progressLabel = modalUpdate.detail.progressLabel;\r\n\t\t}\r\n\r\n\t\tif (modalUpdate.detail.closeLabel) {\r\n\t\t\tthis.closeLabel = modalUpdate.detail.closeLabel;\r\n\t\t}\r\n\t}\r\n\r\n\t#onProcess() {\r\n\t\tthis._pipelineContext.triggerNext();\r\n\t}\r\n\r\n\t#getDialogStyles() {\r\n\t\tconst width = (this.data?.width ?? this.modalType === 'dialog') ? 600 : 0;\r\n\r\n\t\treturn html`<style>\r\n\t\t\t#jumoo-processing-modal {\r\n\t\t\t\tmin-width: ${width > 0 ? width + 'px' : 'auto'};\r\n\t\t\t\tmin-height: ${this.data?.height ? this.data.height + 'px' : 'auto'};\r\n\t\t\t}\r\n\t\t</style>`;\r\n\t}\r\n\r\n\tpublic render() {\r\n\t\treturn html` ${this.#getDialogStyles()}\r\n\t\t\t<umb-body-layout id=\"jumoo-processing-modal\">\r\n\t\t\t\t<div slot=\"header\" id=\"header\">\r\n\t\t\t\t\t<h3>${this.headline}</h3>\r\n\t\t\t\t\t${this.data?.description}\r\n\t\t\t\t</div>\r\n\t\t\t\t${this.renderProcess()}\r\n\t\t\t\t<div slot=\"actions\">${this.renderActions()}</div>\r\n\t\t\t</umb-body-layout>`;\r\n\t}\r\n\r\n\tprivate renderProcess() {\r\n\t\tif (!this.data) return;\r\n\r\n\t\treturn html`<jumoo-pipeline\r\n\t\t\t.processor=${this.data.processor}\r\n\t\t\t.strategy=${this.data.strategy}\r\n\t\t\t.setup=${this.data.options}\r\n\t\t\t.debug=${this.data.debug ?? false}\r\n\t\t\t@pipeline-status=${this.#onStatusChange}\r\n\t\t\t@pipeline-valid=${this.#onSetValid}\r\n\t\t\t@pipeline-complete=${this.#onComplete}\r\n\t\t\t@pipeline-modal-update=${this.#onUpdateModal}></jumoo-pipeline>`;\r\n\t}\r\n\r\n\tprivate renderActions() {\r\n\t\tconst actionButton =\r\n\t\t\tthis._status === PipelineStatus.WAITING && this._isValid && !this._isLastAction\r\n\t\t\t\t? html`<uui-button\r\n\t\t\t\t\t\t@click=${this.#onProcess}\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\t.label=${this.progressLabel}></uui-button>`\r\n\t\t\t\t: nothing;\r\n\r\n\t\tconst closeButton = html`<uui-button\r\n\t\t\t@click=${this.#onClose}\r\n\t\t\tcolor=\"default\"\r\n\t\t\tlook=\"default\"\r\n\t\t\tlabel=${this.closeLabel}></uui-button>`;\r\n\r\n\t\treturn html`${closeButton} ${actionButton}`;\r\n\t}\r\n\r\n\tstatic override styles = css`\r\n\t\t#header h3 {\r\n\t\t\tdisplay: block;\r\n\t\t\tmargin: 0;\r\n\t\t}\r\n\t`;\r\n}\r\n\r\nexport default uSyncProcessingModal;\r\n"],"names":["_uSyncProcessingModal_instances","onStatusChange_fn","onSetValid_fn","onClose_fn","onComplete_fn","onUpdateModal_fn","onProcess_fn","getDialogStyles_fn","uSyncProcessingModal","UmbModalBaseElement","__privateAdd","PipelineContext","finalized","html","__privateMethod","actionButton","PipelineStatus","nothing","closeButton","e","modalUpdate","width","css","__decorateClass","state","customElement","JUMOO_PROCESSING_MODAL_ALIAS","uSyncProcessingModal$1"],"mappings":"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"}