"use strict";(function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(n){for(var i=this;i;){if(i.matches(n))return i;i=i.parentElement}});var L=new WeakSet;document.addEventListener("DOMContentLoaded",O),document.addEventListener("umbracoFormsReinitialize",n=>{var i=n.detail&&n.detail.element?n.detail.element:document;O(i)}),window.UmbracoForms=window.UmbracoForms||{},window.UmbracoForms.reinitialize=O;function O(n){n=n||document;var i=n.getElementsByClassName?n.getElementsByClassName("umbraco-forms-form-config"):document.querySelectorAll(".umbraco-forms-form-config");if(i.length>0){for(var r=[],d=0;d<i.length;d++){var a=i[d],l=a.parentElement,f=l.querySelector(".umbraco-forms-form")||document.querySelector('.umbraco-forms-form[data-form-id="'+a.dataset.id+'"]');if(!(f&&L.has(f))){var o={formId:a.dataset.id,pageButtonConditions:JSON.parse(a.dataset.serializedPageButtonConditions),fieldSetConditions:JSON.parse(a.dataset.serializedFieldsetConditions),fieldConditions:JSON.parse(a.dataset.serializedFieldConditions),triggerConditionsCheckOn:a.dataset.triggerConditionsCheckOn,disableValidationDependencyCheck:a.dataset.disableValidationDependencyCheck==="true",recordValues:JSON.parse(a.dataset.serializedFieldsNotDisplayed),formElementHtmlIdPrefix:a.dataset.formElementHtmlIdPrefix,validationRules:a.dataset.serializedValidationRules?JSON.parse(a.dataset.serializedValidationRules):[]};r.push(o)}}r.length>0&&U(r,!0)}else n===document&&(typeof umbracoFormsCollection>"u"?document.addEventListener("umbracoFormLoaded",V):U(umbracoFormsCollection));if(n===document){var b=document.getElementById("umbraco-forms-form-submitted");if(b){var t=b.dataset.formClientId;_(t)}}}function U(n,i){j(n);for(var r=0;r<n.length;r++)V({form:n[r]},i)}function V(n,i){for(var r=i?n.form:JSON.parse(decodeURI(n.form)),d=document.querySelectorAll(".umbraco-forms-form"),a=0;a<d.length;a++){var l=d[a];if(!L.has(l)){var f=l.querySelector('[name="FormId"]');if(f){var o=f.value.replace(/-/g,"");if(o!==r.formId)continue}L.add(l),r.disableValidationDependencyCheck||J(l);var b=l.querySelector(".umbraco-forms-page"),t=new G(b,r.pageButtonConditions,r.fieldSetConditions,r.fieldConditions,r.triggerConditionsCheckOn&&r.triggerConditionsCheckOn.length>0?r.triggerConditionsCheckOn:"change",r.recordValues,r.formElementHtmlIdPrefix);t.watch(),K(l)}}}function _(n){document.onreadystatechange=function(){if(document.readyState=="complete"){var a=document.querySelectorAll(".field-validation-error"),l=document.querySelectorAll(".umbraco-forms-submitmessage"),f=document.querySelectorAll(".umbraco-forms-submitmessage-html"),o=document.getElementById("umbraco_form_"+n);a.length>0?i(a):l.length>0?r(l[0].parentElement):f.length>0?r(f[0]):o&&r(o)}};function i(a){for(var l=0,f=0;f<a.length;f++){var o=d(a[f]),b=o.getBoundingClientRect().top;0<b&&(b<l||l===0)&&(l=b)}l>0&&window.scrollTo(0,l)}function r(a){a.scrollIntoView({behavior:"auto",block:"start"})}function d(a){for(var l=a;l.tagName!=="BODY";){if(l.classList.contains("umbraco-forms-field"))return l;l=l.parentNode}return a}}function j(n){var i,r;if(window.aspnetValidation!==void 0){var d=new aspnetValidation.ValidationService,a=function(u,m){if(m.type.toLowerCase()==="checkbox"||m.type.toLowerCase()==="radio"){for(var c=m.form.querySelectorAll("input[name='"+m.name+"']"),y=0;y<c.length;y++)if(c[y].checked===!0)return!0;return!1}return!!u};d.addProvider("requiredcb",a),d.addProvider("required",a);var l=function(u,m,c){if(!u||!c.pattern)return!0;var y=new RegExp(c.pattern);return y.test(u)};d.addProvider("umbracoforms_regex",l);var f=function(u){return function(m,c,y){return c.offsetParent===null?!0:u(m,c,y)}};window.addEventListener("load",function(){for(var u in d.providers)d.providers[u]=f(d.providers[u])}),d.bootstrap(),window.umbracoFormsValidationService=d;var o=function(){this.form.elements.PreviousClicked.value="clicked"},b=document.querySelectorAll("[data-umb='prev-forms-form']");b.length===0&&(b=document.getElementsByClassName("prev cancel"));for(var t=0;t<b.length;t++){var e=b[t];e.dataset.umbracoFormsInitialized||(e.dataset.umbracoFormsInitialized="true",e.form.elements.PreviousClicked.value="",e.addEventListener("click",o,!1))}i=B();for(let u=0;u<i.length;u++)r=i[u],!r.dataset.umbracoFormsInitialized&&(r.dataset.umbracoFormsInitialized="true",r.addEventListener("click",function(m){m.preventDefault();var c=m.currentTarget.form,y=E(c,n);d.validateForm(c,F=>{var p=P(c,y,"aspnet-client-validation",d);if(F=F&&p,F){M(c);var s=c.querySelectorAll("[type=submit]:not(.cancel)");for(let C=0;C<s.length;C++)s[C].setAttribute("disabled","disabled")}})}))}else if(typeof jQuery=="function"&&$.validator&&$.validator.unobtrusive){$.validator.setDefaults({ignore:":hidden"}),$.validator.unobtrusive.adapters.addBool("requiredcb","required"),$.validator.addMethod("umbracoforms_regex",function(u,m){var c=$(m).attr("data-regex"),y=$(m).val();return y.length===0?!0:y.match(c)}),$.validator.unobtrusive.adapters.addBool("regex","umbracoforms_regex"),i=B();for(let u=0;u<i.length;u++)if(r=i[u],!r.dataset.umbracoFormsInitialized){r.dataset.umbracoFormsInitialized="true";var g=r.closest("form");$.validator.unobtrusive.parse(g),r.addEventListener("click",function(m){m.preventDefault();var c=$(this).closest("form");T(c[0]);var y=c.validate(),F=E(c[0],n),p=c.valid(),s=P(c[0],F,"jquery",y);p&&s&&(M(c),this.setAttribute("disabled","disabled"))}.bind(r))}}}function B(){return document.querySelectorAll(".umbraco-forms-form [type=submit]:not(.cancel)")}function E(n,i){var r=i.filter(l=>l.formId===n.FormId.value.replaceAll("-",""));if(r.length>0&&r[0].validationRules){var d=structuredClone(r[0].validationRules),a=new FormData(n);return d.map(l=>D(l,a))}return[]}function D(n,i){var r=n.rule;for(var d of i)r=r.replaceAll("{"+d[0]+"}",d[1]);return n.rule=r,n}function P(n,i,r,d){if(typeof jsonLogic>"u")return!0;for(var a=!0,l=0;l<i.length;l++){var f=i[l],o=/{({*[\w]*}*)}/;if(!f.rule.match(o)){var b;try{b=JSON.parse(f.rule)}catch{continue}var t=jsonLogic.apply(b);R(n,r,d,t,f),a=a&&t}}return a}function R(n,i,r,d,a){if(a.fieldId){var l=n[a.fieldId];if(!l)return;if(l.length&&l.length>0&&(l=Array.from(l).filter(b=>b.id===a.fieldId)[0]),i==="aspnet-client-validation")if(d){var f=q(l,"error");f&&f.innerText===a.errorMessage&&r.removeError(l)}else r.addError(l,a.errorMessage);else if(i==="jquery"){var o=n.querySelector(".validation-summary-errors ul");if(d){var f=q(l,"error");f&&f.innerText===a.errorMessage&&(f.classList.remove("field-validation-error"),f.classList.add("field-validation-valid"),f.innerText=""),W(o,a.errorMessage)}else{var f=q(l,"valid");f&&(f.classList.remove("field-validation-valid"),f.classList.add("field-validation-error"),f.innerText=a.errorMessage),H(o,a.errorMessage)}}}}function q(n,i){return n.closest(".umbraco-forms-field-wrapper").querySelector(".field-validation-"+i)}function W(n,i){n&&n.querySelectorAll("li").forEach(r=>{r.innerText===i&&r.remove()})}function H(n,i){if(W(n,i),n){var r=document.createElement("li");r.appendChild(document.createTextNode(validationRule.errorMessage)),n.appendChild(r)}}function M(n){n.requestSubmit?n.requestSubmit():n.submit()}function J(n){var i=document.createElement("div");i.className="umbraco-forms missing-library",i.style.color="#fff",i.style.backgroundColor="#9d261d",i.style.padding="15px",i.style.margin="10px 0";var r="";if(n){var d=n.getElementsByClassName("umbraco-forms missing-library");if(d.length>0)return;var a=!1;(window.jQuery&&$&&$.validator!==void 0||window.aspnetValidation!==void 0)&&(a=!0),a===!1&&(r=r+"Umbraco Forms requires a validation framework to run, please read documentation for posible options."),r!==""&&(i.innerHTML=r+'<br/> <a href="https://docs.umbraco.com/umbraco-forms/developer/prepping-frontend" target="_blank" style="text-decoration:underline; color:#fff;">See Umbraco Forms Documentation</a>',n.insertBefore(i,n.childNodes[0]))}}function K(n){Q(n)}function Q(n){if("MutationObserver"in window&&!n.dataset.umbracoFormsAccessibilityInitialized){if(n.dataset.umbracoFormsAccessibilityInitialized="true",window.aspnetValidation!==void 0){var i=n.getElementsByTagName("form")[0],r=function(){T(i)};i.addEventListener("submit",r,!1)}var d=new MutationObserver(function(a){for(var l=0;l<a.length;l++){var f=a[l];if(f.target.className==="field-validation-error"){Y(f.target);break}}});d.observe(n,{attributes:!0,attributeFilter:["class"],childList:!1,characterData:!1,subtree:!0})}}function T(n){for(var i=n.getElementsByClassName("field-validation-error"),r=0;r<i.length;r++)i[r].className="field-validation-valid"}function Y(n){for(var i=n.previousElementSibling;i;){if(i.tagName.toLowerCase()==="input"||i.tagName.toLowerCase()==="textarea"||i.tagName.toLowerCase()==="select"){i.focus();break}if(i.classList.contains("radiobuttonlist")||i.classList.contains("checkboxlist")){for(var r=0;r<i.children.length;r++){var d=i.children[r];if(d.tagName.toLowerCase()==="input"){d.focus();break}}break}i=i.previousElementSibling}}function G(n,i,r,d,a,l,f){var o={};o.form=n,o.pageButtonConditions=i,o.fieldsetConditions=r,o.fieldConditions=d,o.triggerConditionsCheckOn=a,o.values=l,o.formElementHtmlIdPrefix=f,o.dataTypes={};function b(t,e,g){var u=t.querySelectorAll("select");for(let p=0;p<u.length;p++){const s=u[p];e[s.getAttribute("id")]=s.value,g[s.getAttribute("id")]="select"}var m=t.querySelectorAll("textarea");for(let p=0;p<m.length;p++){const s=m[p];e[s.getAttribute("id")]=s.value,g[s.getAttribute("id")]="textarea"}var c=function(p){const s=p.getAttribute("id").split("_");return s.slice(0,s.length-1).join("_")},y=t.querySelectorAll("input[type=checkbox]");for(let p=0;p<y.length;p++){const s=y[p];if(s.getAttribute("id")!==o.formElementHtmlIdPrefix+s.getAttribute("name")){const C=c(s);e[C]=null,g[C]="checkbox"}else e[s.getAttribute("id")]=null,g[s.getAttribute("id")]="checkbox"}var F=t.querySelectorAll("input");for(let p=0;p<F.length;p++){const s=F[p];if((s.getAttribute("type")==="text"||s.getAttribute("type")==="number"||s.getAttribute("type")==="email"||s.getAttribute("type")==="url"||s.getAttribute("type")==="tel"||s.getAttribute("type")==="time"||s.getAttribute("type")==="date"||s.getAttribute("type")==="datetime-local"||s.getAttribute("type")==="hidden")&&(e[s.getAttribute("id")]=s.value,g[s.getAttribute("id")]="text"),s.getAttribute("type")==="radio"&&s.matches(":checked")){const C=c(s);e[C]=s.value,g[C]="radio"}if(s.getAttribute("type")==="checkbox")if(s.getAttribute("id")!==o.formElementHtmlIdPrefix+s.getAttribute("name")){const C=c(s);s.matches(":checked")&&(e[C]===null?e[C]=s.value:e[C]+=";;"+s.value)}else e[s.getAttribute("id")]=s.matches(":checked")?"true":"false"}}return o.operators={Is:function(t,e){if((t||"")===e)return!0;if(t==null)return e==t;e.toUpperCase()==="TRUE"||e.toUpperCase()==="ON"?e="true":(e.toUpperCase()==="FALSE"||e.toUpperCase()==="OFF")&&(e="false"),t==="true;;false"&&(t="true");var g=t.split(";;"),u=g.filter(function(m){return m===e});return u.length===g.length},IsNot:function(t,e,g){if(t==null)return e!=t;t==="true;;false"&&(t="true");var u=t.split(";;"),m=u.filter(function(c){return c===e});return g==="checkbox"&&(e.toUpperCase()==="TRUE"||e.toUpperCase()==="ON"?e="true":(e.toUpperCase()==="FALSE"||e.toUpperCase()==="OFF")&&(e="false")),(t||"")!==e&&m.length!=u.length},GreaterThen:function(t,e){return isNaN(t)||isNaN(e)?t>e:parseInt(t)>parseInt(e)},LessThen:function(t,e){return isNaN(t)||isNaN(e)?t<e:parseInt(t)<parseInt(e)},StartsWith:function(t,e){return t&&t.startsWith(e)},EndsWith:function(t,e){return t&&t.endsWith(e)},Contains:function(t,e){return t&&t.indexOf(e)>-1},ContainsIgnoreCase:function(t,e){return t&&e&&t.toUpperCase().indexOf(e.toUpperCase())>=0},StartsWithIgnoreCase:function(t,e){return t&&e&&t.toUpperCase().startsWith(e.toUpperCase())},EndsWithIgnoreCase:function(t,e){return t&&e&&t.toUpperCase().endsWith(e.toUpperCase())},NotContains:function(t,e){return!t||e&&t.indexOf(e)<0},NotStartsWith:function(t,e){return!t||e&&!t.startsWith(e)},NotEndsWith:function(t,e){return!t||e&&!t.endsWith(e)},NotContainsIgnoreCase:function(t,e){return!t||e&&t.toUpperCase().indexOf(e.toUpperCase())<0},NotStartsWithIgnoreCase:function(t,e){return!t||e&&!t.toUpperCase().startsWith(e.toUpperCase())},NotEndsWithIgnoreCase:function(t,e){return!t||e&&!t.toUpperCase().endsWith(e.toUpperCase())}},o.watch=function(){var t=o.form.querySelectorAll(".datepickerfield");for(let g=0;g<t.length;g++){const u=t[g];u.addEventListener("blur",function(){if(this.value===""){var m=this.getAttribute("id"),c=m+"_1";o.values[c]="",document.getElementById(c).value=""}b(o.form,o.values,o.dataTypes),o.run()}.bind(u))}var e=o.form.querySelectorAll("input, textarea, select");for(let g=0;g<e.length;g++){const u=e[g];u.addEventListener(o.triggerConditionsCheckOn,function(){b(o.form,o.values,o.dataTypes),o.run()}.bind(u))}b(o.form,o.values,o.dataTypes),o.run()},o.run=function(){var t,e,g,u,m={};function c(v){var h=o.values[o.formElementHtmlIdPrefix+v.field],k=o.operators[v.operator],A=h!==null&&k(h,v.value);return A}function y(v){var h=!0;return o.fieldConditions[v.field]&&(h=s(v.field,o.fieldConditions[v.field])),h?c(v):!1}function F(v,h){var k=h.logicType==="Any",A=h.logicType==="All",w={},x=!1,S=!0,I,N;if(h.rules.length===0)return!1;for(N=0;N<h.rules.length;N++){if(I=h.rules[N],v===I.field||v===I.fieldsetId)throw new Error("Field or fieldset "+v+" has a condition on itself.");w[I.fieldsetId]===void 0&&(o.fieldsetConditions[I.fieldsetId]?(w[I.fieldsetId]=s(I.fieldsetId,o.fieldsetConditions[I.fieldsetId]),w[I.fieldsetId]||(x=!0)):w[I.fieldsetId]=!0)}if(A&&x)return!1;for(N=0;N<h.rules.length&&(I=h.rules[N],w[I.fieldsetId]?S=y(h.rules[N]):S=!1,!(k&&S||A&&!S));N++);return S}function p(v,h){var k=h.actionType==="Show",A=m[v],w;A===void 0?(m[v]=k,w=m[v]=F(v,h)):w=A;var x=!(w^k);return x}function s(v,h){return h?p(v,h):!0}function C(v,h,k){var A=s(h,k);v&&(A?v.classList.remove("umbraco-forms-hidden"):v.classList.add("umbraco-forms-hidden"))}for(t in o.pageButtonConditions)if(Object.prototype.hasOwnProperty.call(o.pageButtonConditions,t)){var z=document.getElementById(t);z&&C(z.querySelector("input[name='__next'], button[name='__next'], input[data-form-navigate='next'], button[data-form-navigate='next']"),t,o.pageButtonConditions[t],"Page")}for(g in o.fieldsetConditions)Object.prototype.hasOwnProperty.call(o.fieldsetConditions,g)&&(e=o.formElementHtmlIdPrefix+g,C(document.getElementById(e),g,o.fieldsetConditions[g],"Fieldset"));for(u in o.fieldConditions)Object.prototype.hasOwnProperty.call(o.fieldConditions,u)&&(e=o.formElementHtmlIdPrefix+u,document.getElementById(e)&&C(document.getElementById(e).closest(".umbraco-forms-field"),u,o.fieldConditions[u],"Field"))},o}})();
