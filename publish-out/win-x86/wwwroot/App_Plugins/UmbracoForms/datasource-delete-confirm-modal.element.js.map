{"version":3,"file":"datasource-delete-confirm-modal.element.js","sources":["../src/section/datasources/entity-actions/delete/modal/datasource-delete-confirm-modal.element.ts"],"sourcesContent":["import { FormsDataSourceDetailRepository } from \"../../../repository/index.js\";\nimport type { FormDataSource } from \"@umbraco-forms/generated\";\nimport { FORMS_DATASOURCE_ROOT_ENTITY_TYPE } from \"../../../entities.js\";\nimport type { FormsDatasourceDeleteConfirmModalData } from \"./index.js\";\nimport { html, customElement } from \"@umbraco-cms/backoffice/external/lit\";\nimport { UmbModalBaseElement } from \"@umbraco-cms/backoffice/modal\";\nimport { UMB_ACTION_EVENT_CONTEXT } from \"@umbraco-cms/backoffice/action\";\nimport { UmbRequestReloadChildrenOfEntityEvent } from \"@umbraco-cms/backoffice/entity-action\";\n\n@customElement(\"forms-datasource-delete-confirm-modal\")\nexport class FormsDatasourceDeleteConfirmModalElement extends UmbModalBaseElement<FormsDatasourceDeleteConfirmModalData> {\n  #datasourceToDelete?: FormDataSource | null;\n\n  #datasourceDetailRepository = new FormsDataSourceDetailRepository(this);\n\n  async connectedCallback() {\n    super.connectedCallback();\n\n    if (!this.data?.unique) return;\n\n    const datasourceToDeleteResponse =\n      await this.#datasourceDetailRepository.requestByUnique(this.data.unique);\n    this.#datasourceToDelete = datasourceToDeleteResponse.data;\n\n    this.requestUpdate();\n  }\n\n  async #deleteDatasource(event: PointerEvent) {\n    event.stopPropagation();\n\n    if (this.data?.unique) {\n      await this.#datasourceDetailRepository.delete(this.data.unique);\n\n      const eventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\n      const eventArgs = {\n        entityType: FORMS_DATASOURCE_ROOT_ENTITY_TYPE,\n        unique: null,\n      };\n      const reloadEvent = new UmbRequestReloadChildrenOfEntityEvent(eventArgs);\n      eventContext?.dispatchEvent(reloadEvent);\n    }\n    this._submitModal();\n\n    event.stopPropagation();\n\n    if (this.data?.unique) {\n      const { data } = await this.#datasourceDetailRepository.requestByUnique(\n        this.data.unique,\n      );\n      if (!data) throw new Error(\"Item not found.\");\n\n      await this.#datasourceDetailRepository.delete(this.data.unique);\n\n      const eventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\n      eventContext?.dispatchEvent(event);\n    }\n    this._submitModal();\n  }\n\n  render() {\n    return html`\n      <umb-body-layout\n        headline=${this.localize.term(\"formDataSources_deleteDatasource\")}\n      >\n        <uui-box>\n          <p>\n            Are you sure you wish to delete the datasource\n            <b>${this.#datasourceToDelete?.name}</b>?\n          </p>\n        </uui-box>\n        <uui-button\n          slot=\"actions\"\n          id=\"cancel\"\n          label=${this.localize.term(\"general_cancel\")}\n          @click=\"${this._rejectModal}\"\n          >${this.localize.term(\"general_cancel\")}</uui-button\n        >\n        <uui-button\n          slot=\"actions\"\n          type=\"button\"\n          label=${this.localize.term(\"general_delete\")}\n          look=\"primary\"\n          color=\"danger\"\n          @click=${this.#deleteDatasource}\n        ></uui-button>\n      </umb-body-layout>\n    `;\n  }\n}\n\nexport default FormsDatasourceDeleteConfirmModalElement;\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"forms-datasource-delete-confirm-modal\": FormsDatasourceDeleteConfirmModalElement;\n  }\n}\n"],"names":["_datasourceToDelete","_datasourceDetailRepository","_FormsDatasourceDeleteConfirmModalElement_instances","deleteDatasource_fn","FormsDatasourceDeleteConfirmModalElement","UmbModalBaseElement","__privateAdd","FormsDataSourceDetailRepository","_a","datasourceToDeleteResponse","__privateGet","__privateSet","html","__privateMethod","event","eventContext","UMB_ACTION_EVENT_CONTEXT","eventArgs","FORMS_DATASOURCE_ROOT_ENTITY_TYPE","reloadEvent","UmbRequestReloadChildrenOfEntityEvent","_b","data","__decorateClass","customElement","FormsDatasourceDeleteConfirmModalElement$1"],"mappings":";;;;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC;AAUO,IAAMC,IAAN,cAAuDC,EAA2D;AAAA,EAAlH,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAJ,CAAA,GACLI,EAAA,MAAAN,CAAA,GAEAM,EAAA,MAAAL,GAA8B,IAAIM,EAAgC,IAAI,CAAA;AAAA,EAAA;AAAA,EAEtE,MAAM,oBAAoB;;AAGxB,QAFA,MAAM,kBAAA,GAEF,GAACC,IAAA,KAAK,SAAL,QAAAA,EAAW,QAAQ;AAExB,UAAMC,IACJ,MAAMC,EAAA,MAAKT,GAA4B,gBAAgB,KAAK,KAAK,MAAM;AACzE,IAAAU,EAAA,MAAKX,GAAsBS,EAA2B,IAAA,GAEtD,KAAK,cAAA;AAAA,EAAc;AAAA,EAmCrB,SAAS;;AACP,WAAOG;AAAA;AAAA,mBAEQ,KAAK,SAAS,KAAK,kCAAkC,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKxDJ,IAAAE,EAAA,MAAKV,OAAL,gBAAAQ,EAA0B,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAM7B,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA,oBAClC,KAAK,YAAY;AAAA,aACxB,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,kBAK/B,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA,mBAGnCK,QAAKX,GAAAC,CAAA,CAAiB;AAAA;AAAA;AAAA;AAAA,EAAA;AAKzC;AA7EEH,IAAA,oBAAA,QAAA;AAEAC,IAAA,oBAAA,QAAA;AAHKC,IAAA,oBAAA,QAAA;AAiBCC,IAAiB,eAACW,GAAqB;;AAG3C,MAFAA,EAAM,gBAAA,IAEFN,IAAA,KAAK,SAAL,QAAAA,EAAW,QAAQ;AACrB,UAAME,EAAA,MAAKT,CAAA,EAA4B,OAAO,KAAK,KAAK,MAAM;AAE9D,UAAMc,IAAe,MAAM,KAAK,WAAWC,CAAwB,GAC7DC,IAAY;AAAA,MAChB,YAAYC;AAAA,MACZ,QAAQ;AAAA,IAAA,GAEJC,IAAc,IAAIC,EAAsCH,CAAS;AACvE,IAAAF,KAAA,QAAAA,EAAc,cAAcI;AAAA,EAAW;AAMzC,MAJA,KAAK,aAAA,GAELL,EAAM,gBAAA,IAEFO,IAAA,KAAK,SAAL,QAAAA,EAAW,QAAQ;AACrB,UAAM,EAAE,MAAAC,EAAA,IAAS,MAAMZ,QAAKT,CAAA,EAA4B;AAAA,MACtD,KAAK,KAAK;AAAA,IAAA;AAEZ,QAAI,CAACqB,EAAM,OAAM,IAAI,MAAM,iBAAiB;AAE5C,UAAMZ,EAAA,MAAKT,CAAA,EAA4B,OAAO,KAAK,KAAK,MAAM;AAE9D,UAAMc,IAAe,MAAM,KAAK,WAAWC,CAAwB;AACnE,IAAAD,KAAA,QAAAA,EAAc,cAAcD;AAAA,EAAK;AAEnC,OAAK,aAAA;AACP;AA/CWV,IAANmB,EAAA;AAAA,EADNC,EAAc,uCAAuC;AAAA,GACzCpB,CAAA;AAgFb,MAAAqB,IAAerB;"}