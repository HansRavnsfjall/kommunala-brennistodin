{"version":3,"file":"email-template-picker-property-editor.element.js","sources":["../src/property-editor/email-template-picker/email-template-picker-property-editor.element.ts"],"sourcesContent":["import { FORMS_EMAIL_TEMPLATE_TREE_ALIAS } from \"../../section/email-templates/tree/index.js\";\nimport {\n  html,\n  customElement,\n  property,\n  css,\n  when,\n} from \"@umbraco-cms/backoffice/external/lit\";\nimport type { UmbPropertyEditorUiElement } from \"@umbraco-cms/backoffice/property-editor\";\nimport { UmbLitElement } from \"@umbraco-cms/backoffice/lit-element\";\nimport type {\n  UmbTreeElement,\n  UmbTreeItemModelBase,\n} from \"@umbraco-cms/backoffice/tree\";\n\nconst elementName = \"forms-email-template-picker-property-editor\";\nconst valuePrefix = \"Forms/Emails\";\n\n@customElement(elementName)\nexport class FormsEmailTemplatePickerPropertyUiElement\n  extends UmbLitElement\n  implements UmbPropertyEditorUiElement\n{\n  #value: string = \"\";\n\n  @property({ type: String })\n  get value() {\n    return this.#value ?? \"\";\n  }\n  set value(value: string) {\n    const oldVal = this.#value;\n    this.#value = value;\n    this.requestUpdate(\"value\", oldVal);\n  }\n\n  #onTreeSelectionChange(event: CustomEvent) {\n    const target = event.target as UmbTreeElement;\n    const selection = target.getSelection();\n    if (selection.length > 0) {\n      this.value =\n        valuePrefix +\n        selection[0].replace(\"%25dot%25\", \".\").replace(\"%2F\", \"/\");\n    } else {\n      this.value = \"\";\n    }\n\n    this.dispatchEvent(new CustomEvent(\"property-value-change\"));\n  }\n\n  #getSelectionForTree() {\n    if (this.value.length === 0) {\n      return [];\n    }\n\n    return [\n      this.value\n        .replace(valuePrefix, \"\")\n        .replace(\".\", \"%25dot%25\")\n        .replace(\"/\", \"%2F\"),\n    ];\n  }\n\n  #getSelectedValueForDisplay() {\n    return this.value.replace(valuePrefix + \"/\", \"\");\n  }\n\n  render() {\n    return html` ${when(\n        this.value.length > 0,\n        () =>\n          html`<div>\n            Selected template:\n            <strong>${this.#getSelectedValueForDisplay()}</strong>\n          </div>`,\n      )}\n      <umb-tree\n        id=\"EmailTemplate\"\n        alias=\"${FORMS_EMAIL_TEMPLATE_TREE_ALIAS}\"\n        .props=${{\n          hideTreeRoot: false,\n          selectionConfiguration: {\n            multiple: false,\n            selection: this.#getSelectionForTree(),\n          },\n          selectableFilter: (item: UmbTreeItemModelBase) => !item.isFolder,\n        }}\n        @selection-change=${this.#onTreeSelectionChange}\n      ></umb-tree>`;\n  }\n\n  static styles = [css``];\n}\n\nexport default FormsEmailTemplatePickerPropertyUiElement;\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [elementName]: FormsEmailTemplatePickerPropertyUiElement;\n  }\n}\n"],"names":["_value","_FormsEmailTemplatePickerPropertyUiElement_instances","onTreeSelectionChange_fn","getSelectionForTree_fn","getSelectedValueForDisplay_fn","elementName","valuePrefix","FormsEmailTemplatePickerPropertyUiElement","UmbLitElement","__privateAdd","__privateGet","value","oldVal","__privateSet","html","when","__privateMethod","FORMS_EMAIL_TEMPLATE_TREE_ALIAS","item","event","selection","css","__decorateClass","property","customElement","FormsEmailTemplatePickerPropertyUiElement$1"],"mappings":";;;;;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC,GAAAC;AAeA,MAAMC,IAAc,+CACdC,IAAc;AAGb,IAAMC,IAAN,cACGC,EAEV;AAAA,EAHO,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAR,CAAA,GAILQ,EAAA,MAAAT,GAAiB,EAAA;AAAA,EAAA;AAAA,EAGjB,IAAI,QAAQ;AACV,WAAOU,QAAKV,CAAA,KAAU;AAAA,EAAA;AAAA,EAExB,IAAI,MAAMW,GAAe;AACvB,UAAMC,IAASF,EAAA,MAAKV,CAAA;AACpB,IAAAa,EAAA,MAAKb,GAASW,CAAA,GACd,KAAK,cAAc,SAASC,CAAM;AAAA,EAAA;AAAA,EAkCpC,SAAS;AACP,WAAOE,KAAQC;AAAA,MACX,KAAK,MAAM,SAAS;AAAA,MACpB,MACED;AAAA;AAAA,sBAEYE,EAAA,MAAKf,MAAL,KAAA,IAAA,CAAkC;AAAA;AAAA,IAAA,CAEjD;AAAA;AAAA;AAAA,iBAGUgB,CAA+B;AAAA,iBAC/B;AAAA,MACP,cAAc;AAAA,MACd,wBAAwB;AAAA,QACtB,UAAU;AAAA,QACV,WAAWD,QAAKf,GAAAE,CAAA,EAAL,KAAA,IAAA;AAAA,MAAA;AAAA,MAEb,kBAAkB,CAACe,MAA+B,CAACA,EAAK;AAAA,IAAA,CACzD;AAAA,4BACmBF,QAAKf,GAAAC,CAAA,CAAsB;AAAA;AAAA,EAAA;AAKvD;AApEEF,IAAA,oBAAA,QAAA;AAJKC,IAAA,oBAAA,QAAA;AAgBLC,IAAsB,SAACiB,GAAoB;AAEzC,QAAMC,IADSD,EAAM,OACI,aAAA;AACzB,EAAIC,EAAU,SAAS,IACrB,KAAK,QACHd,IACAc,EAAU,CAAC,EAAE,QAAQ,aAAa,GAAG,EAAE,QAAQ,OAAO,GAAG,IAE3D,KAAK,QAAQ,IAGf,KAAK,cAAc,IAAI,YAAY,uBAAuB,CAAC;AAC7D;AAEAjB,IAAoB,WAAG;AACrB,SAAI,KAAK,MAAM,WAAW,IACjB,CAAA,IAGF;AAAA,IACL,KAAK,MACF,QAAQG,GAAa,EAAE,EACvB,QAAQ,KAAK,WAAW,EACxB,QAAQ,KAAK,KAAK;AAAA,EAAA;AAEzB;AAEAF,IAA2B,WAAG;AAC5B,SAAO,KAAK,MAAM,QAAQE,IAAc,KAAK,EAAE;AACjD;AA7CWC,EAuEJ,SAAS,CAACc,GAAK;AAhElBC,EAAA;AAAA,EADHC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GANfhB,EAOP,WAAA,SAAA,CAAA;AAPOA,IAANe,EAAA;AAAA,EADNE,EAAcnB,CAAW;AAAA,GACbE,CAAA;AA0Eb,MAAAkB,IAAelB;"}