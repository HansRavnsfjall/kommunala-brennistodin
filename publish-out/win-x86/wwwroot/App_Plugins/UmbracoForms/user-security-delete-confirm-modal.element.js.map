{"version":3,"file":"user-security-delete-confirm-modal.element.js","sources":["../src/section/security/entity-actions/delete/modal/user-security-delete-confirm-modal.element.ts"],"sourcesContent":["import { FORMS_SECURITY_USER_FOLDER_ENTITY_TYPE } from \"../../../entities.js\";\nimport { FormsSecurityUserDetailRepository } from \"../../../repository/index.js\";\nimport type { FormsUserSecurityDeleteConfirmModalData } from \"./index.js\";\nimport { html, customElement } from \"@umbraco-cms/backoffice/external/lit\";\nimport { UmbModalBaseElement } from \"@umbraco-cms/backoffice/modal\";\nimport { UMB_ACTION_EVENT_CONTEXT } from \"@umbraco-cms/backoffice/action\";\nimport type { FormSecurityForUser } from \"@umbraco-forms/generated\";\nimport { UmbRequestReloadChildrenOfEntityEvent } from \"@umbraco-cms/backoffice/entity-action\";\n\n@customElement(\"forms-user-security-delete-confirm-modal\")\nexport class FormsUserSecurityDeleteConfirmModalElement extends UmbModalBaseElement<FormsUserSecurityDeleteConfirmModalData> {\n  #userSecurityToDelete?: FormSecurityForUser | null;\n  #userSecurityDetailRepository = new FormsSecurityUserDetailRepository(this);\n\n  async connectedCallback() {\n    super.connectedCallback();\n\n    if (!this.data?.unique) return;\n\n    const { data } = await this.#userSecurityDetailRepository.requestByUnique(\n      this.data.unique,\n    );\n    this.#userSecurityToDelete = data;\n\n    this.requestUpdate();\n  }\n\n  async #deleteUserSecurity(event: PointerEvent) {\n    event.stopPropagation();\n\n    if (this.data?.unique) {\n      await this.#userSecurityDetailRepository.delete(this.data.unique);\n\n      const reloadEvent = new UmbRequestReloadChildrenOfEntityEvent({\n        entityType: FORMS_SECURITY_USER_FOLDER_ENTITY_TYPE,\n        unique: \"207c2294-970b-4e1f-82fd-ae8996ef171d\", // Matches Umbraco.Forms.Web.Controllers.ManagementApi.Security.Tree.SecurityTreeControllerBase.UsersFolderId\n      });\n\n      const eventContext = await this.getContext(UMB_ACTION_EVENT_CONTEXT);\n      eventContext?.dispatchEvent(reloadEvent);\n    }\n\n    this._submitModal();\n  }\n\n  render() {\n    return html`\n      <umb-body-layout\n        headline=\"${this.localize.term(\n          \"formSecurity_deleteTitle\",\n          this.#userSecurityToDelete?.name,\n        )}\"\n      >\n        <uui-box>\n          <p>${this.localize.term(\"formSecurity_deleteUserRecordNote\")}</p>\n        </uui-box>\n        <uui-button\n          slot=\"actions\"\n          id=\"cancel\"\n          label=${this.localize.term(\"general_cancel\")}\n          @click=\"${this._rejectModal}\"\n          >${this.localize.term(\"general_cancel\")}</uui-button\n        >\n        <uui-button\n          slot=\"actions\"\n          type=\"button\"\n          label=${this.localize.term(\"general_delete\")}\n          look=\"primary\"\n          color=\"danger\"\n          @click=${this.#deleteUserSecurity}\n        ></uui-button>\n      </umb-body-layout>\n    `;\n  }\n}\n\nexport default FormsUserSecurityDeleteConfirmModalElement;\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"forms-user-security-delete-confirm-modal\": FormsUserSecurityDeleteConfirmModalElement;\n  }\n}\n"],"names":["_userSecurityToDelete","_userSecurityDetailRepository","_FormsUserSecurityDeleteConfirmModalElement_instances","deleteUserSecurity_fn","FormsUserSecurityDeleteConfirmModalElement","UmbModalBaseElement","__privateAdd","FormsSecurityUserDetailRepository","_a","data","__privateGet","__privateSet","html","__privateMethod","event","reloadEvent","UmbRequestReloadChildrenOfEntityEvent","FORMS_SECURITY_USER_FOLDER_ENTITY_TYPE","eventContext","UMB_ACTION_EVENT_CONTEXT","__decorateClass","customElement","FormsUserSecurityDeleteConfirmModalElement$1"],"mappings":";;;;;;;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC;AAUO,IAAMC,IAAN,cAAyDC,EAA6D;AAAA,EAAtH,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAJ,CAAA,GACLI,EAAA,MAAAN,CAAA,GACAM,EAAA,MAAAL,GAAgC,IAAIM,EAAkC,IAAI,CAAA;AAAA,EAAA;AAAA,EAE1E,MAAM,oBAAoB;;AAGxB,QAFA,MAAM,kBAAA,GAEF,GAACC,IAAA,KAAK,SAAL,QAAAA,EAAW,QAAQ;AAExB,UAAM,EAAE,MAAAC,EAAA,IAAS,MAAMC,QAAKT,CAAA,EAA8B;AAAA,MACxD,KAAK,KAAK;AAAA,IAAA;AAEZ,IAAAU,EAAA,MAAKX,GAAwBS,CAAA,GAE7B,KAAK,cAAA;AAAA,EAAc;AAAA,EAqBrB,SAAS;;AACP,WAAOG;AAAA;AAAA,oBAES,KAAK,SAAS;AAAA,MACxB;AAAA,OACAJ,IAAAE,QAAKV,CAAA,MAAL,gBAAAQ,EAA4B;AAAA,IAAA,CAC7B;AAAA;AAAA;AAAA,eAGM,KAAK,SAAS,KAAK,mCAAmC,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKpD,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA,oBAClC,KAAK,YAAY;AAAA,aACxB,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA,kBAK/B,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA,mBAGnCK,QAAKX,GAAAC,CAAA,CAAmB;AAAA;AAAA;AAAA;AAAA,EAAA;AAK3C;AA/DEH,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAFKC,IAAA,oBAAA,QAAA;AAiBCC,IAAmB,eAACW,GAAqB;;AAG7C,MAFAA,EAAM,gBAAA,IAEFN,IAAA,KAAK,SAAL,QAAAA,EAAW,QAAQ;AACrB,UAAME,EAAA,MAAKT,CAAA,EAA8B,OAAO,KAAK,KAAK,MAAM;AAEhE,UAAMc,IAAc,IAAIC,EAAsC;AAAA,MAC5D,YAAYC;AAAA,MACZ,QAAQ;AAAA;AAAA,IAAA,CACT,GAEKC,IAAe,MAAM,KAAK,WAAWC,CAAwB;AACnE,IAAAD,KAAA,QAAAA,EAAc,cAAcH;AAAA,EAAW;AAGzC,OAAK,aAAA;AACP;AAjCWX,IAANgB,EAAA;AAAA,EADNC,EAAc,0CAA0C;AAAA,GAC5CjB,CAAA;AAkEb,MAAAkB,IAAelB;"}