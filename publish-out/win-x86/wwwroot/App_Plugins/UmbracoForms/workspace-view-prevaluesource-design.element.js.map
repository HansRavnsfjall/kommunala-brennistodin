{"version":3,"file":"workspace-view-prevaluesource-design.element.js","sources":["../src/section/prevaluesources/workspace/views/design/workspace-view-prevaluesource-design.element.ts"],"sourcesContent":["import { FORMS_PREVALUESOURCE_WORKSPACE_CONTEXT } from \"../../prevaluesource-workspace.context-token.js\";\nimport { ProviderTypeSettingsHelper } from \"../../../../provider-types/provider-type-settings-helper.class.js\";\nimport {\n  css,\n  html,\n  customElement,\n  state,\n  LitElement,\n  when,\n  repeat,\n} from \"@umbraco-cms/backoffice/external/lit\";\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\nimport type { UmbWorkspaceViewElement } from \"@umbraco-cms/backoffice/workspace\";\nimport type {\n  FieldPreValueSource,\n  PreValueSourceTypeWithSettings,\n} from \"@umbraco-forms/generated\";\nimport type { UmbInputRadioButtonListElement } from \"@umbraco-cms/backoffice/components\";\nimport type {\n  UmbPropertyDatasetElement,\n  UmbPropertyValueData,\n} from \"@umbraco-cms/backoffice/property\";\nimport type { UmbPropertyEditorConfig } from \"@umbraco-cms/backoffice/property-editor\";\nimport type { UUIRadioEvent } from \"@umbraco-ui/uui\";\nimport type { UUISelectEvent } from \"@umbraco-cms/backoffice/external/uui\";\n\nconst elementName = \"workspace-view-prevaluesource-design\";\n\n@customElement(elementName)\nexport class UmbWorkspaceViewPrevalueSourceDesignElement\n  extends UmbElementMixin(LitElement)\n  implements UmbWorkspaceViewElement\n{\n  #cacheOptions: UmbInputRadioButtonListElement[\"list\"] = [];\n\n  @state()\n  _prevalueSource?: FieldPreValueSource;\n\n  @state()\n  _prevalueSourceType?: PreValueSourceTypeWithSettings;\n\n  @state()\n  _settingValues: Array<UmbPropertyValueData> = [];\n\n  @state()\n  _settingsConfig: Array<{ alias: string; value: UmbPropertyEditorConfig }> =\n    [];\n\n  @state()\n  _settingsConfigLoaded: boolean = false;\n\n  @state()\n  _cachePrevaluesOption: string = \"\";\n\n  @state()\n  _cachePrevaluesByTimeValue: number = 0;\n\n  @state()\n  _cachePrevaluesByTimeUnit: \"seconds\" | \"minutes\" | \"hours\" = \"seconds\";\n\n  #workspaceContext?: typeof FORMS_PREVALUESOURCE_WORKSPACE_CONTEXT.TYPE;\n\n  #providerTypeSettingsHelper?: ProviderTypeSettingsHelper;\n\n  #init: Promise<unknown>;\n\n  constructor() {\n    super();\n\n    this.#init = Promise.all([\n      this.consumeContext(\n        FORMS_PREVALUESOURCE_WORKSPACE_CONTEXT,\n        (instance) => {\n          this.#workspaceContext = instance;\n          this.#observePrevalues();\n        },\n      ).asPromise(),\n    ]);\n  }\n\n  #observePrevalues() {\n    if (!this.#workspaceContext) return;\n    this.observe(this.#workspaceContext.prevalues, () => {\n      this.requestUpdate();\n    });\n  }\n\n  async connectedCallback() {\n    super.connectedCallback();\n\n    await this.#init;\n    if (!this.#workspaceContext) return;\n\n    this._prevalueSource = this.#workspaceContext.getData();\n\n    const prevalueSourceTypeId =\n      this._prevalueSource?.fieldPreValueSourceTypeId;\n    if (!prevalueSourceTypeId) return;\n\n    this._prevalueSourceType =\n      await this.#workspaceContext?.loadPrevalueSourceType(\n        prevalueSourceTypeId,\n      );\n    if (!this._prevalueSourceType) return;\n\n    this.#providerTypeSettingsHelper = new ProviderTypeSettingsHelper(\n      this,\n      this._prevalueSourceType,\n      \"formProviderPrevalueSources\",\n    );\n\n    await this.#providerTypeSettingsHelper.loadSettingValueConverterApis();\n    await this.#initialize();\n  }\n\n  async #initialize() {\n    if (!this.#workspaceContext || !this._prevalueSource) return;\n\n    this.#initCacheOptions();\n\n    this._settingValues =\n      await this.#providerTypeSettingsHelper!.getSettingValues(\n        this._prevalueSource.settings,\n      );\n\n    this._settingsConfig =\n      await this.#providerTypeSettingsHelper!.getSettingsConfig(\n        this._settingValues,\n        this._prevalueSourceType!.settings,\n      );\n    this._settingsConfigLoaded = true;\n\n    // Initialize settings based on configured default values.\n    if (this.#workspaceContext?.getIsNew() && this._prevalueSourceType) {\n      const settings = structuredClone(this._prevalueSourceType.settings);\n      for (let i = 0; i < this._prevalueSourceType!.settings.length; i++) {\n        const setting = this._prevalueSourceType!.settings[i];\n        if (setting.defaultValue) {\n          settings[setting.alias] = setting.defaultValue;\n        }\n      }\n\n      this._settingValues = settings;\n    }\n\n    if (this._cachePrevaluesOption === \"\") {\n      this.#initCacheOptionsValue();\n    }\n  }\n\n  async #onSettingsChange(e: CustomEvent) {\n    const value = (e.target as UmbPropertyDatasetElement).value;\n    this._settingValues = value;\n\n    const settings =\n      await this.#providerTypeSettingsHelper!.getUpdatedSettingsForPersistence(\n        value,\n      );\n\n    this.#setPropertyValue(\"settings\", settings);\n  }\n\n  #onCacheOptionsChange(event: UUIRadioEvent) {\n    event.stopPropagation();\n    if (event.target.tagName !== \"UUI-RADIO\") return;\n    this._cachePrevaluesOption = event.target.value;\n    this.#updateCacheOptionsValue();\n  }\n\n  #initCacheOptions() {\n    this.#cacheOptions = [\n      {\n        label: this.localize.term(\"formPrevalueSources_cacheOptionsNone\"),\n        value: \"none\",\n      },\n      {\n        label: this.localize.term(\"formPrevalueSources_cacheOptionsTime\"),\n        value: \"time\",\n      },\n      {\n        label: this.localize.term(\"formPrevalueSources_cacheOptionsNoExpiry\"),\n        value: \"noExpiry\",\n      },\n    ];\n  }\n\n  #initCacheOptionsValue() {\n    const value = this._prevalueSource?.cachePrevaluesFor.toString();\n\n    if (value) {\n      if (value[0] === \"-\") {\n        this._cachePrevaluesOption = \"noExpiry\";\n      } else if (value === \"00:00:00\") {\n        this._cachePrevaluesOption = \"none\";\n      } else {\n        this._cachePrevaluesOption = \"time\";\n\n        const timeSpanParts = value.split(\":\");\n        if (parseInt(timeSpanParts[0]) > 0) {\n          this._cachePrevaluesByTimeValue = parseInt(timeSpanParts[0]);\n          this._cachePrevaluesByTimeUnit = \"hours\";\n        } else if (parseInt(timeSpanParts[1]) > 0) {\n          this._cachePrevaluesByTimeValue = parseInt(timeSpanParts[1]);\n          this._cachePrevaluesByTimeUnit = \"minutes\";\n        } else {\n          this._cachePrevaluesByTimeValue = parseInt(timeSpanParts[2]);\n          this._cachePrevaluesByTimeUnit = \"seconds\";\n        }\n      }\n    } else {\n      this._cachePrevaluesOption = \"noExpiry\";\n    }\n  }\n\n  #updateCacheOptionsValue() {\n    let value = \"\";\n    switch (this._cachePrevaluesOption) {\n      case \"none\":\n        value = \"00:00:00.0000000\";\n        break;\n      case \"time\":\n        value = this.#getTimeSpan();\n        break;\n      case \"noExpiry\":\n        value = \"-00:00:00.0010000\";\n        break;\n    }\n    this.#setPropertyValue(\"cachePrevaluesFor\", value);\n  }\n\n  #getTimeSpan() {\n    const value = this._cachePrevaluesByTimeValue;\n    const unit = this._cachePrevaluesByTimeUnit;\n    const timeSpan = new Date(\n      value *\n        1000 *\n        (unit === \"minutes\" || unit === \"hours\" ? 60 : 1) *\n        (unit === \"hours\" ? 60 : 1),\n    )\n      .toISOString()\n      .slice(11, 19);\n    return timeSpan;\n  }\n\n  #onCacheOptionsTimeValueChange(e: CustomEvent) {\n    const value = (e.target as HTMLInputElement).value;\n    this._cachePrevaluesByTimeValue = parseInt(value);\n    this.#updateCacheOptionsValue();\n  }\n\n  #onCacheOptionsTimeUnitChange(e: UUISelectEvent) {\n    const selectedValue = e.target.value.toString() as\n      | \"seconds\"\n      | \"minutes\"\n      | \"hours\";\n    this._cachePrevaluesByTimeUnit = selectedValue;\n    this.#updateCacheOptionsValue();\n  }\n\n  #setPropertyValue(alias: string, value: unknown) {\n    this.#workspaceContext?.setPrevalueSourceProperty(alias, value);\n    this.dispatchEvent(new CustomEvent(\"valueChange\"));\n  }\n\n  render() {\n    return html`\n      <uui-box\n        headline=${this.localize.term(\n          \"formPrevalueSources_designModalHeadline\",\n        )}\n      >\n        <umb-property-layout\n          alias=\"type\"\n          .label=${this.localize.term(\"general_type\")}\n        >\n          <div slot=\"editor\">${this._prevalueSourceType?.name}</div>\n        </umb-property-layout>\n\n        ${when(\n          this.#providerTypeSettingsHelper &&\n            this._prevalueSourceType &&\n            this._settingsConfigLoaded,\n          () =>\n            html`<umb-property-dataset\n              .value=${this._settingValues}\n              @change=${this.#onSettingsChange}\n            >\n              ${this._prevalueSourceType!.settings.map(\n                (setting) => html`\n                  <umb-property\n                    ?inert=${setting.isReadOnly}\n                    .label=${this.#providerTypeSettingsHelper?.getLocalizedSettingDetail(\n                      setting,\n                      \"Label\",\n                      setting.name,\n                    )}\n                    .description=${this.#providerTypeSettingsHelper?.getLocalizedSettingDetail(\n                      setting,\n                      \"Description\",\n                      setting.description,\n                    )}\n                    alias=${setting.alias}\n                    .config=${this.#providerTypeSettingsHelper!.getPropertyConfigForSetting(\n                      this._settingsConfig,\n                      setting,\n                    )}\n                    .appearance=${this.#providerTypeSettingsHelper!.getPropertyAppearanceForSetting(\n                      setting.view,\n                    )}\n                    property-editor-ui-alias=${setting.view}\n                  >\n                  </umb-property>\n                `,\n              )}\n            </umb-property-dataset> `,\n        )}\n\n        <umb-property-layout\n          alias=\"_cachePrevalues\"\n          .label=${this.localize.term(\"formPrevalueSources_cacheOptionsLabel\")}\n          .description=${this.localize.term(\n            \"formPrevalueSources_cacheOptionsDescription\",\n          )}\n        >\n          <div slot=\"editor\">\n            <uui-radio-group\n              .value=${this._cachePrevaluesOption}\n              @change=${this.#onCacheOptionsChange}\n            >\n              ${repeat(\n                this.#cacheOptions,\n                (item) => item,\n                (item) =>\n                  html`<uui-radio\n                    value=${item.value}\n                    label=${item.label}\n                  ></uui-radio>`,\n              )}\n            </uui-radio-group>\n            ${when(\n              this._cachePrevaluesOption === \"time\",\n              () => html`\n                <div>\n                  <label\n                    >${this.localize.term(\n                      \"formPrevalueSources_cacheOptionsEnterTime\",\n                    )}</label\n                  >\n                  <uui-input\n                    type=\"number\"\n                    value=${this._cachePrevaluesByTimeValue}\n                    min=\"1\"\n                    max=\"59\"\n                    label=\"Time value\"\n                    @change=${this.#onCacheOptionsTimeValueChange}\n                  ></uui-input>\n                  <uui-select\n                    label=\"Time unit\"\n                    @change=${this.#onCacheOptionsTimeUnitChange}\n                    .options=${[\"Seconds\", \"Minutes\", \"Hours\"].map((o) => ({\n                      name: this.localize.term(\n                        `formPrevalueSources_cacheOptions${o}`,\n                      ),\n                      value: o.toLowerCase(),\n                      selected:\n                        this._cachePrevaluesByTimeUnit === o.toLowerCase(),\n                    }))}\n                  ></uui-select>\n                </div>\n              `,\n            )}\n          </div>\n        </umb-property-layout>\n      </uui-box>\n\n      ${when(\n        this.#workspaceContext &&\n          this.#workspaceContext.getPrevalues().length > 0,\n        () =>\n          html` <uui-box\n            headline=${this.localize.term(\"formPrevalueSources_listHeadline\")}\n          >\n            <uui-table>\n              <uui-table-head>\n                <uui-table-head-cell\n                  >${this.localize.term(\"general_value\")}</uui-table-head-cell\n                >\n                <uui-table-head-cell\n                  >${this.localize.term(\n                    \"formPrevalues_caption\",\n                  )}</uui-table-head-cell\n                >\n              </uui-table-head>\n              ${this.#workspaceContext?.getPrevalues().map(\n                (pv) =>\n                  html` <uui-table-row>\n                    <uui-table-cell>${pv.value}</uui-table-cell>\n                    <uui-table-cell>${pv.caption}</uui-table-cell>\n                  </uui-table-row>`,\n              )}\n            </uui-table>\n          </uui-box>`,\n      )}\n    `;\n  }\n\n  static styles = [\n    css`\n      :host {\n        display: block;\n        padding: var(--uui-size-layout-1);\n      }\n\n      uui-box + uui-box {\n        margin-top: var(--uui-size-layout-1);\n      }\n\n      [inert] {\n        opacity: 0.5;\n      }\n    `,\n  ];\n}\n\nexport default UmbWorkspaceViewPrevalueSourceDesignElement;\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [elementName]: UmbWorkspaceViewPrevalueSourceDesignElement;\n  }\n}\n"],"names":["_cacheOptions","_workspaceContext","_providerTypeSettingsHelper","_init","_UmbWorkspaceViewPrevalueSourceDesignElement_instances","observePrevalues_fn","initialize_fn","onSettingsChange_fn","onCacheOptionsChange_fn","initCacheOptions_fn","initCacheOptionsValue_fn","updateCacheOptionsValue_fn","getTimeSpan_fn","onCacheOptionsTimeValueChange_fn","onCacheOptionsTimeUnitChange_fn","setPropertyValue_fn","elementName","UmbWorkspaceViewPrevalueSourceDesignElement","UmbElementMixin","LitElement","__privateAdd","__privateSet","FORMS_PREVALUESOURCE_WORKSPACE_CONTEXT","instance","__privateMethod","__privateGet","prevalueSourceTypeId","_a","_b","ProviderTypeSettingsHelper","html","when","setting","repeat","item","o","pv","settings","e","value","event","timeSpanParts","unit","selectedValue","alias","css","__decorateClass","state","customElement","UmbWorkspaceViewPrevalueSourceDesignElement$1"],"mappings":"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"}