{"version":3,"file":"workspace-view-security-user-permissions.element.js","sources":["../src/section/security/workspace/views/permissions/workspace-view-security-user-permissions.element.ts"],"sourcesContent":["import { FORMS_SECURITY_USER_WORKSPACE_CONTEXT } from \"../../security-user-workspace.context-token.js\";\nimport type { PackagePermissionsSecurityBase } from \"../../../entities.js\";\nimport type { FormsSecurityUserWorkspaceContext } from \"../../security-user-workspace.context.js\";\nimport { UmbWorkspaceViewSecurityPermissionsBaseElement } from \"./workspace-view-security-permissions-base.element.js\";\nimport {\n  html,\n  customElement,\n  state,\n} from \"@umbraco-cms/backoffice/external/lit\";\nimport type { UmbWorkspaceViewElement } from \"@umbraco-cms/backoffice/workspace\";\nimport type { FormSecurityForUser } from \"@umbraco-forms/generated\";\nimport type { UUIBooleanInputEvent } from \"@umbraco-cms/backoffice/external/uui\";\n\nconst elementName = \"workspace-view-security-user-permissions\";\n\n@customElement(elementName)\nexport class UmbWorkspaceViewSecurityUserPermissionsElement\n  extends UmbWorkspaceViewSecurityPermissionsBaseElement<FormsSecurityUserWorkspaceContext>\n  implements UmbWorkspaceViewElement\n{\n  @state()\n  _security?: FormSecurityForUser;\n\n  constructor() {\n    super(FORMS_SECURITY_USER_WORKSPACE_CONTEXT.contextAlias);\n  }\n\n  observeSecurityItem() {\n    if (!this.workspaceContext) return;\n\n    this.observe(this.workspaceContext.data, (security) => {\n      if (!security) return;\n      this._security = security;\n    });\n  }\n\n  onPackagePermissionsChange(\n    e: UUIBooleanInputEvent,\n    permission: keyof PackagePermissionsSecurityBase,\n  ) {\n    const value = e.target.checked;\n\n    this.workspaceContext?.setUserSecurityProperty(permission, value);\n\n    if (permission === \"viewEntries\" && !value) {\n      this.workspaceContext?.setUserSecurityProperty(\"editEntries\", false);\n      this.workspaceContext?.setUserSecurityProperty(\"deleteEntries\", false);\n    }\n\n    this.dispatchEvent(new CustomEvent(\"valueChange\"));\n    this.requestUpdate();\n  }\n\n  render() {\n    return html`\n      ${this.renderToggles(this._security?.userSecurity)}\n      ${this.renderStartFolders(this._security?.startFolderIds ?? [])}\n      ${this.renderSecurityTable(this._security?.formsSecurity ?? [])}\n    `;\n  }\n}\n\nexport default UmbWorkspaceViewSecurityUserPermissionsElement;\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    [elementName]: UmbWorkspaceViewSecurityUserPermissionsElement;\n  }\n}\n"],"names":["elementName","UmbWorkspaceViewSecurityUserPermissionsElement","UmbWorkspaceViewSecurityPermissionsBaseElement","FORMS_SECURITY_USER_WORKSPACE_CONTEXT","security","permission","value","_a","_b","_c","html","__decorateClass","state","customElement","UmbWorkspaceViewSecurityUserPermissionsElement$1"],"mappings":";;;;;;;;AAaA,MAAMA,IAAc;AAGb,IAAMC,IAAN,cACGC,EAEV;AAAA,EAIE,cAAc;AACZ,UAAMC,EAAsC,YAAY;AAAA,EAAA;AAAA,EAG1D,sBAAsB;AACpB,IAAK,KAAK,oBAEV,KAAK,QAAQ,KAAK,iBAAiB,MAAM,CAACC,MAAa;AACrD,MAAKA,MACL,KAAK,YAAYA;AAAA,IAAA,CAClB;AAAA,EAAA;AAAA,EAGH,2BACE,GACAC,GACA;;AACA,UAAMC,IAAQ,EAAE,OAAO;AAEvB,KAAAC,IAAA,KAAK,qBAAL,QAAAA,EAAuB,wBAAwBF,GAAYC,IAEvDD,MAAe,iBAAiB,CAACC,OACnCE,IAAA,KAAK,qBAAL,QAAAA,EAAuB,wBAAwB,eAAe,MAC9DC,IAAA,KAAK,qBAAL,QAAAA,EAAuB,wBAAwB,iBAAiB,MAGlE,KAAK,cAAc,IAAI,YAAY,aAAa,CAAC,GACjD,KAAK,cAAA;AAAA,EAAc;AAAA,EAGrB,SAAS;;AACP,WAAOC;AAAA,QACH,KAAK,eAAcH,IAAA,KAAK,cAAL,gBAAAA,EAAgB,YAAY,CAAC;AAAA,QAChD,KAAK,qBAAmBC,IAAA,KAAK,cAAL,gBAAAA,EAAgB,mBAAkB,CAAA,CAAE,CAAC;AAAA,QAC7D,KAAK,sBAAoBC,IAAA,KAAK,cAAL,gBAAAA,EAAgB,kBAAiB,CAAA,CAAE,CAAC;AAAA;AAAA,EAAA;AAGrE;AAvCEE,EAAA;AAAA,EADCC,EAAA;AAAM,GAJIX,EAKX,WAAA,aAAA,CAAA;AALWA,IAANU,EAAA;AAAA,EADNE,EAAcb,CAAW;AAAA,GACbC,CAAA;AA8Cb,MAAAa,IAAeb;"}