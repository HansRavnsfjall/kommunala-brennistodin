{"version":3,"file":"exporter.service-e5HNtlDi.js","sources":["../../../usync-exporter-assets/src/api/sdk.gen.ts","../../../usync-exporter-assets/src/shared/exporter.repository.ts","../../../usync-exporter-assets/src/shared/exporter.service.ts"],"sourcesContent":["// This file is auto-generated by @hey-api/openapi-ts\n\nimport type { Options as ClientOptions, TDataShape, Client } from '@hey-api/client-fetch';\nimport type { GetExportData, GetExportResponse, GetExportersData, GetExportersResponse, GetSettingsData, GetSettingsResponse, GetItemInfoData, GetItemInfoResponse } from './types.gen';\nimport { client as _heyApiClient } from './client.gen';\n\nexport type Options<TData extends TDataShape = TDataShape, ThrowOnError extends boolean = boolean> = ClientOptions<TData, ThrowOnError> & {\n    /**\n     * You can provide a client instance returned by `createClient()` instead of\n     * individual options. This might be also useful if you want to implement a\n     * custom client.\n     */\n    client?: Client;\n    /**\n     * You can pass arbitrary values through the `meta` object. This can be\n     * used to access values that aren't defined as part of the SDK function.\n     */\n    meta?: Record<string, unknown>;\n};\n\nexport class ExporterService {\n    public static getExport<ThrowOnError extends boolean = false>(options?: Options<GetExportData, ThrowOnError>) {\n        return (options?.client ?? _heyApiClient).post<GetExportResponse, unknown, ThrowOnError>({\n            url: '/umbraco/usync/api/v1/Exporter/GetExport',\n            ...options\n        });\n    }\n    \n    public static getExporters<ThrowOnError extends boolean = false>(options?: Options<GetExportersData, ThrowOnError>) {\n        return (options?.client ?? _heyApiClient).get<GetExportersResponse, unknown, ThrowOnError>({\n            url: '/umbraco/usync/api/v1/Exporter/GetExporters',\n            ...options\n        });\n    }\n    \n    public static getSettings<ThrowOnError extends boolean = false>(options?: Options<GetSettingsData, ThrowOnError>) {\n        return (options?.client ?? _heyApiClient).get<GetSettingsResponse, unknown, ThrowOnError>({\n            url: '/umbraco/usync/api/v1/Exporter/GetExporterSettings',\n            ...options\n        });\n    }\n    \n    public static getItemInfo<ThrowOnError extends boolean = false>(options?: Options<GetItemInfoData, ThrowOnError>) {\n        return (options?.client ?? _heyApiClient).post<GetItemInfoResponse, unknown, ThrowOnError>({\n            url: '/umbraco/usync/api/v1/Exporter/GetItemInfo',\n            ...options,\n            headers: {\n                'Content-Type': 'application/json',\n                ...options?.headers\n            }\n        });\n    }\n    \n}","import { UmbControllerBase } from '@umbraco-cms/backoffice/class-api';\r\nimport { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { tryExecute } from '@umbraco-cms/backoffice/resources';\r\nimport { ExporterSelectedItem, ExporterService } from '../api';\r\n\r\nexport class SyncExporterRepository extends UmbControllerBase {\r\n\t#host: UmbControllerHost;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host);\r\n\t\tthis.#host = host;\r\n\t}\r\n\r\n\tasync GetSettings() {\r\n\t\treturn await tryExecute(this.#host, ExporterService.getSettings());\r\n\t}\r\n\r\n\tasync GetExporters() {\r\n\t\treturn await tryExecute(this.#host, ExporterService.getExporters());\r\n\t}\r\n\r\n\tasync GetItemInfo(items: ExporterSelectedItem[]) {\r\n\t\treturn await tryExecute(\r\n\t\t\tthis.#host,\r\n\t\t\tExporterService.getItemInfo({\r\n\t\t\t\tbody: items,\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\tasync GetExport(id: string) {\r\n\t\treturn await tryExecute(this.#host, ExporterService.getExport({ query: { id } }));\r\n\t}\r\n}\r\n","import { UmbControllerBase } from '@umbraco-cms/backoffice/class-api';\r\nimport { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { SyncExporterRepository } from './exporter.repository';\r\nimport { ExporterSelectedItem } from '../api';\r\n\r\n/**\r\n * shared service for exporter, used in workspaces and dialogs.\r\n *\r\n * this service isn't defined in a manifest, rather other contexts iniitalize it.\r\n */\r\nexport class SyncExporterService extends UmbControllerBase {\r\n\t#repository: SyncExporterRepository;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host);\r\n\r\n\t\tthis.#repository = new SyncExporterRepository(host);\r\n\t}\r\n\r\n\tasync GetSettings() {\r\n\t\treturn (await this.#repository.GetSettings()).data;\r\n\t}\r\n\r\n\tasync GetExporters() {\r\n\t\treturn (await this.#repository.GetExporters()).data;\r\n\t}\r\n\r\n\tasync GetItemInfo(items: ExporterSelectedItem[]) {\r\n\t\treturn (await this.#repository.GetItemInfo(items)).data;\r\n\t}\r\n\r\n\tasync getExport(id: string, name: string | null | undefined) {\r\n\t\tconst response = (await this.#repository.GetExport(id)).data;\r\n\t\tif (!response) return;\r\n\t\tconsole.log(response.type);\r\n\r\n\t\tconst url = window.URL.createObjectURL(response);\r\n\r\n\t\tconst download = document.createElement('a');\r\n\t\tdownload.href = url;\r\n\t\tdownload.download = (name ?? 'usync-export') + '.usync';\r\n\t\tdocument.body.appendChild(download);\r\n\t\tdownload.dispatchEvent(new MouseEvent('click'));\r\n\t\tdownload.remove();\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t}\r\n}\r\n\r\nexport default SyncExporterService;\r\n"],"names":["ExporterService","options","_heyApiClient","SyncExporterRepository","UmbControllerBase","host","__privateAdd","_host","__privateSet","tryExecute","__privateGet","items","id","SyncExporterService","_repository","name","response","url","download"],"mappings":";;;;;;;;AAoBO,MAAMA,EAAgB;AAAA,EACzB,OAAc,UAAgDC,GAAgD;AAClG,aAAAA,KAAA,gBAAAA,EAAS,WAAUC,GAAe,KAA+C;AAAA,MACrF,KAAK;AAAA,MACL,GAAGD;AAAA,IAAA,CACN;AAAA,EAAA;AAAA,EAGL,OAAc,aAAmDA,GAAmD;AACxG,aAAAA,KAAA,gBAAAA,EAAS,WAAUC,GAAe,IAAiD;AAAA,MACvF,KAAK;AAAA,MACL,GAAGD;AAAA,IAAA,CACN;AAAA,EAAA;AAAA,EAGL,OAAc,YAAkDA,GAAkD;AACtG,aAAAA,KAAA,gBAAAA,EAAS,WAAUC,GAAe,IAAgD;AAAA,MACtF,KAAK;AAAA,MACL,GAAGD;AAAA,IAAA,CACN;AAAA,EAAA;AAAA,EAGL,OAAc,YAAkDA,GAAkD;AACtG,aAAAA,KAAA,gBAAAA,EAAS,WAAUC,GAAe,KAAiD;AAAA,MACvF,KAAK;AAAA,MACL,GAAGD;AAAA,MACH,SAAS;AAAA,QACL,gBAAgB;AAAA,QAChB,GAAGA,KAAA,gBAAAA,EAAS;AAAA,MAAA;AAAA,IAChB,CACH;AAAA,EAAA;AAGT;;AChDO,MAAME,UAA+BC,EAAkB;AAAA,EAG7D,YAAYC,GAAyB;AACpC,UAAMA,CAAI;AAHX,IAAAC,EAAA,MAAAC;AAIC,IAAAC,EAAA,MAAKD,GAAQF;AAAA,EAAA;AAAA,EAGd,MAAM,cAAc;AACnB,WAAO,MAAMI,EAAWC,EAAA,MAAKH,IAAOP,EAAgB,aAAa;AAAA,EAAA;AAAA,EAGlE,MAAM,eAAe;AACpB,WAAO,MAAMS,EAAWC,EAAA,MAAKH,IAAOP,EAAgB,cAAc;AAAA,EAAA;AAAA,EAGnE,MAAM,YAAYW,GAA+B;AAChD,WAAO,MAAMF;AAAA,MACZC,EAAA,MAAKH;AAAA,MACLP,EAAgB,YAAY;AAAA,QAC3B,MAAMW;AAAA,MACN,CAAA;AAAA,IACF;AAAA,EAAA;AAAA,EAGD,MAAM,UAAUC,GAAY;AAC3B,WAAO,MAAMH,EAAWC,EAAA,MAAKH,IAAOP,EAAgB,UAAU,EAAE,OAAO,EAAE,IAAAY,EAAK,EAAA,CAAC,CAAC;AAAA,EAAA;AAElF;AA3BCL,IAAA;;ACIM,MAAMM,UAA4BT,EAAkB;AAAA,EAG1D,YAAYC,GAAyB;AACpC,UAAMA,CAAI;AAHX,IAAAC,EAAA,MAAAQ;AAKM,IAAAN,EAAA,MAAAM,GAAc,IAAIX,EAAuBE,CAAI;AAAA,EAAA;AAAA,EAGnD,MAAM,cAAc;AACnB,YAAQ,MAAMK,EAAA,MAAKI,GAAY,YAAe,GAAA;AAAA,EAAA;AAAA,EAG/C,MAAM,eAAe;AACpB,YAAQ,MAAMJ,EAAA,MAAKI,GAAY,aAAgB,GAAA;AAAA,EAAA;AAAA,EAGhD,MAAM,YAAYH,GAA+B;AAChD,YAAQ,MAAMD,EAAA,MAAKI,GAAY,YAAYH,CAAK,GAAG;AAAA,EAAA;AAAA,EAGpD,MAAM,UAAUC,GAAYG,GAAiC;AAC5D,UAAMC,KAAY,MAAMN,EAAA,MAAKI,GAAY,UAAUF,CAAE,GAAG;AACxD,QAAI,CAACI,EAAU;AACP,YAAA,IAAIA,EAAS,IAAI;AAEzB,UAAMC,IAAM,OAAO,IAAI,gBAAgBD,CAAQ,GAEzCE,IAAW,SAAS,cAAc,GAAG;AAC3C,IAAAA,EAAS,OAAOD,GACPC,EAAA,YAAYH,KAAQ,kBAAkB,UACtC,SAAA,KAAK,YAAYG,CAAQ,GAClCA,EAAS,cAAc,IAAI,WAAW,OAAO,CAAC,GAC9CA,EAAS,OAAO,GACT,OAAA,IAAI,gBAAgBD,CAAG;AAAA,EAAA;AAEhC;AAnCCH,IAAA;"}