{"version":3,"file":"background-completed-step.element-CLFjDGom.js","sources":["../../../usync-publisher-assets/src/strategies/common/background-completed-step.element.ts"],"sourcesContent":["import {\r\n\tJUMOO_PROCESSING_CONTEXT,\r\n\tPipeline,\r\n\tPipelineStatus,\r\n\tProcessingOptions,\r\n\tProcessingResults,\r\n\tProcessStepElement,\r\n\tProcessStepElementBase,\r\n} from '@jumoo/processing';\r\nimport { SyncPublisherStratey } from '../constants';\r\nimport { css, customElement, html, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { USyncActionView } from '../../api';\r\n\r\n@customElement(SyncPublisherStratey.elements.backgroundCompleted)\r\nexport class SyncPublishBackgroundCompletedStepElement\r\n\textends ProcessStepElementBase\r\n\timplements ProcessStepElement\r\n{\r\n\t@state()\r\n\tbackgroundResults: ProcessingResults | null | undefined;\r\n\r\n\t@state()\r\n\t_options: ProcessingOptions | null | undefined;\r\n\r\n\t@state()\r\n\tpipeline: Pipeline | null | undefined;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(JUMOO_PROCESSING_CONTEXT, async (context) => {\r\n\t\t\tif (!context) return;\r\n\r\n\t\t\tthis.pipeline = await context.getPipeline(this.pipelineId!);\r\n\r\n\t\t\tthis.observe(context.backgroundState, async (backgroundState) => {\r\n\t\t\t\tif (backgroundState?.status == PipelineStatus.COMPLETED) {\r\n\t\t\t\t\tconst completedPipeline = await context.fetchPipeline(this.pipelineId!);\r\n\t\t\t\t\tthis.backgroundResults = completedPipeline?.results;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthis.observe(context.options, (options) => {\r\n\t\t\t\tthis._options = options;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst actions = this.pipeline?.results?.results['actions'] as USyncActionView[];\r\n\r\n\t\treturn html`<div class=\"wrapper\">\r\n\t\t\t<uui-box>Completed in the background</uui-box>\r\n\t\t\t<usync-publisher-report-view\r\n\t\t\t\tserver=${this._options?.server ?? ''}\r\n\t\t\t\t.isReport=${false}\r\n\t\t\t\t.results=${actions}></usync-publisher-report-view>\r\n\t\t</div> `;\r\n\t}\r\n\r\n\tstatic styles = css`\r\n\t\t.wrapper {\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\tgap: var(--uui-size-space-4);\r\n\t\t}\r\n\t`;\r\n}\r\n\r\nexport default SyncPublishBackgroundCompletedStepElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'jumoo-sync-publish-background-completed-step': SyncPublishBackgroundCompletedStepElement;\r\n\t}\r\n}\r\n"],"names":["SyncPublishBackgroundCompletedStepElement","ProcessStepElementBase","JUMOO_PROCESSING_CONTEXT","context","backgroundState","PipelineStatus","completedPipeline","options","actions","_b","_a","html","_c","css","__decorateClass","state","customElement","SyncPublisherStratey","SyncPublishBackgroundCompletedStepElement$1"],"mappings":";;;;;;;;AAca,IAAAA,IAAN,cACEC,EAET;AAAA,EAUC,cAAc;AACP,UAAA,GAED,KAAA,eAAeC,GAA0B,OAAOC,MAAY;AAChE,MAAKA,MAEL,KAAK,WAAW,MAAMA,EAAQ,YAAY,KAAK,UAAW,GAE1D,KAAK,QAAQA,EAAQ,iBAAiB,OAAOC,MAAoB;AAC5D,aAAAA,KAAA,gBAAAA,EAAiB,WAAUC,EAAe,WAAW;AACxD,gBAAMC,IAAoB,MAAMH,EAAQ,cAAc,KAAK,UAAW;AACtE,eAAK,oBAAoBG,KAAA,gBAAAA,EAAmB;AAAA,QAAA;AAAA,MAC7C,CACA,GAED,KAAK,QAAQH,EAAQ,SAAS,CAACI,MAAY;AAC1C,aAAK,WAAWA;AAAA,MAAA,CAChB;AAAA,IAAA,CACD;AAAA,EAAA;AAAA,EAGF,SAAS;;AACR,UAAMC,KAAUC,KAAAC,IAAA,KAAK,aAAL,gBAAAA,EAAe,YAAf,gBAAAD,EAAwB,QAAQ;AAEzC,WAAAE;AAAA;AAAA;AAAA,eAGIC,IAAA,KAAK,aAAL,gBAAAA,EAAe,WAAU,EAAE;AAAA,gBACxB,EAAK;AAAA,eACNJ,CAAO;AAAA;AAAA,EAAA;AAWtB;AArDaR,EA8CL,SAASa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAzChBC,EAAA;AAAA,EADCC,EAAM;AAAA,GAJKf,EAKZ,WAAA,qBAAA,CAAA;AAGAc,EAAA;AAAA,EADCC,EAAM;AAAA,GAPKf,EAQZ,WAAA,YAAA,CAAA;AAGAc,EAAA;AAAA,EADCC,EAAM;AAAA,GAVKf,EAWZ,WAAA,YAAA,CAAA;AAXYA,IAANc,EAAA;AAAA,EADNE,EAAcC,EAAqB,SAAS,mBAAmB;AAAA,GACnDjB,CAAA;AAuDb,MAAAkB,IAAelB;"}