{"version":3,"file":"generate-key.modal-element-CbpoA1K_.js","sources":["../../../usync-publisher-assets/src/servers/modals/generate-key.modal-element.ts"],"sourcesContent":["import { customElement, html, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport {\r\n\tSyncPublisherGenerateKeyData,\r\n\tSyncPublisherGenerateKeyValie,\r\n} from './generate-key.modal-token';\r\nimport {\r\n\tSyncPublisherServerSharedContext,\r\n\tUSYNC_PUBLISHER_SERVER_SHARED_CONTEXT,\r\n} from '../workspace/server-workspace-shared.context';\r\nimport { AppKeySetupResult } from '../../api';\r\n\r\n@customElement('usync-publisher-generate-key-modal')\r\nexport class uSyncPublisherGenerateKeyModalElement extends UmbModalBaseElement<\r\n\tSyncPublisherGenerateKeyData,\r\n\tSyncPublisherGenerateKeyValie\r\n> {\r\n\t#context?: SyncPublisherServerSharedContext;\r\n\r\n\t@state()\r\n\tkeydata: AppKeySetupResult | undefined;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(USYNC_PUBLISHER_SERVER_SHARED_CONTEXT, async (context) => {\r\n\t\t\tif (!context) return;\r\n\r\n\t\t\tthis.#context = context;\r\n\t\t\tthis.keydata = await this.#context.createKeys();\r\n\t\t});\r\n\t}\r\n\r\n\t#onCancel() {\r\n\t\tthis.modalContext?.reject();\r\n\t}\r\n\r\n\tasync #onConfirm() {\r\n\t\tif (!this.keydata) return;\r\n\t\tconst result = await this.#context?.saveKeys(this.keydata.appId, this.keydata.appKey);\r\n\r\n\t\tif (result) {\r\n\t\t\talert('Keys saved to appsettings.json');\r\n\t\t\tthis.modalContext?.submit();\r\n\t\t}\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst keyJson = JSON.parse(this.keydata?.json || '{}');\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=\"Generate Keys\" style=\"max-width:600px;\">\r\n\t\t\t\t<umb-localize key=\"usyncpublish_generateKeyDescription\"></umb-localize>\r\n\r\n\t\t\t\t<umb-code-block language=\"JSON\" .copy=${true}\r\n\t\t\t\t\t>${JSON.stringify(keyJson, null, 1)}</umb-code-block\r\n\t\t\t\t>\r\n\r\n\t\t\t\t<div slot=\"actions\">${this.renderActions()}</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\trenderActions() {\r\n\t\treturn html`\r\n\t\t\t<uui-button label=\"Cancel\" @click=\"${this.#onCancel}\">Cancel</uui-button>\r\n\t\t\t<uui-button label=\"Save\" color=\"positive\" look=\"primary\" @click=\"${this.#onConfirm}\"\r\n\t\t\t\t>Save</uui-button\r\n\t\t\t>\r\n\t\t`;\r\n\t}\r\n}\r\n\r\nexport default uSyncPublisherGenerateKeyModalElement;\r\n"],"names":["_context","_uSyncPublisherGenerateKeyModalElement_instances","onCancel_fn","onConfirm_fn","uSyncPublisherGenerateKeyModalElement","UmbModalBaseElement","__privateAdd","USYNC_PUBLISHER_SERVER_SHARED_CONTEXT","context","__privateSet","__privateGet","keyJson","_a","html","__privateMethod","_b","__decorateClass","state","customElement","uSyncPublisherGenerateKeyModalElement$1"],"mappings":";;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC;AAaa,IAAAC,IAAN,cAAoDC,EAGzD;AAAA,EAMD,cAAc;AACP,UAAA,GAVDC,EAAA,MAAAL,CAAA,GAINK,EAAA,MAAAN,CAAA,GAQM,KAAA,eAAeO,GAAuC,OAAOC,MAAY;AAC7E,MAAKA,MAELC,EAAA,MAAKT,GAAWQ,CAAA,GAChB,KAAK,UAAU,MAAME,EAAK,MAAAV,CAAA,EAAS,WAAW;AAAA,IAAA,CAC9C;AAAA,EAAA;AAAA,EAiBF,SAAS;;AACR,UAAMW,IAAU,KAAK,QAAMC,IAAA,KAAK,YAAL,gBAAAA,EAAc,SAAQ,IAAI;AAE9C,WAAAC;AAAA;AAAA;AAAA;AAAA,4CAImC,EAAI;AAAA,QACxC,KAAK,UAAUF,GAAS,MAAM,CAAC,CAAC;AAAA;AAAA;AAAA,0BAGd,KAAK,eAAe;AAAA;AAAA;AAAA,EAAA;AAAA,EAK7C,gBAAgB;AACR,WAAAE;AAAA,wCAC+BC,QAAKb,GAASC,CAAA,CAAA;AAAA,sEACgBY,QAAKb,GAAUE,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA,EAAA;AAKrF;AAtDCH,IAAA,oBAAA,QAAA;AAJMC,IAAA,oBAAA,QAAA;AAoBNC,IAAS,WAAG;;AACX,GAAAU,IAAA,KAAK,iBAAL,QAAAA,EAAmB;AACpB;AAEMT,IAAU,iBAAG;;AACd,MAAA,CAAC,KAAK,QAAS;AAGnB,EAFe,QAAMS,IAAAF,EAAA,MAAKV,CAAU,MAAf,gBAAAY,EAAe,SAAS,KAAK,QAAQ,OAAO,KAAK,QAAQ,aAG7E,MAAM,gCAAgC,IACtCG,IAAA,KAAK,iBAAL,QAAAA,EAAmB;AAErB;AAzBAC,EAAA;AAAA,EADCC,EAAM;AAAA,GANKb,EAOZ,WAAA,WAAA,CAAA;AAPYA,IAANY,EAAA;AAAA,EADNE,EAAc,oCAAoC;AAAA,GACtCd,CAAA;AA4Db,MAAAe,IAAef;"}