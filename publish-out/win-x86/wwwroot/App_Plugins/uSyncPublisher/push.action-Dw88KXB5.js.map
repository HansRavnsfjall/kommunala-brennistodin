{"version":3,"file":"push.action-Dw88KXB5.js","sources":["../../../usync-publisher-assets/src/actions/push.action.ts"],"sourcesContent":["import { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport {\r\n\tUmbEntityActionArgs,\r\n\tUmbEntityActionBase,\r\n} from '@umbraco-cms/backoffice/entity-action';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { PublishMode } from '../api';\r\nimport { USYNC_PUBLISHER_PROCESS_MODAL } from '../strategies/modal/process-modal.token';\r\nimport PublisherStrategyContext from '../strategies/strategy.context';\r\n\r\nexport default class SyncPublisherPushEntityAction extends UmbEntityActionBase<never> {\r\n\t#strategyContext: PublisherStrategyContext;\r\n\r\n\tmode = PublishMode.PUSH;\r\n\r\n\tconstructor(host: UmbControllerHost, args: UmbEntityActionArgs<never>) {\r\n\t\tsuper(host, args);\r\n\t\tthis.#strategyContext = new PublisherStrategyContext(host);\r\n\t}\r\n\r\n\tasync execute(): Promise<void> {\r\n\t\tconst item = await this.#strategyContext?.getSyncItem(\r\n\t\t\tthis.args.entityType,\r\n\t\t\tthis.args.unique ?? '',\r\n\t\t);\r\n\t\tif (!item) return;\r\n\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalManager) return;\r\n\r\n\t\tconst actionModalContext = modalManager.open(this, USYNC_PUBLISHER_PROCESS_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\taction: 'push',\r\n\t\t\t\titems: [item.udi],\r\n\t\t\t\tentityType: this.args.entityType,\r\n\t\t\t\tmode: this.mode,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tawait actionModalContext?.onSubmit().catch(() => {\r\n\t\t\treturn; // user pressed cancel.\r\n\t\t});\r\n\r\n\t\treturn;\r\n\t}\r\n}\r\n"],"names":["SyncPublisherPushEntityAction","UmbEntityActionBase","host","args","__privateAdd","_strategyContext","PublishMode","__privateSet","PublisherStrategyContext","item","_a","__privateGet","modalManager","UMB_MODAL_MANAGER_CONTEXT","actionModalContext","USYNC_PUBLISHER_PROCESS_MODAL"],"mappings":";;;;;;;;;;AAUA,MAAqBA,UAAsCC,EAA2B;AAAA,EAKrF,YAAYC,GAAyBC,GAAkC;AACtE,UAAMD,GAAMC,CAAI;AALjB,IAAAC,EAAA,MAAAC;AAEA,SAAA,OAAOC,EAAY,MAIbC,EAAA,MAAAF,GAAmB,IAAIG,EAAyBN,CAAI;AAAA,EAAA;AAAA,EAG1D,MAAM,UAAyB;;AACxB,UAAAO,IAAO,QAAMC,IAAAC,EAAA,MAAKN,OAAL,gBAAAK,EAAuB;AAAA,MACzC,KAAK,KAAK;AAAA,MACV,KAAK,KAAK,UAAU;AAAA;AAErB,QAAI,CAACD,EAAM;AAEX,UAAMG,IAAe,MAAM,KAAK,WAAWC,CAAyB;AACpE,QAAI,CAACD,EAAc;AAEnB,UAAME,IAAqBF,EAAa,KAAK,MAAMG,GAA+B;AAAA,MACjF,MAAM;AAAA,QACL,QAAQ;AAAA,QACR,OAAO,CAACN,EAAK,GAAG;AAAA,QAChB,YAAY,KAAK,KAAK;AAAA,QACtB,MAAM,KAAK;AAAA,MAAA;AAAA,IACZ,CACA;AAED,WAAMK,KAAA,gBAAAA,EAAoB,WAAW,MAAM,MAAM;AAAA,IAChD;AAAA,EAGD;AAEF;AAlCCT,IAAA;"}