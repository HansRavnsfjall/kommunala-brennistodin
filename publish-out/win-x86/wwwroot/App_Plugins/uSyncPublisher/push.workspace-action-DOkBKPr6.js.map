{"version":3,"file":"push.workspace-action-DOkBKPr6.js","sources":["../../../usync-publisher-assets/src/actions/push.workspace-action.ts"],"sourcesContent":["import { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { PublishMode } from '../api';\r\nimport PublisherStrategyContext from '../strategies/strategy.context';\r\nimport { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport {\r\n\tUmbWorkspaceActionArgs,\r\n\tUmbWorkspaceActionBase,\r\n} from '@umbraco-cms/backoffice/workspace';\r\nimport { UMB_DOCUMENT_WORKSPACE_CONTEXT } from '@umbraco-cms/backoffice/document';\r\nimport { USYNC_PUBLISHER_PROCESS_MODAL } from '../strategies/modal/process-modal.token';\r\n\r\nexport class SyncPublisherPushEntityAction extends UmbWorkspaceActionBase {\r\n\t#strategyContext: PublisherStrategyContext;\r\n\r\n\tconstructor(host: UmbControllerHost, args: UmbWorkspaceActionArgs<never>) {\r\n\t\tsuper(host, args);\r\n\t\tthis.#strategyContext = new PublisherStrategyContext(host);\r\n\t}\r\n\r\n\toverride async execute() {\r\n\t\tconst workspaceContext = await this.getContext(UMB_DOCUMENT_WORKSPACE_CONTEXT);\r\n\t\tif (!workspaceContext) return;\r\n\r\n\t\tconst unique = workspaceContext.getUnique();\r\n\t\tif (!unique) return;\r\n\r\n\t\tconst entityType = workspaceContext.getEntityType();\r\n\r\n\t\tconst item = await this.#strategyContext.getSyncItem(entityType, unique);\r\n\t\tif (!item) return;\r\n\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalManager) return;\r\n\r\n\t\tconst modalContext = modalManager.open(this, USYNC_PUBLISHER_PROCESS_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\taction: 'push',\r\n\t\t\t\titems: [item.udi],\r\n\t\t\t\tentityType: entityType,\r\n\t\t\t\tmode: PublishMode.PUSH,\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tawait modalContext.onSubmit().catch(() => {\r\n\t\t\treturn; // user pressed cancel.\r\n\t\t});\r\n\r\n\t\treturn;\r\n\t}\r\n}\r\n\r\nexport { SyncPublisherPushEntityAction as api };\r\n"],"names":["SyncPublisherPushEntityAction","UmbWorkspaceActionBase","host","args","__privateAdd","_strategyContext","__privateSet","PublisherStrategyContext","workspaceContext","UMB_DOCUMENT_WORKSPACE_CONTEXT","unique","entityType","item","__privateGet","modalManager","UMB_MODAL_MANAGER_CONTEXT","USYNC_PUBLISHER_PROCESS_MODAL","PublishMode"],"mappings":";;;;;;;;;;;AAWO,MAAMA,UAAsCC,EAAuB;AAAA,EAGzE,YAAYC,GAAyBC,GAAqC;AACzE,UAAMD,GAAMC,CAAI;AAHjB,IAAAC,EAAA,MAAAC;AAIM,IAAAC,EAAA,MAAAD,GAAmB,IAAIE,EAAyBL,CAAI;AAAA,EAAA;AAAA,EAG1D,MAAe,UAAU;AACxB,UAAMM,IAAmB,MAAM,KAAK,WAAWC,CAA8B;AAC7E,QAAI,CAACD,EAAkB;AAEjB,UAAAE,IAASF,EAAiB,UAAU;AAC1C,QAAI,CAACE,EAAQ;AAEP,UAAAC,IAAaH,EAAiB,cAAc,GAE5CI,IAAO,MAAMC,EAAA,MAAKR,GAAiB,YAAYM,GAAYD,CAAM;AACvE,QAAI,CAACE,EAAM;AAEX,UAAME,IAAe,MAAM,KAAK,WAAWC,CAAyB;AACpE,QAAI,CAACD,EAAc;AAWnB,UATqBA,EAAa,KAAK,MAAME,GAA+B;AAAA,MAC3E,MAAM;AAAA,QACL,QAAQ;AAAA,QACR,OAAO,CAACJ,EAAK,GAAG;AAAA,QAChB,YAAAD;AAAA,QACA,MAAMM,EAAY;AAAA,MAAA;AAAA,IACnB,CACA,EAEkB,WAAW,MAAM,MAAM;AAAA,IACzC,CACA;AAAA,EAED;AAEF;AArCCZ,IAAA;"}