{"version":3,"file":"server-item-sync.element-BwSJwgj2.js","sources":["../../../usync-publisher-assets/src/servers/workspace/server-item/views/server-item-sync.element.ts"],"sourcesContent":["import { css, customElement, html, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { PublishMode, SyncPublishServerView } from '../../../../api';\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from '@umbraco-cms/backoffice/modal';\r\nimport { USYNC_PUBLISHER_SERVER_SHARED_CONTEXT } from '../../server-workspace-shared.context';\r\nimport { USYNC_PUBLISHER_PROCESS_MODAL } from '../../../../strategies/modal/process-modal.token';\r\n\r\n@customElement('usync-publisher-server-sync')\r\nexport class uSyncPublisherServerSyncElement extends UmbLitElement {\r\n\t@state()\r\n\tdata?: SyncPublishServerView;\r\n\r\n\t@state()\r\n\t_selectedEntities: string[] = [];\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(USYNC_PUBLISHER_SERVER_SHARED_CONTEXT, (_context) => {\r\n\t\t\tif (!_context) return;\r\n\r\n\t\t\tthis.observe(_context.data, (_data) => {\r\n\t\t\t\tthis.data = _data;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t#onUpdateEntities = (e: CustomEvent<string[]>) => {\r\n\t\tthis._selectedEntities = e.detail;\r\n\t};\r\n\r\n\tasync #openSyncDialog(mode: PublishMode) {\r\n\t\tconst modalContext = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalContext) return;\r\n\r\n\t\tconst entityType = this._selectedEntities[0].split('/')[2];\r\n\r\n\t\tconst settingsMode =\r\n\t\t\tmode == PublishMode.PUSH ? PublishMode.SETTINGS_PUSH : PublishMode.SETTINGS_PULL;\r\n\r\n\t\tconst actionModalContext = await modalContext.open(\r\n\t\t\tthis,\r\n\t\t\tUSYNC_PUBLISHER_PROCESS_MODAL,\r\n\t\t\t{\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tserver: this.data,\r\n\t\t\t\t\taction: settingsMode,\r\n\t\t\t\t\t// @ts-expect-error - udis are strings in this instance its ok.\r\n\t\t\t\t\titems: this._selectedEntities,\r\n\t\t\t\t\tentityType: entityType,\r\n\t\t\t\t\tmode: settingsMode,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t);\r\n\r\n\t\tactionModalContext.onSubmit().catch(() => {\r\n\t\t\treturn; // user pressed cancel.\r\n\t\t});\r\n\r\n\t\treturn;\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn html`<umb-body-layout>\r\n\t\t\t<uui-box headline=\"Sync this server\">\r\n\t\t\t\t<div slot=\"header\">\r\n\t\t\t\t\t<small\r\n\t\t\t\t\t\t>Choose what elements of this server to sync with your current site.</small\r\n\t\t\t\t\t>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<usync-publisher-server-sync-list\r\n\t\t\t\t\t\t@update-selected-entities=${this\r\n\t\t\t\t\t\t\t.#onUpdateEntities}></usync-publisher-server-sync-list>\r\n\t\t\t\t</div>\r\n\t\t\t</uui-box>\r\n\r\n\t\t\t${this.renderButtons()}\r\n\t\t</umb-body-layout> `;\r\n\t}\r\n\r\n\trenderButtons() {\r\n\t\treturn html`\r\n\t\t\t<div class=\"action-buttons\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\tlabel=\"Pull\"\r\n\t\t\t\t\t\t@click=${() => this.#openSyncDialog(PublishMode.PULL)}>\r\n\t\t\t\t\t\t<uui-icon name=\"icon-arrow-left\"></uui-icon> Pull\r\n\t\t\t\t\t</uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\tclass=\"right\"\r\n\t\t\t\t\t\tlabel=\"Push\"\r\n\t\t\t\t\t\t@click=${() => this.#openSyncDialog(PublishMode.PUSH)}>\r\n\t\t\t\t\t\tPush <uui-icon name=\"icon-arrow-right\"></uui-icon\r\n\t\t\t\t\t></uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic styles = css`\r\n\t\t.action-buttons {\r\n\t\t\tdisplay: flex;\r\n\t\t\tpadding: var(--uui-size-3) 0;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\tgap: 20px;\r\n\t\t}\r\n\r\n\t\tuui-button {\r\n\t\t\ttext-align: left;\r\n\t\t}\r\n\r\n\t\tuui-button.right {\r\n\t\t\ttext-align: right;\r\n\t\t}\r\n\t`;\r\n}\r\n\r\nexport default uSyncPublisherServerSyncElement;\r\n"],"names":["_onUpdateEntities","_uSyncPublisherServerSyncElement_instances","openSyncDialog_fn","uSyncPublisherServerSyncElement","UmbLitElement","__privateAdd","e","USYNC_PUBLISHER_SERVER_SHARED_CONTEXT","_context","_data","html","__privateGet","__privateMethod","PublishMode","mode","modalContext","UMB_MODAL_MANAGER_CONTEXT","entityType","settingsMode","USYNC_PUBLISHER_PROCESS_MODAL","css","__decorateClass","state","customElement","uSyncPublisherServerSyncElement$1"],"mappings":";;;;;;;;;;+TAAAA,GAAAC,GAAAC;AAQa,IAAAC,IAAN,cAA8CC,EAAc;AAAA,EAOlE,cAAc;AACP,UAAA,GARDC,EAAA,MAAAJ,CAAA,GAKN,KAAA,oBAA8B,CAAC,GAc/BI,EAAA,MAAAL,GAAoB,CAACM,MAA6B;AACjD,WAAK,oBAAoBA,EAAE;AAAA,IAAA,CAC5B,GAXM,KAAA,eAAeC,GAAuC,CAACC,MAAa;AACxE,MAAKA,KAEL,KAAK,QAAQA,EAAS,MAAM,CAACC,MAAU;AACtC,aAAK,OAAOA;AAAA,MAAA,CACZ;AAAA,IAAA,CACD;AAAA,EAAA;AAAA,EAsCF,SAAS;AACD,WAAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAUyBC,QAC1BX,CAAiB,CAAA;AAAA;AAAA;AAAA;AAAA,KAIpB,KAAK,cAAe,CAAA;AAAA;AAAA,EAAA;AAAA,EAIxB,gBAAgB;AACR,WAAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAQM,MAAME,EAAA,MAAKX,GAALC,CAAA,EAAA,KAAA,MAAqBW,EAAY,IAAK,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAW5C,MAAMD,EAAA,MAAKX,GAALC,CAAA,EAAA,KAAA,MAAqBW,EAAY,IAAK,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAA;AAwB3D;AAnGCb,IAAA,oBAAA,QAAA;AAnBMC,IAAA,oBAAA,QAAA;AAuBAC,IAAe,eAACY,GAAmB;AACxC,QAAMC,IAAe,MAAM,KAAK,WAAWC,CAAyB;AACpE,MAAI,CAACD,EAAc;AAEb,QAAAE,IAAa,KAAK,kBAAkB,CAAC,EAAE,MAAM,GAAG,EAAE,CAAC,GAEnDC,IACLJ,KAAQD,EAAY,OAAOA,EAAY,gBAAgBA,EAAY;AAiBjD,GAfQ,MAAME,EAAa;AAAA,IAC7C;AAAA,IACAI;AAAA,IACA;AAAA,MACC,MAAM;AAAA,QACL,QAAQ,KAAK;AAAA,QACb,QAAQD;AAAA;AAAA,QAER,OAAO,KAAK;AAAA,QACZ,YAAAD;AAAA,QACA,MAAMC;AAAA,MAAA;AAAA,IACP;AAAA,EAEF,GAEmB,WAAW,MAAM,MAAM;AAAA,EACzC,CACA;AAGF;AApDYf,EAsGL,SAASiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AApGhBC,EAAA;AAAA,EADCC,EAAM;AAAA,GADKnB,EAEZ,WAAA,QAAA,CAAA;AAGAkB,EAAA;AAAA,EADCC,EAAM;AAAA,GAJKnB,EAKZ,WAAA,qBAAA,CAAA;AALYA,IAANkB,EAAA;AAAA,EADNE,EAAc,6BAA6B;AAAA,GAC/BpB,CAAA;AAwHb,MAAAqB,IAAerB;"}