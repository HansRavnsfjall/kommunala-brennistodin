{"version":3,"file":"default.element-B275mLAZ.js","sources":["../../../usync-snapshots-assets/src/workspace/views/default.element.ts"],"sourcesContent":["import {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tnothing,\r\n\tstate,\r\n\twhen,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport {\r\n\tUMB_CONFIRM_MODAL,\r\n\tUMB_MODAL_MANAGER_CONTEXT,\r\n} from '@umbraco-cms/backoffice/modal';\r\nimport { JUMOO_PROCESSING_SIDEBAR_LARGE_MODAL } from '@jumoo/processing';\r\nimport { uSyncSnapshots } from '../../constants';\r\nimport uSyncSnapshotsWorkspaceContext, {\r\n\tUSYNC_SNAPSHOTS_CONTEXT,\r\n} from '../snapshots.context';\r\nimport { SnapshotInfo } from '../../api';\r\nimport { USYNC_SNAPSHOTS_UPLOAD_MODAL } from '../modal/snapshot-upload.token';\r\n\r\ntype strategyModalInfo = {\r\n\tstrategy: string;\r\n\talias?: string;\r\n\theadline: string;\r\n\tlabel: string;\r\n};\r\n\r\n@customElement('usync-snapshot-default-veiw-element')\r\nexport class uSyncSnapshotsDefaultViewElement extends UmbLitElement {\r\n\t#context?: uSyncSnapshotsWorkspaceContext;\r\n\r\n\t@state()\r\n\tsnapshots?: SnapshotInfo[];\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(USYNC_SNAPSHOTS_CONTEXT, (_context) => {\r\n\t\t\tif (!_context) return;\r\n\r\n\t\t\tthis.#context = _context;\r\n\r\n\t\t\tthis.observe(this.#context.snapshots, (_snapshots) => {\r\n\t\t\t\tthis.snapshots = _snapshots;\r\n\t\t\t});\r\n\r\n\t\t\tthis.#context.getSnapshots();\r\n\t\t});\r\n\t}\r\n\r\n\tasync #openStrategyModal(info: strategyModalInfo) {\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalManager) return;\r\n\r\n\t\tconst snapshotModal = modalManager.open(this, JUMOO_PROCESSING_SIDEBAR_LARGE_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tprocessor: uSyncSnapshots.processing.pipeline,\r\n\t\t\t\tstrategy: info.strategy,\r\n\t\t\t\tprogressLabel: info.label ?? 'Create',\r\n\t\t\t\theadline: info.headline,\r\n\t\t\t\toptions: {\r\n\t\t\t\t\t$type: 'SnapshotsProcessingOptions',\r\n\t\t\t\t\tname: '',\r\n\t\t\t\t\talias: info.alias,\r\n\t\t\t\t\tfullSnapshot: false,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tconst data = await snapshotModal.onSubmit().catch((_error) => {\r\n\t\t\treturn false;\r\n\t\t});\r\n\r\n\t\tthis.#context?.getSnapshots();\r\n\t\treturn data !== undefined;\r\n\t}\r\n\r\n\tasync #onCreateSnapshot() {\r\n\t\treturn await this.#openStrategyModal({\r\n\t\t\tstrategy: uSyncSnapshots.processing.stratageies.create,\r\n\t\t\theadline: 'Create Snapshot',\r\n\t\t\tlabel: 'Create',\r\n\t\t});\r\n\t}\r\n\r\n\tasync #onApply(e: CustomEvent) {\r\n\t\treturn await this.#openStrategyModal({\r\n\t\t\tstrategy: uSyncSnapshots.processing.stratageies.apply,\r\n\t\t\theadline: 'Apply Snapshot',\r\n\t\t\tlabel: 'Apply',\r\n\t\t\talias: e.detail.alias,\r\n\t\t});\r\n\t}\r\n\r\n\tasync #onReport(e: CustomEvent) {\r\n\t\treturn await this.#openStrategyModal({\r\n\t\t\tstrategy: uSyncSnapshots.processing.stratageies.report,\r\n\t\t\theadline: 'Report Snapshot',\r\n\t\t\tlabel: 'Report',\r\n\t\t\talias: e.detail.alias,\r\n\t\t});\r\n\t}\r\n\r\n\tasync #onReportAll() {\r\n\t\treturn await this.#openStrategyModal({\r\n\t\t\tstrategy: uSyncSnapshots.processing.stratageies.report,\r\n\t\t\theadline: 'Report All Snapshots',\r\n\t\t\tlabel: 'Report',\r\n\t\t});\r\n\t}\r\n\r\n\tasync #onApplyAll() {\r\n\t\treturn await this.#openStrategyModal({\r\n\t\t\tstrategy: uSyncSnapshots.processing.stratageies.apply,\r\n\t\t\theadline: 'Apply All Snapshots',\r\n\t\t\tlabel: 'Apply',\r\n\t\t});\r\n\t}\r\n\r\n\tasync #onDownload(e: CustomEvent) {\r\n\t\tif (!e.detail?.alias) return;\r\n\t\tawait this.#context?.downloadSnapshot(e.detail.alias);\r\n\t}\r\n\r\n\tasync #onDownloadAll() {\r\n\t\tawait this.#context?.downloadAll();\r\n\t}\r\n\r\n\tasync #onUpload() {\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalManager) return;\r\n\r\n\t\tconst uploadModal = modalManager.open(this, USYNC_SNAPSHOTS_UPLOAD_MODAL, {\r\n\t\t\tdata: {},\r\n\t\t});\r\n\r\n\t\tuploadModal\r\n\t\t\t.onSubmit()\r\n\t\t\t.then(async () => {\r\n\t\t\t\tawait this.#context?.getSnapshots();\r\n\t\t\t})\r\n\t\t\t.catch(() => {\r\n\t\t\t\t// cancel\r\n\t\t\t});\r\n\t}\r\n\r\n\tasync #onRemove(e: CustomEvent) {\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tif (!modalManager) return;\r\n\r\n\t\tconst confirmModal = modalManager.open(this, UMB_CONFIRM_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\theadline: 'Remove Snapshot',\r\n\t\t\t\tcontent: 'Are you sure you want to remove this snapshot?',\r\n\t\t\t\tconfirmLabel: 'Remove',\r\n\t\t\t\tcolor: 'danger',\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tconfirmModal\r\n\t\t\t.onSubmit()\r\n\t\t\t.then(async () => {\r\n\t\t\t\tawait this.#context?.remove(e.detail.alias);\r\n\t\t\t})\r\n\t\t\t.catch(() => {\r\n\t\t\t\t// cancel\r\n\t\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\treturn html`<umb-body-layout>\r\n\t\t\t${when(this.snapshots?.length === 0, () => this.renderEmpty())}\r\n\t\t\t<uui-box headline=\"Snapshots\">\r\n\t\t\t\t<div slot=\"header-actions\">\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=\"Create Snapshot\"\r\n\t\t\t\t\t\tcolor=\"default\"\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t@click=${this.#onCreateSnapshot}></uui-button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t${this.snapshots?.length === 0 ? nothing : this.renderTable()}\r\n\t\t\t</uui-box>\r\n\t\t</umb-body-layout>`;\r\n\t}\r\n\r\n\trenderTable() {\r\n\t\treturn html` <usync-snapshot-table\r\n\t\t\t\t.snapshots=${this.snapshots}\r\n\t\t\t\t@snapshot-apply=${this.#onApply}\r\n\t\t\t\t@snapshot-download=${this.#onDownload}\r\n\t\t\t\t@snapshot-remove=${this.#onRemove}\r\n\t\t\t\t@snapshot-report=${this.#onReport}></usync-snapshot-table>\r\n\r\n\t\t\t${this.renderButtons()}`;\r\n\t}\r\n\r\n\trenderEmpty() {\r\n\t\treturn html`<umb-empty-state>\r\n\t\t\t<h2><uui-icon name=\"icon-flash\"></uui-icon>uSync.Snapshots</h2>\r\n\t\t</umb-empty-state>`;\r\n\t}\r\n\r\n\trenderButtons() {\r\n\t\treturn this.snapshots?.length === 0\r\n\t\t\t? nothing\r\n\t\t\t: html`\r\n\t\t\t\t<div class=\"buttons\">\r\n\t\t\t\t\t<div class=\"buttons-left\">\r\n\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\tcompact\r\n\t\t\t\t\t\t\tlabel=\"upload\"\r\n\t\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t\tlook=\"default\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\ttitle=\"upload\"\r\n\t\t\t\t\t\t\t@click=${this.#onUpload}>\r\n\t\t\t\t\t\t\t<uui-icon name=\"icon-page-up\"></uui-icon\r\n\t\t\t\t\t\t></uui-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"buttons-right\">\r\n\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\tlabel=\"Apply all\"\r\n\t\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t@click=${this.#onApplyAll}>\r\n\t\t\t\t\t\t\t<uui-icon name=\"icon-add\"></uui-icon> Apply All\r\n\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\tlabel=\"Report\"\r\n\t\t\t\t\t\t\tcolor=\"default\"\r\n\t\t\t\t\t\t\tlook=\"default\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t@click=${this.#onReportAll}>\r\n\t\t\t\t\t\t\t<uui-icon name=\"icon-info\"></uui-icon> Report All\r\n\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\tlabel=\"Download\"\r\n\t\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t\tlook=\"default\"\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t@click=${this.#onDownloadAll}>\r\n\t\t\t\t\t\t\t<uui-icon name=\"icon-download-alt\"></uui-icon> Download All\r\n\t\t\t\t\t\t</uui-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</uui-box>\r\n\t\t</umb-body-layout>`;\r\n\t}\r\n\r\n\tstatic styles = css`\r\n\t\tuui-box {\r\n\t\t\tposition: relative;\r\n\t\t\tz-index: 1;\r\n\t\t}\r\n\r\n\t\t.buttons {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\tmargin-top: 20px;\r\n\t\t}\r\n\r\n\t\t.buttons-right {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: flex-end;\r\n\t\t\tgap: 10px;\r\n\t\t}\r\n\r\n\t\tumb-empty-state {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 50%;\r\n\t\t\ttransform: translateY(-50%);\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t\tmargin: 0 auto;\r\n\t\t\ttext-align: center;\r\n\t\t\tcolor: var(--uui-color-border);\r\n\t\t\tz-index: 0;\r\n\t\t}\r\n\r\n\t\tumb-empty-state h2 {\r\n\t\t\tfont-size: var(--uui-type-h2-size);\r\n\t\t}\r\n\t\tumb-empty-state uui-icon {\r\n\t\t\tposition: relative;\r\n\t\t\ttop: var(--uui-size-4);\r\n\t\t}\r\n\t`;\r\n}\r\n\r\nexport default uSyncSnapshotsDefaultViewElement;\r\n"],"names":["_context","_uSyncSnapshotsDefaultViewElement_instances","openStrategyModal_fn","onCreateSnapshot_fn","onApply_fn","onReport_fn","onReportAll_fn","onApplyAll_fn","onDownload_fn","onDownloadAll_fn","onUpload_fn","onRemove_fn","uSyncSnapshotsDefaultViewElement","UmbLitElement","__privateAdd","USYNC_SNAPSHOTS_CONTEXT","__privateSet","__privateGet","_snapshots","html","when","_a","__privateMethod","_b","nothing","info","modalManager","UMB_MODAL_MANAGER_CONTEXT","data","JUMOO_PROCESSING_SIDEBAR_LARGE_MODAL","uSyncSnapshots","_error","e","USYNC_SNAPSHOTS_UPLOAD_MODAL","UMB_CONFIRM_MODAL","css","__decorateClass","state","customElement","uSyncSnapshotsDefaultViewElement$1"],"mappings":"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"}