{"version":3,"file":"block-catalogue-modal.element-DgrfRSxG.js","sources":["../../../src/packages/block/block/modals/block-catalogue/block-catalogue-modal.element.ts"],"sourcesContent":["import { UMB_BLOCK_WORKSPACE_MODAL } from '../../workspace/index.js';\r\nimport { UMB_BLOCK_MANAGER_CONTEXT } from '../../context/index.js';\r\nimport type { UmbBlockCatalogueModalData, UmbBlockCatalogueModalValue } from './block-catalogue-modal.token.js';\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tifDefined,\r\n\tnothing,\r\n\trepeat,\r\n\tstate,\r\n\twhen,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { transformServerPathToClientPath } from '@umbraco-cms/backoffice/utils';\r\nimport { UmbModalRouteRegistrationController } from '@umbraco-cms/backoffice/router';\r\nimport { UmbRepositoryItemsManager } from '@umbraco-cms/backoffice/repository';\r\nimport { UMB_DOCUMENT_TYPE_ITEM_REPOSITORY_ALIAS } from '@umbraco-cms/backoffice/document-type';\r\nimport { UMB_MODAL_CONTEXT, UmbModalBaseElement } from '@umbraco-cms/backoffice/modal';\r\nimport { UMB_SERVER_CONTEXT } from '@umbraco-cms/backoffice/server';\r\nimport type { UmbBlockTypeGroup, UmbBlockTypeWithGroupKey } from '@umbraco-cms/backoffice/block-type';\r\nimport type { UmbDocumentTypeItemModel } from '@umbraco-cms/backoffice/document-type';\r\nimport type { UmbSelectionChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport type { UUIInputEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\ntype UmbBlockTypeItemWithGroupKey = UmbBlockTypeWithGroupKey & UmbDocumentTypeItemModel;\r\n\r\n@customElement('umb-block-catalogue-modal')\r\nexport class UmbBlockCatalogueModalElement extends UmbModalBaseElement<\r\n\tUmbBlockCatalogueModalData,\r\n\tUmbBlockCatalogueModalValue\r\n> {\r\n\treadonly #itemManager = new UmbRepositoryItemsManager<UmbDocumentTypeItemModel>(\r\n\t\tthis,\r\n\t\tUMB_DOCUMENT_TYPE_ITEM_REPOSITORY_ALIAS,\r\n\t);\r\n\r\n\t#search = '';\r\n\r\n\t#serverUrl = '';\r\n\r\n\tprivate _groupedBlocks: Array<{ name?: string; blocks: Array<UmbBlockTypeItemWithGroupKey> }> = [];\r\n\r\n\t@state()\r\n\tprivate _openClipboard?: boolean;\r\n\r\n\t@state()\r\n\tprivate _workspacePath?: string;\r\n\r\n\t@state()\r\n\tprivate _filtered: Array<{ name?: string; blocks: Array<UmbBlockTypeItemWithGroupKey> }> = [];\r\n\r\n\t@state()\r\n\tprivate _manager?: typeof UMB_BLOCK_MANAGER_CONTEXT.TYPE;\r\n\r\n\t@state()\r\n\tprivate _loading = true;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_SERVER_CONTEXT, (instance) => {\r\n\t\t\tthis.#serverUrl = instance?.getServerUrl() ?? '';\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_MODAL_CONTEXT, (modalContext) => {\r\n\t\t\tif (modalContext?.data.createBlockInWorkspace) {\r\n\t\t\t\tnew UmbModalRouteRegistrationController(this, UMB_BLOCK_WORKSPACE_MODAL)\r\n\t\t\t\t\t//.addAdditionalPath('block') // No need for additional path specification in this context as this is for sure the only workspace we want to open here.\r\n\t\t\t\t\t.onSetup(() => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tdata: { preset: {}, originData: (modalContext.data as UmbBlockCatalogueModalData).originData },\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.onSubmit(() => {\r\n\t\t\t\t\t\t// When workspace is submitted, we want to close this modal.\r\n\t\t\t\t\t\tthis.modalContext?.submit();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\t\t\tthis._workspacePath = routeBuilder({});\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_BLOCK_MANAGER_CONTEXT, (manager) => {\r\n\t\t\tthis._manager = manager;\r\n\t\t});\r\n\r\n\t\tthis.observe(this.#itemManager.items, async (items) => {\r\n\t\t\tthis.#observeBlockTypes(items);\r\n\t\t});\r\n\t}\r\n\r\n\toverride connectedCallback() {\r\n\t\tsuper.connectedCallback();\r\n\t\tif (!this.data) return;\r\n\r\n\t\tthis._openClipboard = this.data.openClipboard ?? false;\r\n\r\n\t\tthis.#itemManager.setUniques(this.data.blocks.map((block) => block.contentElementTypeKey));\r\n\t}\r\n\r\n\t#observeBlockTypes(items: Array<UmbDocumentTypeItemModel> | undefined) {\r\n\t\tif (!items?.length) return;\r\n\r\n\t\tconst lookup = items.reduce(\r\n\t\t\t(acc, item) => {\r\n\t\t\t\tacc[item.unique] = item;\r\n\t\t\t\treturn acc;\r\n\t\t\t},\r\n\t\t\t{} as { [key: string]: UmbDocumentTypeItemModel },\r\n\t\t);\r\n\r\n\t\tconst blocks: Array<UmbBlockTypeItemWithGroupKey> =\r\n\t\t\tthis.data?.blocks?.map((block) => ({ ...(lookup[block.contentElementTypeKey] ?? {}), ...block })) ?? [];\r\n\r\n\t\tconst blockGroups: Array<UmbBlockTypeGroup> = this.data?.blockGroups ?? [];\r\n\r\n\t\tconst noGroupBlocks = blocks.filter((block) => !blockGroups.find((group) => group.key === block.groupKey));\r\n\r\n\t\tconst grouped = blockGroups.map((group) => ({\r\n\t\t\tname: group.name,\r\n\t\t\tblocks: blocks.filter((block) => block.groupKey === group.key),\r\n\t\t}));\r\n\r\n\t\tthis._groupedBlocks = [{ blocks: noGroupBlocks }, ...grouped];\r\n\r\n\t\tthis.#updateFiltered();\r\n\r\n\t\tthis._loading = false;\r\n\t}\r\n\r\n\t#updateFiltered() {\r\n\t\tif (this.#search.length === 0) {\r\n\t\t\tthis._filtered = this._groupedBlocks;\r\n\t\t} else {\r\n\t\t\tconst search = this.#search.toLowerCase();\r\n\t\t\tthis._filtered = this._groupedBlocks.map((group) => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...group,\r\n\t\t\t\t\tblocks: group.blocks.filter(\r\n\t\t\t\t\t\t(block) =>\r\n\t\t\t\t\t\t\tblock.label?.toLowerCase().includes(search) ||\r\n\t\t\t\t\t\t\tblock.name?.toLowerCase().includes(search) ||\r\n\t\t\t\t\t\t\tblock.description?.toLowerCase().includes(search),\r\n\t\t\t\t\t),\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t#onSearch(e: UUIInputEvent) {\r\n\t\tthis.#search = e.target.value as string;\r\n\t\tthis.#updateFiltered();\r\n\t}\r\n\r\n\t#chooseBlock(contentElementTypeKey: string) {\r\n\t\tthis.value = {\r\n\t\t\tcreate: {\r\n\t\t\t\tcontentElementTypeKey,\r\n\t\t\t},\r\n\t\t};\r\n\t\tthis.modalContext?.submit();\r\n\t}\r\n\r\n\tasync #onClipboardPickerSelectionChange(event: UmbSelectionChangeEvent) {\r\n\t\tconst target = event.target as any;\r\n\t\tconst selection = target?.selection || [];\r\n\t\tthis.value = {\r\n\t\t\tclipboard: {\r\n\t\t\t\tselection,\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=${this.localize.term('blockEditor_addBlock')}>\r\n\t\t\t\t${this.#renderViews()}${this.#renderMain()}\r\n\t\t\t\t<div slot=\"actions\">\r\n\t\t\t\t\t<uui-button label=${this.localize.term('general_close')} @click=${this._rejectModal}></uui-button>\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=${this.localize.term('general_submit')}\r\n\t\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t\t@click=${this._submitModal}></uui-button>\r\n\t\t\t\t</div>\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderMain() {\r\n\t\treturn this._manager ? (this._openClipboard ? this.#renderClipboard() : this.#renderCreateEmpty()) : nothing;\r\n\t}\r\n\r\n\t#renderClipboard() {\r\n\t\treturn html`\r\n\t\t\t<uui-box>\r\n\t\t\t\t<umb-clipboard-entry-picker\r\n\t\t\t\t\t.config=${{ multiple: true, asyncFilter: this.data?.clipboardFilter }}\r\n\t\t\t\t\t@selection-change=${this.#onClipboardPickerSelectionChange}></umb-clipboard-entry-picker>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderCreateEmpty() {\r\n\t\tif (this._loading) return html`<div id=\"loader\"><uui-loader></uui-loader></div>`;\r\n\t\treturn html`\r\n\t\t\t${when(\r\n\t\t\t\tthis.data?.blocks && this.data?.blocks.length > 8,\r\n\t\t\t\t() => html`\r\n\t\t\t\t\t<uui-input\r\n\t\t\t\t\t\tid=\"search\"\r\n\t\t\t\t\t\t@input=${this.#onSearch}\r\n\t\t\t\t\t\tlabel=${this.localize.term('general_search')}\r\n\t\t\t\t\t\tplaceholder=${this.localize.term('placeholders_search')}>\r\n\t\t\t\t\t\t<uui-icon name=\"icon-search\" slot=\"prepend\"></uui-icon>\r\n\t\t\t\t\t</uui-input>\r\n\t\t\t\t`,\r\n\t\t\t)}\r\n\t\t\t${repeat(\r\n\t\t\t\tthis._filtered,\r\n\t\t\t\t(group) => group.name,\r\n\t\t\t\t(group) => html`\r\n\t\t\t\t\t${when(group.name && group.blocks.length !== 0 && group.name !== '', () => html`<h4>${group.name}</h4>`)}\r\n\t\t\t\t\t<div class=\"blockGroup\">\r\n\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\tgroup.blocks,\r\n\t\t\t\t\t\t\t(block) => block.contentElementTypeKey,\r\n\t\t\t\t\t\t\t(block) => this.#renderBlockTypeCard(block),\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`,\r\n\t\t\t)}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderBlockTypeCard(block: UmbBlockTypeItemWithGroupKey) {\r\n\t\tconst href =\r\n\t\t\tthis._workspacePath && this._manager!.getContentTypeHasProperties(block.contentElementTypeKey)\r\n\t\t\t\t? `${this._workspacePath}create/${block.contentElementTypeKey}`\r\n\t\t\t\t: undefined;\r\n\r\n\t\tconst path = block.thumbnail ? transformServerPathToClientPath(block.thumbnail) : undefined;\r\n\t\tconst imgSrc = path ? new URL(path, this.#serverUrl)?.href : undefined;\r\n\r\n\t\treturn html`\r\n\t\t\t<uui-card-block-type\r\n\t\t\t\thref=${ifDefined(href)}\r\n\t\t\t\tname=${this.localize.string(block.name)}\r\n\t\t\t\tdescription=${this.localize.string(block.description)}\r\n\t\t\t\t.background=${block.backgroundColor}\r\n\t\t\t\t@open=${() => this.#chooseBlock(block.contentElementTypeKey)}>\r\n\t\t\t\t${when(\r\n\t\t\t\t\timgSrc,\r\n\t\t\t\t\t(src) => html`<img src=${src} alt=\"\" />`,\r\n\t\t\t\t\t() => html`<umb-icon name=${block.icon ?? ''} color=${ifDefined(block.iconColor)}></umb-icon>`,\r\n\t\t\t\t)}\r\n\t\t\t\t<slot name=\"actions\" slot=\"actions\"> </slot>\r\n\t\t\t</uui-card-block-type>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderViews() {\r\n\t\treturn html`\r\n\t\t\t<uui-tab-group slot=\"navigation\">\r\n\t\t\t\t<uui-tab\r\n\t\t\t\t\tlabel=${this.localize.term('blockEditor_tabCreateEmpty')}\r\n\t\t\t\t\t?active=${!this._openClipboard}\r\n\t\t\t\t\t@click=${() => (this._openClipboard = false)}>\r\n\t\t\t\t\t<umb-localize key=${this.localize.term('blockEditor_tabCreateEmpty')}>Create Empty</umb-localize>\r\n\t\t\t\t\t<uui-icon slot=\"icon\" name=\"icon-add\"></uui-icon>\r\n\t\t\t\t</uui-tab>\r\n\t\t\t\t<uui-tab\r\n\t\t\t\t\tlabel=${this.localize.term('blockEditor_tabClipboard')}\r\n\t\t\t\t\t?active=${this._openClipboard}\r\n\t\t\t\t\t@click=${() => (this._openClipboard = true)}>\r\n\t\t\t\t\t<umb-localize key=${this.localize.term('blockEditor_tabClipboard')}>Clipboard</umb-localize>\r\n\t\t\t\t\t<uui-icon slot=\"icon\" name=\"icon-clipboard\"></uui-icon>\r\n\t\t\t\t</uui-tab>\r\n\t\t\t</uui-tab-group>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#loader {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t}\r\n\r\n\t\t\t#search {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmargin-bottom: var(--uui-size-layout-1);\r\n\r\n\t\t\t\t> uui-icon {\r\n\t\t\t\t\tpadding-left: var(--uui-size-space-3);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.blockGroup {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: 1rem;\r\n\t\t\t\tgrid-template-columns: repeat(auto-fill, minmax(min(var(--umb-card-medium-min-width), 100%), 1fr));\r\n\t\t\t}\r\n\r\n\t\t\tuui-tab-group {\r\n\t\t\t\t--uui-tab-divider: var(--uui-color-border);\r\n\t\t\t\tborder-left: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-right: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbBlockCatalogueModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-block-catalogue-modal': UmbBlockCatalogueModalElement;\r\n\t}\r\n}\r\n"],"names":["_itemManager","_search","_serverUrl","_UmbBlockCatalogueModalElement_instances","observeBlockTypes_fn","updateFiltered_fn","onSearch_fn","chooseBlock_fn","onClipboardPickerSelectionChange_fn","renderMain_fn","renderClipboard_fn","renderCreateEmpty_fn","renderBlockTypeCard_fn","renderViews_fn","UmbBlockCatalogueModalElement","UmbModalBaseElement","__privateAdd","UmbRepositoryItemsManager","UMB_DOCUMENT_TYPE_ITEM_REPOSITORY_ALIAS","UMB_SERVER_CONTEXT","instance","__privateSet","UMB_MODAL_CONTEXT","modalContext","UmbModalRouteRegistrationController","UMB_BLOCK_WORKSPACE_MODAL","routeBuilder","UMB_BLOCK_MANAGER_CONTEXT","manager","__privateGet","items","__privateMethod","block","html","lookup","acc","item","blocks","blockGroups","noGroupBlocks","group","grouped","search","e","contentElementTypeKey","event","selection","nothing","when","repeat","href","path","transformServerPathToClientPath","imgSrc","ifDefined","src","css","__decorateClass","state","customElement","UmbBlockCatalogueModalElement$1"],"mappings":"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"}