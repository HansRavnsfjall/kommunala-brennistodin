{"version":3,"file":"property-editor-ui-block-list.element-z8jC0iNy.js","sources":["../../../src/packages/block/block-list/context/block-list-manager.context.ts","../../../src/packages/block/block-list/context/block-list-entries.context.ts","../../../src/packages/block/block-list/context/block-list-entry.context.ts","../../../src/packages/block/block-list/components/ref-list-block/ref-list-block.element.ts","../../../src/packages/block/block/workspace/views/edit/block-workspace-view-edit-content-no-router.element.ts","../../../src/packages/block/block-list/components/inline-list-block/inline-list-block.element.ts","../../../src/packages/block/block-list/components/unsupported-list-block/unsupported-list-block.element.ts","../../../src/packages/block/block-list/components/block-list-entry/block-list-entry.element.ts","../../../src/packages/block/block-list/property-editors/block-list-editor/property-editor-ui-block-list.element.ts"],"sourcesContent":["import type { UmbBlockListLayoutModel, UmbBlockListTypeModel } from '../types.js';\r\nimport type { UmbBlockListWorkspaceOriginData } from '../index.js';\r\nimport type { UmbBlockDataModel } from '../../block/types.js';\r\nimport { UmbBooleanState } from '@umbraco-cms/backoffice/observable-api';\r\nimport { UmbBlockManagerContext } from '@umbraco-cms/backoffice/block';\r\n\r\n/**\r\n * A implementation of the Block Manager specifically for the Block List Editor.\r\n */\r\nexport class UmbBlockListManagerContext<\r\n\tBlockLayoutType extends UmbBlockListLayoutModel = UmbBlockListLayoutModel,\r\n> extends UmbBlockManagerContext<UmbBlockListTypeModel, BlockLayoutType, UmbBlockListWorkspaceOriginData> {\r\n\t//\r\n\t#inlineEditingMode = new UmbBooleanState(undefined);\r\n\treadonly inlineEditingMode = this.#inlineEditingMode.asObservable();\r\n\r\n\tsetInlineEditingMode(inlineEditingMode: boolean | undefined) {\r\n\t\tthis.#inlineEditingMode.setValue(inlineEditingMode ?? false);\r\n\t}\r\n\tgetInlineEditingMode(): boolean | undefined {\r\n\t\treturn this.#inlineEditingMode.getValue();\r\n\t}\r\n\r\n\t/**\r\n\t * @param contentElementTypeKey\r\n\t * @param partialLayoutEntry\r\n\t * @param _originData\r\n\t * @deprecated Use createWithPresets instead. Will be removed in v.17.\r\n\t */\r\n\tcreate(\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tcontentElementTypeKey: string,\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tpartialLayoutEntry?: Omit<BlockLayoutType, 'contentKey'>,\r\n\t\t// This property is used by some implementations, but not used in this. Do not remove. [NL]\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\t_originData?: UmbBlockListWorkspaceOriginData,\r\n\t): never {\r\n\t\tthrow new Error('Method deparecated use createWithPresets');\r\n\t}\r\n\tasync createWithPresets(\r\n\t\tcontentElementTypeKey: string,\r\n\t\tpartialLayoutEntry?: Omit<BlockLayoutType, 'contentKey'>,\r\n\t\t// This property is used by some implementations, but not used in this. Do not remove. [NL]\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\t_originData?: UmbBlockListWorkspaceOriginData,\r\n\t) {\r\n\t\treturn await super._createBlockData(contentElementTypeKey, partialLayoutEntry);\r\n\t}\r\n\r\n\tinsert(\r\n\t\tlayoutEntry: BlockLayoutType,\r\n\t\tcontent: UmbBlockDataModel,\r\n\t\tsettings: UmbBlockDataModel | undefined,\r\n\t\toriginData: UmbBlockListWorkspaceOriginData,\r\n\t) {\r\n\t\tthis._layouts.appendOneAt(layoutEntry, originData.index ?? -1);\r\n\r\n\t\tthis.insertBlockData(layoutEntry, content, settings, originData);\r\n\r\n\t\treturn true;\r\n\t}\r\n}\r\n","import type { UmbBlockDataModel } from '../../block/index.js';\r\nimport { UMB_BLOCK_CATALOGUE_MODAL, UmbBlockEntriesContext } from '../../block/index.js';\r\nimport type { UmbBlockListWorkspaceOriginData } from '../index.js';\r\nimport {\r\n\tUMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS,\r\n\tUMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS,\r\n\tUMB_BLOCK_LIST_WORKSPACE_MODAL,\r\n} from '../index.js';\r\nimport type { UmbBlockListLayoutModel, UmbBlockListTypeModel, UmbBlockListValueModel } from '../types.js';\r\nimport { UMB_BLOCK_LIST_MANAGER_CONTEXT } from './block-list-manager.context-token.js';\r\nimport { UmbBooleanState } from '@umbraco-cms/backoffice/observable-api';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UmbModalRouteRegistrationController } from '@umbraco-cms/backoffice/router';\r\nimport {\r\n\tUMB_CLIPBOARD_PROPERTY_CONTEXT,\r\n\tUmbClipboardPastePropertyValueTranslatorValueResolver,\r\n} from '@umbraco-cms/backoffice/clipboard';\r\nimport { UMB_PROPERTY_CONTEXT } from '@umbraco-cms/backoffice/property';\r\n\r\nexport class UmbBlockListEntriesContext extends UmbBlockEntriesContext<\r\n\ttypeof UMB_BLOCK_LIST_MANAGER_CONTEXT,\r\n\ttypeof UMB_BLOCK_LIST_MANAGER_CONTEXT.TYPE,\r\n\tUmbBlockListTypeModel,\r\n\tUmbBlockListLayoutModel,\r\n\tUmbBlockListWorkspaceOriginData\r\n> {\r\n\t//\r\n\r\n\t// We will just say its always allowed for list for now: [NL]\r\n\tpublic readonly canCreate = new UmbBooleanState(true).asObservable();\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_BLOCK_LIST_MANAGER_CONTEXT);\r\n\r\n\t\tnew UmbModalRouteRegistrationController(this, UMB_BLOCK_CATALOGUE_MODAL)\r\n\t\t\t.addAdditionalPath('_catalogue/:view/:index')\r\n\t\t\t.onSetup(async (routingInfo) => {\r\n\t\t\t\tawait this._retrieveManager;\r\n\t\t\t\tif (!this._manager) return false;\r\n\t\t\t\tconst index = routingInfo.index ? parseInt(routingInfo.index) : -1;\r\n\t\t\t\tconst clipboardContext = await this.getContext(UMB_CLIPBOARD_PROPERTY_CONTEXT);\r\n\t\t\t\tif (!clipboardContext) {\r\n\t\t\t\t\tthrow new Error('Clipboard context not found');\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst pasteTranslatorManifests = clipboardContext.getPasteTranslatorManifests(\r\n\t\t\t\t\tUMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS,\r\n\t\t\t\t);\r\n\r\n\t\t\t\t// TODO: consider moving some of this logic to the clipboard property context\r\n\t\t\t\tconst propertyContext = await this.getContext(UMB_PROPERTY_CONTEXT);\r\n\t\t\t\tif (!propertyContext) {\r\n\t\t\t\t\tthrow new Error('Property context not found');\r\n\t\t\t\t}\r\n\t\t\t\tconst config = propertyContext.getConfig();\r\n\t\t\t\tconst valueResolver = new UmbClipboardPastePropertyValueTranslatorValueResolver(this);\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tblocks: this._manager?.getBlockTypes() ?? [],\r\n\t\t\t\t\t\tblockGroups: [],\r\n\t\t\t\t\t\topenClipboard: routingInfo.view === 'clipboard',\r\n\t\t\t\t\t\tclipboardFilter: async (clipboardEntryDetail) => {\r\n\t\t\t\t\t\t\tconst hasSupportedPasteTranslator = clipboardContext.hasSupportedPasteTranslator(\r\n\t\t\t\t\t\t\t\tpasteTranslatorManifests,\r\n\t\t\t\t\t\t\t\tclipboardEntryDetail.values,\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (!hasSupportedPasteTranslator) {\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconst pasteTranslator = await valueResolver.getPasteTranslator(\r\n\t\t\t\t\t\t\t\tclipboardEntryDetail.values,\r\n\t\t\t\t\t\t\t\tUMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS,\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (pasteTranslator.isCompatibleValue) {\r\n\t\t\t\t\t\t\t\tconst value = await valueResolver.resolve(\r\n\t\t\t\t\t\t\t\t\tclipboardEntryDetail.values,\r\n\t\t\t\t\t\t\t\t\tUMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS,\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\treturn pasteTranslator.isCompatibleValue(value, config);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\toriginData: { index: index },\r\n\t\t\t\t\t\tcreateBlockInWorkspace: this._manager.getInlineEditingMode() === false,\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t})\r\n\t\t\t.onSubmit(async (value, data) => {\r\n\t\t\t\tif (value?.create && data) {\r\n\t\t\t\t\tconst created = await this.create(\r\n\t\t\t\t\t\tvalue.create.contentElementTypeKey,\r\n\t\t\t\t\t\t{},\r\n\t\t\t\t\t\tdata.originData as UmbBlockListWorkspaceOriginData,\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (created) {\r\n\t\t\t\t\t\tthis.insert(\r\n\t\t\t\t\t\t\tcreated.layout,\r\n\t\t\t\t\t\t\tcreated.content,\r\n\t\t\t\t\t\t\tcreated.settings,\r\n\t\t\t\t\t\t\tdata.originData as UmbBlockListWorkspaceOriginData,\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error('Failed to create block');\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (value?.clipboard && value.clipboard.selection?.length && data) {\r\n\t\t\t\t\tconst clipboardContext = await this.getContext(UMB_CLIPBOARD_PROPERTY_CONTEXT);\r\n\t\t\t\t\tif (!clipboardContext) {\r\n\t\t\t\t\t\tthrow new Error('Clipboard context not found');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst propertyValues = await clipboardContext.readMultiple<UmbBlockListValueModel>(\r\n\t\t\t\t\t\tvalue.clipboard.selection,\r\n\t\t\t\t\t\tUMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS,\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis._insertFromPropertyValues(propertyValues, data.originData as UmbBlockListWorkspaceOriginData);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis._catalogueRouteBuilderState.setValue(routeBuilder);\r\n\t\t\t});\r\n\r\n\t\tnew UmbModalRouteRegistrationController(this, UMB_BLOCK_LIST_WORKSPACE_MODAL)\r\n\t\t\t.addAdditionalPath('block')\r\n\t\t\t.onSetup(() => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdata: { entityType: 'block', preset: {}, baseDataPath: this._dataPath },\r\n\t\t\t\t\tmodal: { size: 'medium' },\r\n\t\t\t\t};\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tconst newPath = routeBuilder({});\r\n\t\t\t\tthis._workspacePath.setValue(newPath);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprotected _gotBlockManager() {\r\n\t\tif (!this._manager) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis._manager.layouts,\r\n\t\t\t(layouts) => {\r\n\t\t\t\tthis._layoutEntries.setValue(layouts);\r\n\t\t\t},\r\n\t\t\t'observeParentLayouts',\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.layoutEntries,\r\n\t\t\t(layouts) => {\r\n\t\t\t\tthis._manager?.setLayouts(layouts);\r\n\t\t\t},\r\n\t\t\t'observeThisLayouts',\r\n\t\t);\r\n\t}\r\n\r\n\tgetPathForCreateBlock(index: number) {\r\n\t\treturn this._catalogueRouteBuilderState.getValue()?.({ view: 'create', index: index });\r\n\t}\r\n\r\n\tgetPathForClipboard(index: number) {\r\n\t\treturn this._catalogueRouteBuilderState.getValue()?.({ view: 'clipboard', index: index });\r\n\t}\r\n\r\n\toverride async setLayouts(layouts: Array<UmbBlockListLayoutModel>) {\r\n\t\tawait this._retrieveManager;\r\n\t\tthis._manager?.setLayouts(layouts);\r\n\t}\r\n\r\n\tasync create(\r\n\t\tcontentElementTypeKey: string,\r\n\t\tpartialLayoutEntry?: Omit<UmbBlockListLayoutModel, 'contentKey'>,\r\n\t\toriginData?: UmbBlockListWorkspaceOriginData,\r\n\t) {\r\n\t\tawait this._retrieveManager;\r\n\t\treturn await this._manager?.createWithPresets(contentElementTypeKey, partialLayoutEntry, originData);\r\n\t}\r\n\r\n\t// insert Block?\r\n\r\n\tasync insert(\r\n\t\tlayoutEntry: UmbBlockListLayoutModel,\r\n\t\tcontent: UmbBlockDataModel,\r\n\t\tsettings: UmbBlockDataModel | undefined,\r\n\t\toriginData: UmbBlockListWorkspaceOriginData,\r\n\t) {\r\n\t\tawait this._retrieveManager;\r\n\r\n\t\treturn this._manager?.insert(layoutEntry, content, settings, originData) ?? false;\r\n\t}\r\n\r\n\tprotected async _insertFromPropertyValue(value: UmbBlockListValueModel, originData: UmbBlockListWorkspaceOriginData) {\r\n\t\tconst layoutEntries = value.layout[UMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS];\r\n\r\n\t\tif (!layoutEntries) {\r\n\t\t\tthrow new Error('No layout entries found');\r\n\t\t}\r\n\r\n\t\tawait Promise.all(\r\n\t\t\tlayoutEntries.map(async (layoutEntry) => {\r\n\t\t\t\tthis._insertBlockFromPropertyValue(layoutEntry, value, originData);\r\n\t\t\t\tif (originData.index !== -1) {\r\n\t\t\t\t\toriginData = { ...originData, index: originData.index + 1 };\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t);\r\n\r\n\t\treturn originData;\r\n\t}\r\n}\r\n","import { UMB_BLOCK_LIST_MANAGER_CONTEXT } from './block-list-manager.context-token.js';\r\nimport { UMB_BLOCK_LIST_ENTRIES_CONTEXT } from './block-list-entries.context-token.js';\r\nimport { UmbBlockEntryContext } from '@umbraco-cms/backoffice/block';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UmbBooleanState, mergeObservables } from '@umbraco-cms/backoffice/observable-api';\r\nexport class UmbBlockListEntryContext extends UmbBlockEntryContext<\r\n\ttypeof UMB_BLOCK_LIST_MANAGER_CONTEXT,\r\n\ttypeof UMB_BLOCK_LIST_MANAGER_CONTEXT.TYPE,\r\n\ttypeof UMB_BLOCK_LIST_ENTRIES_CONTEXT,\r\n\ttypeof UMB_BLOCK_LIST_ENTRIES_CONTEXT.TYPE\r\n> {\r\n\t#inlineEditingMode = new UmbBooleanState(undefined);\r\n\treadonly inlineEditingMode = this.#inlineEditingMode.asObservable();\r\n\treadonly forceHideContentEditorInOverlay = this._blockType.asObservablePart((x) =>\r\n\t\tx ? (x.forceHideContentEditorInOverlay ?? false) : undefined,\r\n\t);\r\n\r\n\treadonly showContentEdit = mergeObservables(\r\n\t\t[this._contentStructureHasProperties, this.forceHideContentEditorInOverlay, this.inlineEditingMode],\r\n\t\t([a, b, c]): boolean => {\r\n\t\t\treturn a === true && b === false && c === false;\r\n\t\t},\r\n\t);\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_BLOCK_LIST_MANAGER_CONTEXT, UMB_BLOCK_LIST_ENTRIES_CONTEXT);\r\n\t}\r\n\r\n\tprotected override _gotManager() {\r\n\t\tthis.observe(\r\n\t\t\tthis._manager?.inlineEditingMode,\r\n\t\t\t(inlineEditingMode) => {\r\n\t\t\t\tthis.#inlineEditingMode.setValue(inlineEditingMode);\r\n\t\t\t},\r\n\t\t\t'observeInlineEditingMode',\r\n\t\t);\r\n\t}\r\n\r\n\tprotected override _gotEntries() {}\r\n\r\n\tprotected override _gotContentType() {}\r\n}\r\n","import { css, customElement, html, property, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbBlockDataType } from '@umbraco-cms/backoffice/block';\r\n\r\nimport '@umbraco-cms/backoffice/ufm';\r\nimport type { UmbBlockEditorCustomViewConfiguration } from '@umbraco-cms/backoffice/block-custom-view';\r\n\r\n@customElement('umb-ref-list-block')\r\nexport class UmbRefListBlockElement extends UmbLitElement {\r\n\t//\r\n\t@property({ type: String, reflect: false })\r\n\tlabel?: string;\r\n\r\n\t@property({ type: String, reflect: false })\r\n\ticon?: string;\r\n\r\n\t@property({ type: Number, attribute: false })\r\n\tindex?: number;\r\n\r\n\t@property({ type: Boolean, reflect: true })\r\n\tunpublished?: boolean;\r\n\r\n\t@property({ attribute: false })\r\n\tcontent?: UmbBlockDataType;\r\n\r\n\t@property({ attribute: false })\r\n\tsettings?: UmbBlockDataType;\r\n\r\n\t@property({ attribute: false })\r\n\tconfig?: UmbBlockEditorCustomViewConfiguration;\r\n\r\n\toverride render() {\r\n\t\tconst blockValue = { ...this.content, $settings: this.settings, $index: this.index };\r\n\t\treturn html`\r\n\t\t\t<uui-ref-node standalone href=${(this.config?.showContentEdit ? this.config?.editContentPath : undefined) ?? ''}>\r\n\t\t\t\t<umb-icon slot=\"icon\" .name=${this.icon}></umb-icon>\r\n\t\t\t\t<umb-ufm-render slot=\"name\" inline .markdown=${this.label} .value=${blockValue}></umb-ufm-render>\r\n\t\t\t\t${when(\r\n\t\t\t\t\tthis.unpublished,\r\n\t\t\t\t\t() =>\r\n\t\t\t\t\t\thtml`<uui-tag slot=\"name\" look=\"secondary\" title=${this.localize.term('blockEditor_notExposedDescription')}\r\n\t\t\t\t\t\t\t><umb-localize key=\"blockEditor_notExposedLabel\"></umb-localize\r\n\t\t\t\t\t\t></uui-tag>`,\r\n\t\t\t\t)}\r\n\t\t\t</uui-ref-node>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\tuui-ref-node {\r\n\t\t\t\tmin-height: var(--uui-size-16);\r\n\t\t\t}\r\n\t\t\tuui-tag {\r\n\t\t\t\tmargin-left: 0.5em;\r\n\t\t\t\tmargin-bottom: -0.3em;\r\n\t\t\t\tmargin-top: -0.3em;\r\n\t\t\t\tvertical-align: text-top;\r\n\t\t\t}\r\n\t\t\t:host([unpublished]) umb-icon,\r\n\t\t\t:host([unpublished]) umb-ufm-render {\r\n\t\t\t\topacity: 0.6;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbRefListBlockElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-ref-list-block': UmbRefListBlockElement;\r\n\t}\r\n}\r\n","import { UMB_BLOCK_WORKSPACE_CONTEXT } from '../../block-workspace.context-token.js';\r\nimport './block-workspace-view-edit-tab.element.js';\r\nimport { css, html, customElement, state, repeat, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbContentTypeContainerStructureHelper } from '@umbraco-cms/backoffice/content-type';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbPropertyTypeContainerMergedModel } from '@umbraco-cms/backoffice/content-type';\r\nimport type { UmbWorkspaceViewElement } from '@umbraco-cms/backoffice/workspace';\r\n\r\n/**\r\n * @element umb-block-workspace-view-edit-content-no-router\r\n * @description\r\n * A specific view for editing content in a block workspace placed inline within a block view/element.\r\n */\r\n@customElement('umb-block-workspace-view-edit-content-no-router')\r\nexport class UmbBlockWorkspaceViewEditContentNoRouterElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t// private _hasRootProperties = false;\r\n\r\n\t@state()\r\n\tprivate _hasRootGroups = false;\r\n\r\n\t@state()\r\n\tprivate _tabs?: Array<UmbPropertyTypeContainerMergedModel>;\r\n\r\n\t@state()\r\n\tprivate _activeTabKey?: string | null | undefined;\r\n\r\n\t#blockWorkspace?: typeof UMB_BLOCK_WORKSPACE_CONTEXT.TYPE;\r\n\t#tabsStructureHelper = new UmbContentTypeContainerStructureHelper(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.#tabsStructureHelper.setIsRoot(true);\r\n\t\tthis.#tabsStructureHelper.setContainerChildType('Tab');\r\n\t\tthis.observe(this.#tabsStructureHelper.childContainers, (tabs) => {\r\n\t\t\tthis._tabs = tabs;\r\n\t\t\tthis.#checkDefaultTabName();\r\n\t\t});\r\n\r\n\t\t// _hasRootProperties can be gotten via _tabsStructureHelper.hasProperties. But we do not support root properties currently.\r\n\r\n\t\tthis.consumeContext(UMB_BLOCK_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis.#blockWorkspace = context;\r\n\t\t\tthis.#tabsStructureHelper.setStructureManager(context?.content.structure);\r\n\r\n\t\t\tthis.#observeRootGroups();\r\n\t\t});\r\n\t}\r\n\r\n\tasync #observeRootGroups() {\r\n\t\tif (!this.#blockWorkspace) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tawait this.#blockWorkspace.content.structure.hasRootContainers('Group'),\r\n\t\t\t(hasRootGroups) => {\r\n\t\t\t\tthis._hasRootGroups = hasRootGroups;\r\n\t\t\t\tthis.#checkDefaultTabName();\r\n\t\t\t},\r\n\t\t\t'observeGroups',\r\n\t\t);\r\n\t}\r\n\r\n\t#checkDefaultTabName() {\r\n\t\tif (!this._tabs || !this.#blockWorkspace) return;\r\n\r\n\t\t// Find the default tab to grab\r\n\t\tif (this._activeTabKey === undefined) {\r\n\t\t\tif (this._hasRootGroups) {\r\n\t\t\t\tthis._activeTabKey = null;\r\n\t\t\t} else if (this._tabs.length > 0) {\r\n\t\t\t\tconst tab = this._tabs[0];\r\n\t\t\t\tthis._activeTabKey = tab.ownerId ?? tab.ids[0];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t#setTabKey(tabKey: string | null | undefined) {\r\n\t\tthis._activeTabKey = tabKey;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this._tabs) return;\r\n\r\n\t\treturn html`\r\n\t\t\t${this._tabs.length > 1 || (this._tabs.length === 1 && this._hasRootGroups)\r\n\t\t\t\t? html`<uui-tab-group slot=\"header\">\r\n\t\t\t\t\t\t${this._hasRootGroups && this._tabs.length > 0\r\n\t\t\t\t\t\t\t? html`<uui-tab\r\n\t\t\t\t\t\t\t\t\tlabel=${this.localize.term('general_generic')}\r\n\t\t\t\t\t\t\t\t\t.active=${this._activeTabKey === null}\r\n\t\t\t\t\t\t\t\t\t@click=${() => this.#setTabKey(null)}\r\n\t\t\t\t\t\t\t\t\t>Content</uui-tab\r\n\t\t\t\t\t\t\t\t>`\r\n\t\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\tthis._tabs,\r\n\t\t\t\t\t\t\t(tab) => tab.name,\r\n\t\t\t\t\t\t\t(tab) => {\r\n\t\t\t\t\t\t\t\tconst tabKey = tab.ownerId ?? tab.ids[0];\r\n\r\n\t\t\t\t\t\t\t\treturn html`<uui-tab\r\n\t\t\t\t\t\t\t\t\tlabel=${this.localize.string(tab.name ?? '#general_unnamed')}\r\n\t\t\t\t\t\t\t\t\t.active=${this._activeTabKey === tabKey}\r\n\t\t\t\t\t\t\t\t\t@click=${() => this.#setTabKey(tabKey)}\r\n\t\t\t\t\t\t\t\t\t>${tab.name}</uui-tab\r\n\t\t\t\t\t\t\t\t>`;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</uui-tab-group>`\r\n\t\t\t\t: nothing}\r\n\t\t\t${this._activeTabKey !== undefined\r\n\t\t\t\t? html`<umb-block-workspace-view-edit-tab\r\n\t\t\t\t\t\t.managerName=${'content'}\r\n\t\t\t\t\t\t.hideSingleGroup=${true}\r\n\t\t\t\t\t\t.containerId=${this._activeTabKey}>\r\n\t\t\t\t\t</umb-block-workspace-view-edit-tab>`\r\n\t\t\t\t: nothing}\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\t--uui-tab-background: var(--uui-color-surface);\r\n\r\n\t\t\t\tpadding: calc(var(--uui-size-layout-1));\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbBlockWorkspaceViewEditContentNoRouterElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-block-workspace-view-edit-content-no-router': UmbBlockWorkspaceViewEditContentNoRouterElement;\r\n\t}\r\n}\r\n","import { UMB_BLOCK_LIST_ENTRY_CONTEXT } from '../../context/index.js';\r\nimport { UMB_BLOCK_WORKSPACE_ALIAS } from '@umbraco-cms/backoffice/block';\r\nimport { css, customElement, html, nothing, property, state, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbExtensionApiInitializer, UmbExtensionsApiInitializer } from '@umbraco-cms/backoffice/extension-api';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UmbLanguageItemRepository } from '@umbraco-cms/backoffice/language';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { UmbApiConstructorArgumentsMethodType } from '@umbraco-cms/backoffice/extension-api';\r\nimport type { UmbBlockDataType, UMB_BLOCK_WORKSPACE_CONTEXT } from '@umbraco-cms/backoffice/block';\r\n\r\nimport '../../../block/workspace/views/edit/block-workspace-view-edit-content-no-router.element.js';\r\n\r\nconst apiArgsCreator: UmbApiConstructorArgumentsMethodType<unknown> = (manifest: unknown) => {\r\n\treturn [{ manifest }];\r\n};\r\n\r\n/**\r\n * @element umb-inline-list-block\r\n */\r\n@customElement('umb-inline-list-block')\r\nexport class UmbInlineListBlockElement extends UmbLitElement {\r\n\t#blockContext?: typeof UMB_BLOCK_LIST_ENTRY_CONTEXT.TYPE;\r\n\t#workspaceContext?: typeof UMB_BLOCK_WORKSPACE_CONTEXT.TYPE;\r\n\t#contentKey?: string;\r\n\r\n\t@property({ type: String, reflect: false })\r\n\tlabel?: string;\r\n\r\n\t@property({ type: String, reflect: false })\r\n\ticon?: string;\r\n\r\n\t@property({ type: Number, attribute: false })\r\n\tindex?: number;\r\n\r\n\t@property({ type: Boolean, reflect: true })\r\n\tunpublished?: boolean;\r\n\r\n\t@property({ attribute: false })\r\n\tcontent?: UmbBlockDataType;\r\n\r\n\t@property({ attribute: false })\r\n\tsettings?: UmbBlockDataType;\r\n\r\n\t@state()\r\n\tprivate _exposed?: boolean;\r\n\r\n\t@state()\r\n\tprivate _isOpen = false;\r\n\r\n\t@state()\r\n\tprivate _ownerContentTypeName?: string;\r\n\r\n\t@state()\r\n\tprivate _variantName?: string;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_BLOCK_LIST_ENTRY_CONTEXT, (blockContext) => {\r\n\t\t\tthis.#blockContext = blockContext;\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#blockContext?.unique,\r\n\t\t\t\t(contentKey) => {\r\n\t\t\t\t\tthis.#contentKey = contentKey;\r\n\t\t\t\t\tthis.#load();\r\n\t\t\t\t},\r\n\t\t\t\t'observeContentKey',\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tnew UmbExtensionApiInitializer(\r\n\t\t\tthis,\r\n\t\t\tumbExtensionsRegistry,\r\n\t\t\tUMB_BLOCK_WORKSPACE_ALIAS,\r\n\t\t\tapiArgsCreator,\r\n\t\t\t(permitted, ctrl) => {\r\n\t\t\t\tconst context = ctrl.api as typeof UMB_BLOCK_WORKSPACE_CONTEXT.TYPE;\r\n\t\t\t\tif (permitted && context) {\r\n\t\t\t\t\tthis.#workspaceContext = context;\r\n\t\t\t\t\tthis.#workspaceContext.establishLiveSync();\r\n\t\t\t\t\tthis.#load();\r\n\r\n\t\t\t\t\tthis.observe(\r\n\t\t\t\t\t\tthis.#workspaceContext.exposed,\r\n\t\t\t\t\t\t(exposed) => {\r\n\t\t\t\t\t\t\tthis._exposed = exposed;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'observeExposed',\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis.observe(\r\n\t\t\t\t\t\tcontext.content.structure.ownerContentTypeName,\r\n\t\t\t\t\t\t(name) => {\r\n\t\t\t\t\t\t\tthis._ownerContentTypeName = name;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'observeContentTypeName',\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tthis.observe(\r\n\t\t\t\t\t\tcontext.variantId,\r\n\t\t\t\t\t\tasync (variantId) => {\r\n\t\t\t\t\t\t\tif (variantId) {\r\n\t\t\t\t\t\t\t\tcontext.content.setup(this, variantId);\r\n\t\t\t\t\t\t\t\t// TODO: Support segment name?\r\n\t\t\t\t\t\t\t\tconst culture = variantId.culture;\r\n\t\t\t\t\t\t\t\tif (culture) {\r\n\t\t\t\t\t\t\t\t\tconst languageRepository = new UmbLanguageItemRepository(this);\r\n\t\t\t\t\t\t\t\t\tconst { data } = await languageRepository.requestItems([culture]);\r\n\t\t\t\t\t\t\t\t\tconst name = data?.[0].name;\r\n\t\t\t\t\t\t\t\t\tthis._variantName = name ? this.localize.string(name) : undefined;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'observeVariant',\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tnew UmbExtensionsApiInitializer(this, umbExtensionsRegistry, 'workspaceContext', [this.#workspaceContext]);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\t#load() {\r\n\t\tif (!this.#workspaceContext || !this.#contentKey) return;\r\n\t\tthis.#workspaceContext.load(this.#contentKey);\r\n\t}\r\n\r\n\t#expose = () => {\r\n\t\tthis.#workspaceContext?.expose();\r\n\t};\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"host\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tid=\"open-part\"\r\n\t\t\t\t\ttabindex=\"0\"\r\n\t\t\t\t\t@keydown=${(e: KeyboardEvent) => {\r\n\t\t\t\t\t\tif (e.key !== ' ' && e.key !== 'Enter') return;\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\t\tthis._isOpen = !this._isOpen;\r\n\t\t\t\t\t}}\r\n\t\t\t\t\t@click=${() => {\r\n\t\t\t\t\t\tthis._isOpen = !this._isOpen;\r\n\t\t\t\t\t}}>\r\n\t\t\t\t\t<uui-symbol-expand .open=${this._isOpen}></uui-symbol-expand>\r\n\t\t\t\t\t${this.#renderBlockInfo()}\r\n\t\t\t\t\t<slot></slot>\r\n\t\t\t\t\t<slot name=\"tag\"></slot>\r\n\t\t\t\t</button>\r\n\t\t\t\t${this._isOpen === true ? this.#renderInside() : nothing}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderBlockInfo() {\r\n\t\tconst blockValue = { ...this.content, $settings: this.settings, $index: this.index };\r\n\t\treturn html`\r\n\t\t\t<span id=\"content\">\r\n\t\t\t\t<span id=\"icon\">\r\n\t\t\t\t\t<umb-icon .name=${this.icon}></umb-icon>\r\n\t\t\t\t</span>\r\n\t\t\t\t<div id=\"info\">\r\n\t\t\t\t\t<umb-ufm-render id=\"name\" inline .markdown=${this.label} .value=${blockValue}></umb-ufm-render>\r\n\t\t\t\t</div>\r\n\t\t\t</span>\r\n\t\t\t${when(\r\n\t\t\t\tthis.unpublished,\r\n\t\t\t\t() =>\r\n\t\t\t\t\thtml`<uui-tag slot=\"name\" look=\"secondary\" title=${this.localize.term('blockEditor_notExposedDescription')}\r\n\t\t\t\t\t\t><umb-localize key=\"blockEditor_notExposedLabel\"></umb-localize\r\n\t\t\t\t\t></uui-tag>`,\r\n\t\t\t)}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderInside() {\r\n\t\tif (this._exposed === false) {\r\n\t\t\treturn html`<uui-button id=\"exposeButton\" draggable=\"false\" @click=${this.#expose}\r\n\t\t\t\t><uui-icon name=\"icon-add\"></uui-icon>\r\n\t\t\t\t<umb-localize\r\n\t\t\t\t\tkey=\"blockEditor_createThisFor\"\r\n\t\t\t\t\t.args=${[this._ownerContentTypeName, this._variantName]}></umb-localize\r\n\t\t\t></uui-button>`;\r\n\t\t} else {\r\n\t\t\treturn html`<umb-block-workspace-view-edit-content-no-router\r\n\t\t\t\tdraggable=\"false\"></umb-block-workspace-view-edit-content-no-router>`;\r\n\t\t}\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t#host {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tbackground-color: var(--uui-color-surface);\r\n\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\ttransition: border-color 80ms;\r\n\r\n\t\t\t\tmin-width: 250px;\r\n\t\t\t}\r\n\r\n\t\t\t#exposeButton {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tmin-height: var(--uui-size-16);\r\n\t\t\t}\r\n\r\n\t\t\t#open-part + * {\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\t\t\t:host([disabled]) #open-part {\r\n\t\t\t\tcursor: default;\r\n\t\t\t\ttransition: border-color 80ms;\r\n\t\t\t}\r\n\t\t\t:host(:not([disabled])) #host:has(#open-part:hover) {\r\n\t\t\t\tborder-color: var(--uui-color-border-emphasis);\r\n\t\t\t}\r\n\t\t\t:host(:not([disabled])) #open-part:hover + * {\r\n\t\t\t\tborder-color: var(--uui-color-border-emphasis);\r\n\t\t\t}\r\n\t\t\t:host([disabled]) #host {\r\n\t\t\t\tborder-color: var(--uui-color-disabled-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t:host([unpublished]) #open-part #content {\r\n\t\t\t\topacity: 0.6;\r\n\t\t\t}\r\n\r\n\t\t\tslot[name='tag'] {\r\n\t\t\t\tflex-grow: 1;\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: flex-end;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\tbutton {\r\n\t\t\t\tfont-size: inherit;\r\n\t\t\t\tfont-family: inherit;\r\n\t\t\t\tborder: 0;\r\n\t\t\t\tpadding: 0;\r\n\t\t\t\tbackground-color: transparent;\r\n\t\t\t\ttext-align: left;\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t#content {\r\n\t\t\t\talign-self: stretch;\r\n\t\t\t\tline-height: normal;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tposition: relative;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t#open-part {\r\n\t\t\t\tcolor: inherit;\r\n\t\t\t\ttext-decoration: none;\r\n\t\t\t\tcursor: pointer;\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\ttext-align: left;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: flex-start;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tborder: none;\r\n\t\t\t\tbackground: none;\r\n\r\n\t\t\t\tmin-height: var(--uui-size-16);\r\n\t\t\t\tpadding: calc(var(--uui-size-2) + 1px);\r\n\t\t\t}\r\n\r\n\t\t\t#icon {\r\n\t\t\t\tfont-size: 1.2em;\r\n\t\t\t\tmargin-left: var(--uui-size-2);\r\n\t\t\t\tmargin-right: var(--uui-size-1);\r\n\t\t\t}\r\n\r\n\t\t\t#info {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: start;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tpadding-left: var(--uui-size-2, 6px);\r\n\t\t\t}\r\n\r\n\t\t\tuui-tag {\r\n\t\t\t\tmargin-left: 0.5em;\r\n\t\t\t\tmargin-bottom: -0.3em;\r\n\t\t\t\tmargin-top: -0.3em;\r\n\t\t\t\tvertical-align: text-top;\r\n\t\t\t}\r\n\r\n\t\t\t:host(:not([disabled])) #open-part:hover #icon {\r\n\t\t\t\tcolor: var(--uui-color-interactive-emphasis);\r\n\t\t\t}\r\n\t\t\t:host(:not([disabled])) #open-part:hover #name {\r\n\t\t\t\tcolor: var(--uui-color-interactive-emphasis);\r\n\t\t\t}\r\n\r\n\t\t\t:host([disabled]) #icon {\r\n\t\t\t\tcolor: var(--uui-color-disabled-contrast);\r\n\t\t\t}\r\n\t\t\t:host([disabled]) #name {\r\n\t\t\t\tcolor: var(--uui-color-disabled-contrast);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbInlineListBlockElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-inline-list-block': UmbInlineListBlockElement;\r\n\t}\r\n}\r\n","import { css, customElement, html } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\n/**\r\n * @element umb-unsupported-list-block\r\n */\r\n@customElement('umb-unsupported-list-block')\r\nexport class UmbUnsupportedListBlockElement extends UmbLitElement {\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"host\">\r\n\t\t\t\t<div id=\"open-part\">\r\n\t\t\t\t\t${this.#renderBlockInfo()}\r\n\t\t\t\t\t<slot></slot>\r\n\t\t\t\t\t<slot name=\"tag\"></slot>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div id=\"inside\" draggable=\"false\">${this.localize.term('blockEditor_unsupportedBlockDescription')}</div>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderBlockInfo() {\r\n\t\treturn html`\r\n\t\t\t<span id=\"content\">\r\n\t\t\t\t<span id=\"icon\">\r\n\t\t\t\t\t<umb-icon name=\"icon-alert\"></umb-icon>\r\n\t\t\t\t</span>\r\n\t\t\t\t<div id=\"info\">\r\n\t\t\t\t\t<span id=\"name\">${this.localize.term('blockEditor_unsupportedBlockName')}</span>\r\n\t\t\t\t</div>\r\n\t\t\t</span>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t#host {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tbackground-color: var(--uui-color-surface);\r\n\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\ttransition: border-color 80ms;\r\n\r\n\t\t\t\tmin-width: 250px;\r\n\t\t\t}\r\n\r\n\t\t\t#open-part + * {\r\n\t\t\t\tborder-top: 1px solid var(--uui-color-border);\r\n\t\t\t}\r\n\t\t\t:host([disabled]) #open-part {\r\n\t\t\t\tcursor: default;\r\n\t\t\t\ttransition: border-color 80ms;\r\n\t\t\t}\r\n\t\t\t:host([disabled]) #host {\r\n\t\t\t\tborder-color: var(--uui-color-disabled-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t:host([unpublished]) #open-part #content {\r\n\t\t\t\topacity: 0.6;\r\n\t\t\t}\r\n\r\n\t\t\tslot[name='tag'] {\r\n\t\t\t\tflex-grow: 1;\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: flex-end;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\tbutton {\r\n\t\t\t\tfont-size: inherit;\r\n\t\t\t\tfont-family: inherit;\r\n\t\t\t\tborder: 0;\r\n\t\t\t\tpadding: 0;\r\n\t\t\t\tbackground-color: transparent;\r\n\t\t\t\ttext-align: left;\r\n\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t}\r\n\r\n\t\t\t#content {\r\n\t\t\t\talign-self: stretch;\r\n\t\t\t\tline-height: normal;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tposition: relative;\r\n\t\t\t\talign-items: center;\r\n\t\t\t}\r\n\r\n\t\t\t#open-part {\r\n\t\t\t\tcolor: inherit;\r\n\t\t\t\ttext-decoration: none;\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\ttext-align: left;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: flex-start;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tborder: none;\r\n\t\t\t\tbackground: none;\r\n\r\n\t\t\t\tmin-height: var(--uui-size-16);\r\n\t\t\t\tpadding: calc(var(--uui-size-2) + 1px);\r\n\t\t\t}\r\n\r\n\t\t\t#icon {\r\n\t\t\t\tfont-size: 1.2em;\r\n\t\t\t\tmargin-left: var(--uui-size-2);\r\n\t\t\t\tmargin-right: var(--uui-size-1);\r\n\t\t\t}\r\n\r\n\t\t\t#info {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: start;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tpadding-left: var(--uui-size-2, 6px);\r\n\t\t\t}\r\n\r\n\t\t\t#name {\r\n\t\t\t\tfont-weight: 700;\r\n\t\t\t}\r\n\r\n\t\t\tuui-tag {\r\n\t\t\t\tmargin-left: 0.5em;\r\n\t\t\t\tmargin-bottom: -0.3em;\r\n\t\t\t\tmargin-top: -0.3em;\r\n\t\t\t\tvertical-align: text-top;\r\n\t\t\t}\r\n\r\n\t\t\t:host([disabled]) #icon {\r\n\t\t\t\tcolor: var(--uui-color-disabled-contrast);\r\n\t\t\t}\r\n\t\t\t:host([disabled]) #name {\r\n\t\t\t\tcolor: var(--uui-color-disabled-contrast);\r\n\t\t\t}\r\n\r\n\t\t\t#inside {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tpadding: calc(var(--uui-size-layout-1));\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbUnsupportedListBlockElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-unsupported-list-block': UmbUnsupportedListBlockElement;\r\n\t}\r\n}\r\n","import { UmbBlockListEntryContext } from '../../context/block-list-entry.context.js';\r\nimport type { UmbBlockListLayoutModel, UmbBlockListValueModel } from '../../types.js';\r\nimport {\r\n\tUMB_BLOCK_LIST,\r\n\tUMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS,\r\n\tUMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS,\r\n} from '../../constants.js';\r\nimport { css, customElement, html, nothing, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement, umbDestroyOnDisconnect } from '@umbraco-cms/backoffice/lit-element';\r\nimport { stringOrStringArrayContains } from '@umbraco-cms/backoffice/utils';\r\nimport { UmbDataPathBlockElementDataQuery } from '@umbraco-cms/backoffice/block';\r\nimport { UmbObserveValidationStateController } from '@umbraco-cms/backoffice/validation';\r\nimport { UUIBlinkAnimationValue, UUIBlinkKeyframes } from '@umbraco-cms/backoffice/external/uui';\r\nimport { UMB_PROPERTY_CONTEXT, UMB_PROPERTY_DATASET_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport { UMB_CLIPBOARD_PROPERTY_CONTEXT } from '@umbraco-cms/backoffice/clipboard';\r\nimport type {\r\n\tManifestBlockEditorCustomView,\r\n\tUmbBlockEditorCustomViewProperties,\r\n} from '@umbraco-cms/backoffice/block-custom-view';\r\nimport type { UmbExtensionElementInitializer } from '@umbraco-cms/backoffice/extension-api';\r\nimport type { UmbPropertyEditorUiElement } from '@umbraco-cms/backoffice/property-editor';\r\n\r\nimport '../ref-list-block/index.js';\r\nimport '../inline-list-block/index.js';\r\nimport '../unsupported-list-block/index.js';\r\n\r\n/**\r\n * @element umb-block-list-entry\r\n */\r\n@customElement('umb-block-list-entry')\r\nexport class UmbBlockListEntryElement extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n\t@property({ type: Number })\r\n\tpublic set index(value: number | undefined) {\r\n\t\tthis.#context.setIndex(value);\r\n\t}\r\n\tpublic get index(): number | undefined {\r\n\t\treturn this.#context.getIndex();\r\n\t}\r\n\r\n\t@property({ attribute: false })\r\n\tpublic set contentKey(value: string | undefined) {\r\n\t\tif (!value) return;\r\n\t\tthis._contentKey = value;\r\n\t\tthis.#context.setContentKey(value);\r\n\r\n\t\tnew UmbObserveValidationStateController(\r\n\t\t\tthis,\r\n\t\t\t`$.contentData[${UmbDataPathBlockElementDataQuery({ key: value })}]`,\r\n\t\t\t(hasMessages) => {\r\n\t\t\t\tthis._contentInvalid = hasMessages;\r\n\t\t\t\tthis._blockViewProps.contentInvalid = hasMessages;\r\n\t\t\t},\r\n\t\t\t'observeMessagesForContent',\r\n\t\t);\r\n\t}\r\n\tpublic get contentKey(): string | undefined {\r\n\t\treturn this._contentKey;\r\n\t}\r\n\tprivate _contentKey?: string | undefined;\r\n\r\n\t#context = new UmbBlockListEntryContext(this);\r\n\r\n\t@state()\r\n\tprivate _contentTypeAlias?: string;\r\n\r\n\t@state()\r\n\tprivate _contentTypeName?: string;\r\n\r\n\t@state()\r\n\tprivate _showContentEdit = false;\r\n\r\n\t@state()\r\n\tprivate _hasSettings = false;\r\n\r\n\t@state()\r\n\tprivate _label = '';\r\n\r\n\t@state()\r\n\tprivate _icon?: string;\r\n\r\n\t@state()\r\n\tprivate _exposed?: boolean;\r\n\r\n\t@state()\r\n\tprivate _unsupported?: boolean;\r\n\r\n\t@state()\r\n\tprivate _showActions?: boolean;\r\n\r\n\t@state()\r\n\tprivate _workspaceEditContentPath?: string;\r\n\r\n\t@state()\r\n\tprivate _workspaceEditSettingsPath?: string;\r\n\r\n\t@state()\r\n\tprivate _inlineEditingMode?: boolean;\r\n\r\n\t// 'content-invalid' attribute is used for styling purpose.\r\n\t@property({ type: Boolean, attribute: 'content-invalid', reflect: true })\r\n\tprivate _contentInvalid?: boolean;\r\n\r\n\t// 'settings-invalid' attribute is used for styling purpose.\r\n\t@property({ type: Boolean, attribute: 'settings-invalid', reflect: true })\r\n\tprivate _settingsInvalid?: boolean;\r\n\r\n\t@state()\r\n\tprivate _blockViewProps: UmbBlockEditorCustomViewProperties<UmbBlockListLayoutModel> = {\r\n\t\tcontentKey: undefined!,\r\n\t\tconfig: { showContentEdit: false, showSettingsEdit: false },\r\n\t}; // Set to undefined cause it will be set before we render.\r\n\r\n\t#updateBlockViewProps(incoming: Partial<UmbBlockEditorCustomViewProperties<UmbBlockListLayoutModel>>) {\r\n\t\tthis._blockViewProps = { ...this._blockViewProps, ...incoming };\r\n\t\tthis.requestUpdate('_blockViewProps');\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _isReadOnly = false;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.#init();\r\n\t}\r\n\t#init() {\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.showContentEdit,\r\n\t\t\t(showContentEdit) => {\r\n\t\t\t\tthis._showContentEdit = showContentEdit;\r\n\t\t\t\tthis.#updateBlockViewProps({ config: { ...this._blockViewProps.config!, showContentEdit } });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.settingsElementTypeKey,\r\n\t\t\t(key) => {\r\n\t\t\t\tthis._hasSettings = !!key;\r\n\t\t\t\tthis.#updateBlockViewProps({ config: { ...this._blockViewProps.config!, showSettingsEdit: !!key } });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.blockType,\r\n\t\t\t(blockType) => {\r\n\t\t\t\tthis.#updateBlockViewProps({ blockType });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(this.#context.index, (index) => this.#updateBlockViewProps({ index }), null);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.label,\r\n\t\t\t(label) => {\r\n\t\t\t\tthis.#updateBlockViewProps({ label });\r\n\t\t\t\tthis._label = label;\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.contentElementTypeIcon,\r\n\t\t\t(icon) => {\r\n\t\t\t\tthis.#updateBlockViewProps({ icon });\r\n\t\t\t\tthis._icon = icon;\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.hasExpose,\r\n\t\t\t(exposed) => {\r\n\t\t\t\tthis.#updateBlockViewProps({ unpublished: !exposed });\r\n\t\t\t\tthis._exposed = exposed;\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.unsupported,\r\n\t\t\t(unsupported) => {\r\n\t\t\t\tif (unsupported === undefined) return;\r\n\t\t\t\tthis.#updateBlockViewProps({ unsupported: unsupported });\r\n\t\t\t\tthis._unsupported = unsupported;\r\n\t\t\t\tthis.toggleAttribute('unsupported', unsupported);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.actionsVisibility,\r\n\t\t\t(showActions) => {\r\n\t\t\t\tthis._showActions = showActions;\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.inlineEditingMode,\r\n\t\t\t(mode) => {\r\n\t\t\t\tthis._inlineEditingMode = mode;\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\t// Data props:\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.layout,\r\n\t\t\t(layout) => {\r\n\t\t\t\tthis.#updateBlockViewProps({ layout });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.#observeData();\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.settingsKey,\r\n\t\t\t(settingsKey) => {\r\n\t\t\t\tthis.removeUmbControllerByAlias('observeMessagesForSettings');\r\n\t\t\t\tif (settingsKey) {\r\n\t\t\t\t\t// Observe settings validation state:\r\n\t\t\t\t\tnew UmbObserveValidationStateController(\r\n\t\t\t\t\t\tthis,\r\n\t\t\t\t\t\t`$.settingsData[${UmbDataPathBlockElementDataQuery({ key: settingsKey })}]`,\r\n\t\t\t\t\t\t(hasMessages) => {\r\n\t\t\t\t\t\t\tthis._settingsInvalid = hasMessages;\r\n\t\t\t\t\t\t\tthis._blockViewProps.settingsInvalid = hasMessages;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'observeMessagesForSettings',\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.workspaceEditContentPath,\r\n\t\t\t(path) => {\r\n\t\t\t\tthis._workspaceEditContentPath = path;\r\n\t\t\t\tthis.#updateBlockViewProps({ config: { ...this._blockViewProps.config!, editContentPath: path } });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.workspaceEditSettingsPath,\r\n\t\t\t(path) => {\r\n\t\t\t\tthis._workspaceEditSettingsPath = path;\r\n\t\t\t\tthis.#updateBlockViewProps({ config: { ...this._blockViewProps.config!, editSettingsPath: path } });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.readOnlyGuard.permitted,\r\n\t\t\t(isReadOnly) => (this._isReadOnly = isReadOnly),\r\n\t\t\t'umbReadOnlyObserver',\r\n\t\t);\r\n\t}\r\n\r\n\tasync #observeData() {\r\n\t\tthis.observe(\r\n\t\t\tawait this.#context.contentValues(),\r\n\t\t\t(content) => {\r\n\t\t\t\tthis.#updateBlockViewProps({ content });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tawait this.#context.settingsValues(),\r\n\t\t\t(settings) => {\r\n\t\t\t\tthis.#updateBlockViewProps({ settings });\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t}\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\t\t// element styling:\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.contentElementTypeKey,\r\n\t\t\t(contentElementTypeKey) => {\r\n\t\t\t\tif (contentElementTypeKey) {\r\n\t\t\t\t\tthis.setAttribute('data-content-element-type-key', contentElementTypeKey);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'contentElementTypeKey',\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.contentElementTypeAlias,\r\n\t\t\t(contentElementTypeAlias) => {\r\n\t\t\t\tif (contentElementTypeAlias) {\r\n\t\t\t\t\tthis._contentTypeAlias = contentElementTypeAlias;\r\n\t\t\t\t\tthis.setAttribute('data-content-element-type-alias', contentElementTypeAlias);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'contentElementTypeAlias',\r\n\t\t);\r\n\t\tthis.observe(\r\n\t\t\tthis.#context.contentElementTypeName,\r\n\t\t\t(contentElementTypeName) => {\r\n\t\t\t\tthis._contentTypeName = contentElementTypeName;\r\n\t\t\t},\r\n\t\t\t'contentElementTypeName',\r\n\t\t);\r\n\t}\r\n\r\n\t#expose = () => {\r\n\t\tthis.#context.expose();\r\n\t};\r\n\r\n\tasync #copyToClipboard() {\r\n\t\tconst propertyDatasetContext = await this.getContext(UMB_PROPERTY_DATASET_CONTEXT);\r\n\t\tconst propertyContext = await this.getContext(UMB_PROPERTY_CONTEXT);\r\n\t\tconst clipboardContext = await this.getContext(UMB_CLIPBOARD_PROPERTY_CONTEXT);\r\n\t\tif (!propertyDatasetContext || !propertyContext || !clipboardContext) {\r\n\t\t\tthrow new Error('Could not get required contexts to copy.');\r\n\t\t}\r\n\r\n\t\tconst workspaceName = propertyDatasetContext?.getName();\r\n\t\tconst propertyLabel = propertyContext?.getLabel();\r\n\t\tconst blockLabel = this.#context.getName();\r\n\r\n\t\tconst entryName = workspaceName\r\n\t\t\t? `${workspaceName} - ${propertyLabel} - ${blockLabel}`\r\n\t\t\t: `${propertyLabel} - ${blockLabel}`;\r\n\r\n\t\tconst content = this.#context.getContent();\r\n\t\tconst layout = this.#context.getLayout();\r\n\t\tconst settings = this.#context.getSettings();\r\n\t\tconst expose = this.#context.getExpose();\r\n\r\n\t\tconst propertyValue: UmbBlockListValueModel = {\r\n\t\t\tcontentData: content ? [structuredClone(content)] : [],\r\n\t\t\tlayout: {\r\n\t\t\t\t[UMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS]: layout ? [structuredClone(layout)] : undefined,\r\n\t\t\t},\r\n\t\t\tsettingsData: settings ? [structuredClone(settings)] : [],\r\n\t\t\texpose: expose ? [structuredClone(expose)] : [],\r\n\t\t};\r\n\r\n\t\tclipboardContext.write({\r\n\t\t\ticon: this._icon,\r\n\t\t\tname: entryName,\r\n\t\t\tpropertyValue,\r\n\t\t\tpropertyEditorUiAlias: UMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS,\r\n\t\t});\r\n\t}\r\n\r\n\t#extensionSlotFilterMethod = (manifest: ManifestBlockEditorCustomView) => {\r\n\t\tif (this._unsupported) {\r\n\t\t\t// If the block is unsupported, we should not allow any custom views to render.\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\tmanifest.forContentTypeAlias &&\r\n\t\t\t!stringOrStringArrayContains(manifest.forContentTypeAlias, this._contentTypeAlias!)\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (manifest.forBlockEditor && !stringOrStringArrayContains(manifest.forBlockEditor, UMB_BLOCK_LIST)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\r\n\t#extensionSlotRenderMethod = (ext: UmbExtensionElementInitializer<ManifestBlockEditorCustomView>) => {\r\n\t\text.component?.setAttribute('part', 'component');\r\n\t\tif (this._exposed) {\r\n\t\t\treturn ext.component;\r\n\t\t} else {\r\n\t\t\treturn html`<div style=\"min-height: var(--uui-size-16);\">\r\n\t\t\t\t${ext.component}\r\n\t\t\t\t<umb-block-overlay-expose-button\r\n\t\t\t\t\t.contentTypeName=${this._contentTypeName}\r\n\t\t\t\t\t@click=${this.#expose}></umb-block-overlay-expose-button>\r\n\t\t\t</div>`;\r\n\t\t}\r\n\t};\r\n\r\n\t#renderRefBlock() {\r\n\t\treturn html`<umb-ref-list-block\r\n\t\t\t.label=${this._label}\r\n\t\t\t.icon=${this._icon}\r\n\t\t\t.index=${this._blockViewProps.index}\r\n\t\t\t.unpublished=${!this._exposed}\r\n\t\t\t.config=${this._blockViewProps.config}\r\n\t\t\t.content=${this._blockViewProps.content}\r\n\t\t\t.settings=${this._blockViewProps.settings}\r\n\t\t\t${umbDestroyOnDisconnect()}></umb-ref-list-block>`;\r\n\t}\r\n\r\n\t#renderInlineBlock() {\r\n\t\treturn html`<umb-inline-list-block\r\n\t\t\t.label=${this._label}\r\n\t\t\t.icon=${this._icon}\r\n\t\t\t.index=${this._blockViewProps.index}\r\n\t\t\t.unpublished=${!this._exposed}\r\n\t\t\t.config=${this._blockViewProps.config}\r\n\t\t\t.content=${this._blockViewProps.content}\r\n\t\t\t.settings=${this._blockViewProps.settings}\r\n\t\t\t${umbDestroyOnDisconnect()}></umb-inline-list-block>`;\r\n\t}\r\n\r\n\t#renderUnsupportedBlock() {\r\n\t\treturn html`<umb-unsupported-list-block\r\n\t\t\t.config=${this._blockViewProps.config}\r\n\t\t\t.content=${this._blockViewProps.content}\r\n\t\t\t.settings=${this._blockViewProps.settings}\r\n\t\t\t${umbDestroyOnDisconnect()}></umb-unsupported-list-block>`;\r\n\t}\r\n\r\n\t#renderBuiltinBlockView = () => {\r\n\t\tif (this._unsupported) {\r\n\t\t\treturn this.#renderUnsupportedBlock();\r\n\t\t}\r\n\t\tif (this._inlineEditingMode) {\r\n\t\t\treturn this.#renderInlineBlock();\r\n\t\t}\r\n\t\treturn this.#renderRefBlock();\r\n\t};\r\n\r\n\t#renderBlock() {\r\n\t\treturn this.contentKey && (this._contentTypeAlias || this._unsupported)\r\n\t\t\t? html`\r\n\t\t\t\t\t<div class=\"umb-block-list__block\">\r\n\t\t\t\t\t\t<umb-extension-slot\r\n\t\t\t\t\t\t\ttype=\"blockEditorCustomView\"\r\n\t\t\t\t\t\t\tdefault-element=${this._inlineEditingMode ? 'umb-inline-list-block' : 'umb-ref-list-block'}\r\n\t\t\t\t\t\t\t.renderMethod=${this.#extensionSlotRenderMethod}\r\n\t\t\t\t\t\t\t.fallbackRenderMethod=${this.#renderBuiltinBlockView}\r\n\t\t\t\t\t\t\t.props=${this._blockViewProps}\r\n\t\t\t\t\t\t\t.filter=${this.#extensionSlotFilterMethod}\r\n\t\t\t\t\t\t\tsingle></umb-extension-slot>\r\n\t\t\t\t\t\t${this.#renderActionBar()}\r\n\t\t\t\t\t\t${!this._showContentEdit && this._contentInvalid\r\n\t\t\t\t\t\t\t? html`<uui-badge attention color=\"invalid\" label=\"Invalid content\">!</uui-badge>`\r\n\t\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\t#renderActionBar() {\r\n\t\treturn this._showActions\r\n\t\t\t? html`<uui-action-bar>\r\n\t\t\t\t\t${this.#renderEditContentAction()} ${this.#renderEditSettingsAction()} ${this.#renderCopyToClipboardAction()}\r\n\t\t\t\t\t${this.#renderDeleteAction()}\r\n\t\t\t\t</uui-action-bar>`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\t#renderEditContentAction() {\r\n\t\treturn this._showContentEdit && this._workspaceEditContentPath\r\n\t\t\t? html`<uui-button\r\n\t\t\t\t\tlabel=\"edit\"\r\n\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\tcolor=${this._contentInvalid ? 'invalid' : ''}\r\n\t\t\t\t\thref=${this._workspaceEditContentPath}>\r\n\t\t\t\t\t<uui-icon name=${this._exposed === false && this._isReadOnly === false ? 'icon-add' : 'icon-edit'}></uui-icon>\r\n\t\t\t\t\t${this._contentInvalid\r\n\t\t\t\t\t\t? html`<uui-badge attention color=\"invalid\" label=\"Invalid content\">!</uui-badge>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t</uui-button>`\r\n\t\t\t: this._showContentEdit === false && this._exposed === false\r\n\t\t\t\t? html`<uui-button\r\n\t\t\t\t\t\t@click=${this.#expose}\r\n\t\t\t\t\t\tlabel=${this.localize.term('blockEditor_createThisFor', this._contentTypeName)}\r\n\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\t><uui-icon name=\"icon-add\"></uui-icon\r\n\t\t\t\t\t></uui-button>`\r\n\t\t\t\t: nothing;\r\n\t}\r\n\r\n\t#renderEditSettingsAction() {\r\n\t\treturn html`\r\n\t\t\t${this._hasSettings && this._workspaceEditSettingsPath\r\n\t\t\t\t? html`<uui-button\r\n\t\t\t\t\t\tlabel=\"Edit settings\"\r\n\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\tcolor=${this._settingsInvalid ? 'invalid' : ''}\r\n\t\t\t\t\t\thref=${this._workspaceEditSettingsPath}>\r\n\t\t\t\t\t\t<uui-icon name=\"icon-settings\"></uui-icon>\r\n\t\t\t\t\t\t${this._settingsInvalid\r\n\t\t\t\t\t\t\t? html`<uui-badge attention color=\"invalid\" label=\"Invalid settings\">!</uui-badge>`\r\n\t\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t</uui-button>`\r\n\t\t\t\t: nothing}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderDeleteAction() {\r\n\t\tif (this._isReadOnly) return nothing;\r\n\t\treturn html` <uui-button label=\"delete\" look=\"secondary\" @click=${() => this.#context.requestDelete()}>\r\n\t\t\t<uui-icon name=\"icon-remove\"></uui-icon>\r\n\t\t</uui-button>`;\r\n\t}\r\n\r\n\t#renderCopyToClipboardAction() {\r\n\t\treturn html`<uui-button label=\"Copy to clipboard\" look=\"secondary\" @click=${() => this.#copyToClipboard()}>\r\n\t\t\t<uui-icon name=\"icon-clipboard-copy\"></uui-icon>\r\n\t\t</uui-button>`;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this.#renderBlock();\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUUIBlinkKeyframes,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\t--umb-block-list-entry-actions-opacity: 0;\r\n\t\t\t}\r\n\r\n\t\t\t:host([settings-invalid]),\r\n\t\t\t:host([content-invalid]),\r\n\t\t\t:host(:hover),\r\n\t\t\t:host(:focus-within) {\r\n\t\t\t\t--umb-block-list-entry-actions-opacity: 1;\r\n\t\t\t}\r\n\r\n\t\t\t:host::after {\r\n\t\t\t\tcontent: '';\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tz-index: 1;\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tinset: 0;\r\n\t\t\t\tborder: 1px solid transparent;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\r\n\t\t\t\ttransition: border-color 240ms ease-in;\r\n\t\t\t}\r\n\r\n\t\t\t:host([settings-invalid])::after,\r\n\t\t\t:host([content-invalid])::after {\r\n\t\t\t\tborder-color: var(--uui-color-invalid);\r\n\t\t\t}\r\n\r\n\t\t\tumb-extension-slot::part(component) {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tz-index: 0;\r\n\t\t\t}\r\n\r\n\t\t\tuui-action-bar {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: var(--uui-size-2);\r\n\t\t\t\tright: var(--uui-size-2);\r\n\t\t\t\topacity: var(--umb-block-list-entry-actions-opacity, 0);\r\n\t\t\t\ttransition: opacity 120ms;\r\n\t\t\t}\r\n\r\n\t\t\tuui-badge {\r\n\t\t\t\tz-index: 2;\r\n\t\t\t}\r\n\r\n\t\t\t:host::after {\r\n\t\t\t\tcontent: '';\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tz-index: 1;\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tinset: 0;\r\n\t\t\t\tborder: 1px solid transparent;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\r\n\t\t\t\ttransition: border-color 240ms ease-in;\r\n\t\t\t}\r\n\t\t\t:host(:hover):not(:drop)::after {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tborder-color: var(--uui-color-interactive-emphasis);\r\n\t\t\t\tbox-shadow:\r\n\t\t\t\t\t0 0 0 1px rgba(255, 255, 255, 0.7),\r\n\t\t\t\t\tinset 0 0 0 1px rgba(255, 255, 255, 0.7);\r\n\t\t\t}\r\n\r\n\t\t\t:host([drag-placeholder])::after {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tborder-width: 2px;\r\n\t\t\t\tborder-color: var(--uui-color-interactive-emphasis);\r\n\t\t\t\tanimation: ${UUIBlinkAnimationValue};\r\n\t\t\t}\r\n\t\t\t:host([drag-placeholder])::before {\r\n\t\t\t\tcontent: '';\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tpointer-events: none;\r\n\t\t\t\tinset: 0;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tbackground-color: var(--uui-color-interactive-emphasis);\r\n\t\t\t\topacity: 0.12;\r\n\t\t\t}\r\n\t\t\t:host([drag-placeholder]) .umb-block-list__block {\r\n\t\t\t\ttransition: opacity 50ms 16ms;\r\n\t\t\t\topacity: 0;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbBlockListEntryElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-block-list-entry': UmbBlockListEntryElement;\r\n\t}\r\n}\r\n","import { UmbBlockListManagerContext } from '../../context/block-list-manager.context.js';\r\nimport { UmbBlockListEntriesContext } from '../../context/block-list-entries.context.js';\r\nimport type { UmbBlockListLayoutModel, UmbBlockListValueModel } from '../../types.js';\r\nimport type { UmbBlockListEntryElement } from '../../components/block-list-entry/index.js';\r\nimport { UMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS } from './constants.js';\r\nimport { UmbLitElement, umbDestroyOnDisconnect } from '@umbraco-cms/backoffice/lit-element';\r\nimport { html, customElement, property, state, repeat, css, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type {\r\n\tUmbPropertyEditorConfigCollection,\r\n\tUmbPropertyEditorUiElement,\r\n} from '@umbraco-cms/backoffice/property-editor';\r\nimport type { UmbNumberRangeValueType } from '@umbraco-cms/backoffice/models';\r\nimport type { UmbModalRouteBuilder } from '@umbraco-cms/backoffice/router';\r\nimport type { UmbSorterConfig } from '@umbraco-cms/backoffice/sorter';\r\nimport { UmbSorterController } from '@umbraco-cms/backoffice/sorter';\r\nimport type { UmbBlockLayoutBaseModel } from '@umbraco-cms/backoffice/block';\r\nimport type { UmbBlockTypeBaseModel } from '@umbraco-cms/backoffice/block-type';\r\n\r\nimport '../../components/block-list-entry/index.js';\r\nimport { UMB_PROPERTY_CONTEXT, UMB_PROPERTY_DATASET_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport {\r\n\textractJsonQueryProps,\r\n\tUMB_VALIDATION_EMPTY_LOCALIZATION_KEY,\r\n\tUmbFormControlMixin,\r\n\tUmbValidationContext,\r\n} from '@umbraco-cms/backoffice/validation';\r\nimport { jsonStringComparison, observeMultiple } from '@umbraco-cms/backoffice/observable-api';\r\nimport { debounceTime } from '@umbraco-cms/backoffice/external/rxjs';\r\nimport { UMB_CONTENT_WORKSPACE_CONTEXT } from '@umbraco-cms/backoffice/content';\r\n\r\nconst SORTER_CONFIG: UmbSorterConfig<UmbBlockListLayoutModel, UmbBlockListEntryElement> = {\r\n\tgetUniqueOfElement: (element) => {\r\n\t\treturn element.contentKey!;\r\n\t},\r\n\tgetUniqueOfModel: (modelEntry) => {\r\n\t\treturn modelEntry.contentKey;\r\n\t},\r\n\t//identifier: 'block-list-editor',\r\n\titemSelector: 'umb-block-list-entry',\r\n\t//containerSelector: 'EMPTY ON PURPOSE, SO IT BECOMES THE HOST ELEMENT',\r\n};\r\n\r\n@customElement('umb-property-editor-ui-block-list')\r\nexport class UmbPropertyEditorUIBlockListElement\r\n\textends UmbFormControlMixin<UmbBlockListValueModel | undefined, typeof UmbLitElement, undefined>(UmbLitElement)\r\n\timplements UmbPropertyEditorUiElement\r\n{\r\n\treadonly #sorter = new UmbSorterController<UmbBlockListLayoutModel, UmbBlockListEntryElement>(this, {\r\n\t\t...SORTER_CONFIG,\r\n\t\tonChange: ({ model }) => {\r\n\t\t\tthis.#entriesContext.setLayouts(model);\r\n\t\t},\r\n\t});\r\n\r\n\treadonly #validationContext = new UmbValidationContext(this);\r\n\r\n\t#lastValue: UmbBlockListValueModel | undefined = undefined;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic override set value(value: UmbBlockListValueModel | undefined) {\r\n\t\tthis.#lastValue = value;\r\n\r\n\t\tif (!value) {\r\n\t\t\tsuper.value = undefined;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst buildUpValue: Partial<UmbBlockListValueModel> = value ? { ...value } : {};\r\n\t\tbuildUpValue.layout ??= {};\r\n\t\tbuildUpValue.contentData ??= [];\r\n\t\tbuildUpValue.settingsData ??= [];\r\n\t\tbuildUpValue.expose ??= [];\r\n\t\tsuper.value = buildUpValue as UmbBlockListValueModel;\r\n\r\n\t\tthis.#managerContext.setLayouts(super.value.layout[UMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS] ?? []);\r\n\t\tthis.#managerContext.setContents(super.value.contentData);\r\n\t\tthis.#managerContext.setSettings(super.value.settingsData);\r\n\t\tthis.#managerContext.setExposes(super.value.expose);\r\n\t}\r\n\tpublic override get value(): UmbBlockListValueModel | undefined {\r\n\t\treturn super.value;\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _createButtonLabel = this.localize.term('content_createEmpty');\r\n\r\n\tpublic set config(config: UmbPropertyEditorConfigCollection | undefined) {\r\n\t\tif (!config) return;\r\n\r\n\t\tconst validationLimit = config.getValueByAlias<UmbNumberRangeValueType>('validationLimit');\r\n\r\n\t\tthis._limitMin = validationLimit?.min;\r\n\t\tthis._limitMax = validationLimit?.max;\r\n\r\n\t\tconst blocks = config.getValueByAlias<Array<UmbBlockTypeBaseModel>>('blocks') ?? [];\r\n\t\tthis.#managerContext.setBlockTypes(blocks);\r\n\r\n\t\tconst useInlineEditingAsDefault = config.getValueByAlias<boolean>('useInlineEditingAsDefault');\r\n\t\tthis.#managerContext.setInlineEditingMode(useInlineEditingAsDefault);\r\n\t\tthis.style.maxWidth = config.getValueByAlias<string>('maxPropertyWidth') ?? '';\r\n\t\t// TODO:\r\n\t\t//config.useSingleBlockMode, not done jet\r\n\r\n\t\tthis.#managerContext.setEditorConfiguration(config);\r\n\r\n\t\tconst customCreateButtonLabel = config.getValueByAlias<string>('createLabel');\r\n\t\tif (customCreateButtonLabel) {\r\n\t\t\tthis._createButtonLabel = this.localize.string(customCreateButtonLabel);\r\n\t\t} else if (blocks.length === 1) {\r\n\t\t\tthis.#managerContext.contentTypesLoaded.then(() => {\r\n\t\t\t\tconst firstContentTypeName = this.#managerContext.getContentTypeNameOf(blocks[0].contentElementTypeKey);\r\n\t\t\t\tthis._createButtonLabel = this.localize.term('blockEditor_addThis', this.localize.string(firstContentTypeName));\r\n\r\n\t\t\t\t// If we are in a invariant context:\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the input to readonly mode, meaning value cannot be changed but still able to read and select its content.\r\n\t * @type {boolean}\r\n\t * @default\r\n\t */\r\n\tpublic set readonly(value) {\r\n\t\tthis.#readonly = value;\r\n\r\n\t\tif (this.#readonly) {\r\n\t\t\tthis.#sorter.disable();\r\n\t\t\tthis.#managerContext.readOnlyState.fallbackToPermitted();\r\n\t\t} else {\r\n\t\t\tthis.#sorter.enable();\r\n\t\t\tthis.#managerContext.readOnlyState.fallbackToNotPermitted();\r\n\t\t}\r\n\t}\r\n\tpublic get readonly() {\r\n\t\treturn this.#readonly;\r\n\t}\r\n\t#readonly = false;\r\n\r\n\t@property({ type: Boolean })\r\n\tmandatory?: boolean;\r\n\r\n\t@property({ type: String })\r\n\tmandatoryMessage?: string | undefined;\r\n\r\n\t@state()\r\n\tprivate _limitMin?: number;\r\n\t@state()\r\n\tprivate _limitMax?: number;\r\n\r\n\t@state()\r\n\tprivate _blocks?: Array<UmbBlockTypeBaseModel>;\r\n\r\n\t@state()\r\n\tprivate _layouts: Array<UmbBlockLayoutBaseModel> = [];\r\n\r\n\t@state()\r\n\tprivate _catalogueRouteBuilder?: UmbModalRouteBuilder;\r\n\r\n\treadonly #managerContext = new UmbBlockListManagerContext(this);\r\n\treadonly #entriesContext = new UmbBlockListEntriesContext(this);\r\n\r\n\t@state()\r\n\tprivate _notSupportedVariantSetting?: boolean;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_CONTENT_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tif (context) {\r\n\t\t\t\tthis.observe(\r\n\t\t\t\t\tobserveMultiple([\r\n\t\t\t\t\t\tthis.#managerContext.blockTypes,\r\n\t\t\t\t\t\tcontext.structure.variesByCulture,\r\n\t\t\t\t\t\tcontext.structure.variesBySegment,\r\n\t\t\t\t\t]),\r\n\t\t\t\t\tasync ([blockTypes, variesByCulture, variesBySegment]) => {\r\n\t\t\t\t\t\tif (blockTypes.length > 0 && (variesByCulture === false || variesBySegment === false)) {\r\n\t\t\t\t\t\t\t// check if any of the Blocks varyByCulture or Segment and then display a warning.\r\n\t\t\t\t\t\t\tconst promises = await Promise.all(\r\n\t\t\t\t\t\t\t\tblockTypes.map(async (blockType) => {\r\n\t\t\t\t\t\t\t\t\tconst elementType = blockType.contentElementTypeKey;\r\n\t\t\t\t\t\t\t\t\tawait this.#managerContext.contentTypesLoaded;\r\n\t\t\t\t\t\t\t\t\tconst structure = await this.#managerContext.getStructure(elementType);\r\n\t\t\t\t\t\t\t\t\tif (variesByCulture === false && structure?.getVariesByCulture() === true) {\r\n\t\t\t\t\t\t\t\t\t\t// If block varies by culture but document does not.\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t} else if (variesBySegment === false && structure?.getVariesBySegment() === true) {\r\n\t\t\t\t\t\t\t\t\t\t// If block varies by segment but document does not.\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tthis._notSupportedVariantSetting = promises.filter((x) => x === true).length > 0;\r\n\r\n\t\t\t\t\t\t\tif (this._notSupportedVariantSetting) {\r\n\t\t\t\t\t\t\t\tthis.#validationContext.messages.addMessage(\r\n\t\t\t\t\t\t\t\t\t'config',\r\n\t\t\t\t\t\t\t\t\t'$',\r\n\t\t\t\t\t\t\t\t\t'#blockEditor_blockVariantConfigurationNotSupported',\r\n\t\t\t\t\t\t\t\t\t'blockConfigurationNotSupported',\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t'blockTypeConfigurationCheck',\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthis.removeUmbControllerByAlias('blockTypeConfigurationCheck');\r\n\t\t\t}\r\n\t\t}).passContextAliasMatches();\r\n\r\n\t\tthis.consumeContext(UMB_PROPERTY_CONTEXT, (context) => {\r\n\t\t\tthis.#gotPropertyContext(context);\r\n\t\t});\r\n\r\n\t\t// TODO: Why is this logic not part of the Block Grid and RTE Editors? [NL]\r\n\t\t// Observe Blocks and clean up validation messages for content/settings that are not in the block list anymore:\r\n\t\tthis.observe(\r\n\t\t\tthis.#managerContext.layouts,\r\n\t\t\t(layouts) => {\r\n\t\t\t\tconst validationMessagesToRemove: string[] = [];\r\n\t\t\t\tconst contentKeys = layouts.map((x) => x.contentKey);\r\n\t\t\t\tthis.#validationContext.messages.getMessagesOfPathAndDescendant('$.contentData').forEach((message) => {\r\n\t\t\t\t\t// get the KEY from this string: $.contentData[?(@.key == 'KEY')]\r\n\t\t\t\t\t// TODO: Investigate if this is missing a part to just get the [] part of the path. Cause couldn't there be a sub path inside of this. [NL]\r\n\t\t\t\t\tconst key = extractJsonQueryProps(message.path).key;\r\n\t\t\t\t\tif (key && contentKeys.indexOf(key) === -1) {\r\n\t\t\t\t\t\tvalidationMessagesToRemove.push(message.key);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst settingsKeys = layouts.map((x) => x.settingsKey).filter((x) => x !== undefined) as string[];\r\n\t\t\t\tthis.#validationContext.messages.getMessagesOfPathAndDescendant('$.settingsData').forEach((message) => {\r\n\t\t\t\t\t// TODO: Investigate if this is missing a part to just get the [] part of the path. Cause couldn't there be a sub path inside of this. [NL]\r\n\t\t\t\t\t// get the key from this string: $.settingsData[?(@.key == 'KEY')]\r\n\t\t\t\t\tconst key = extractJsonQueryProps(message.path).key;\r\n\t\t\t\t\tif (key && settingsKeys.indexOf(key) === -1) {\r\n\t\t\t\t\t\tvalidationMessagesToRemove.push(message.key);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Remove the messages after the loop to prevent changing the array while iterating over it.\r\n\t\t\t\tthis.#validationContext.messages.removeMessageByKeys(validationMessagesToRemove);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\r\n\t\tthis.consumeContext(UMB_PROPERTY_DATASET_CONTEXT, async (context) => {\r\n\t\t\tthis.#managerContext.setVariantId(context?.getVariantId());\r\n\t\t});\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'rangeUnderflow',\r\n\t\t\t() =>\r\n\t\t\t\tthis.localize.term(\r\n\t\t\t\t\t'validation_entriesShort',\r\n\t\t\t\t\tthis._limitMin,\r\n\t\t\t\t\t(this._limitMin ?? 0) - this.#entriesContext.getLength(),\r\n\t\t\t\t),\r\n\t\t\t() => !!this._limitMin && this.#entriesContext.getLength() < this._limitMin,\r\n\t\t);\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'rangeOverflow',\r\n\t\t\t() =>\r\n\t\t\t\tthis.localize.term(\r\n\t\t\t\t\t'validation_entriesExceed',\r\n\t\t\t\t\tthis._limitMax,\r\n\t\t\t\t\tthis.#entriesContext.getLength() - (this._limitMax || 0),\r\n\t\t\t\t),\r\n\t\t\t() => !!this._limitMax && this.#entriesContext.getLength() > this._limitMax,\r\n\t\t);\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'valueMissing',\r\n\t\t\t() => this.mandatoryMessage ?? UMB_VALIDATION_EMPTY_LOCALIZATION_KEY,\r\n\t\t\t() => !!this.mandatory && this.#entriesContext.getLength() === 0,\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#entriesContext.layoutEntries,\r\n\t\t\t(layouts) => {\r\n\t\t\t\tthis._layouts = layouts;\r\n\t\t\t\t// Update sorter.\r\n\t\t\t\tthis.#sorter.setModel(layouts);\r\n\t\t\t\t// Update manager:\r\n\t\t\t\tthis.#managerContext.setLayouts(layouts);\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#managerContext.blockTypes,\r\n\t\t\t(blockTypes) => {\r\n\t\t\t\tthis._blocks = blockTypes;\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#entriesContext.catalogueRouteBuilder,\r\n\t\t\t(routeBuilder) => {\r\n\t\t\t\tthis._catalogueRouteBuilder = routeBuilder;\r\n\t\t\t},\r\n\t\t\tnull,\r\n\t\t);\r\n\t}\r\n\r\n\t#gotPropertyContext(context: typeof UMB_PROPERTY_CONTEXT.TYPE | undefined) {\r\n\t\tthis.observe(\r\n\t\t\tcontext?.dataPath,\r\n\t\t\t(dataPath) => {\r\n\t\t\t\tif (dataPath) {\r\n\t\t\t\t\t// Set the data path for the local validation context:\r\n\t\t\t\t\tthis.#validationContext.setDataPath(dataPath);\r\n\t\t\t\t\tthis.#validationContext.autoReport();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'observeDataPath',\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tcontext?.alias,\r\n\t\t\t(alias) => {\r\n\t\t\t\tthis.#managerContext.setPropertyAlias(alias);\r\n\t\t\t},\r\n\t\t\t'observePropertyAlias',\r\n\t\t);\r\n\r\n\t\tthis.observe(\r\n\t\t\tobserveMultiple([\r\n\t\t\t\tthis.#managerContext.layouts,\r\n\t\t\t\tthis.#managerContext.contents,\r\n\t\t\t\tthis.#managerContext.settings,\r\n\t\t\t\tthis.#managerContext.exposes,\r\n\t\t\t]).pipe(debounceTime(20)),\r\n\t\t\t([layouts, contents, settings, exposes]) => {\r\n\t\t\t\tif (layouts.length === 0) {\r\n\t\t\t\t\tif (this.value === undefined) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsuper.value = undefined;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst newValue = {\r\n\t\t\t\t\t\t...super.value,\r\n\t\t\t\t\t\tlayout: { [UMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS]: layouts },\r\n\t\t\t\t\t\tcontentData: contents,\r\n\t\t\t\t\t\tsettingsData: settings,\r\n\t\t\t\t\t\texpose: exposes,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (jsonStringComparison(this.value, newValue)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsuper.value = newValue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If we don't have a value set from the outside or an internal value, we don't want to set the value.\r\n\t\t\t\t// This is added to prevent the block list from setting an empty value on startup.\r\n\t\t\t\tif (this.#lastValue === undefined && super.value === undefined) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontext?.setValue(super.value);\r\n\t\t\t},\r\n\t\t\t'motherObserver',\r\n\t\t);\r\n\t}\r\n\r\n\tprotected override getFormElement() {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (this._notSupportedVariantSetting) {\r\n\t\t\treturn nothing;\r\n\t\t}\r\n\t\treturn html`\r\n\t\t\t${repeat(\r\n\t\t\t\tthis._layouts,\r\n\t\t\t\t(layout, index) => `${index}_${layout.contentKey}`,\r\n\t\t\t\t(layout, index) => html`\r\n\t\t\t\t\t${this.#renderInlineCreateButton(index)}\r\n\t\t\t\t\t<umb-block-list-entry\r\n\t\t\t\t\t\tindex=${index}\r\n\t\t\t\t\t\t.contentKey=${layout.contentKey}\r\n\t\t\t\t\t\t.layout=${layout}\r\n\t\t\t\t\t\t${umbDestroyOnDisconnect()}>\r\n\t\t\t\t\t</umb-block-list-entry>\r\n\t\t\t\t`,\r\n\t\t\t)}\r\n\t\t\t${this.#renderCreateButtonGroup()}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderCreateButtonGroup() {\r\n\t\tif (this.readonly && this._layouts.length > 0) {\r\n\t\t\treturn nothing;\r\n\t\t} else {\r\n\t\t\treturn html`<uui-button-group>${this.#renderCreateButton()}${this.#renderPasteButton()}</uui-button-group>`;\r\n\t\t}\r\n\t}\r\n\r\n\t#renderInlineCreateButton(index: number) {\r\n\t\tif (this.readonly) return nothing;\r\n\t\treturn html`<uui-button-inline-create\r\n\t\t\tlabel=${this._createButtonLabel}\r\n\t\t\thref=${this._catalogueRouteBuilder?.({ view: 'create', index: index }) ?? ''}></uui-button-inline-create>`;\r\n\t}\r\n\r\n\t#renderCreateButton() {\r\n\t\tlet createPath: string | undefined;\r\n\t\tif (this._blocks?.length === 1) {\r\n\t\t\tconst elementKey = this._blocks[0].contentElementTypeKey;\r\n\t\t\tcreatePath =\r\n\t\t\t\tthis._catalogueRouteBuilder?.({ view: 'create', index: -1 }) + 'modal/umb-modal-workspace/create/' + elementKey;\r\n\t\t} else {\r\n\t\t\tcreatePath = this._catalogueRouteBuilder?.({ view: 'create', index: -1 });\r\n\t\t}\r\n\t\treturn html`\r\n\t\t\t<uui-button\r\n\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\tlabel=${this._createButtonLabel}\r\n\t\t\t\thref=${createPath ?? ''}\r\n\t\t\t\t?disabled=${this.readonly}></uui-button>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderPasteButton() {\r\n\t\treturn html`\r\n\t\t\t<uui-button\r\n\t\t\t\tlabel=${this.localize.term('content_createFromClipboard')}\r\n\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\thref=${this._catalogueRouteBuilder?.({ view: 'clipboard', index: -1 }) ?? ''}\r\n\t\t\t\t?disabled=${this.readonly}>\r\n\t\t\t\t<uui-icon name=\"icon-clipboard-paste\"></uui-icon>\r\n\t\t\t</uui-button>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override readonly styles = [\r\n\t\tUmbTextStyles,\r\n\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: 1px;\r\n\t\t\t}\r\n\t\t\t> div {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\talign-items: stretch;\r\n\t\t\t}\r\n\r\n\t\t\tuui-button-group {\r\n\t\t\t\tpadding-top: 1px;\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-template-columns: 1fr auto;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbPropertyEditorUIBlockListElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-block-list': UmbPropertyEditorUIBlockListElement;\r\n\t}\r\n}\r\n"],"names":["UmbBlockListManagerContext","UmbBlockManagerContext","#inlineEditingMode","UmbBooleanState","inlineEditingMode","contentElementTypeKey","partialLayoutEntry","_originData","layoutEntry","content","settings","originData","UmbBlockListEntriesContext","UmbBlockEntriesContext","host","UMB_BLOCK_LIST_MANAGER_CONTEXT","UmbModalRouteRegistrationController","UMB_BLOCK_CATALOGUE_MODAL","routingInfo","index","clipboardContext","UMB_CLIPBOARD_PROPERTY_CONTEXT","pasteTranslatorManifests","UMB_BLOCK_LIST_PROPERTY_EDITOR_UI_ALIAS","propertyContext","UMB_PROPERTY_CONTEXT","config","valueResolver","UmbClipboardPastePropertyValueTranslatorValueResolver","clipboardEntryDetail","pasteTranslator","value","data","created","propertyValues","routeBuilder","UMB_BLOCK_LIST_WORKSPACE_MODAL","newPath","layouts","layoutEntries","UMB_BLOCK_LIST_PROPERTY_EDITOR_SCHEMA_ALIAS","UmbBlockListEntryContext","UmbBlockEntryContext","UMB_BLOCK_LIST_ENTRIES_CONTEXT","x","mergeObservables","a","b","c","UmbRefListBlockElement","UmbLitElement","blockValue","html","when","css","__decorateClass","property","customElement","_blockWorkspace","_tabsStructureHelper","_UmbBlockWorkspaceViewEditContentNoRouterElement_instances","observeRootGroups_fn","checkDefaultTabName_fn","setTabKey_fn","UmbBlockWorkspaceViewEditContentNoRouterElement","__privateAdd","UmbContentTypeContainerStructureHelper","__privateGet","tabs","__privateMethod","UMB_BLOCK_WORKSPACE_CONTEXT","context","__privateSet","nothing","repeat","tab","tabKey","hasRootGroups","UmbTextStyles","state","_blockContext","_workspaceContext","_contentKey","_UmbInlineListBlockElement_instances","load_fn","_expose","renderBlockInfo_fn","renderInside_fn","apiArgsCreator","manifest","UmbInlineListBlockElement","UMB_BLOCK_LIST_ENTRY_CONTEXT","blockContext","contentKey","UmbExtensionApiInitializer","umbExtensionsRegistry","UMB_BLOCK_WORKSPACE_ALIAS","permitted","ctrl","exposed","name","variantId","culture","languageRepository","UmbLanguageItemRepository","UmbExtensionsApiInitializer","e","_UmbUnsupportedListBlockElement_instances","UmbUnsupportedListBlockElement","_context","_UmbBlockListEntryElement_instances","updateBlockViewProps_fn","init_fn","observeData_fn","copyToClipboard_fn","_extensionSlotFilterMethod","_extensionSlotRenderMethod","renderRefBlock_fn","renderInlineBlock_fn","renderUnsupportedBlock_fn","_renderBuiltinBlockView","renderBlock_fn","renderActionBar_fn","renderEditContentAction_fn","renderEditSettingsAction_fn","renderDeleteAction_fn","renderCopyToClipboardAction_fn","UmbBlockListEntryElement","stringOrStringArrayContains","UMB_BLOCK_LIST","ext","UmbObserveValidationStateController","UmbDataPathBlockElementDataQuery","hasMessages","contentElementTypeAlias","contentElementTypeName","incoming","showContentEdit","key","blockType","label","icon","unsupported","showActions","mode","layout","settingsKey","path","isReadOnly","propertyDatasetContext","UMB_PROPERTY_DATASET_CONTEXT","workspaceName","propertyLabel","blockLabel","entryName","expose","propertyValue","umbDestroyOnDisconnect","UUIBlinkKeyframes","UUIBlinkAnimationValue","_sorter","_validationContext","_lastValue","_readonly","_managerContext","_entriesContext","_UmbPropertyEditorUIBlockListElement_instances","gotPropertyContext_fn","renderCreateButtonGroup_fn","renderInlineCreateButton_fn","renderCreateButton_fn","renderPasteButton_fn","SORTER_CONFIG","element","modelEntry","UmbPropertyEditorUIBlockListElement","UmbFormControlMixin","UmbSorterController","model","UmbValidationContext","UMB_CONTENT_WORKSPACE_CONTEXT","observeMultiple","blockTypes","variesByCulture","variesBySegment","promises","elementType","structure","validationMessagesToRemove","contentKeys","message","extractJsonQueryProps","settingsKeys","UMB_VALIDATION_EMPTY_LOCALIZATION_KEY","buildUpValue","validationLimit","blocks","useInlineEditingAsDefault","customCreateButtonLabel","firstContentTypeName","dataPath","alias","debounceTime","contents","exposes","__superSet","newValue","__superGet","jsonStringComparison","createPath","elementKey","UmbPropertyEditorUIBlockListElement$1"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASO,MAAMA,WAEHC,GAAgG;AAAA,EAFnG,cAAA;AAAA,UAAA,GAAA,SAAA,GAIN,KAAAC,KAAqB,IAAIC,GAAgB,MAAS,GAClD,KAAS,oBAAoB,KAAKD,GAAmB,aAAA;AAAA,EAAa;AAAA,EADlEA;AAAA,EAGA,qBAAqBE,GAAwC;AAC5D,SAAKF,GAAmB,SAASE,KAAqB,EAAK;AAAA,EAC5D;AAAA,EACA,uBAA4C;AAC3C,WAAO,KAAKF,GAAmB,SAAA;AAAA,EAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,OAECG,GAEAC,GAGAC,GACQ;AACR,UAAM,IAAI,MAAM,0CAA0C;AAAA,EAC3D;AAAA,EACA,MAAM,kBACLF,GACAC,GAGAC,GACC;AACD,WAAO,MAAM,MAAM,iBAAiBF,GAAuBC,CAAkB;AAAA,EAC9E;AAAA,EAEA,OACCE,GACAC,GACAC,GACAC,GACC;AACD,gBAAK,SAAS,YAAYH,GAAaG,EAAW,SAAS,EAAE,GAE7D,KAAK,gBAAgBH,GAAaC,GAASC,GAAUC,CAAU,GAExD;AAAA,EACR;AACD;AC3CO,MAAMC,WAAmCC,GAM9C;AAAA,EAMD,YAAYC,GAAyB;AACpC,UAAMA,GAAMC,EAA8B,GAH3C,KAAgB,YAAY,IAAIZ,GAAgB,EAAI,EAAE,aAAA,GAKrD,IAAIa,GAAoC,MAAMC,EAAyB,EACrE,kBAAkB,yBAAyB,EAC3C,QAAQ,OAAOC,MAAgB;AAE/B,UADA,MAAM,KAAK,kBACP,CAAC,KAAK,SAAU,QAAO;AAC3B,YAAMC,IAAQD,EAAY,QAAQ,SAASA,EAAY,KAAK,IAAI,IAC1DE,IAAmB,MAAM,KAAK,WAAWC,EAA8B;AAC7E,UAAI,CAACD;AACJ,cAAM,IAAI,MAAM,6BAA6B;AAG9C,YAAME,IAA2BF,EAAiB;AAAA,QACjDG;AAAA,MAAA,GAIKC,IAAkB,MAAM,KAAK,WAAWC,EAAoB;AAClE,UAAI,CAACD;AACJ,cAAM,IAAI,MAAM,4BAA4B;AAE7C,YAAME,IAASF,EAAgB,UAAA,GACzBG,IAAgB,IAAIC,GAAsD,IAAI;AAEpF,aAAO;AAAA,QACN,MAAM;AAAA,UACL,QAAQ,KAAK,UAAU,cAAA,KAAmB,CAAA;AAAA,UAC1C,aAAa,CAAA;AAAA,UACb,eAAeV,EAAY,SAAS;AAAA,UACpC,iBAAiB,OAAOW,MAAyB;AAMhD,gBAAI,CALgCT,EAAiB;AAAA,cACpDE;AAAA,cACAO,EAAqB;AAAA,YAAA;AAIrB,qBAAO;AAGR,kBAAMC,IAAkB,MAAMH,EAAc;AAAA,cAC3CE,EAAqB;AAAA,cACrBN;AAAA,YAAA;AAGD,gBAAIO,EAAgB,mBAAmB;AACtC,oBAAMC,KAAQ,MAAMJ,EAAc;AAAA,gBACjCE,EAAqB;AAAA,gBACrBN;AAAA,cAAA;AAED,qBAAOO,EAAgB,kBAAkBC,IAAOL,CAAM;AAAA,YACvD;AAEA,mBAAO;AAAA,UACR;AAAA,UACA,YAAY,EAAE,OAAAP,EAAA;AAAA,UACd,wBAAwB,KAAK,SAAS,2BAA2B;AAAA,QAAA;AAAA,MAClE;AAAA,IAEF,CAAC,EACA,SAAS,OAAOY,GAAOC,MAAS;AAChC,UAAID,GAAO,UAAUC,GAAM;AAC1B,cAAMC,IAAU,MAAM,KAAK;AAAA,UAC1BF,EAAM,OAAO;AAAA,UACb,CAAA;AAAA,UACAC,EAAK;AAAA,QAAA;AAEN,YAAIC;AACH,eAAK;AAAA,YACJA,EAAQ;AAAA,YACRA,EAAQ;AAAA,YACRA,EAAQ;AAAA,YACRD,EAAK;AAAA,UAAA;AAAA;AAGN,gBAAM,IAAI,MAAM,wBAAwB;AAAA,MAE1C,WAAWD,GAAO,aAAaA,EAAM,UAAU,WAAW,UAAUC,GAAM;AACzE,cAAMZ,IAAmB,MAAM,KAAK,WAAWC,EAA8B;AAC7E,YAAI,CAACD;AACJ,gBAAM,IAAI,MAAM,6BAA6B;AAE9C,cAAMc,IAAiB,MAAMd,EAAiB;AAAA,UAC7CW,EAAM,UAAU;AAAA,UAChBR;AAAA,QAAA;AAGD,aAAK,0BAA0BW,GAAgBF,EAAK,UAA6C;AAAA,MAClG;AAAA,IACD,CAAC,EACA,oBAAoB,CAACG,MAAiB;AACtC,WAAK,4BAA4B,SAASA,CAAY;AAAA,IACvD,CAAC,GAEF,IAAInB,GAAoC,MAAMoB,EAA8B,EAC1E,kBAAkB,OAAO,EACzB,QAAQ,OACD;AAAA,MACN,MAAM,EAAE,YAAY,SAAS,QAAQ,CAAA,GAAI,cAAc,KAAK,UAAA;AAAA,MAC5D,OAAO,EAAE,MAAM,SAAA;AAAA,IAAS,EAEzB,EACA,oBAAoB,CAACD,MAAiB;AACtC,YAAME,IAAUF,EAAa,EAAE;AAC/B,WAAK,eAAe,SAASE,CAAO;AAAA,IACrC,CAAC;AAAA,EACH;AAAA,EAEU,mBAAmB;AAC5B,IAAK,KAAK,aAEV,KAAK;AAAA,MACJ,KAAK,SAAS;AAAA,MACd,CAACC,MAAY;AACZ,aAAK,eAAe,SAASA,CAAO;AAAA,MACrC;AAAA,MACA;AAAA,IAAA,GAED,KAAK;AAAA,MACJ,KAAK;AAAA,MACL,CAACA,MAAY;AACZ,aAAK,UAAU,WAAWA,CAAO;AAAA,MAClC;AAAA,MACA;AAAA,IAAA;AAAA,EAEF;AAAA,EAEA,sBAAsBnB,GAAe;AACpC,WAAO,KAAK,4BAA4B,SAAA,IAAa,EAAE,MAAM,UAAU,OAAAA,GAAc;AAAA,EACtF;AAAA,EAEA,oBAAoBA,GAAe;AAClC,WAAO,KAAK,4BAA4B,SAAA,IAAa,EAAE,MAAM,aAAa,OAAAA,GAAc;AAAA,EACzF;AAAA,EAEA,MAAe,WAAWmB,GAAyC;AAClE,UAAM,KAAK,kBACX,KAAK,UAAU,WAAWA,CAAO;AAAA,EAClC;AAAA,EAEA,MAAM,OACLjC,GACAC,GACAK,GACC;AACD,iBAAM,KAAK,kBACJ,MAAM,KAAK,UAAU,kBAAkBN,GAAuBC,GAAoBK,CAAU;AAAA,EACpG;AAAA;AAAA,EAIA,MAAM,OACLH,GACAC,GACAC,GACAC,GACC;AACD,iBAAM,KAAK,kBAEJ,KAAK,UAAU,OAAOH,GAAaC,GAASC,GAAUC,CAAU,KAAK;AAAA,EAC7E;AAAA,EAEA,MAAgB,yBAAyBoB,GAA+BpB,GAA6C;AACpH,UAAM4B,IAAgBR,EAAM,OAAOS,EAA2C;AAE9E,QAAI,CAACD;AACJ,YAAM,IAAI,MAAM,yBAAyB;AAG1C,iBAAM,QAAQ;AAAA,MACbA,EAAc,IAAI,OAAO/B,MAAgB;AACxC,aAAK,8BAA8BA,GAAauB,GAAOpB,CAAU,GAC7DA,EAAW,UAAU,OACxBA,IAAa,EAAE,GAAGA,GAAY,OAAOA,EAAW,QAAQ,EAAA;AAAA,MAE1D,CAAC;AAAA,IAAA,GAGKA;AAAA,EACR;AACD;AC/MO,MAAM8B,WAAiCC,GAK5C;AAAA,EAcD,YAAY5B,GAAyB;AACpC,UAAMA,GAAMC,IAAgC4B,EAA8B,GAd3E,KAAAzC,KAAqB,IAAIC,GAAgB,MAAS,GAClD,KAAS,oBAAoB,KAAKD,GAAmB,aAAA,GACrD,KAAS,kCAAkC,KAAK,WAAW;AAAA,MAAiB,CAAC0C,MAC5EA,IAAKA,EAAE,mCAAmC,KAAS;AAAA,IAAA,GAGpD,KAAS,kBAAkBC;AAAA,MAC1B,CAAC,KAAK,gCAAgC,KAAK,iCAAiC,KAAK,iBAAiB;AAAA,MAClG,CAAC,CAACC,GAAGC,GAAGC,CAAC,MACDF,MAAM,MAAQC,MAAM,MAASC,MAAM;AAAA,IAC3C;AAAA,EAKD;AAAA,EAfA9C;AAAA,EAiBmB,cAAc;AAChC,SAAK;AAAA,MACJ,KAAK,UAAU;AAAA,MACf,CAACE,MAAsB;AACtB,aAAKF,GAAmB,SAASE,CAAiB;AAAA,MACnD;AAAA,MACA;AAAA,IAAA;AAAA,EAEF;AAAA,EAEmB,cAAc;AAAA,EAAC;AAAA,EAEf,kBAAkB;AAAA,EAAC;AACvC;;;;;;ACjCO,IAAM6C,IAAN,cAAqCC,EAAc;AAAA,EAuBhD,SAAS;AACjB,UAAMC,IAAa,EAAE,GAAG,KAAK,SAAS,WAAW,KAAK,UAAU,QAAQ,KAAK,MAAA;AAC7E,WAAOC;AAAA,oCAC2B,KAAK,QAAQ,kBAAkB,KAAK,QAAQ,kBAAkB,WAAc,EAAE;AAAA,kCAChF,KAAK,IAAI;AAAA,mDACQ,KAAK,KAAK,WAAWD,CAAU;AAAA,MAC5EE;AAAA,MACD,KAAK;AAAA,MACL,MACCD,gDAAmD,KAAK,SAAS,KAAK,mCAAmC,CAAC;AAAA;AAAA;AAAA,IAAA,CAG3G;AAAA;AAAA;AAAA,EAGJ;AAmBD;AAzDaH,EAwCI,SAAS;AAAA,EACxBK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAeD;AArDAC,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,SAAS,IAAO;AAAA,GAF9BP,EAGZ,WAAA,SAAA,CAAA;AAGAM,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,SAAS,IAAO;AAAA,GAL9BP,EAMZ,WAAA,QAAA,CAAA;AAGAM,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,WAAW,IAAO;AAAA,GARhCP,EASZ,WAAA,SAAA,CAAA;AAGAM,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAS,SAAS,IAAM;AAAA,GAX9BP,EAYZ,WAAA,eAAA,CAAA;AAGAM,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GAdlBP,EAeZ,WAAA,WAAA,CAAA;AAGAM,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GAjBlBP,EAkBZ,WAAA,YAAA,CAAA;AAGAM,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GApBlBP,EAqBZ,WAAA,UAAA,CAAA;AArBYA,IAANM,EAAA;AAAA,EADNE,EAAc,oBAAoB;AAAA,GACtBR,CAAA;;;;;;;gZCRbS,GAAAC,GAAAC,GAAAC,IAAAC,IAAAC;AAeO,IAAMC,IAAN,cAA8Dd,EAAiD;AAAA,EAerH,cAAc;AACb,UAAA,GAhBKe,GAAA,MAAAL,CAAA,GAIN,KAAQ,iBAAiB,IAQzBK,GAAA,MAAAP,CAAA,GACAO,GAAA,MAAAN,GAAuB,IAAIO,GAAuC,IAAI,CAAA,GAKrEC,EAAA,MAAKR,CAAA,EAAqB,UAAU,EAAI,GACxCQ,EAAA,MAAKR,CAAA,EAAqB,sBAAsB,KAAK,GACrD,KAAK,QAAQQ,EAAA,MAAKR,CAAA,EAAqB,iBAAiB,CAACS,MAAS;AACjE,WAAK,QAAQA,GACbC,EAAA,MAAKT,GAAAE,EAAA,EAAL,KAAA,IAAA;AAAA,IACD,CAAC,GAID,KAAK,eAAeQ,IAA6B,CAACC,MAAY;AAC7DC,MAAAA,GAAA,MAAKd,GAAkBa,CAAA,GACvBJ,EAAA,MAAKR,CAAA,EAAqB,oBAAoBY,GAAS,QAAQ,SAAS,GAExEF,EAAA,MAAKT,GAAAC,EAAA,EAAL,KAAA,IAAA;AAAA,IACD,CAAC;AAAA,EACF;AAAA,EAiCS,SAAS;AACjB,QAAK,KAAK;AAEV,aAAOT;AAAA,KACJ,KAAK,MAAM,SAAS,KAAM,KAAK,MAAM,WAAW,KAAK,KAAK,iBACzDA;AAAA,QACE,KAAK,kBAAkB,KAAK,MAAM,SAAS,IAC1CA;AAAA,iBACQ,KAAK,SAAS,KAAK,iBAAiB,CAAC;AAAA,mBACnC,KAAK,kBAAkB,IAAI;AAAA,kBAC5B,MAAMiB,EAAA,MAAKT,GAAAG,EAAA,EAAL,KAAA,MAAgB,IAAA,CAAK;AAAA;AAAA,aAGpCU,CAAO;AAAA,QACRC;AAAA,QACD,KAAK;AAAA,QACL,CAACC,MAAQA,EAAI;AAAA,QACb,CAACA,MAAQ;AACR,gBAAMC,IAASD,EAAI,WAAWA,EAAI,IAAI,CAAC;AAEvC,iBAAOvB;AAAA,iBACE,KAAK,SAAS,OAAOuB,EAAI,QAAQ,kBAAkB,CAAC;AAAA,mBAClD,KAAK,kBAAkBC,CAAM;AAAA,kBAC9B,MAAMP,EAAA,MAAKT,GAAAG,EAAA,EAAL,KAAA,MAAgBa,CAAA,CAAO;AAAA,YACnCD,EAAI,IAAI;AAAA;AAAA,QAEb;AAAA,MAAA,CACA;AAAA,yBAEDF,CAAO;AAAA,KACR,KAAK,kBAAkB,SACtBrB;AAAA,qBACe,SAAS;AAAA,yBACL,EAAI;AAAA,qBACR,KAAK,aAAa;AAAA,6CAEjCqB,CAAO;AAAA;AAAA,EAEZ;AAeD;AA3GCf,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAbMC,IAAA,oBAAA,QAAA;AAmCAC,KAAkB,iBAAG;AAC1B,EAAKM,QAAKT,CAAA,KAEV,KAAK;AAAA,IACJ,MAAMS,EAAA,MAAKT,CAAA,EAAgB,QAAQ,UAAU,kBAAkB,OAAO;AAAA,IACtE,CAACmB,MAAkB;AAClB,WAAK,iBAAiBA,GACtBR,EAAA,MAAKT,GAAAE,EAAA,EAAL,KAAA,IAAA;AAAA,IACD;AAAA,IACA;AAAA,EAAA;AAEF;AAEAA,KAAoB,WAAG;AACtB,MAAI,GAAC,KAAK,SAAS,CAACK,QAAKT,CAAA,MAGrB,KAAK,kBAAkB;AAC1B,QAAI,KAAK;AACR,WAAK,gBAAgB;AAAA,aACX,KAAK,MAAM,SAAS,GAAG;AACjC,YAAMiB,IAAM,KAAK,MAAM,CAAC;AACxB,WAAK,gBAAgBA,EAAI,WAAWA,EAAI,IAAI,CAAC;AAAA,IAC9C;AAAA;AAEF;AAEAZ,KAAU,SAACa,GAAmC;AAC7C,OAAK,gBAAgBA;AACtB;AAhEYZ,EA0GI,SAAS;AAAA,EACxBc;AAAA,EACAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUD;AAlHQC,GAAA;AAAA,EADPwB,EAAA;AAAM,GAHKf,EAIJ,WAAA,kBAAA,CAAA;AAGAT,GAAA;AAAA,EADPwB,EAAA;AAAM,GANKf,EAOJ,WAAA,SAAA,CAAA;AAGAT,GAAA;AAAA,EADPwB,EAAA;AAAM,GATKf,EAUJ,WAAA,iBAAA,CAAA;AAVIA,IAANT,GAAA;AAAA,EADNE,EAAc,iDAAiD;AAAA,GACnDO,CAAA;;;;;;;+XCfbgB,IAAAC,GAAAC,GAAAC,GAAAC,IAAAC,IAAAC,IAAAC;AAaA,MAAMC,KAAgE,CAACC,MAC/D,CAAC,EAAE,UAAAA,GAAU;AAOd,IAAMC,IAAN,cAAwCxC,EAAc;AAAA,EAmC5D,cAAc;AACb,UAAA,GApCKe,EAAA,MAAAkB,CAAA,GACNlB,EAAA,MAAAe,EAAA,GACAf,EAAA,MAAAgB,CAAA,GACAhB,EAAA,MAAAiB,CAAA,GAwBA,KAAQ,UAAU,IAgFlBjB,EAAA,MAAAoB,IAAU,MAAM;AACflB,MAAAA,EAAA,MAAKc,IAAmB,OAAA;AAAA,IACzB,CAAA,GAvEC,KAAK,eAAeU,IAA8B,CAACC,MAAiB;AACnEpB,MAAAA,GAAA,MAAKQ,IAAgBY,CAAA,GACrB,KAAK;AAAA,QACJzB,QAAKa,EAAA,GAAe;AAAA,QACpB,CAACa,MAAe;AACfrB,UAAAA,GAAA,MAAKU,GAAcW,CAAA,GACnBxB,EAAA,MAAKc,GAAAC,EAAA,EAAL,KAAA,IAAA;AAAA,QACD;AAAA,QACA;AAAA,MAAA;AAAA,IAEF,CAAC,GAED,IAAIU;AAAA,MACH;AAAA,MACAC;AAAA,MACAC;AAAA,MACAR;AAAA,MACA,CAACS,GAAWC,MAAS;AACpB,cAAM3B,IAAU2B,EAAK;AACrB,QAAID,KAAa1B,MAChBC,GAAA,MAAKS,GAAoBV,CAAA,GACzBJ,EAAA,MAAKc,GAAkB,kBAAA,GACvBZ,EAAA,MAAKc,GAAAC,EAAA,EAAL,KAAA,IAAA,GAEA,KAAK;AAAA,UACJjB,QAAKc,CAAA,EAAkB;AAAA,UACvB,CAACkB,MAAY;AACZ,iBAAK,WAAWA;AAAA,UACjB;AAAA,UACA;AAAA,QAAA,GAGD,KAAK;AAAA,UACJ5B,EAAQ,QAAQ,UAAU;AAAA,UAC1B,CAAC6B,MAAS;AACT,iBAAK,wBAAwBA;AAAA,UAC9B;AAAA,UACA;AAAA,QAAA,GAGD,KAAK;AAAA,UACJ7B,EAAQ;AAAA,UACR,OAAO8B,MAAc;AACpB,gBAAIA,GAAW;AACd,cAAA9B,EAAQ,QAAQ,MAAM,MAAM8B,CAAS;AAErC,oBAAMC,IAAUD,EAAU;AAC1B,kBAAIC,GAAS;AACZ,sBAAMC,IAAqB,IAAIC,GAA0B,IAAI,GACvD,EAAE,MAAAxE,MAAS,MAAMuE,EAAmB,aAAa,CAACD,CAAO,CAAC,GAC1DF,IAAOpE,IAAO,CAAC,EAAE;AACvB,qBAAK,eAAeoE,IAAO,KAAK,SAAS,OAAOA,CAAI,IAAI;AAAA,cACzD;AAAA,YACD;AAAA,UACD;AAAA,UACA;AAAA,QAAA,GAGD,IAAIK,GAA4B,MAAMV,IAAuB,oBAAoB,CAAC5B,EAAA,MAAKc,EAAiB,CAAC;AAAA,MAE3G;AAAA,IAAA;AAAA,EAEF;AAAA,EAWS,SAAS;AACjB,WAAO7B;AAAA;AAAA;AAAA;AAAA;AAAA,gBAKO,CAACsD,MAAqB;AAChC,MAAIA,EAAE,QAAQ,OAAOA,EAAE,QAAQ,YAC/BA,EAAE,eAAA,GACFA,EAAE,gBAAA,GACF,KAAK,UAAU,CAAC,KAAK;AAAA,IACtB,CAAC;AAAA,cACQ,MAAM;AACd,WAAK,UAAU,CAAC,KAAK;AAAA,IACtB,CAAC;AAAA,gCAC0B,KAAK,OAAO;AAAA,OACrCrC,EAAA,MAAKc,OAAL,KAAA,IAAA,CAAuB;AAAA;AAAA;AAAA;AAAA,MAIxB,KAAK,YAAY,KAAOd,EAAA,MAAKc,GAAAI,EAAA,EAAL,aAAuBd,CAAO;AAAA;AAAA;AAAA,EAG3D;AAiKD;AAtSCO,KAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAHMC,IAAA,oBAAA,QAAA;AAsGNC,KAAK,WAAG;AACP,EAAI,CAACjB,EAAA,MAAKc,CAAA,KAAqB,CAACd,QAAKe,CAAA,KACrCf,EAAA,MAAKc,CAAA,EAAkB,KAAKd,EAAA,MAAKe,CAAA,CAAW;AAC7C;AAEAG,KAAA,oBAAA,QAAA;AA6BAC,KAAgB,WAAG;AAClB,QAAMnC,IAAa,EAAE,GAAG,KAAK,SAAS,WAAW,KAAK,UAAU,QAAQ,KAAK,MAAA;AAC7E,SAAOC;AAAA;AAAA;AAAA,uBAGc,KAAK,IAAI;AAAA;AAAA;AAAA,kDAGkB,KAAK,KAAK,WAAWD,CAAU;AAAA;AAAA;AAAA,KAG5EE;AAAA,IACD,KAAK;AAAA,IACL,MACCD,gDAAmD,KAAK,SAAS,KAAK,mCAAmC,CAAC;AAAA;AAAA;AAAA,EAAA,CAG3G;AAAA;AAEH;AAEAmC,KAAa,WAAG;AACf,SAAI,KAAK,aAAa,KACdnC,2DAA8De,QAAKkB,EAAA,CAAO;AAAA;AAAA;AAAA;AAAA,aAIvE,CAAC,KAAK,uBAAuB,KAAK,YAAY,CAAC;AAAA,qBAGlDjC;AAAA;AAGT;AAzKYsC,EA2KI,SAAS;AAAA,EACxBZ;AAAA,EACAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyHD;AAhSAC,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,SAAS,IAAO;AAAA,GAL9BkC,EAMZ,WAAA,SAAA,CAAA;AAGAnC,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,SAAS,IAAO;AAAA,GAR9BkC,EASZ,WAAA,QAAA,CAAA;AAGAnC,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAQ,WAAW,IAAO;AAAA,GAXhCkC,EAYZ,WAAA,SAAA,CAAA;AAGAnC,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAS,SAAS,IAAM;AAAA,GAd9BkC,EAeZ,WAAA,eAAA,CAAA;AAGAnC,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GAjBlBkC,EAkBZ,WAAA,WAAA,CAAA;AAGAnC,EAAA;AAAA,EADCC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GApBlBkC,EAqBZ,WAAA,YAAA,CAAA;AAGQnC,EAAA;AAAA,EADPwB,EAAA;AAAM,GAvBKW,EAwBJ,WAAA,YAAA,CAAA;AAGAnC,EAAA;AAAA,EADPwB,EAAA;AAAM,GA1BKW,EA2BJ,WAAA,WAAA,CAAA;AAGAnC,EAAA;AAAA,EADPwB,EAAA;AAAM,GA7BKW,EA8BJ,WAAA,yBAAA,CAAA;AAGAnC,EAAA;AAAA,EADPwB,EAAA;AAAM,GAhCKW,EAiCJ,WAAA,gBAAA,CAAA;AAjCIA,IAANnC,EAAA;AAAA,EADNE,EAAc,uBAAuB;AAAA,GACzBiC,CAAA;;;;;;;oPCrBbiB,IAAArB;AAQO,IAAMsB,KAAN,cAA6C1D,EAAc;AAAA,EAA3D,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAe,GAAA,MAAA0C,EAAA;AAAA,EAAA;AAAA,EACG,SAAS;AACjB,WAAOvD;AAAA;AAAA;AAAA,OAGFiB,GAAA,MAAKsC,QAAL,KAAA,IAAA,CAAuB;AAAA;AAAA;AAAA;AAAA,yCAIW,KAAK,SAAS,KAAK,yCAAyC,CAAC;AAAA;AAAA;AAAA,EAGrG;AAkID;AA9IOA,KAAA,oBAAA,QAAA;AAcNrB,KAAgB,WAAG;AAClB,SAAOlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAMc,KAAK,SAAS,KAAK,kCAAkC,CAAC;AAAA;AAAA;AAAA;AAI5E;AAzBYwD,GA2BI,SAAS;AAAA,EACxB9B;AAAA,EACAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgHD;AA7IYsD,KAANrD,GAAA;AAAA,EADNE,EAAc,4BAA4B;AAAA,GAC9BmD,EAAA;;;;;;;oUCRbC,GAAAC,GAAAC,GAAAC,IAAAC,IAAA5B,IAAA6B,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC,IAAAC;AA8BO,IAAMC,IAAN,cAAuC7E,EAAoD;AAAA,EA0FjG,cAAc;AACb,UAAA,GA3FKe,EAAA,MAAA6C,CAAA,GA8BN7C,EAAA,MAAA4C,GAAW,IAAIpE,GAAyB,IAAI,CAAA,GAS5C,KAAQ,mBAAmB,IAG3B,KAAQ,eAAe,IAGvB,KAAQ,SAAS,IAgCjB,KAAQ,kBAA+E;AAAA,MACtF,YAAY;AAAA,MACZ,QAAQ,EAAE,iBAAiB,IAAO,kBAAkB,GAAA;AAAA,IAAM,GAS3D,KAAQ,cAAc,IAmLtBwB,EAAA,MAAAoB,IAAU,MAAM;AACflB,MAAAA,EAAA,MAAK0C,GAAS,OAAA;AAAA,IACf,CAAA,GAwCA5C,EAAA,MAAAkD,IAA6B,CAAC1B,MACzB,OAAK,gBAMRA,EAAS,uBACT,CAACuC,GAA4BvC,EAAS,qBAAqB,KAAK,iBAAkB,KAI/EA,EAAS,kBAAkB,CAACuC,GAA4BvC,EAAS,gBAAgBwC,EAAc,EAIpG,GAEAhE,EAAA,MAAAmD,IAA6B,CAACc,OAC7BA,EAAI,WAAW,aAAa,QAAQ,WAAW,GAC3C,KAAK,WACDA,EAAI,YAEJ9E;AAAA,MACJ8E,EAAI,SAAS;AAAA;AAAA,wBAEK,KAAK,gBAAgB;AAAA,cAC/B/D,QAAKkB,EAAA,CAAO;AAAA,WAGzB,GAkCApB,EAAA,MAAAuD,IAA0B,MACrB,KAAK,eACDnD,QAAKyC,GAAAS,EAAA,EAAL,KAAA,IAAA,IAEJ,KAAK,qBACDlD,QAAKyC,GAAAQ,EAAA,EAAL,KAAA,IAAA,IAEDjD,QAAKyC,GAAAO,EAAA,EAAL,KAAA,IAAA,CACR,GAjSChD,EAAA,MAAKyC,GAAAE,EAAA,EAAL,KAAA,IAAA;AAAA,EACD;AAAA,EA3FA,IAAW,MAAMjF,GAA2B;AAC3CoC,IAAAA,EAAA,MAAK0C,CAAA,EAAS,SAAS9E,CAAK;AAAA,EAC7B;AAAA,EACA,IAAW,QAA4B;AACtC,WAAOoC,EAAA,MAAK0C,GAAS,SAAA;AAAA,EACtB;AAAA,EAGA,IAAW,WAAW9E,GAA2B;AAChD,IAAKA,MACL,KAAK,cAAcA,GACnBoC,EAAA,MAAK0C,CAAA,EAAS,cAAc9E,CAAK,GAEjC,IAAIoG;AAAA,MACH;AAAA,MACA,iBAAiBC,GAAiC,EAAE,KAAKrG,EAAA,CAAO,CAAC;AAAA,MACjE,CAACsG,MAAgB;AAChB,aAAK,kBAAkBA,GACvB,KAAK,gBAAgB,iBAAiBA;AAAA,MACvC;AAAA,MACA;AAAA,IAAA;AAAA,EAEF;AAAA,EACA,IAAW,aAAiC;AAC3C,WAAO,KAAK;AAAA,EACb;AAAA,EAiNS,oBAA0B;AAClC,UAAM,kBAAA,GAEN,KAAK;AAAA,MACJlE,QAAK0C,CAAA,EAAS;AAAA,MACd,CAACxG,MAA0B;AAC1B,QAAIA,KACH,KAAK,aAAa,iCAAiCA,CAAqB;AAAA,MAE1E;AAAA,MACA;AAAA,IAAA,GAED,KAAK;AAAA,MACJ8D,QAAK0C,CAAA,EAAS;AAAA,MACd,CAACyB,MAA4B;AAC5B,QAAIA,MACH,KAAK,oBAAoBA,GACzB,KAAK,aAAa,mCAAmCA,CAAuB;AAAA,MAE9E;AAAA,MACA;AAAA,IAAA,GAED,KAAK;AAAA,MACJnE,QAAK0C,CAAA,EAAS;AAAA,MACd,CAAC0B,MAA2B;AAC3B,aAAK,mBAAmBA;AAAA,MACzB;AAAA,MACA;AAAA,IAAA;AAAA,EAEF;AAAA,EAwMS,SAAS;AACjB,WAAOlE,QAAKyC,GAAAW,EAAA,EAAL,KAAA,IAAA;AAAA,EACR;AA4FD;AAjhBCZ,IAAA,oBAAA,QAAA;AA9BMC,IAAA,oBAAA,QAAA;AAkFNC,IAAqB,SAACyB,GAAgF;AACrG,OAAK,kBAAkB,EAAE,GAAG,KAAK,iBAAiB,GAAGA,EAAA,GACrD,KAAK,cAAc,iBAAiB;AACrC;AASAxB,KAAK,WAAG;AACP,OAAK;AAAA,IACJ7C,QAAK0C,CAAA,EAAS;AAAA,IACd,CAAC4B,MAAoB;AACpB,WAAK,mBAAmBA,GACxBpE,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,QAAQ,EAAE,GAAG,KAAK,gBAAgB,QAAS,iBAAA0B,EAAA,EAAgB,CAAE;AAAA,IAC3F;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJtE,QAAK0C,CAAA,EAAS;AAAA,IACd,CAAC6B,MAAQ;AACR,WAAK,eAAe,CAAC,CAACA,GACtBrE,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,QAAQ,EAAE,GAAG,KAAK,gBAAgB,QAAS,kBAAkB,CAAC,CAAC2B,KAAM;AAAA,IACnG;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJvE,QAAK0C,CAAA,EAAS;AAAA,IACd,CAAC8B,MAAc;AACdtE,MAAAA,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,WAAA4B,GAAU;AAAA,IACxC;AAAA,IACA;AAAA,EAAA,GAED,KAAK,QAAQxE,EAAA,MAAK0C,CAAA,EAAS,OAAO,CAAC1F,MAAUkD,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,OAAA5F,EAAA,CAAM,GAAI,IAAI,GACxF,KAAK;AAAA,IACJgD,QAAK0C,CAAA,EAAS;AAAA,IACd,CAAC+B,MAAU;AACVvE,MAAAA,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,OAAA6B,GAAM,GACnC,KAAK,SAASA;AAAA,IACf;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJzE,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACgC,MAAS;AACTxE,MAAAA,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,MAAA8B,GAAK,GAClC,KAAK,QAAQA;AAAA,IACd;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJ1E,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACV,MAAY;AACZ9B,MAAAA,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,aAAa,CAACZ,GAAQ,GACnD,KAAK,WAAWA;AAAA,IACjB;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJhC,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACiC,MAAgB;AAChB,MAAIA,MAAgB,WACpBzE,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,aAAA+B,GAAyB,GACtD,KAAK,eAAeA,GACpB,KAAK,gBAAgB,eAAeA,CAAW;AAAA,IAChD;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJ3E,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACkC,MAAgB;AAChB,WAAK,eAAeA;AAAA,IACrB;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJ5E,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACmC,MAAS;AACT,WAAK,qBAAqBA;AAAA,IAC3B;AAAA,IACA;AAAA,EAAA,GAGD,KAAK;AAAA,IACJ7E,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACoC,MAAW;AACX5E,MAAAA,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,QAAAkC,GAAO;AAAA,IACrC;AAAA,IACA;AAAA,EAAA,GAED5E,EAAA,MAAKyC,GAAAG,EAAA,EAAL,KAAA,IAAA,GAEA,KAAK;AAAA,IACJ9C,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACqC,MAAgB;AAChB,WAAK,2BAA2B,4BAA4B,GACxDA,KAEH,IAAIf;AAAA,QACH;AAAA,QACA,kBAAkBC,GAAiC,EAAE,KAAKc,EAAA,CAAa,CAAC;AAAA,QACxE,CAACb,MAAgB;AAChB,eAAK,mBAAmBA,GACxB,KAAK,gBAAgB,kBAAkBA;AAAA,QACxC;AAAA,QACA;AAAA,MAAA;AAAA,IAGH;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJlE,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACsC,MAAS;AACT,WAAK,4BAA4BA,GACjC9E,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,QAAQ,EAAE,GAAG,KAAK,gBAAgB,QAAS,iBAAiBoC,EAAA,GAAO;AAAA,IACjG;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJhF,QAAK0C,CAAA,EAAS;AAAA,IACd,CAACsC,MAAS;AACT,WAAK,6BAA6BA,GAClC9E,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,QAAQ,EAAE,GAAG,KAAK,gBAAgB,QAAS,kBAAkBoC,EAAA,GAAO;AAAA,IAClG;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJhF,EAAA,MAAK0C,GAAS,cAAc;AAAA,IAC5B,CAACuC,MAAgB,KAAK,cAAcA;AAAA,IACpC;AAAA,EAAA;AAEF;AAEMnC,KAAY,iBAAG;AACpB,OAAK;AAAA,IACJ,MAAM9C,EAAA,MAAK0C,CAAA,EAAS,cAAA;AAAA,IACpB,CAACpG,MAAY;AACZ4D,MAAAA,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,SAAAtG,GAAQ;AAAA,IACtC;AAAA,IACA;AAAA,EAAA,GAED,KAAK;AAAA,IACJ,MAAM0D,EAAA,MAAK0C,CAAA,EAAS,eAAA;AAAA,IACpB,CAACnG,MAAa;AACb2D,MAAAA,EAAA,MAAKyC,GAAAC,CAAA,EAAL,KAAA,MAA2B,EAAE,UAAArG,GAAS;AAAA,IACvC;AAAA,IACA;AAAA,EAAA;AAEF;AAiCA2E,KAAA,oBAAA,QAAA;AAIM6B,KAAgB,iBAAG;AACxB,QAAMmC,IAAyB,MAAM,KAAK,WAAWC,EAA4B,GAC3E9H,IAAkB,MAAM,KAAK,WAAWC,EAAoB,GAC5DL,IAAmB,MAAM,KAAK,WAAWC,EAA8B;AAC7E,MAAI,CAACgI,KAA0B,CAAC7H,KAAmB,CAACJ;AACnD,UAAM,IAAI,MAAM,0CAA0C;AAG3D,QAAMmI,IAAgBF,GAAwB,QAAA,GACxCG,IAAgBhI,GAAiB,SAAA,GACjCiI,IAAatF,EAAA,MAAK0C,CAAA,EAAS,QAAA,GAE3B6C,IAAYH,IACf,GAAGA,CAAa,MAAMC,CAAa,MAAMC,CAAU,KACnD,GAAGD,CAAa,MAAMC,CAAU,IAE7BhJ,IAAU0D,EAAA,MAAK0C,CAAA,EAAS,WAAA,GACxBoC,IAAS9E,EAAA,MAAK0C,CAAA,EAAS,UAAA,GACvBnG,IAAWyD,EAAA,MAAK0C,CAAA,EAAS,YAAA,GACzB8C,KAASxF,EAAA,MAAK0C,CAAA,EAAS,UAAA,GAEvB+C,IAAwC;AAAA,IAC7C,aAAanJ,IAAU,CAAC,gBAAgBA,CAAO,CAAC,IAAI,CAAA;AAAA,IACpD,QAAQ;AAAA,MACP,CAAC+B,EAA2C,GAAGyG,IAAS,CAAC,gBAAgBA,CAAM,CAAC,IAAI;AAAA,IAAA;AAAA,IAErF,cAAcvI,IAAW,CAAC,gBAAgBA,CAAQ,CAAC,IAAI,CAAA;AAAA,IACvD,QAAQiJ,KAAS,CAAC,gBAAgBA,EAAM,CAAC,IAAI,CAAA;AAAA,EAAC;AAG/C,EAAAvI,EAAiB,MAAM;AAAA,IACtB,MAAM,KAAK;AAAA,IACX,MAAMsI;AAAA,IACN,eAAAE;AAAA,IACA,uBAAuBrI;AAAA,EAAA,CACvB;AACF;AAEA4F,KAAA,oBAAA,QAAA;AAkBAC,KAAA,oBAAA,QAAA;AAcAC,KAAe,WAAG;AACjB,SAAOjE;AAAA,YACG,KAAK,MAAM;AAAA,WACZ,KAAK,KAAK;AAAA,YACT,KAAK,gBAAgB,KAAK;AAAA,kBACpB,CAAC,KAAK,QAAQ;AAAA,aACnB,KAAK,gBAAgB,MAAM;AAAA,cAC1B,KAAK,gBAAgB,OAAO;AAAA,eAC3B,KAAK,gBAAgB,QAAQ;AAAA,KACvCyG,IAAwB;AAC5B;AAEAvC,KAAkB,WAAG;AACpB,SAAOlE;AAAA,YACG,KAAK,MAAM;AAAA,WACZ,KAAK,KAAK;AAAA,YACT,KAAK,gBAAgB,KAAK;AAAA,kBACpB,CAAC,KAAK,QAAQ;AAAA,aACnB,KAAK,gBAAgB,MAAM;AAAA,cAC1B,KAAK,gBAAgB,OAAO;AAAA,eAC3B,KAAK,gBAAgB,QAAQ;AAAA,KACvCyG,IAAwB;AAC5B;AAEAtC,KAAuB,WAAG;AACzB,SAAOnE;AAAA,aACI,KAAK,gBAAgB,MAAM;AAAA,cAC1B,KAAK,gBAAgB,OAAO;AAAA,eAC3B,KAAK,gBAAgB,QAAQ;AAAA,KACvCyG,IAAwB;AAC5B;AAEArC,KAAA,oBAAA,QAAA;AAUAC,KAAY,WAAG;AACd,SAAO,KAAK,eAAe,KAAK,qBAAqB,KAAK,gBACvDrE;AAAA;AAAA;AAAA;AAAA,yBAIoB,KAAK,qBAAqB,0BAA0B,oBAAoB;AAAA,uBAC1Ee,QAAKiD,EAAA,CAA0B;AAAA,+BACvBjD,QAAKqD,EAAA,CAAuB;AAAA,gBAC3C,KAAK,eAAe;AAAA,iBACnBrD,QAAKgD,EAAA,CAA0B;AAAA;AAAA,QAExC9C,EAAA,MAAKyC,OAAL,KAAA,IAAA,CAAuB;AAAA,QACvB,CAAC,KAAK,oBAAoB,KAAK,kBAC9B1D,gFACAqB,CAAO;AAAA;AAAA,QAGXA;AACJ;AAEAiD,KAAgB,WAAG;AAClB,SAAO,KAAK,eACTtE;AAAA,OACEiB,EAAA,MAAKyC,GAAAa,EAAA,EAAL,KAAA,IAAA,CAA+B,IAAItD,EAAA,MAAKyC,OAAL,KAAA,IAAA,CAAgC,IAAIzC,EAAA,MAAKyC,GAAAgB,EAAA,EAAL,KAAA,IAAA,CAAmC;AAAA,OAC1GzD,EAAA,MAAKyC,OAAL,KAAA,IAAA,CAA0B;AAAA,yBAE5BrC;AACJ;AAEAkD,KAAwB,WAAG;AAC1B,SAAO,KAAK,oBAAoB,KAAK,4BAClCvE;AAAA;AAAA;AAAA,aAGQ,KAAK,kBAAkB,YAAY,EAAE;AAAA,YACtC,KAAK,yBAAyB;AAAA,sBACpB,KAAK,aAAa,MAAS,KAAK,gBAAgB,KAAQ,aAAa,WAAW;AAAA,OAC/F,KAAK,kBACJA,gFACAqB,CAAO;AAAA,qBAEV,KAAK,qBAAqB,MAAS,KAAK,aAAa,KACpDrB;AAAA,eACSe,QAAKkB,EAAA,CAAO;AAAA,cACb,KAAK,SAAS,KAAK,6BAA6B,KAAK,gBAAgB,CAAC;AAAA;AAAA;AAAA,uBAI9EZ;AACL;AAEAmD,KAAyB,WAAG;AAC3B,SAAOxE;AAAA,KACJ,KAAK,gBAAgB,KAAK,6BACzBA;AAAA;AAAA;AAAA,cAGQ,KAAK,mBAAmB,YAAY,EAAE;AAAA,aACvC,KAAK,0BAA0B;AAAA;AAAA,QAEpC,KAAK,mBACJA,iFACAqB,CAAO;AAAA,sBAEVA,CAAO;AAAA;AAEZ;AAEAoD,KAAmB,WAAG;AACrB,SAAI,KAAK,cAAoBpD,IACtBrB,wDAA2D,MAAMe,EAAA,MAAK0C,CAAA,EAAS,eAAe;AAAA;AAAA;AAGtG;AAEAiB,KAA4B,WAAG;AAC9B,SAAO1E,kEAAqE,MAAMiB,EAAA,MAAKyC,GAAAI,EAAA,EAAL,KAAA,IAAA,CAAuB;AAAA;AAAA;AAG1G;AA/cYa,EAqdI,SAAS;AAAA,EACxB+B;AAAA,EACAxG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAuEeyG,EAAsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgBtC;AA5iBWxG,EAAA;AAAA,EADVC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GADduE,EAED,WAAA,SAAA,CAAA;AAQAxE,EAAA;AAAA,EADVC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GATlBuE,EAUD,WAAA,cAAA,CAAA;AAuBHxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAhCKgD,EAiCJ,WAAA,qBAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAnCKgD,EAoCJ,WAAA,oBAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAtCKgD,EAuCJ,WAAA,oBAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAzCKgD,EA0CJ,WAAA,gBAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GA5CKgD,EA6CJ,WAAA,UAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GA/CKgD,EAgDJ,WAAA,SAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAlDKgD,EAmDJ,WAAA,YAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GArDKgD,EAsDJ,WAAA,gBAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAxDKgD,EAyDJ,WAAA,gBAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GA3DKgD,EA4DJ,WAAA,6BAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GA9DKgD,EA+DJ,WAAA,8BAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAjEKgD,EAkEJ,WAAA,sBAAA,CAAA;AAIAxE,EAAA;AAAA,EADPC,EAAS,EAAE,MAAM,SAAS,WAAW,mBAAmB,SAAS,IAAM;AAAA,GArE5DuE,EAsEJ,WAAA,mBAAA,CAAA;AAIAxE,EAAA;AAAA,EADPC,EAAS,EAAE,MAAM,SAAS,WAAW,oBAAoB,SAAS,IAAM;AAAA,GAzE7DuE,EA0EJ,WAAA,oBAAA,CAAA;AAGAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GA5EKgD,EA6EJ,WAAA,mBAAA,CAAA;AAWAxE,EAAA;AAAA,EADPwB,EAAA;AAAM,GAvFKgD,EAwFJ,WAAA,eAAA,CAAA;AAxFIA,IAANxE,EAAA;AAAA,EADNE,EAAc,sBAAsB;AAAA,GACxBsE,CAAA;;;;;;;geC9BbiC,GAAAC,GAAAC,IAAAC,GAAAC,GAAAC,GAAAC,GAAAC,IAAAC,IAAAC,IAAAC,IAAAC;AA+BA,MAAMC,KAAoF;AAAA,EACzF,oBAAoB,CAACC,MACbA,EAAQ;AAAA,EAEhB,kBAAkB,CAACC,MACXA,EAAW;AAAA;AAAA,EAGnB,cAAc;AAAA;AAEf;AAGO,IAAMC,IAAN,cACEC,GAAyF9H,CAAa,EAE/G;AAAA,EAuHC,cAAc;AACb,UAAA,GA3HKe,EAAA,MAAAqG,CAAA,GAINrG,EAAA,MAAS+F,GAAU,IAAIiB,GAAuE,MAAM;AAAA,MACnG,GAAGL;AAAA,MACH,UAAU,CAAC,EAAE,OAAAM,QAAY;AACxB,QAAA/G,EAAA,MAAKkG,CAAA,EAAgB,WAAWa,CAAK;AAAA,MACtC;AAAA,IAAA,CACA,CAAA,GAEDjH,EAAA,MAASgG,GAAqB,IAAIkB,GAAqB,IAAI,CAAA,GAE3DlH,EAAA,MAAAiG,EAAA,GA4BA,KAAQ,qBAAqB,KAAK,SAAS,KAAK,qBAAqB,GAqDrEjG,EAAA,MAAAkG,GAAY,EAAA,GAiBZ,KAAQ,WAA2C,CAAA,GAKnDlG,EAAA,MAASmG,GAAkB,IAAIpK,GAA2B,IAAI,CAAA,GAC9DiE,EAAA,MAASoG,GAAkB,IAAIzJ,GAA2B,IAAI,CAAA,GAQ7D,KAAK,eAAewK,IAA+B,CAAC7G,MAAY;AAC/D,MAAIA,IACH,KAAK;AAAA,QACJ8G,GAAgB;AAAA,UACflH,QAAKiG,CAAA,EAAgB;AAAA,UACrB7F,EAAQ,UAAU;AAAA,UAClBA,EAAQ,UAAU;AAAA,QAAA,CAClB;AAAA,QACD,OAAO,CAAC+G,GAAYC,GAAiBC,CAAe,MAAM;AACzD,cAAIF,EAAW,SAAS,MAAMC,MAAoB,MAASC,MAAoB,KAAQ;AAEtF,kBAAMC,IAAW,MAAM,QAAQ;AAAA,cAC9BH,EAAW,IAAI,OAAO3C,MAAc;AACnC,sBAAM+C,IAAc/C,EAAU;AAC9B,sBAAMxE,QAAKiG,CAAA,EAAgB;AAC3B,sBAAMuB,IAAY,MAAMxH,EAAA,MAAKiG,CAAA,EAAgB,aAAasB,CAAW;AACrE,uBAAIH,MAAoB,MAASI,GAAW,mBAAA,MAAyB,KAE7D,KACGH,MAAoB,MAASG,GAAW,mBAAA,MAAyB;AAAA,cAK7E,CAAC;AAAA,YAAA;AAEF,iBAAK,8BAA8BF,EAAS,OAAO,CAAC7I,MAAMA,MAAM,EAAI,EAAE,SAAS,GAE3E,KAAK,+BACRuB,EAAA,MAAK8F,GAAmB,SAAS;AAAA,cAChC;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,YAAA;AAAA,UAGH;AAAA,QACD;AAAA,QACA;AAAA,MAAA,IAGD,KAAK,2BAA2B,6BAA6B;AAAA,IAE/D,CAAC,EAAE,wBAAA,GAEH,KAAK,eAAexI,IAAsB,CAAC8C,MAAY;AACtD,MAAAF,EAAA,MAAKiG,OAAL,KAAA,MAAyB/F,CAAA;AAAA,IAC1B,CAAC,GAID,KAAK;AAAA,MACJJ,QAAKiG,CAAA,EAAgB;AAAA,MACrB,CAAC9H,MAAY;AACZ,cAAMsJ,IAAuC,CAAA,GACvCC,IAAcvJ,EAAQ,IAAI,CAACM,MAAMA,EAAE,UAAU;AACnD,QAAAuB,EAAA,MAAK8F,GAAmB,SAAS,+BAA+B,eAAe,EAAE,QAAQ,CAAC6B,MAAY;AAGrG,gBAAMpD,IAAMqD,GAAsBD,EAAQ,IAAI,EAAE;AAChD,UAAIpD,KAAOmD,EAAY,QAAQnD,CAAG,MAAM,MACvCkD,EAA2B,KAAKE,EAAQ,GAAG;AAAA,QAE7C,CAAC;AAED,cAAME,IAAe1J,EAAQ,IAAI,CAACM,MAAMA,EAAE,WAAW,EAAE,OAAO,CAACA,MAAMA,MAAM,MAAS;AACpF,QAAAuB,EAAA,MAAK8F,GAAmB,SAAS,+BAA+B,gBAAgB,EAAE,QAAQ,CAAC6B,MAAY;AAGtG,gBAAMpD,IAAMqD,GAAsBD,EAAQ,IAAI,EAAE;AAChD,UAAIpD,KAAOsD,EAAa,QAAQtD,CAAG,MAAM,MACxCkD,EAA2B,KAAKE,EAAQ,GAAG;AAAA,QAE7C,CAAC,GAGD3H,EAAA,MAAK8F,CAAA,EAAmB,SAAS,oBAAoB2B,CAA0B;AAAA,MAChF;AAAA,MACA;AAAA,IAAA,GAGD,KAAK,eAAetC,IAA8B,OAAO/E,MAAY;AACpE,MAAAJ,EAAA,MAAKiG,CAAA,EAAgB,aAAa7F,GAAS,cAAc;AAAA,IAC1D,CAAC,GAED,KAAK;AAAA,MACJ;AAAA,MACA,MACC,KAAK,SAAS;AAAA,QACb;AAAA,QACA,KAAK;AAAA,SACJ,KAAK,aAAa,KAAKJ,EAAA,MAAKkG,GAAgB,UAAA;AAAA,MAAU;AAAA,MAEzD,MAAM,CAAC,CAAC,KAAK,aAAalG,EAAA,MAAKkG,CAAA,EAAgB,UAAA,IAAc,KAAK;AAAA,IAAA,GAGnE,KAAK;AAAA,MACJ;AAAA,MACA,MACC,KAAK,SAAS;AAAA,QACb;AAAA,QACA,KAAK;AAAA,QACLlG,EAAA,MAAKkG,CAAA,EAAgB,UAAA,KAAe,KAAK,aAAa;AAAA,MAAA;AAAA,MAExD,MAAM,CAAC,CAAC,KAAK,aAAalG,EAAA,MAAKkG,CAAA,EAAgB,UAAA,IAAc,KAAK;AAAA,IAAA,GAGnE,KAAK;AAAA,MACJ;AAAA,MACA,MAAM,KAAK,oBAAoB4B;AAAA,MAC/B,MAAM,CAAC,CAAC,KAAK,aAAa9H,EAAA,MAAKkG,CAAA,EAAgB,gBAAgB;AAAA,IAAA,GAGhE,KAAK;AAAA,MACJlG,QAAKkG,CAAA,EAAgB;AAAA,MACrB,CAAC/H,MAAY;AACZ,aAAK,WAAWA,GAEhB6B,EAAA,MAAK6F,CAAA,EAAQ,SAAS1H,CAAO,GAE7B6B,EAAA,MAAKiG,CAAA,EAAgB,WAAW9H,CAAO;AAAA,MACxC;AAAA,MACA;AAAA,IAAA,GAGD,KAAK;AAAA,MACJ6B,QAAKiG,CAAA,EAAgB;AAAA,MACrB,CAACkB,MAAe;AACf,aAAK,UAAUA;AAAA,MAChB;AAAA,MACA;AAAA,IAAA,GAGD,KAAK;AAAA,MACJnH,QAAKkG,CAAA,EAAgB;AAAA,MACrB,CAAClI,MAAiB;AACjB,aAAK,yBAAyBA;AAAA,MAC/B;AAAA,MACA;AAAA,IAAA;AAAA,EAEF;AAAA,EAzPA,IAAoB,MAAMJ,GAA2C;AAGpE,QAFAyC,GAAA,MAAK0F,IAAanI,CAAA,GAEd,CAACA,GAAO;AACX,YAAM,QAAQ;AACd;AAAA,IACD;AAEA,UAAMmK,IAAgDnK,IAAQ,EAAE,GAAGA,EAAA,IAAU,CAAA;AAC7E,IAAAmK,EAAa,WAAW,CAAA,GACxBA,EAAa,gBAAgB,CAAA,GAC7BA,EAAa,iBAAiB,CAAA,GAC9BA,EAAa,WAAW,CAAA,GACxB,MAAM,QAAQA,GAEd/H,EAAA,MAAKiG,CAAA,EAAgB,WAAW,MAAM,MAAM,OAAO5H,EAA2C,KAAK,EAAE,GACrG2B,EAAA,MAAKiG,CAAA,EAAgB,YAAY,MAAM,MAAM,WAAW,GACxDjG,EAAA,MAAKiG,CAAA,EAAgB,YAAY,MAAM,MAAM,YAAY,GACzDjG,EAAA,MAAKiG,CAAA,EAAgB,WAAW,MAAM,MAAM,MAAM;AAAA,EACnD;AAAA,EACA,IAAoB,QAA4C;AAC/D,WAAO,MAAM;AAAA,EACd;AAAA,EAKA,IAAW,OAAO1I,GAAuD;AACxE,QAAI,CAACA,EAAQ;AAEb,UAAMyK,IAAkBzK,EAAO,gBAAyC,iBAAiB;AAEzF,SAAK,YAAYyK,GAAiB,KAClC,KAAK,YAAYA,GAAiB;AAElC,UAAMC,IAAS1K,EAAO,gBAA8C,QAAQ,KAAK,CAAA;AACjF,IAAAyC,EAAA,MAAKiG,CAAA,EAAgB,cAAcgC,CAAM;AAEzC,UAAMC,IAA4B3K,EAAO,gBAAyB,2BAA2B;AAC7F,IAAAyC,EAAA,MAAKiG,CAAA,EAAgB,qBAAqBiC,CAAyB,GACnE,KAAK,MAAM,WAAW3K,EAAO,gBAAwB,kBAAkB,KAAK,IAI5EyC,EAAA,MAAKiG,CAAA,EAAgB,uBAAuB1I,CAAM;AAElD,UAAM4K,IAA0B5K,EAAO,gBAAwB,aAAa;AAC5E,IAAI4K,IACH,KAAK,qBAAqB,KAAK,SAAS,OAAOA,CAAuB,IAC5DF,EAAO,WAAW,KAC5BjI,EAAA,MAAKiG,CAAA,EAAgB,mBAAmB,KAAK,MAAM;AAClD,YAAMmC,IAAuBpI,EAAA,MAAKiG,CAAA,EAAgB,qBAAqBgC,EAAO,CAAC,EAAE,qBAAqB;AACtG,WAAK,qBAAqB,KAAK,SAAS,KAAK,uBAAuB,KAAK,SAAS,OAAOG,CAAoB,CAAC;AAAA,IAG/G,CAAC;AAAA,EAEH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,IAAW,SAASxK,GAAO;AAC1B,IAAAyC,GAAA,MAAK2F,GAAYpI,CAAA,GAEboC,QAAKgG,CAAA,KACRhG,EAAA,MAAK6F,GAAQ,QAAA,GACb7F,EAAA,MAAKiG,CAAA,EAAgB,cAAc,oBAAA,MAEnCjG,EAAA,MAAK6F,GAAQ,OAAA,GACb7F,EAAA,MAAKiG,CAAA,EAAgB,cAAc,uBAAA;AAAA,EAErC;AAAA,EACA,IAAW,WAAW;AACrB,WAAOjG,EAAA,MAAKgG,CAAA;AAAA,EACb;AAAA,EA0OmB,iBAAiB;AAAA,EAEpC;AAAA,EAES,SAAS;AACjB,WAAI,KAAK,8BACD1F,IAEDrB;AAAA,KACJsB;AAAA,MACD,KAAK;AAAA,MACL,CAACuE,GAAQ9H,MAAU,GAAGA,CAAK,IAAI8H,EAAO,UAAU;AAAA,MAChD,CAACA,GAAQ9H,MAAUiC;AAAA,OAChBiB,EAAA,MAAKiG,GAAAG,EAAA,EAAL,KAAA,MAA+BtJ,CAAA,CAAM;AAAA;AAAA,cAE9BA,CAAK;AAAA,oBACC8H,EAAO,UAAU;AAAA,gBACrBA,CAAM;AAAA,QACdY,IAAwB;AAAA;AAAA;AAAA,IAAA,CAG5B;AAAA,KACCxF,EAAA,MAAKiG,OAAL,KAAA,IAAA,CAA+B;AAAA;AAAA,EAEnC;AAoED;AA/ZUN,IAAA,oBAAA,QAAA;AAOAC,IAAA,oBAAA,QAAA;AAETC,KAAA,oBAAA,QAAA;AAiFAC,IAAA,oBAAA,QAAA;AAsBSC,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AArHHC,IAAA,oBAAA,QAAA;AA2QNC,KAAmB,SAAChG,GAAuD;AAC1E,OAAK;AAAA,IACJA,GAAS;AAAA,IACT,CAACiI,MAAa;AACb,MAAIA,MAEHrI,EAAA,MAAK8F,CAAA,EAAmB,YAAYuC,CAAQ,GAC5CrI,EAAA,MAAK8F,GAAmB,WAAA;AAAA,IAE1B;AAAA,IACA;AAAA,EAAA,GAGD,KAAK;AAAA,IACJ1F,GAAS;AAAA,IACT,CAACkI,MAAU;AACV,MAAAtI,EAAA,MAAKiG,CAAA,EAAgB,iBAAiBqC,CAAK;AAAA,IAC5C;AAAA,IACA;AAAA,EAAA,GAGD,KAAK;AAAA,IACJpB,GAAgB;AAAA,MACflH,QAAKiG,CAAA,EAAgB;AAAA,MACrBjG,QAAKiG,CAAA,EAAgB;AAAA,MACrBjG,QAAKiG,CAAA,EAAgB;AAAA,MACrBjG,QAAKiG,CAAA,EAAgB;AAAA,IAAA,CACrB,EAAE,KAAKsC,GAAa,EAAE,CAAC;AAAA,IACxB,CAAC,CAACpK,GAASqK,GAAUjM,GAAUkM,CAAO,MAAM;AAC3C,UAAItK,EAAQ,WAAW,GAAG;AACzB,YAAI,KAAK,UAAU;AAClB;AAED,QAAAuK,GAAA9B,EAAA,WAAA,MAAM,SAAQ,MAAA;AAAA,MACf,OAAO;AACN,cAAM+B,IAAW;AAAA,UAChB,GAAGC,GAAAhC,EAAA,WAAA,MAAM,OAAA;AAAA,UACT,QAAQ,EAAE,CAACvI,EAA2C,GAAGF,EAAA;AAAA,UACzD,aAAaqK;AAAA,UACb,cAAcjM;AAAA,UACd,QAAQkM;AAAA,QAAA;AAET,YAAII,GAAqB,KAAK,OAAOF,CAAQ;AAC5C;AAED,QAAAD,GAAA9B,EAAA,WAAA,MAAM,SAAQ+B,CAAA;AAAA,MACf;AAIA,MAAI3I,EAAA,MAAK+F,EAAA,MAAe,UAAa6C,GAAAhC,EAAA,WAAA,MAAM,aAAU,UAIrDxG,GAAS,SAASwI,sBAAM,OAAA,CAAK;AAAA,IAC9B;AAAA,IACA;AAAA,EAAA;AAEF;AA4BAvC,KAAwB,WAAG;AAC1B,SAAI,KAAK,YAAY,KAAK,SAAS,SAAS,IACpC/F,IAEArB,sBAAyBiB,EAAA,MAAKiG,GAAAI,EAAA,EAAL,UAA0B,GAAGrG,EAAA,MAAKiG,OAAL,KAAA,IAAA,CAAyB;AAExF;AAEAG,KAAyB,SAACtJ,GAAe;AACxC,SAAI,KAAK,WAAiBsD,IACnBrB;AAAA,WACE,KAAK,kBAAkB;AAAA,UACxB,KAAK,yBAAyB,EAAE,MAAM,UAAU,OAAAjC,EAAA,CAAc,KAAK,EAAE;AAC9E;AAEAuJ,KAAmB,WAAG;AACrB,MAAIuC;AACJ,MAAI,KAAK,SAAS,WAAW,GAAG;AAC/B,UAAMC,IAAa,KAAK,QAAQ,CAAC,EAAE;AACnC,IAAAD,IACC,KAAK,yBAAyB,EAAE,MAAM,UAAU,OAAO,GAAA,CAAI,IAAI,sCAAsCC;AAAA,EACvG;AACC,IAAAD,IAAa,KAAK,yBAAyB,EAAE,MAAM,UAAU,OAAO,IAAI;AAEzE,SAAO7J;AAAA;AAAA;AAAA,YAGG,KAAK,kBAAkB;AAAA,WACxB6J,KAAc,EAAE;AAAA,gBACX,KAAK,QAAQ;AAAA;AAE5B;AAEAtC,KAAkB,WAAG;AACpB,SAAOvH;AAAA;AAAA,YAEG,KAAK,SAAS,KAAK,6BAA6B,CAAC;AAAA;AAAA,WAElD,KAAK,yBAAyB,EAAE,MAAM,aAAa,OAAO,GAAA,CAAI,KAAK,EAAE;AAAA,gBAChE,KAAK,QAAQ;AAAA;AAAA;AAAA;AAI5B;AA5YY2H,EA8Ya,SAAS;AAAA,EACjCjG;AAAA,EAEAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiBD;AAlZoBC,EAAA;AAAA,EADnBC,EAAS,EAAE,WAAW,GAAA,CAAO;AAAA,GAflBuH,EAgBQ,WAAA,SAAA,CAAA;AAyBZxH,EAAA;AAAA,EADPwB,EAAA;AAAM,GAxCKgG,EAyCJ,WAAA,sBAAA,CAAA;AAwDRxH,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,QAAA,CAAS;AAAA,GAhGfuH,EAiGZ,WAAA,aAAA,CAAA;AAGAxH,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,OAAA,CAAQ;AAAA,GAnGduH,EAoGZ,WAAA,oBAAA,CAAA;AAGQxH,EAAA;AAAA,EADPwB,EAAA;AAAM,GAtGKgG,EAuGJ,WAAA,aAAA,CAAA;AAEAxH,EAAA;AAAA,EADPwB,EAAA;AAAM,GAxGKgG,EAyGJ,WAAA,aAAA,CAAA;AAGAxH,EAAA;AAAA,EADPwB,EAAA;AAAM,GA3GKgG,EA4GJ,WAAA,WAAA,CAAA;AAGAxH,EAAA;AAAA,EADPwB,EAAA;AAAM,GA9GKgG,EA+GJ,WAAA,YAAA,CAAA;AAGAxH,EAAA;AAAA,EADPwB,EAAA;AAAM,GAjHKgG,EAkHJ,WAAA,0BAAA,CAAA;AAMAxH,EAAA;AAAA,EADPwB,EAAA;AAAM,GAvHKgG,EAwHJ,WAAA,+BAAA,CAAA;AAxHIA,IAANxH,EAAA;AAAA,EADNE,EAAc,mCAAmC;AAAA,GACrCsH,CAAA;AAqab,MAAAoC,KAAepC;"}