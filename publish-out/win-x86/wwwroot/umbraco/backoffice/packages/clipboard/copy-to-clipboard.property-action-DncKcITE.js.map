{"version":3,"file":"copy-to-clipboard.property-action-DncKcITE.js","sources":["../../../src/packages/clipboard/property/actions/copy/copy-to-clipboard.property-action.ts"],"sourcesContent":["import { UMB_CLIPBOARD_PROPERTY_CONTEXT } from '../../context/constants.js';\r\nimport type { MetaPropertyActionCopyToClipboardKind } from './types.js';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UMB_NOTIFICATION_CONTEXT } from '@umbraco-cms/backoffice/notification';\r\nimport { UMB_PROPERTY_CONTEXT, UMB_PROPERTY_DATASET_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport { UmbPropertyActionBase, type UmbPropertyActionArgs } from '@umbraco-cms/backoffice/property-action';\r\n\r\nexport class UmbCopyToClipboardPropertyAction extends UmbPropertyActionBase<MetaPropertyActionCopyToClipboardKind> {\r\n\t#propertyDatasetContext?: typeof UMB_PROPERTY_DATASET_CONTEXT.TYPE;\r\n\t#propertyContext?: typeof UMB_PROPERTY_CONTEXT.TYPE;\r\n\t#notificationContext?: typeof UMB_NOTIFICATION_CONTEXT.TYPE;\r\n\t#clipboardContext?: typeof UMB_CLIPBOARD_PROPERTY_CONTEXT.TYPE;\r\n\t#init?: Promise<unknown>;\r\n\r\n\tconstructor(host: UmbControllerHost, args: UmbPropertyActionArgs<MetaPropertyActionCopyToClipboardKind>) {\r\n\t\tsuper(host, args);\r\n\r\n\t\tthis.#init = Promise.all([\r\n\t\t\tthis.consumeContext(UMB_PROPERTY_DATASET_CONTEXT, (context) => {\r\n\t\t\t\tthis.#propertyDatasetContext = context;\r\n\t\t\t}).asPromise({ preventTimeout: true }),\r\n\r\n\t\t\tthis.consumeContext(UMB_PROPERTY_CONTEXT, (context) => {\r\n\t\t\t\tthis.#propertyContext = context;\r\n\t\t\t}).asPromise({ preventTimeout: true }),\r\n\r\n\t\t\tthis.consumeContext(UMB_NOTIFICATION_CONTEXT, (context) => {\r\n\t\t\t\tthis.#notificationContext = context;\r\n\t\t\t}).asPromise({ preventTimeout: true }),\r\n\r\n\t\t\tthis.consumeContext(UMB_CLIPBOARD_PROPERTY_CONTEXT, (context) => {\r\n\t\t\t\tthis.#clipboardContext = context;\r\n\t\t\t}).asPromise({ preventTimeout: true }),\r\n\t\t]);\r\n\t}\r\n\r\n\toverride async execute() {\r\n\t\tawait this.#init;\r\n\r\n\t\tif (!this.#propertyDatasetContext) throw new Error('Property dataset context is not available');\r\n\t\tif (!this.#propertyContext) throw new Error('Property context is not available');\r\n\t\tif (!this.#notificationContext) throw new Error('Notification context is not available');\r\n\t\tif (!this.#clipboardContext) throw new Error('Clipboard context is not available');\r\n\r\n\t\tconst propertyEditorUiAlias = this.#propertyContext.getEditorManifest()?.alias;\r\n\r\n\t\tif (!propertyEditorUiAlias) {\r\n\t\t\tthrow new Error('Property editor alias is not available');\r\n\t\t}\r\n\r\n\t\tconst workspaceName = this.#propertyDatasetContext.getName();\r\n\t\tconst propertyLabel = this.#propertyContext.getLabel()!;\r\n\t\tconst entryName = workspaceName ? `${workspaceName} - ${propertyLabel}` : propertyLabel;\r\n\r\n\t\tconst propertyValue = this.#propertyContext.getValue();\r\n\r\n\t\tif (!propertyValue) {\r\n\t\t\t// TODO: Add correct message + localization\r\n\t\t\tthis.#notificationContext!.peek('danger', { data: { message: 'The property does not have a value to copy' } });\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst propertyEditorUiIcon = this.#propertyContext.getEditorManifest()?.meta.icon;\r\n\r\n\t\tawait this.#clipboardContext.write({\r\n\t\t\tname: entryName,\r\n\t\t\ticon: propertyEditorUiIcon,\r\n\t\t\tpropertyValue,\r\n\t\t\tpropertyEditorUiAlias,\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport { UmbCopyToClipboardPropertyAction as api };\r\n"],"names":["UmbCopyToClipboardPropertyAction","UmbPropertyActionBase","#propertyDatasetContext","#propertyContext","#notificationContext","#clipboardContext","#init","host","args","UMB_PROPERTY_DATASET_CONTEXT","context","UMB_PROPERTY_CONTEXT","UMB_NOTIFICATION_CONTEXT","UMB_CLIPBOARD_PROPERTY_CONTEXT","propertyEditorUiAlias","workspaceName","propertyLabel","entryName","propertyValue","propertyEditorUiIcon"],"mappings":";;;;AAOO,MAAMA,UAAyCC,EAA6D;AAAA,EAClHC;AAAA,EACAC;AAAA,EACAC;AAAA,EACAC;AAAA,EACAC;AAAA,EAEA,YAAYC,GAAyBC,GAAoE;AACxG,UAAMD,GAAMC,CAAI,GAEhB,KAAKF,KAAQ,QAAQ,IAAI;AAAA,MACxB,KAAK,eAAeG,GAA8B,CAACC,MAAY;AAC9D,aAAKR,KAA0BQ;AAAA,MAChC,CAAC,EAAE,UAAU,EAAE,gBAAgB,IAAM;AAAA,MAErC,KAAK,eAAeC,GAAsB,CAACD,MAAY;AACtD,aAAKP,KAAmBO;AAAA,MACzB,CAAC,EAAE,UAAU,EAAE,gBAAgB,IAAM;AAAA,MAErC,KAAK,eAAeE,GAA0B,CAACF,MAAY;AAC1D,aAAKN,KAAuBM;AAAA,MAC7B,CAAC,EAAE,UAAU,EAAE,gBAAgB,IAAM;AAAA,MAErC,KAAK,eAAeG,GAAgC,CAACH,MAAY;AAChE,aAAKL,KAAoBK;AAAA,MAC1B,CAAC,EAAE,UAAU,EAAE,gBAAgB,IAAM;AAAA,IAAA,CACrC;AAAA,EACF;AAAA,EAEA,MAAe,UAAU;AAGxB,QAFA,MAAM,KAAKJ,IAEP,CAAC,KAAKJ,GAAyB,OAAM,IAAI,MAAM,2CAA2C;AAC9F,QAAI,CAAC,KAAKC,GAAkB,OAAM,IAAI,MAAM,mCAAmC;AAC/E,QAAI,CAAC,KAAKC,GAAsB,OAAM,IAAI,MAAM,uCAAuC;AACvF,QAAI,CAAC,KAAKC,GAAmB,OAAM,IAAI,MAAM,oCAAoC;AAEjF,UAAMS,IAAwB,KAAKX,GAAiB,kBAAA,GAAqB;AAEzE,QAAI,CAACW;AACJ,YAAM,IAAI,MAAM,wCAAwC;AAGzD,UAAMC,IAAgB,KAAKb,GAAwB,QAAA,GAC7Cc,IAAgB,KAAKb,GAAiB,SAAA,GACtCc,IAAYF,IAAgB,GAAGA,CAAa,MAAMC,CAAa,KAAKA,GAEpEE,IAAgB,KAAKf,GAAiB,SAAA;AAE5C,QAAI,CAACe,GAAe;AAEnB,WAAKd,GAAsB,KAAK,UAAU,EAAE,MAAM,EAAE,SAAS,6CAAA,GAAgD;AAC7G;AAAA,IACD;AAEA,UAAMe,IAAuB,KAAKhB,GAAiB,kBAAA,GAAqB,KAAK;AAE7E,UAAM,KAAKE,GAAkB,MAAM;AAAA,MAClC,MAAMY;AAAA,MACN,MAAME;AAAA,MACN,eAAAD;AAAA,MACA,uBAAAJ;AAAA,IAAA,CACA;AAAA,EACF;AACD;"}