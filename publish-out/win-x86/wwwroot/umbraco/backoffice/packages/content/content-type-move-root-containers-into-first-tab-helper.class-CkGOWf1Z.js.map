{"version":3,"file":"content-type-move-root-containers-into-first-tab-helper.class-CkGOWf1Z.js","sources":["../../../src/packages/content/content-type/modals/composition-picker/composition-picker-modal.token.ts","../../../src/packages/content/content-type/workspace/views/design/content-type-design-editor.context-token.ts","../../../src/packages/content/content-type/workspace/content-type-workspace.context-token.ts","../../../src/packages/content/content-type/structure/content-type-container-structure-helper.class.ts","../../../src/packages/content/content-type/structure/content-type-move-root-containers-into-first-tab-helper.class.ts"],"sourcesContent":["import { UmbModalToken } from '@umbraco-cms/backoffice/modal';\r\n\r\n// TODO: Stop sending the initial selection as part of data [NL], it should just be in the value:\r\nexport interface UmbCompositionPickerModalData {\r\n\tcompositionRepositoryAlias: string;\r\n\tselection: Array<string>;\r\n\tusedForInheritance: Array<string>;\r\n\tusedForComposition: Array<string>;\r\n\tunique: string | null;\r\n\tisElement: boolean;\r\n\tcurrentPropertyAliases: Array<string>;\r\n\tisNew: boolean;\r\n}\r\n\r\nexport interface UmbCompositionPickerModalValue {\r\n\tselection: Array<string>;\r\n}\r\n\r\nexport const UMB_COMPOSITION_PICKER_MODAL = new UmbModalToken<\r\n\tUmbCompositionPickerModalData,\r\n\tUmbCompositionPickerModalValue\r\n>('Umb.Modal.CompositionPicker', {\r\n\tmodal: {\r\n\t\ttype: 'sidebar',\r\n\t\tsize: 'small',\r\n\t},\r\n});\r\n","import type { UmbContentTypeDesignEditorContext } from './content-type-design-editor.context.js';\r\nimport { UmbContextToken } from '@umbraco-cms/backoffice/context-api';\r\n\r\nexport const UMB_CONTENT_TYPE_DESIGN_EDITOR_CONTEXT = new UmbContextToken<\r\n\tUmbContentTypeDesignEditorContext,\r\n\tUmbContentTypeDesignEditorContext\r\n>('UmbContentTypeDesignEditorContext');\r\n","import type { UmbContentTypeWorkspaceContext } from './content-type-workspace-context.interface.js';\r\nimport { UmbContextToken } from '@umbraco-cms/backoffice/context-api';\r\n\r\nexport const UMB_CONTENT_TYPE_WORKSPACE_CONTEXT = new UmbContextToken<\r\n\tUmbContentTypeWorkspaceContext,\r\n\tUmbContentTypeWorkspaceContext\r\n>(\r\n\t'UmbWorkspaceContext',\r\n\tundefined,\r\n\t(context): context is UmbContentTypeWorkspaceContext => (context as any).IS_CONTENT_TYPE_WORKSPACE_CONTEXT,\r\n);\r\n","import type {\r\n\tUmbContentTypeModel,\r\n\tUmbPropertyContainerTypes,\r\n\tUmbPropertyTypeContainerMergedModel,\r\n\tUmbPropertyTypeContainerModel,\r\n} from '../types.js';\r\nimport type { UmbContentTypeStructureManager } from './content-type-structure-manager.class.js';\r\nimport { UmbControllerBase } from '@umbraco-cms/backoffice/class-api';\r\nimport type { UmbController, UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UmbArrayState, UmbBooleanState } from '@umbraco-cms/backoffice/observable-api';\r\n\r\n/**\r\n * This class is a helper class for managing the structure of containers in a content type.\r\n * This requires a structure manager {@link UmbContentTypeStructureManager} to manage the structure.\r\n */\r\nexport class UmbContentTypeContainerStructureHelper<T extends UmbContentTypeModel> extends UmbControllerBase {\r\n\t#init;\r\n\t#initResolver?: (value: unknown) => void;\r\n\t#initRejector?: () => void;\r\n\r\n\t#containerId?: string | null;\r\n\t#childType?: UmbPropertyContainerTypes = 'Group';\r\n\r\n\t#structure?: UmbContentTypeStructureManager<T>;\r\n\r\n\t#containerObservers: Array<UmbController> = [];\r\n\r\n\t// State containing the all containers defined in the data:\r\n\t#childContainers = new UmbArrayState<UmbPropertyTypeContainerModel>([], (x) => x.id);\r\n\tget containers() {\r\n\t\tthis.#startLegacy();\r\n\t\treturn this.#childContainers.asObservable();\r\n\t}\r\n\r\n\t// State containing the merged containers (only one pr. name):\r\n\t#legacyMergedChildContainers = new UmbArrayState<UmbPropertyTypeContainerModel>([], (x) => x.id);\r\n\tget mergedContainers() {\r\n\t\tthis.#startLegacy();\r\n\t\treturn this.#legacyMergedChildContainers.asObservable();\r\n\t}\r\n\r\n\t#childContainersMerged = new UmbArrayState<UmbPropertyTypeContainerMergedModel>([], (x) => x.key);\r\n\tpublic readonly childContainers = this.#childContainersMerged.asObservable();\r\n\r\n\t// Owner containers are containers owned by the owner Content Type (The specific one up for editing)\r\n\t#ownerChildContainers: UmbPropertyTypeContainerModel[] = [];\r\n\r\n\t#hasProperties = new UmbBooleanState(false);\r\n\treadonly hasProperties = this.#hasProperties.asObservable();\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host);\r\n\t\tthis.#init = new Promise((resolve, reject) => {\r\n\t\t\tthis.#initResolver = resolve;\r\n\t\t\tthis.#initRejector = reject;\r\n\t\t});\r\n\r\n\t\tthis.#childContainersMerged.sortBy((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0));\r\n\t\tthis.#legacyMergedChildContainers.sortBy((a, b) => (a.sortOrder || 0) - (b.sortOrder || 0));\r\n\t}\r\n\r\n\t// TODO: Implement UmbDeprecated and Obsolete this from v.17 [NL]\r\n\t#legacyMergeLogic = false;\r\n\t#startLegacy() {\r\n\t\tif (this.#legacyMergeLogic) return;\r\n\t\tconsole.log(\r\n\t\t\t\"Pst. we will be deprecating 'mergedContainers' and 'containers' in v.17.0, feel free to use them until v.18.0. But please use 'childContainers'\",\r\n\t\t);\r\n\t\tthis.#legacyMergeLogic = true;\r\n\t\tthis.#legacyObserveContainers();\r\n\t\tthis.observe(this.containers, this.#legacyPerformContainerMerge, null);\r\n\t}\r\n\r\n\tpublic setStructureManager(structure: UmbContentTypeStructureManager<T> | undefined) {\r\n\t\tif (this.#structure === structure || !structure) return;\r\n\t\tif (this.#structure && !structure) {\r\n\t\t\tthis.#initRejector?.();\r\n\t\t\tthis.#initResolver = undefined;\r\n\t\t\tthis.#initRejector = undefined;\r\n\t\t\tthrow new Error(\r\n\t\t\t\t'Structure manager is already set, the helpers are not designed to be re-setup with new managers',\r\n\t\t\t);\r\n\t\t}\r\n\t\tthis.#structure = structure;\r\n\t\tthis.#initResolver?.(undefined);\r\n\t\tthis.#initResolver = undefined;\r\n\t\tthis.#initRejector = undefined;\r\n\t\tthis.#observeContainer();\r\n\t\tthis.#legacyObserveContainers();\r\n\t}\r\n\r\n\tpublic getStructureManager() {\r\n\t\treturn this.#structure;\r\n\t}\r\n\r\n\tpublic setIsRoot(value: boolean) {\r\n\t\tif (value === true) {\r\n\t\t\tthis.setContainerId(null);\r\n\t\t}\r\n\t}\r\n\tpublic getIsRoot() {\r\n\t\treturn this.#containerId === null;\r\n\t}\r\n\r\n\tpublic setContainerId(value: string | null | undefined) {\r\n\t\tif (this.#containerId === value) return;\r\n\t\tthis.#containerId = value;\r\n\t\tthis.#observeContainer();\r\n\t\tthis.#legacyObserveContainers();\r\n\t}\r\n\tpublic getContainerId() {\r\n\t\treturn this.#containerId;\r\n\t}\r\n\r\n\tpublic setContainerChildType(value?: UmbPropertyContainerTypes) {\r\n\t\tif (this.#childType === value) return;\r\n\t\tthis.#childType = value;\r\n\t\tthis.#observeContainer();\r\n\t\tthis.#legacyObserveContainers();\r\n\t}\r\n\tpublic getContainerChildType() {\r\n\t\treturn this.#childType;\r\n\t}\r\n\r\n\t#observeContainer() {\r\n\t\t// Determine the observable, leaving it undefined if not ready, in this way the observation will be determined if not everything is ready. [NL]\r\n\t\tconst childObservable =\r\n\t\t\tthis.#containerId !== undefined && this.#childType\r\n\t\t\t\t? this.#structure?.mergedContainersOfParentIdAndType(this.#containerId, this.#childType)\r\n\t\t\t\t: undefined;\r\n\r\n\t\tthis.observe(\r\n\t\t\tchildObservable,\r\n\t\t\t(childContainers) => {\r\n\t\t\t\tthis.#childContainersMerged.setValue(childContainers ?? []);\r\n\t\t\t},\r\n\t\t\t'observeChildContainers',\r\n\t\t);\r\n\r\n\t\tif (this.#containerId === null) {\r\n\t\t\tthis.removeUmbControllerByAlias('observeParentContainer');\r\n\t\t\t// Observe root properties:\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#structure?.hasPropertyStructuresOfRoot(),\r\n\t\t\t\t(has) => {\r\n\t\t\t\t\tthis.#hasProperties.setValue(has ?? false);\r\n\t\t\t\t},\r\n\t\t\t\t'observeProperties',\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\t// Observe properties of the parent container and matching containers (therefor getting the merged container of the parent id):\t[NL]\r\n\t\t\tconst parentObservable =\r\n\t\t\t\tthis.#containerId !== undefined && this.#childType\r\n\t\t\t\t\t? this.#structure?.mergedContainersOfId(this.#containerId)\r\n\t\t\t\t\t: undefined;\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tparentObservable,\r\n\t\t\t\t(parentContainer) => {\r\n\t\t\t\t\tthis.observe(\r\n\t\t\t\t\t\tparentContainer ? this.#structure?.hasPropertyStructuresOfGroupIds(parentContainer.ids ?? []) : undefined,\r\n\t\t\t\t\t\t(has) => {\r\n\t\t\t\t\t\t\tthis.#hasProperties.setValue(has ?? false);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t'observeProperties',\r\n\t\t\t\t\t);\r\n\t\t\t\t},\r\n\t\t\t\t'observeParentContainer',\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\t// LEGACY properties:\r\n\t#containerName?: string;\r\n\t#containerType?: UmbPropertyContainerTypes;\r\n\t#parentName?: string | null;\r\n\t#parentType?: UmbPropertyContainerTypes;\r\n\r\n\t// LEGACY method:\r\n\t#legacyObserveContainers() {\r\n\t\tif (!this.#legacyMergeLogic) return;\r\n\t\tif (!this.#structure || this.#containerId === undefined) return;\r\n\r\n\t\tif (this.#containerId === null) {\r\n\t\t\t//this.#observeHasPropertiesOf(null);\r\n\t\t\tthis.#legacyObserveRootContainers();\r\n\t\t\tthis.removeUmbControllerByAlias('_observeContainers');\r\n\t\t} else {\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#structure.containerById(this.#containerId),\r\n\t\t\t\t(container) => {\r\n\t\t\t\t\tif (container) {\r\n\t\t\t\t\t\tthis.#containerName = container.name ?? '';\r\n\t\t\t\t\t\tthis.#containerType = container.type;\r\n\t\t\t\t\t\tif (container.parent) {\r\n\t\t\t\t\t\t\t// We have a parent for our main container, so lets observe that one as well:\r\n\t\t\t\t\t\t\tthis.observe(\r\n\t\t\t\t\t\t\t\tthis.#structure!.containerById(container.parent.id),\r\n\t\t\t\t\t\t\t\t(parent) => {\r\n\t\t\t\t\t\t\t\t\tif (parent) {\r\n\t\t\t\t\t\t\t\t\t\tthis.#parentName = parent.name ?? '';\r\n\t\t\t\t\t\t\t\t\t\tthis.#parentType = parent.type;\r\n\t\t\t\t\t\t\t\t\t\tthis.#observeSimilarContainers();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis.removeUmbControllerByAlias('_observeContainers');\r\n\t\t\t\t\t\t\t\t\t\tthis.#parentName = undefined;\r\n\t\t\t\t\t\t\t\t\t\tthis.#parentType = undefined;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t'_observeMainParentContainer',\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.removeUmbControllerByAlias('_observeMainParentContainer');\r\n\t\t\t\t\t\t\tthis.#parentName = null; //In this way we want to look for one without a parent. [NL]\r\n\t\t\t\t\t\t\tthis.#parentType = undefined;\r\n\t\t\t\t\t\t\tthis.#observeSimilarContainers();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.removeUmbControllerByAlias('_observeContainers');\r\n\t\t\t\t\t\tthis.#containerName = undefined;\r\n\t\t\t\t\t\tthis.#containerType = undefined;\r\n\t\t\t\t\t\t//this.#hasProperties.setValue([]);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'_observeMainContainer',\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\t// LEGACY method:\r\n\t#observeSimilarContainers() {\r\n\t\tif (this.#containerName === undefined || !this.#containerType || this.#parentName === undefined) return;\r\n\t\tthis.observe(\r\n\t\t\tthis.#structure!.containersByNameAndTypeAndParent(\r\n\t\t\t\tthis.#containerName,\r\n\t\t\t\tthis.#containerType,\r\n\t\t\t\tthis.#parentName,\r\n\t\t\t\tthis.#parentType,\r\n\t\t\t),\r\n\t\t\t(containers) => {\r\n\t\t\t\t//this.#hasProperties.setValue([]);\r\n\t\t\t\tthis.#childContainers.setValue([]);\r\n\t\t\t\tthis.#containerObservers.forEach((x) => x.destroy());\r\n\t\t\t\tthis.#containerObservers = [];\r\n\r\n\t\t\t\tcontainers.forEach((container) => {\r\n\t\t\t\t\t//this.#observeHasPropertiesOf(container.id);\r\n\r\n\t\t\t\t\tthis.#containerObservers.push(\r\n\t\t\t\t\t\tthis.observe(\r\n\t\t\t\t\t\t\tthis.#structure!.containersOfParentId(container.id, this.#childType!),\r\n\t\t\t\t\t\t\t(containers) => {\r\n\t\t\t\t\t\t\t\t// get the direct owner containers of this container id: [NL]\r\n\t\t\t\t\t\t\t\tthis.#ownerChildContainers =\r\n\t\t\t\t\t\t\t\t\tthis.#structure!.getOwnerContainers(this.#childType!, this.#containerId!) ?? [];\r\n\r\n\t\t\t\t\t\t\t\t// Remove existing containers that are not the parent of the new containers: [NL]\r\n\t\t\t\t\t\t\t\tthis.#childContainers.filter(\r\n\t\t\t\t\t\t\t\t\t(x) => x.parent?.id !== container.id || containers.some((y) => y.id === x.id),\r\n\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\tthis.#childContainers.append(containers);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t'_observeGroupsOf_' + container.id,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t'_observeContainers',\r\n\t\t);\r\n\t}\r\n\r\n\t// LEGACY method:\r\n\t#legacyObserveRootContainers() {\r\n\t\tif (!this.#structure || !this.#childType || this.#containerId === undefined) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#structure.rootContainers(this.#childType),\r\n\t\t\t(rootContainers) => {\r\n\t\t\t\t// Here (When getting root containers) we get containers from all ContentTypes. It also means we need to do an extra filtering to ensure we only get one of each containers. [NL]\r\n\r\n\t\t\t\t// For that we get the owner containers first (We do not need to observe as this observation will be triggered if one of the owner containers change) [NL]\r\n\t\t\t\tthis.#ownerChildContainers = this.#structure!.getOwnerContainers(this.#childType!, this.#containerId!) ?? [];\r\n\r\n\t\t\t\tthis.#childContainers.setValue(rootContainers);\r\n\t\t\t},\r\n\t\t\t'_observeRootContainers',\r\n\t\t);\r\n\t}\r\n\r\n\t/*\r\n\t#observeHasPropertiesOf(groupId?: string | null) {\r\n\t\tif (!this.#structure || groupId === undefined) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tthis.#structure.hasPropertyStructuresOf(groupId),\r\n\t\t\t(hasProperties) => {\r\n\t\t\t\tthis.#hasProperties.appendOne({ id: groupId, has: hasProperties });\r\n\t\t\t},\r\n\t\t\t'_observePropertyStructureOfGroup' + groupId,\r\n\t\t);\r\n\t}\r\n\t\t*/\r\n\r\n\t// LEGACY method:\r\n\t#legacyFilterNonOwnerContainers(containers: Array<UmbPropertyTypeContainerModel>) {\r\n\t\treturn this.#ownerChildContainers.length > 0\r\n\t\t\t? containers.filter(\r\n\t\t\t\t\t(anyCon) =>\r\n\t\t\t\t\t\t!this.#ownerChildContainers.some(\r\n\t\t\t\t\t\t\t(ownerCon) =>\r\n\t\t\t\t\t\t\t\t// Then if this is not the owner container but matches one by name & type, then we do not want it.\r\n\t\t\t\t\t\t\t\townerCon.id !== anyCon.id && ownerCon.name === anyCon.name && ownerCon.type === anyCon.type,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t)\r\n\t\t\t: containers;\r\n\t}\r\n\r\n\t// LEGACY method:\r\n\t#legacyPerformContainerMerge = (containers: Array<UmbPropertyTypeContainerModel>) => {\r\n\t\t// Remove containers that matches with a owner container:\r\n\t\tlet merged = this.#legacyFilterNonOwnerContainers(containers);\r\n\t\t// Remove containers of same name and type:\r\n\t\t// This only works cause we are dealing with a single level of containers in this Helper, if we had more levels we would need to be more clever about the parent as well. [NL]\r\n\t\tmerged = merged.filter((x, i, cons) => i === cons.findIndex((y) => y.name === x.name && y.type === x.type));\r\n\t\tthis.#legacyMergedChildContainers.setValue(merged);\r\n\t};\r\n\r\n\t/**\r\n\t * Returns true if the container is an owner container.\r\n\t * @param containerId\r\n\t */\r\n\tisOwnerChildContainer(containerId?: string): boolean | undefined {\r\n\t\tif (!this.#structure || !containerId) return;\r\n\t\treturn this.#structure.isOwnerContainer(containerId);\r\n\t}\r\n\r\n\tgetContentTypeOfContainer(containerId?: string) {\r\n\t\tif (!this.#structure || !containerId) return;\r\n\t\treturn this.#structure.getContentTypeOfContainer(containerId);\r\n\t}\r\n\r\n\tcontainersByNameAndType(name: string, type: UmbPropertyContainerTypes) {\r\n\t\treturn this.#childContainers.asObservablePart((cons) => cons.filter((x) => x.name === name && x.type === type));\r\n\t}\r\n\r\n\t/** Manipulate methods: */\r\n\r\n\t/*async insertContainer(container: UmbPropertyTypeContainerModel, sortOrder = 0) {\r\n\t\tawait this.#init;\r\n\t\tif (!this.#structure) return false;\r\n\r\n\t\tconst newContainer = { ...container, sortOrder };\r\n\r\n\t\tawait this.#structure.insertContainer(null, newContainer);\r\n\t\treturn true;\r\n\t}*/\r\n\r\n\tasync addContainer(parentContainerId?: string | null, sortOrder?: number) {\r\n\t\tif (!this.#structure) return;\r\n\r\n\t\tawait this.#structure.createContainer(null, parentContainerId, this.#childType, sortOrder);\r\n\t}\r\n\r\n\tasync removeContainer(groupId: string) {\r\n\t\tawait this.#init;\r\n\t\tif (!this.#structure) return false;\r\n\r\n\t\tawait this.#structure.removeContainer(null, groupId);\r\n\t\treturn true;\r\n\t}\r\n\r\n\tasync partialUpdateContainer(containerId: string, partialUpdate: Partial<UmbPropertyTypeContainerModel>) {\r\n\t\tawait this.#init;\r\n\t\tif (!this.#structure || !containerId || !partialUpdate) return;\r\n\r\n\t\treturn await this.#structure.updateContainer(null, containerId, partialUpdate);\r\n\t}\r\n}\r\n","import type { UmbContentTypeModel } from '../types.js';\r\nimport type { UmbContentTypeStructureManager } from './content-type-structure-manager.class.js';\r\nimport { UmbControllerBase } from '@umbraco-cms/backoffice/class-api';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\n\r\nconst MoveRootContainersIntoFirstTabHelperControllerAlias = Symbol('moveRootContainersHelper');\r\n/**\r\n * This class is a helper class that specifically takes care of moving owner root containers into the first created tab.\r\n * This will give the user the experience of the first tab becoming the 'main' tab.\r\n */\r\nexport class UmbContentTypeMoveRootGroupsIntoFirstTabHelper<T extends UmbContentTypeModel> extends UmbControllerBase {\r\n\t#structure?: UmbContentTypeStructureManager<T>;\r\n\r\n\tconstructor(host: UmbControllerHost, structure: UmbContentTypeStructureManager<T>) {\r\n\t\tsuper(host, MoveRootContainersIntoFirstTabHelperControllerAlias);\r\n\t\tthis.#structure = structure;\r\n\t\tthis.#observeContainers();\r\n\t}\r\n\r\n\tasync #observeContainers() {\r\n\t\tif (!this.#structure) return;\r\n\r\n\t\tawait this.observe(\r\n\t\t\tthis.#structure.ownerContainersOf('Tab', null),\r\n\t\t\t(tabContainers) => {\r\n\t\t\t\t// If the amount of containers now became 1, we should move all root containers into this tab:\r\n\t\t\t\tif (tabContainers?.length === 1) {\r\n\t\t\t\t\tconst firstTabId = tabContainers[0].id;\r\n\t\t\t\t\tconst rootContainers = this.#structure?.getOwnerContainers('Group', null);\r\n\t\t\t\t\trootContainers?.forEach((groupContainer) => {\r\n\t\t\t\t\t\tthis.#structure?.updateContainer(null, groupContainer.id, { parent: { id: firstTabId } });\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.destroy();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'_observeMainContainer',\r\n\t\t).asPromise();\r\n\r\n\t\tthis.destroy();\r\n\t}\r\n\r\n\toverride destroy() {\r\n\t\tsuper.destroy();\r\n\t\tthis.#structure = undefined;\r\n\t}\r\n}\r\n"],"names":["UMB_COMPOSITION_PICKER_MODAL","UmbModalToken","UMB_CONTENT_TYPE_DESIGN_EDITOR_CONTEXT","UmbContextToken","UMB_CONTENT_TYPE_WORKSPACE_CONTEXT","context","UmbContentTypeContainerStructureHelper","UmbControllerBase","host","#childType","#containerObservers","#childContainers","UmbArrayState","x","#legacyMergedChildContainers","#childContainersMerged","#ownerChildContainers","#hasProperties","UmbBooleanState","#legacyMergeLogic","#legacyPerformContainerMerge","containers","merged","#legacyFilterNonOwnerContainers","i","cons","y","#init","resolve","reject","#initResolver","#initRejector","a","b","#containerId","#structure","#startLegacy","#legacyObserveContainers","structure","#observeContainer","value","childObservable","childContainers","has","parentObservable","parentContainer","#containerName","#containerType","#parentName","#parentType","#legacyObserveRootContainers","container","parent","#observeSimilarContainers","rootContainers","anyCon","ownerCon","containerId","name","type","parentContainerId","sortOrder","groupId","partialUpdate","MoveRootContainersIntoFirstTabHelperControllerAlias","UmbContentTypeMoveRootGroupsIntoFirstTabHelper","#observeContainers","tabContainers","firstTabId","groupContainer"],"mappings":"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"}