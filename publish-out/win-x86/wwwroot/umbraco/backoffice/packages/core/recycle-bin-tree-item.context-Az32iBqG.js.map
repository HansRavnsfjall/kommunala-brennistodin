{"version":3,"file":"recycle-bin-tree-item.context-Az32iBqG.js","sources":["../../../src/packages/core/recycle-bin/tree/tree-item/recycle-bin-tree-item.context.ts"],"sourcesContent":["import { UmbEntityTrashedEvent } from '../../entity-action/trash/index.js';\r\nimport type { ManifestTreeItemRecycleBinKind } from './types.js';\r\nimport { UmbDefaultTreeItemContext, type UmbTreeItemModel, type UmbTreeRootModel } from '@umbraco-cms/backoffice/tree';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport type { UmbActionEventContext } from '@umbraco-cms/backoffice/action';\r\nimport { UMB_ACTION_EVENT_CONTEXT } from '@umbraco-cms/backoffice/action';\r\nimport { debounce } from '@umbraco-cms/backoffice/utils';\r\n\r\nexport class UmbRecycleBinTreeItemContext<\r\n\tRecycleBinTreeItemModelType extends UmbTreeItemModel,\r\n\tRecycleBinTreeRootModelType extends UmbTreeRootModel,\r\n> extends UmbDefaultTreeItemContext<\r\n\tRecycleBinTreeItemModelType,\r\n\tRecycleBinTreeRootModelType,\r\n\tManifestTreeItemRecycleBinKind\r\n> {\r\n\t#actionEventContext?: UmbActionEventContext;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host);\r\n\r\n\t\tthis.consumeContext(UMB_ACTION_EVENT_CONTEXT, (instance) => {\r\n\t\t\tthis.#removeEventListener();\r\n\t\t\tthis.#actionEventContext = instance;\r\n\t\t\tthis.#actionEventContext?.addEventListener(UmbEntityTrashedEvent.TYPE, this.#onEntityTrashed as EventListener);\r\n\t\t});\r\n\t}\r\n\r\n\t#debounceLoadChildren = debounce(() => this.loadChildren(), 100);\r\n\r\n\t#onEntityTrashed = (event: UmbEntityTrashedEvent) => {\r\n\t\tconst entityType = event.getEntityType();\r\n\t\tif (!entityType) throw new Error('Entity type is required');\r\n\r\n\t\tconst supportedEntityTypes = this.manifest?.meta.supportedEntityTypes;\r\n\r\n\t\tif (!supportedEntityTypes) {\r\n\t\t\tthrow new Error('Entity types are missing from the manifest (manifest.meta.supportedEntityTypes).');\r\n\t\t}\r\n\r\n\t\tif (supportedEntityTypes.includes(entityType)) {\r\n\t\t\tthis.#debounceLoadChildren();\r\n\t\t}\r\n\t};\r\n\r\n\t#removeEventListener = () => {\r\n\t\tthis.#actionEventContext?.removeEventListener(UmbEntityTrashedEvent.TYPE, this.#onEntityTrashed as EventListener);\r\n\t};\r\n\r\n\toverride destroy(): void {\r\n\t\tthis.#removeEventListener();\r\n\t\tsuper.destroy();\r\n\t}\r\n}\r\n\r\nexport { UmbRecycleBinTreeItemContext as api };\r\n"],"names":["UmbRecycleBinTreeItemContext","UmbDefaultTreeItemContext","#actionEventContext","host","UMB_ACTION_EVENT_CONTEXT","instance","#removeEventListener","UmbEntityTrashedEvent","#onEntityTrashed","#debounceLoadChildren","debounce","event","entityType","supportedEntityTypes"],"mappings":";;;;;;;;AAQO,MAAMA,UAGHC,EAIR;AAAA,EACDC;AAAA,EAEA,YAAYC,GAAyB;AACpC,UAAMA,CAAI,GAEV,KAAK,eAAeC,GAA0B,CAACC,MAAa;AAC3D,WAAKC,GAAA,GACL,KAAKJ,KAAsBG,GAC3B,KAAKH,IAAqB,iBAAiBK,EAAsB,MAAM,KAAKC,EAAiC;AAAA,IAC9G,CAAC;AAAA,EACF;AAAA,EAEAC,KAAwBC,EAAS,MAAM,KAAK,aAAA,GAAgB,GAAG;AAAA,EAE/DF,KAAmB,CAACG,MAAiC;AACpD,UAAMC,IAAaD,EAAM,cAAA;AACzB,QAAI,CAACC,EAAY,OAAM,IAAI,MAAM,yBAAyB;AAE1D,UAAMC,IAAuB,KAAK,UAAU,KAAK;AAEjD,QAAI,CAACA;AACJ,YAAM,IAAI,MAAM,kFAAkF;AAGnG,IAAIA,EAAqB,SAASD,CAAU,KAC3C,KAAKH,GAAA;AAAA,EAEP;AAAA,EAEAH,KAAuB,MAAM;AAC5B,SAAKJ,IAAqB,oBAAoBK,EAAsB,MAAM,KAAKC,EAAiC;AAAA,EACjH;AAAA,EAES,UAAgB;AACxB,SAAKF,GAAA,GACL,MAAM,QAAA;AAAA,EACP;AACD;"}