{"version":3,"file":"ref-manifest.element-U7BEJu6e.js","sources":["../../../src/packages/core/extension-registry/registry.ts","../../../src/packages/core/extension-registry/components/extension-slot/extension-slot.element.ts","../../../src/packages/core/extension-registry/components/extension-with-api-slot/extension-with-api-slot.element.ts","../../../src/packages/core/extension-registry/components/ref-manifest/ref-manifest.element.ts"],"sourcesContent":["import type { ManifestKind } from '@umbraco-cms/backoffice/extension-api';\r\nimport { UmbExtensionRegistry } from '@umbraco-cms/backoffice/extension-api';\r\n\r\nexport type UmbExtensionManifestKind = ManifestKind<UmbExtensionManifest>;\r\nexport type UmbBackofficeExtensionRegistry = UmbExtensionRegistry<UmbExtensionManifest, UmbExtensionConditionConfig>;\r\n\r\nexport const umbExtensionsRegistry = new UmbExtensionRegistry<\r\n\tUmbExtensionManifest,\r\n\tUmbExtensionConditionConfig\r\n>() as UmbBackofficeExtensionRegistry;\r\n\r\n/**\r\n * @deprecated Use `UmbExtensionManifestKind` instead.\r\n */\r\nexport type UmbBackofficeManifestKind = ManifestKind<UmbExtensionManifest>;\r\n","import { umbExtensionsRegistry } from '../../registry.js';\r\nimport type { TemplateResult } from '@umbraco-cms/backoffice/external/lit';\r\nimport { css, repeat, customElement, property, state, html, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport {\r\n\ttype UmbExtensionElementInitializer,\r\n\tUmbExtensionsElementInitializer,\r\n} from '@umbraco-cms/backoffice/extension-api';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\n\r\n/**\r\n * @element umb-extension-slot\r\n * @description A element which renderers the extensions of a given type or types.\r\n * @slot default - slot for inserting additional things into this slot.\r\n * @class UmbExtensionSlot\r\n * @augments {UmbLitElement}\r\n */\r\n\r\n// TODO: Refactor extension-slot and extension-with-api slot.\r\n// TODO: Fire change event.\r\n// TODO: Make property that reveals the amount of displayed/permitted extensions.\r\n@customElement('umb-extension-slot')\r\nexport class UmbExtensionSlotElement extends UmbLitElement {\r\n\t#attached = false;\r\n\t#extensionsController?: UmbExtensionsElementInitializer | UmbExtensionElementInitializer;\r\n\r\n\t@state()\r\n\tprivate _permitted?: Array<UmbExtensionElementInitializer>;\r\n\r\n\t@property({ type: Boolean })\r\n\tsingle?: boolean;\r\n\r\n\t/**\r\n\t * The type or types of extensions to render.\r\n\t * @type {string | string[]}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-slot type=\"my-extension-type\"></umb-extension-slot>\r\n\t * or multiple:\r\n\t * <umb-extension-slot .type=${['my-extension-type','another-extension-type']}></umb-extension-slot>\r\n\t */\r\n\t@property({ type: String })\r\n\tpublic set type(value: string | string[] | undefined) {\r\n\t\tif (value === this.#type) return;\r\n\t\tthis.#type = value;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\tpublic get type(): string | string[] | undefined {\r\n\t\treturn this.#type;\r\n\t}\r\n\t#type?: string | string[] | undefined;\r\n\r\n\t/**\r\n\t * Filter method for extension manifests.\r\n\t * This is an initial filter taking effect before conditions or overwrites, the extensions will still be filtered by the conditions defined in the manifest.\r\n\t * @type {(manifest: any) => boolean}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-slot type=\"my-extension-type\" .filter=${(ext) => ext.meta.anyPropToFilter === 'foo'}></umb-extension-slot>\r\n\t */\r\n\t@property({ type: Object, attribute: false })\r\n\tpublic set filter(value: (manifest: any) => boolean) {\r\n\t\tif (value === this.#filter) return;\r\n\t\tthis.#filter = value;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\tpublic get filter(): (manifest: any) => boolean {\r\n\t\treturn this.#filter;\r\n\t}\r\n\t#filter: (manifest: any) => boolean = () => true;\r\n\r\n\t/**\r\n\t * Properties to pass to the extensions elements.\r\n\t * Notice: The individual manifest of the extension is parsed to each extension element no matter if this is set or not.\r\n\t * @type {Record<string, any>}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-slot type=\"my-extension-type\" .props=${{foo: 'bar'}}></umb-extension-slot>\r\n\t */\r\n\t@property({ type: Object, attribute: false })\r\n\tset props(newVal: Record<string, unknown> | undefined) {\r\n\t\tthis.#props = newVal;\r\n\t\tif (this.#extensionsController) {\r\n\t\t\tthis.#extensionsController.properties = newVal;\r\n\t\t}\r\n\t}\r\n\tget props(): Record<string, unknown> | undefined {\r\n\t\treturn this.#props;\r\n\t}\r\n\t#props?: Record<string, unknown> = {};\r\n\r\n\t@property({ type: Object, attribute: false })\r\n\tset events(newVal: Record<string, (event: Event) => void> | undefined) {\r\n\t\tthis.#events = newVal;\r\n\t\tif (this.#extensionsController) {\r\n\t\t\tthis.#addEventListenersToExtensionElement();\r\n\t\t}\r\n\t}\r\n\tget events(): Record<string, (event: Event) => void> | undefined {\r\n\t\treturn this.#events;\r\n\t}\r\n\t#events?: Record<string, (event: Event) => void> = {};\r\n\r\n\t@property({ type: String, attribute: 'default-element' })\r\n\tpublic defaultElement?: string;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic renderMethod?: (\r\n\t\textension: UmbExtensionElementInitializer,\r\n\t\tindex: number,\r\n\t) => TemplateResult | TemplateResult<1> | HTMLElement | null | undefined | typeof nothing;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic fallbackRenderMethod?: () =>\r\n\t\t| TemplateResult\r\n\t\t| TemplateResult<1>\r\n\t\t| HTMLElement\r\n\t\t| null\r\n\t\t| undefined\r\n\t\t| typeof nothing;\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\t\tthis.#attached = true;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\toverride disconnectedCallback(): void {\r\n\t\t// _permitted is reset as the extensionsController fires a callback on destroy.\r\n\t\tthis.#removeEventListenersFromExtensionElement();\r\n\t\tthis.#attached = false;\r\n\t\tthis.#extensionsController?.destroy();\r\n\t\tthis.#extensionsController = undefined;\r\n\t\tsuper.disconnectedCallback();\r\n\t}\r\n\r\n\t#observeExtensions(): void {\r\n\t\tif (!this.#attached) return;\r\n\t\tthis.#extensionsController?.destroy();\r\n\t\tif (this.#type) {\r\n\t\t\tthis.#extensionsController = new UmbExtensionsElementInitializer(\r\n\t\t\t\tthis,\r\n\t\t\t\tumbExtensionsRegistry,\r\n\t\t\t\tthis.#type,\r\n\t\t\t\tthis.filter,\r\n\t\t\t\t(extensionControllers) => {\r\n\t\t\t\t\tthis._permitted = extensionControllers;\r\n\t\t\t\t\tthis.#addEventListenersToExtensionElement();\r\n\t\t\t\t},\r\n\t\t\t\tundefined, // We can leave the alias undefined as we destroy this our selfs.\r\n\t\t\t\tthis.defaultElement,\r\n\t\t\t\t{\r\n\t\t\t\t\tsingle: this.single,\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t\tthis.#extensionsController.properties = this.#props;\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\t// First renders something once _permitted is set, this is to avoid flickering. [NL]\r\n\t\treturn this._permitted\r\n\t\t\t? this._permitted.length > 0\r\n\t\t\t\t? repeat(this._permitted, (ext) => ext.alias, this.#renderExtension)\r\n\t\t\t\t: this.#renderNoting()\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\t#renderNoting() {\r\n\t\treturn this.fallbackRenderMethod ? this.fallbackRenderMethod() : html`<slot></slot>`;\r\n\t}\r\n\r\n\t#renderExtension = (ext: UmbExtensionElementInitializer, i: number) => {\r\n\t\treturn this.renderMethod ? this.renderMethod(ext, i) : ext.component;\r\n\t};\r\n\r\n\t#addEventListenersToExtensionElement() {\r\n\t\tthis._permitted?.forEach((initializer) => {\r\n\t\t\tconst component = initializer.component as HTMLElement;\r\n\t\t\tif (!component) return;\r\n\r\n\t\t\tconst events = this.#events;\r\n\t\t\tif (!events) return;\r\n\r\n\t\t\tthis.#removeEventListenersFromExtensionElement();\r\n\r\n\t\t\tObject.entries(events).forEach(([eventName, handler]) => {\r\n\t\t\t\tcomponent.addEventListener(eventName, handler);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t#removeEventListenersFromExtensionElement() {\r\n\t\tthis._permitted?.forEach((initializer) => {\r\n\t\t\tconst component = initializer.component as HTMLElement;\r\n\t\t\tif (!component) return;\r\n\r\n\t\t\tconst events = this.#events;\r\n\t\t\tif (!events) return;\r\n\r\n\t\t\tObject.entries(events).forEach(([eventName, handler]) => {\r\n\t\t\t\tcomponent.removeEventListener(eventName, handler);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tstatic override styles = css`\r\n\t\t:host {\r\n\t\t\tdisplay: contents;\r\n\t\t}\r\n\t`;\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-extension-slot': UmbExtensionSlotElement;\r\n\t}\r\n}\r\n","import { umbExtensionsRegistry } from '../../registry.js';\r\nimport type { TemplateResult } from '@umbraco-cms/backoffice/external/lit';\r\nimport { css, repeat, customElement, property, state, html, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport {\r\n\ttype UmbExtensionElementAndApiInitializer,\r\n\tUmbExtensionsElementAndApiInitializer,\r\n\ttype UmbApiConstructorArgumentsMethodType,\r\n\ttype ApiLoaderProperty,\r\n} from '@umbraco-cms/backoffice/extension-api';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\n\r\n/**\r\n * @element umb-extension-with-api-slot\r\n * @description A element which renderers the extensions of a given type or types.\r\n * @slot default - slot for inserting additional things into this slot.\r\n * @class UmbExtensionSlot\r\n * @augments {UmbLitElement}\r\n */\r\n\r\n// TODO: Refactor extension-slot and extension-with-api slot.\r\n// TODO: Fire change event.\r\n// TODO: Make property that reveals the amount of displayed/permitted extensions.\r\n@customElement('umb-extension-with-api-slot')\r\nexport class UmbExtensionWithApiSlotElement extends UmbLitElement {\r\n\t#attached = false;\r\n\t#extensionsController?: UmbExtensionsElementAndApiInitializer;\r\n\r\n\t@state()\r\n\tprivate _permitted?: Array<UmbExtensionElementAndApiInitializer>;\r\n\r\n\t@property({ type: Boolean })\r\n\tsingle?: boolean;\r\n\r\n\t/**\r\n\t * The type or types of extensions to render.\r\n\t * @type {string | string[]}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-with-api-slot type=\"my-extension-type\"></umb-extension-with-api-slot>\r\n\t * or multiple:\r\n\t * <umb-extension-with-api-slot .type=${['my-extension-type','another-extension-type']}></umb-extension-with-api-slot>\r\n\t */\r\n\t@property({ type: String })\r\n\tpublic get type(): string | string[] | undefined {\r\n\t\treturn this.#type;\r\n\t}\r\n\tpublic set type(value: string | string[] | undefined) {\r\n\t\tif (value === this.#type) return;\r\n\t\tthis.#type = value;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\t#type?: string | string[] | undefined;\r\n\r\n\t/**\r\n\t * Filter method for extension manifests.\r\n\t * This is an initial filter taking effect before conditions or overwrites, the extensions will still be filtered by the conditions defined in the manifest.\r\n\t * @type {(manifest: any) => boolean}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-with-api-slot type=\"my-extension-type\" .filter=${(ext) => ext.meta.anyPropToFilter === 'foo'}></umb-extension-with-api-slot>\r\n\t */\r\n\t@property({ type: Object, attribute: false })\r\n\tpublic get filter(): (manifest: any) => boolean {\r\n\t\treturn this.#filter;\r\n\t}\r\n\tpublic set filter(value: (manifest: any) => boolean) {\r\n\t\tif (value === this.#filter) return;\r\n\t\tthis.#filter = value;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\t#filter: (manifest: any) => boolean = () => true;\r\n\r\n\t/**\r\n\t * Properties to pass to the extensions elements.\r\n\t * Notice: The individual manifest of the extension is parsed to each extension element no matter if this is set or not.\r\n\t * @type {Record<string, any>}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-with-api-slot type=\"my-extension-type\" .elementProps=${{foo: 'bar'}}></umb-extension-with-api-slot>\r\n\t */\r\n\t@property({ attribute: false })\r\n\tget elementProps(): Record<string, unknown> | undefined {\r\n\t\treturn this.#elProps;\r\n\t}\r\n\tset elementProps(newVal: Record<string, unknown> | undefined) {\r\n\t\t// TODO, compare changes since last time. only reset the ones that changed. This might be better done by the controller is self:\r\n\t\tthis.#elProps = newVal;\r\n\t\tif (this.#extensionsController) {\r\n\t\t\tthis.#extensionsController.elementProperties = newVal;\r\n\t\t}\r\n\t}\r\n\t#elProps?: Record<string, unknown> = {};\r\n\r\n\t/**\r\n\t * constructor arguments to pass to the extensions apis.\r\n\t * Notice: The host argument will be prepended as the first argument no matter if this is set or not.\r\n\t * @type {Array<unknown>}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-with-api-slot type=\"my-extension-type\" .apiArgs=${{foo: 'bar'}}></umb-extension-with-api-slot>\r\n\t */\r\n\t@property({ attribute: false })\r\n\tget apiArgs(): Array<unknown> | UmbApiConstructorArgumentsMethodType<any> | undefined {\r\n\t\treturn this.#constructorArgs;\r\n\t}\r\n\tset apiArgs(newVal: Array<unknown> | UmbApiConstructorArgumentsMethodType<any> | undefined) {\r\n\t\tif (newVal === this.#constructorArgs) return;\r\n\t\tthis.#constructorArgs = newVal;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\t#constructorArgs?: Array<unknown> | UmbApiConstructorArgumentsMethodType<any> = [];\r\n\r\n\t/**\r\n\t * Properties to pass to the extensions apis.\r\n\t * Notice: The individual manifest of the extension is parsed to each extension api no matter if this is set or not.\r\n\t * @type {Record<string, any>}\r\n\t * @memberof UmbExtensionSlot\r\n\t * @example\r\n\t * <umb-extension-with-api-slot type=\"my-extension-type\" .apiProps=${{foo: 'bar'}}></umb-extension-with-api-slot>\r\n\t */\r\n\t@property({ attribute: false })\r\n\tget apiProps(): Record<string, unknown> | undefined {\r\n\t\treturn this.#apiProps;\r\n\t}\r\n\tset apiProps(newVal: Record<string, unknown> | undefined) {\r\n\t\t// TODO, compare changes since last time. only reset the ones that changed. This might be better done by the controller is self:\r\n\t\tthis.#apiProps = newVal;\r\n\t\tif (this.#extensionsController) {\r\n\t\t\tthis.#extensionsController.apiProperties = newVal;\r\n\t\t}\r\n\t}\r\n\t#apiProps?: Record<string, unknown> = {};\r\n\r\n\t@property({ type: String, attribute: 'default-element' })\r\n\tpublic defaultElement?: string;\r\n\r\n\t@property({ type: String, attribute: 'default-api' })\r\n\tpublic defaultApi?: ApiLoaderProperty;\r\n\r\n\t@property()\r\n\tpublic renderMethod?: (\r\n\t\textension: UmbExtensionElementAndApiInitializer,\r\n\t\tindex: number,\r\n\t) => TemplateResult | TemplateResult<1> | HTMLElement | null | undefined | typeof nothing;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic fallbackRenderMethod?: () =>\r\n\t\t| TemplateResult\r\n\t\t| TemplateResult<1>\r\n\t\t| HTMLElement\r\n\t\t| null\r\n\t\t| undefined\r\n\t\t| typeof nothing;\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\t\tthis.#attached = true;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\toverride disconnectedCallback(): void {\r\n\t\tthis.#attached = false;\r\n\t\tthis.#extensionsController?.destroy();\r\n\t\tthis.#extensionsController = undefined;\r\n\t\tsuper.disconnectedCallback();\r\n\t}\r\n\r\n\t#observeExtensions(): void {\r\n\t\t// We want to be attached before we start observing extensions, cause first at this point we know that we got the right properties. [NL]\r\n\t\tif (!this.#attached) return;\r\n\t\tthis.#extensionsController?.destroy();\r\n\t\tif (this.#type) {\r\n\t\t\tthis.#extensionsController = new UmbExtensionsElementAndApiInitializer(\r\n\t\t\t\tthis,\r\n\t\t\t\tumbExtensionsRegistry,\r\n\t\t\t\tthis.#type,\r\n\t\t\t\tthis.#constructorArgs,\r\n\t\t\t\tthis.filter,\r\n\t\t\t\t(extensionControllers) => {\r\n\t\t\t\t\tthis._permitted = extensionControllers;\r\n\t\t\t\t},\r\n\t\t\t\tundefined, // We can leave the alias to undefined, as we destroy this our selfs.\r\n\t\t\t\tthis.defaultElement,\r\n\t\t\t\tthis.defaultApi,\r\n\t\t\t\t{\r\n\t\t\t\t\tsingle: this.single,\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t\tthis.#extensionsController.apiProperties = this.#apiProps;\r\n\t\t\tthis.#extensionsController.elementProperties = this.#elProps;\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._permitted\r\n\t\t\t? this._permitted.length > 0\r\n\t\t\t\t? repeat(this._permitted, (ext) => ext.alias, this.#renderExtension)\r\n\t\t\t\t: this.#renderNoting()\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\t#renderNoting() {\r\n\t\treturn this.fallbackRenderMethod ? this.fallbackRenderMethod() : html`<slot></slot>`;\r\n\t}\r\n\r\n\t#renderExtension = (ext: UmbExtensionElementAndApiInitializer, i: number) => {\r\n\t\treturn this.renderMethod ? this.renderMethod(ext, i) : ext.component;\r\n\t};\r\n\r\n\tstatic override styles = css`\r\n\t\t:host {\r\n\t\t\tdisplay: contents;\r\n\t\t}\r\n\t`;\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-extension-with-api-slot': UmbExtensionWithApiSlotElement;\r\n\t}\r\n}\r\n","import { UUIIconRequestEvent, UUIRefNodeElement } from '@umbraco-cms/backoffice/external/uui';\r\nimport { html, customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbElementMixin } from '@umbraco-cms/backoffice/element-api';\r\nimport type { ManifestBase } from '@umbraco-cms/backoffice/extension-api';\r\n\r\n@customElement('umb-ref-manifest')\r\nexport class UmbRefManifestElement extends UmbElementMixin(UUIRefNodeElement) {\r\n\t@property({ type: Object, attribute: false })\r\n\tpublic get manifest(): ManifestBase | undefined {\r\n\t\treturn undefined;\r\n\t}\r\n\tpublic set manifest(value: ManifestBase | undefined) {\r\n\t\tthis._alias = value?.alias;\r\n\t\tthis.name = value?.name ?? '';\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _alias?: string;\r\n\r\n\toverride connectedCallback() {\r\n\t\tsuper.connectedCallback();\r\n\r\n\t\tthis.#requestIconSVG('icon-umb-manifest');\r\n\t}\r\n\r\n\t/* This is a bit stupid, but because this element extends from uui-ref-node, it only accepts the icon via the icon slot.\r\n\t ** Instead we overwrite the fallbackIcon property which requires a SVG... */\r\n\t#requestIconSVG(iconName: string) {\r\n\t\tif (iconName !== '' && iconName !== null) {\r\n\t\t\tconst event = new UUIIconRequestEvent(UUIIconRequestEvent.ICON_REQUEST, {\r\n\t\t\t\tdetail: { iconName: iconName },\r\n\t\t\t});\r\n\t\t\tthis.dispatchEvent(event);\r\n\t\t\tif (event.icon !== null) {\r\n\t\t\t\tevent.icon.then((iconSvg: string) => {\r\n\t\t\t\t\tthis.fallbackIcon = iconSvg;\r\n\t\t\t\t\tthis.requestUpdate('fallbackIcon');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected override renderDetail() {\r\n\t\treturn html`<small id=\"detail\">${this._alias}<slot name=\"detail\"></slot></small>`;\r\n\t}\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-ref-manifest': UmbRefManifestElement;\r\n\t}\r\n}\r\n"],"names":["umbExtensionsRegistry","UmbExtensionRegistry","_attached","_extensionsController","_type","_filter","_props","_events","_UmbExtensionSlotElement_instances","observeExtensions_fn","renderNoting_fn","_renderExtension","addEventListenersToExtensionElement_fn","removeEventListenersFromExtensionElement_fn","UmbExtensionSlotElement","UmbLitElement","__privateAdd","ext","i","value","__privateGet","__privateSet","__privateMethod","newVal","repeat","nothing","UmbExtensionsElementInitializer","extensionControllers","html","initializer","component","events","eventName","handler","css","__decorateClass","state","property","customElement","_elProps","_constructorArgs","_apiProps","_UmbExtensionWithApiSlotElement_instances","UmbExtensionWithApiSlotElement","UmbExtensionsElementAndApiInitializer","_UmbRefManifestElement_instances","requestIconSVG_fn","UmbRefManifestElement","UmbElementMixin","UUIRefNodeElement","iconName","event","UUIIconRequestEvent","iconSvg"],"mappings":"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"}