{"version":3,"file":"section-main-views.element-BH3UTh7O.js","sources":["../../../src/packages/core/section/section-main-views/section-main-views.element.ts"],"sourcesContent":["import type { ManifestSectionView, UmbSectionViewElement } from '../extensions/index.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { css, html, nothing, customElement, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UmbRoute, UmbRouterSlotChangeEvent, UmbRouterSlotInitEvent } from '@umbraco-cms/backoffice/router';\r\nimport type { ManifestDashboard, UmbDashboardElement } from '@umbraco-cms/backoffice/dashboard';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UmbExtensionsManifestInitializer, createExtensionElement } from '@umbraco-cms/backoffice/extension-api';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { pathFolderName } from '@umbraco-cms/backoffice/utils';\r\n\r\n@customElement('umb-section-main-views')\r\nexport class UmbSectionMainViewElement extends UmbLitElement {\r\n\t@property({ type: String, attribute: 'section-alias' })\r\n\tpublic sectionAlias?: string;\r\n\r\n\t@state()\r\n\tprivate _views: Array<ManifestSectionView> = [];\r\n\r\n\t@state()\r\n\tprivate _dashboards: Array<ManifestDashboard> = [];\r\n\r\n\t@state()\r\n\tprivate _routerPath?: string;\r\n\r\n\t@state()\r\n\tprivate _activePath?: string;\r\n\r\n\t@state()\r\n\tprivate _defaultView?: string;\r\n\r\n\t@state()\r\n\tprivate _routes: Array<UmbRoute> = [];\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tnew UmbExtensionsManifestInitializer(this, umbExtensionsRegistry, 'dashboard', null, (dashboards) => {\r\n\t\t\tthis._dashboards = dashboards.map((dashboard) => dashboard.manifest);\r\n\t\t\tthis.#createRoutes();\r\n\t\t});\r\n\r\n\t\tnew UmbExtensionsManifestInitializer(this, umbExtensionsRegistry, 'sectionView', null, (views) => {\r\n\t\t\tthis._views = views.map((view) => view.manifest);\r\n\t\t\tthis.#createRoutes();\r\n\t\t});\r\n\t}\r\n\r\n\t#constructDashboardPath(manifest: ManifestDashboard) {\r\n\t\tconst dashboardName = manifest.meta.label ?? manifest.name ?? manifest.alias;\r\n\t\treturn 'dashboard/' + (manifest.meta.pathname ? manifest.meta.pathname : pathFolderName(dashboardName));\r\n\t}\r\n\r\n\t#constructViewPath(manifest: ManifestSectionView) {\r\n\t\tconst viewName = manifest.meta.label ?? manifest.name ?? manifest.alias;\r\n\t\treturn 'view/' + (manifest.meta.pathname ? manifest.meta.pathname : pathFolderName(viewName));\r\n\t}\r\n\r\n\tasync #createRoutes() {\r\n\t\tconst dashboardRoutes = this._dashboards?.map((manifest) => {\r\n\t\t\treturn {\r\n\t\t\t\tpath: this.#constructDashboardPath(manifest),\r\n\t\t\t\tcomponent: () => createExtensionElement(manifest),\r\n\t\t\t\tsetup: (component: UmbDashboardElement) => {\r\n\t\t\t\t\tcomponent.manifest = manifest;\r\n\t\t\t\t},\r\n\t\t\t} as UmbRoute;\r\n\t\t});\r\n\r\n\t\tconst viewRoutes = this._views?.map((manifest) => {\r\n\t\t\treturn {\r\n\t\t\t\tpath: this.#constructViewPath(manifest),\r\n\t\t\t\tcomponent: () => createExtensionElement(manifest),\r\n\t\t\t\tsetup: (component: UmbSectionViewElement) => {\r\n\t\t\t\t\tcomponent.manifest = manifest;\r\n\t\t\t\t},\r\n\t\t\t} as UmbRoute;\r\n\t\t});\r\n\r\n\t\tconst routes = [...dashboardRoutes, ...viewRoutes];\r\n\t\tif (routes.length > 0) {\r\n\t\t\tthis._defaultView = routes[0].path;\r\n\t\t\troutes.push({\r\n\t\t\t\t...routes[0],\r\n\t\t\t\tpath: '',\r\n\t\t\t});\r\n\r\n\t\t\troutes.push({\r\n\t\t\t\tpath: `**`,\r\n\t\t\t\tcomponent: async () => (await import('@umbraco-cms/backoffice/router')).UmbRouteNotFoundElement,\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis._routes = routes;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._routes.length > 0\r\n\t\t\t? html`\r\n\t\t\t\t\t<umb-body-layout main-no-padding>\r\n\t\t\t\t\t\t${this.#renderDashboards()} ${this.#renderViews()}\r\n\t\t\t\t\t\t<umb-router-slot\r\n\t\t\t\t\t\t\t.routes=${this._routes}\r\n\t\t\t\t\t\t\t@init=${(event: UmbRouterSlotInitEvent) => {\r\n\t\t\t\t\t\t\t\tthis._routerPath = event.target.absoluteRouterPath;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t@change=${(event: UmbRouterSlotChangeEvent) => {\r\n\t\t\t\t\t\t\t\tthis._activePath = event.target.localActiveViewPath;\r\n\t\t\t\t\t\t\t}}>\r\n\t\t\t\t\t\t</umb-router-slot>\r\n\t\t\t\t\t</umb-body-layout>\r\n\t\t\t\t`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\t#getDashboardName(dashboard: ManifestDashboard) {\r\n\t\treturn dashboard.meta?.label ? this.localize.string(dashboard.meta.label) : (dashboard.name ?? dashboard.alias);\r\n\t}\r\n\r\n\t#renderDashboards() {\r\n\t\t// Only show dashboards if there are more than one dashboard or if there are both dashboards and views\r\n\t\treturn (this._dashboards.length > 0 && this._views.length > 0) || this._dashboards.length > 1\r\n\t\t\t? html`\r\n\t\t\t\t\t<uui-tab-group slot=\"header\" id=\"dashboards\">\r\n\t\t\t\t\t\t${this._dashboards.map((dashboard) => {\r\n\t\t\t\t\t\t\tconst dashboardPath = this.#constructDashboardPath(dashboard);\r\n\t\t\t\t\t\t\t// If this path matches, or if this is the default view and the active path is empty.\r\n\t\t\t\t\t\t\tconst isActive =\r\n\t\t\t\t\t\t\t\tthis._activePath === dashboardPath || (this._defaultView === dashboardPath && this._activePath === '');\r\n\t\t\t\t\t\t\treturn html`\r\n\t\t\t\t\t\t\t\t<uui-tab\r\n\t\t\t\t\t\t\t\t\thref=\"${this._routerPath}/${dashboardPath}\"\r\n\t\t\t\t\t\t\t\t\tlabel=\"${this.#getDashboardName(dashboard)}\"\r\n\t\t\t\t\t\t\t\t\t?active=\"${isActive}\"\r\n\t\t\t\t\t\t\t\t\t>${this.#getDashboardName(dashboard)}</uui-tab\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t`;\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</uui-tab-group>\r\n\t\t\t\t`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\t#renderViews() {\r\n\t\t// Only show views if there are more than one view or if there are both dashboards and views\r\n\t\treturn (this._views.length > 0 && this._dashboards.length > 0) || this._views.length > 1\r\n\t\t\t? html`\r\n\t\t\t\t\t<uui-tab-group slot=\"navigation\" id=\"views\">\r\n\t\t\t\t\t\t${this._views.map((view) => {\r\n\t\t\t\t\t\t\tconst viewName = view.meta.label ? this.localize.string(view.meta.label) : (view.name ?? view.alias);\r\n\t\t\t\t\t\t\tconst viewPath = this.#constructViewPath(view);\r\n\t\t\t\t\t\t\t// If this path matches, or if this is the default view and the active path is empty.\r\n\t\t\t\t\t\t\tconst isActive =\r\n\t\t\t\t\t\t\t\tthis._activePath === viewPath || (this._defaultView === viewPath && this._activePath === '');\r\n\t\t\t\t\t\t\treturn html`\r\n\t\t\t\t\t\t\t\t<uui-tab href=\"${this._routerPath}/${viewPath}\" label=\"${viewName}\" ?active=\"${isActive}\">\r\n\t\t\t\t\t\t\t\t\t<umb-icon slot=\"icon\" name=${view.meta.icon}></umb-icon>\r\n\t\t\t\t\t\t\t\t\t${viewName}\r\n\t\t\t\t\t\t\t\t</uui-tab>\r\n\t\t\t\t\t\t\t`;\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</uui-tab-group>\r\n\t\t\t\t`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#views {\r\n\t\t\t\t--uui-tab-divider: var(--uui-color-divider-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t#views uui-tab:first-child {\r\n\t\t\t\tborder-left: 1px solid var(--uui-color-divider-standalone);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbSectionMainViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-section-main-views': UmbSectionMainViewElement;\r\n\t}\r\n}\r\n"],"names":["_UmbSectionMainViewElement_instances","constructDashboardPath_fn","constructViewPath_fn","createRoutes_fn","getDashboardName_fn","renderDashboards_fn","renderViews_fn","UmbSectionMainViewElement","UmbLitElement","__privateAdd","UmbExtensionsManifestInitializer","umbExtensionsRegistry","dashboards","dashboard","__privateMethod","views","view","html","event","nothing","manifest","dashboardName","pathFolderName","viewName","dashboardRoutes","createExtensionElement","component","viewRoutes","routes","dashboardPath","isActive","viewPath","UmbTextStyles","css","__decorateClass","property","state","customElement","UmbSectionMainViewElement$1"],"mappings":"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"}