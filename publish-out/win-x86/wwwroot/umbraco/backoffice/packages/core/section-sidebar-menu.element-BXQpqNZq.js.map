{"version":3,"file":"section-sidebar-menu.element-BXQpqNZq.js","sources":["../../../src/packages/core/menu/components/menu-item/expansion/is-menu-item-expansion-entry.guard.ts","../../../src/packages/core/menu/section-sidebar-menu/section-sidebar-menu.element.ts"],"sourcesContent":["import type { UmbMenuItemExpansionEntryModel } from '../../types.js';\r\n\r\n/**\r\n * Checks if the provided object is a Menu Item Expansion Entry.\r\n * @param {object } object - The object to check.\r\n * @returns {boolean } True if the object is a Menu Item Expansion Entry, false otherwise.\r\n */\r\nexport function isMenuItemExpansionEntry(object: unknown): object is UmbMenuItemExpansionEntryModel {\r\n\treturn (\r\n\t\ttypeof object === 'object' &&\r\n\t\tobject !== null &&\r\n\t\t'entityType' in object &&\r\n\t\t'unique' in object &&\r\n\t\t'menuItemAlias' in object\r\n\t);\r\n}\r\n","import type { ManifestMenu } from '../menu.extension.js';\r\nimport { isMenuItemExpansionEntry } from '../components/menu-item/expansion/is-menu-item-expansion-entry.guard.js';\r\nimport type { ManifestSectionSidebarAppBaseMenu, ManifestSectionSidebarAppMenuKind } from './types.js';\r\nimport { UMB_SECTION_SIDEBAR_MENU_SECTION_CONTEXT } from './section-context/section-sidebar-menu.section-context.token.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { css, html, customElement, property } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbExpansionEntryCollapsedEvent, UmbExpansionEntryExpandedEvent } from '@umbraco-cms/backoffice/utils';\r\nimport { UmbExtensionSlotElement } from '@umbraco-cms/backoffice/extension-registry';\r\n\r\n@customElement('umb-section-sidebar-menu')\r\nexport class UmbSectionSidebarMenuElement<\r\n\tManifestType extends ManifestSectionSidebarAppBaseMenu = ManifestSectionSidebarAppMenuKind,\r\n> extends UmbLitElement {\r\n\t@property({ type: Object, attribute: false })\r\n\tmanifest?: ManifestType;\r\n\r\n\trenderHeader() {\r\n\t\t/*\r\n\t\tNotice we are not using the UUI-H3 here, we would need to wrap it into uui-text for this to take action,\r\n\t\tbut it does look odd so lets return to this later. I have made a few corrections especially for this component. [NL]\r\n\t\t*/\r\n\t\treturn html`<h3>${this.localize.string(this.manifest?.meta?.label ?? '')}</h3>`;\r\n\t}\r\n\r\n\t#sectionSidebarMenuContext?: typeof UMB_SECTION_SIDEBAR_MENU_SECTION_CONTEXT.TYPE;\r\n\r\n\t#extensionSlotElement = new UmbExtensionSlotElement();\r\n\t#muteStateUpdate = false;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.#initExtensionSlotElement();\r\n\t\tthis.consumeContext(UMB_SECTION_SIDEBAR_MENU_SECTION_CONTEXT, (context) => {\r\n\t\t\tthis.#sectionSidebarMenuContext = context;\r\n\t\t\tthis.#observeExpansion();\r\n\t\t});\r\n\t}\r\n\r\n\t#initExtensionSlotElement() {\r\n\t\t/* For better performance and UX we prevent lit from doing unnecessary rerenders we programmatically create the element,\r\n\t\tand manually update the props when needed. */\r\n\r\n\t\tthis.#extensionSlotElement.type = 'menu';\r\n\t\tthis.#extensionSlotElement.filter = (menu: ManifestMenu) => menu.alias === this.manifest?.meta?.menu;\r\n\t\tthis.#extensionSlotElement.defaultElement = 'umb-menu';\r\n\t\tthis.#extensionSlotElement.events = {\r\n\t\t\t[UmbExpansionEntryExpandedEvent.TYPE]: this.#onExpansionChange.bind(this),\r\n\t\t\t[UmbExpansionEntryCollapsedEvent.TYPE]: this.#onExpansionChange.bind(this),\r\n\t\t};\r\n\t}\r\n\r\n\t#observeExpansion() {\r\n\t\tthis.observe(this.#sectionSidebarMenuContext?.expansion.expansion, (items) => {\r\n\t\t\tif (this.#muteStateUpdate) return;\r\n\r\n\t\t\tthis.#extensionSlotElement.props = {\r\n\t\t\t\texpansion: items || [],\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t#onExpansionChange(e: Event) {\r\n\t\tconst event = e as UmbExpansionEntryExpandedEvent | UmbExpansionEntryCollapsedEvent;\r\n\t\tevent.stopPropagation();\r\n\t\tconst eventEntry = event.entry;\r\n\r\n\t\tif (!eventEntry) {\r\n\t\t\tthrow new Error('Entity is required to toggle expansion.');\r\n\t\t}\r\n\r\n\t\t// Only react to the event if it is a valid Menu Item Expansion Entry\r\n\t\tif (isMenuItemExpansionEntry(eventEntry) === false) return;\r\n\r\n\t\tif (event.type === UmbExpansionEntryExpandedEvent.TYPE) {\r\n\t\t\tthis.#muteStateUpdate = true;\r\n\t\t\tthis.#sectionSidebarMenuContext?.expansion.expandItem(eventEntry);\r\n\t\t\tthis.#muteStateUpdate = false;\r\n\t\t} else if (event.type === UmbExpansionEntryCollapsedEvent.TYPE) {\r\n\t\t\tthis.#muteStateUpdate = true;\r\n\t\t\tthis.#sectionSidebarMenuContext?.expansion.collapseItem(eventEntry);\r\n\t\t\tthis.#muteStateUpdate = false;\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html` ${this.renderHeader()} ${this.#extensionSlotElement}`;\r\n\t}\r\n\r\n\toverride disconnectedCallback(): void {\r\n\t\tsuper.disconnectedCallback();\r\n\t\tthis.#extensionSlotElement.destroy();\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\th3 {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\theight: var(--umb-header-layout-height);\r\n\t\t\t\tmargin: 0;\r\n\t\t\t\tpadding: var(--uui-size-4) var(--uui-size-8);\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tfont-size: 14px;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbSectionSidebarMenuElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-section-sidebar-menu': UmbSectionSidebarMenuElement;\r\n\t}\r\n}\r\n"],"names":["isMenuItemExpansionEntry","object","_sectionSidebarMenuContext","_extensionSlotElement","_muteStateUpdate","_UmbSectionSidebarMenuElement_instances","initExtensionSlotElement_fn","observeExpansion_fn","onExpansionChange_fn","UmbSectionSidebarMenuElement","UmbLitElement","__privateAdd","UmbExtensionSlotElement","__privateMethod","UMB_SECTION_SIDEBAR_MENU_SECTION_CONTEXT","context","__privateSet","html","__privateGet","menu","UmbExpansionEntryExpandedEvent","UmbExpansionEntryCollapsedEvent","items","event","eventEntry","UmbTextStyles","css","__decorateClass","property","customElement","UmbSectionSidebarMenuElement$1"],"mappings":"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"}