{"version":3,"file":"tree-picker-modal.element-DnTD7GuE.js","sources":["../../../src/packages/core/tree/tree-item-picker/tree-item-picker-expansion.manager.ts","../../../src/packages/core/tree/tree-item-picker/tree-item-picker.context.ts","../../../src/packages/core/tree/tree-picker-modal/tree-picker-modal.element.ts"],"sourcesContent":["import { UmbControllerBase } from '@umbraco-cms/backoffice/class-api';\r\nimport { UmbEntityExpansionManager } from '@umbraco-cms/backoffice/utils';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport type { UmbEntityExpansionModel } from '@umbraco-cms/backoffice/utils';\r\nimport type {\r\n\tUmbInteractionMemoryManager,\r\n\tUmbInteractionMemoryModel,\r\n} from '@umbraco-cms/backoffice/interaction-memory';\r\n\r\nexport interface UmbTreeItemPickerExpansionManagerArgs {\r\n\tinteractionMemoryManager?: UmbInteractionMemoryManager;\r\n}\r\n\r\nexport class UmbTreeItemPickerExpansionManager extends UmbControllerBase {\r\n\t#manager = new UmbEntityExpansionManager(this);\r\n\tpublic readonly expansion = this.#manager.expansion;\r\n\r\n\t#interactionMemoryManager?: UmbInteractionMemoryManager;\r\n\t#interactionMemoryUnique: string = 'UmbTreeItemPickerExpansion';\r\n\t#muteMemoryObservation = false;\r\n\r\n\tconstructor(host: UmbControllerHost, args?: UmbTreeItemPickerExpansionManagerArgs) {\r\n\t\tsuper(host);\r\n\t\tthis.#interactionMemoryManager = args?.interactionMemoryManager;\r\n\r\n\t\tif (this.#interactionMemoryManager) {\r\n\t\t\tthis.#observeInteractionMemory();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the full expansion state\r\n\t * @param {UmbEntityExpansionModel} expansion - The full expansion state to set\r\n\t * @memberof UmbTreeItemPickerExpansionManager\r\n\t */\r\n\tsetExpansion(expansion: UmbEntityExpansionModel): void {\r\n\t\tthis.#manager.setExpansion(expansion);\r\n\r\n\t\t// Store the latest expansion state in interaction memory\r\n\t\tif (expansion.length > 0) {\r\n\t\t\tthis.#setExpansionMemory();\r\n\t\t} else {\r\n\t\t\tthis.#removeExpansionMemory();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the current expansion state\r\n\t * @returns {UmbEntityExpansionModel} The full expansion state\r\n\t * @memberof UmbTreeItemPickerExpansionManager\r\n\t */\r\n\tgetExpansion(): UmbEntityExpansionModel {\r\n\t\treturn this.#manager.getExpansion();\r\n\t}\r\n\r\n\t#observeInteractionMemory() {\r\n\t\tthis.observe(this.#interactionMemoryManager?.memory(this.#interactionMemoryUnique), (memory) => {\r\n\t\t\tif (this.#muteMemoryObservation) return;\r\n\r\n\t\t\tif (memory) {\r\n\t\t\t\tthis.#applyExpansionInteractionMemory(memory);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t#setExpansionMemory() {\r\n\t\tif (!this.#interactionMemoryManager) return;\r\n\r\n\t\t// Add a memory entry with the latest expansion state\r\n\t\tconst memory: UmbInteractionMemoryModel = {\r\n\t\t\tunique: this.#interactionMemoryUnique,\r\n\t\t\tvalue: {\r\n\t\t\t\texpansion: this.getExpansion(),\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tthis.#muteMemoryObservation = true;\r\n\t\tthis.#interactionMemoryManager?.setMemory(memory);\r\n\t\tthis.#muteMemoryObservation = false;\r\n\t}\r\n\r\n\t#removeExpansionMemory() {\r\n\t\tif (!this.#interactionMemoryManager) return;\r\n\t\tthis.#interactionMemoryManager.deleteMemory(this.#interactionMemoryUnique);\r\n\t}\r\n\r\n\t#applyExpansionInteractionMemory(memory: UmbInteractionMemoryModel) {\r\n\t\tconst memoryExpansion = memory?.value?.expansion as UmbEntityExpansionModel | undefined;\r\n\r\n\t\tif (memoryExpansion) {\r\n\t\t\tthis.#manager.setExpansion(memoryExpansion);\r\n\t\t}\r\n\t}\r\n}\r\n","import { UmbTreeItemPickerExpansionManager } from './tree-item-picker-expansion.manager.js';\r\nimport { UmbPickerContext } from '@umbraco-cms/backoffice/picker';\r\n\r\nexport class UmbTreeItemPickerContext extends UmbPickerContext {\r\n\tpublic readonly expansion = new UmbTreeItemPickerExpansionManager(this, {\r\n\t\tinteractionMemoryManager: this.interactionMemory,\r\n\t});\r\n}\r\n\r\nexport { UmbTreeItemPickerContext as api };\r\n","import { UmbTreeItemPickerContext } from '../tree-item-picker/index.js';\r\nimport type { UmbTreeElement } from '../tree.element.js';\r\nimport type { UmbTreeItemModelBase, UmbTreeSelectionConfiguration } from '../types.js';\r\nimport type { UmbTreePickerModalData, UmbTreePickerModalValue } from './tree-picker-modal.token.js';\r\nimport { customElement, html, ifDefined, nothing, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbDeselectedEvent, UmbSelectedEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UmbModalRouteRegistrationController } from '@umbraco-cms/backoffice/router';\r\nimport { UmbPickerModalBaseElement } from '@umbraco-cms/backoffice/picker';\r\nimport { UMB_WORKSPACE_MODAL } from '@umbraco-cms/backoffice/workspace';\r\nimport type { PropertyValueMap } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UmbEntityExpansionModel, UmbExpansionChangeEvent } from '@umbraco-cms/backoffice/utils';\r\n\r\n@customElement('umb-tree-picker-modal')\r\nexport class UmbTreePickerModalElement<TreeItemType extends UmbTreeItemModelBase> extends UmbPickerModalBaseElement<\r\n\tTreeItemType,\r\n\tUmbTreePickerModalData<TreeItemType>,\r\n\tUmbTreePickerModalValue\r\n> {\r\n\t@state()\r\n\tprivate _selectionConfiguration: UmbTreeSelectionConfiguration = {\r\n\t\tmultiple: false,\r\n\t\tselectable: true,\r\n\t\tselection: [],\r\n\t};\r\n\r\n\t@state()\r\n\tprivate _hasSelection: boolean = false;\r\n\r\n\t@state()\r\n\tprivate _createPath?: string;\r\n\r\n\t@state()\r\n\tprivate _createLabel?: string;\r\n\r\n\t@state()\r\n\tprivate _searchQuery?: string;\r\n\r\n\t@state()\r\n\tprivate _treeExpansion: UmbEntityExpansionModel = [];\r\n\r\n\tprotected _pickerContext = new UmbTreeItemPickerContext(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis._pickerContext.selection.setSelectable(true);\r\n\t\tthis.observe(this._pickerContext.selection.hasSelection, (hasSelection) => {\r\n\t\t\tthis._hasSelection = hasSelection;\r\n\t\t});\r\n\t\tthis.#observePickerSelection();\r\n\t\tthis.#observeSearch();\r\n\t\tthis.#observeExpansion();\r\n\t}\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\t\tthis.#initCreateAction();\r\n\t}\r\n\r\n\tprotected override async updated(_changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>) {\r\n\t\tsuper.updated(_changedProperties);\r\n\r\n\t\tif (_changedProperties.has('data')) {\r\n\t\t\tif (this.data?.search) {\r\n\t\t\t\tthis._pickerContext.search.updateConfig({\r\n\t\t\t\t\t...this.data.search,\r\n\t\t\t\t\tsearchFrom: this.data.startNode,\r\n\t\t\t\t\tdataTypeUnique: this._pickerContext.dataType?.unique,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst multiple = this.data?.multiple ?? false;\r\n\t\t\tthis._pickerContext.selection.setMultiple(multiple);\r\n\r\n\t\t\tthis._selectionConfiguration = {\r\n\t\t\t\t...this._selectionConfiguration,\r\n\t\t\t\tmultiple,\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (_changedProperties.has('value')) {\r\n\t\t\tconst selection = this.value?.selection ?? [];\r\n\t\t\tthis._pickerContext.selection.setSelection(selection);\r\n\t\t\tthis._selectionConfiguration = {\r\n\t\t\t\t...this._selectionConfiguration,\r\n\t\t\t\tselection: [...selection],\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t#observePickerSelection() {\r\n\t\tthis.observe(\r\n\t\t\tthis._pickerContext.selection.selection,\r\n\t\t\t(selection) => {\r\n\t\t\t\tthis.updateValue({ selection });\r\n\t\t\t\tthis.requestUpdate();\r\n\t\t\t},\r\n\t\t\t'umbPickerSelectionObserver',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeSearch() {\r\n\t\tthis.observe(\r\n\t\t\tthis._pickerContext.search.query,\r\n\t\t\t(query) => {\r\n\t\t\t\tthis._searchQuery = query?.query;\r\n\t\t\t},\r\n\t\t\t'umbPickerSearchQueryObserver',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeExpansion() {\r\n\t\tthis.observe(\r\n\t\t\tthis._pickerContext.expansion.expansion,\r\n\t\t\t(value) => {\r\n\t\t\t\tthis._treeExpansion = value;\r\n\t\t\t},\r\n\t\t\t'umbTreeItemPickerExpansionObserver',\r\n\t\t);\r\n\t}\r\n\r\n\t// Tree Selection\r\n\t#onTreeItemSelected(event: UmbSelectedEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tthis._pickerContext.selection.select(event.unique);\r\n\t\tthis.modalContext?.dispatchEvent(new UmbSelectedEvent(event.unique));\r\n\t}\r\n\r\n\t#onTreeItemDeselected(event: UmbDeselectedEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tthis._pickerContext.selection.deselect(event.unique);\r\n\t\tthis.modalContext?.dispatchEvent(new UmbDeselectedEvent(event.unique));\r\n\t}\r\n\r\n\t// Create action\r\n\t#initCreateAction() {\r\n\t\t// TODO: If data.enableCreate is true, we should add a button to create a new item. [NL]\r\n\t\t// Does the tree know enough about this, for us to be able to create a new item? [NL]\r\n\t\t// I think we need to be able to get entityType and a parentId?, or do we only allow creation in the root? and then create via entity actions? [NL]\r\n\t\t// To remove the hardcoded URLs for workspaces of entity types, we could make an create event from the tree, which either this or the sidebar impl. will pick up and react to. [NL]\r\n\t\t// Or maybe the tree item context base can handle this? [NL]\r\n\t\t// Maybe its a general item context problem to be solved. [NL]\r\n\t\tconst createAction = this.data?.createAction;\r\n\t\tif (createAction) {\r\n\t\t\tthis._createLabel = createAction.label;\r\n\t\t\tnew UmbModalRouteRegistrationController(\r\n\t\t\t\tthis,\r\n\t\t\t\t(createAction.modalToken as typeof UMB_WORKSPACE_MODAL) ?? UMB_WORKSPACE_MODAL,\r\n\t\t\t)\r\n\t\t\t\t.onSetup(() => {\r\n\t\t\t\t\treturn { data: createAction.modalData };\r\n\t\t\t\t})\r\n\t\t\t\t.onSubmit((value) => {\r\n\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\tthis.value = { selection: [value.unique] };\r\n\t\t\t\t\t\tthis._submitModal();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._rejectModal();\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\t\tconst oldPath = this._createPath;\r\n\t\t\t\t\tthis._createPath =\r\n\t\t\t\t\t\trouteBuilder({}) + createAction.extendWithPathPattern.generateLocal(createAction.extendWithPathParams);\r\n\t\t\t\t\tthis.requestUpdate('_createPath', oldPath);\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t#onTreeItemExpansionChange(event: UmbExpansionChangeEvent) {\r\n\t\tconst target = event.target as UmbTreeElement;\r\n\t\tconst expansion = target.getExpansion();\r\n\t\tthis._pickerContext.expansion.setExpansion(expansion);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-body-layout headline=${this.localize.term('general_choose')}>\r\n\t\t\t\t<uui-box> ${this.#renderSearch()} ${this.#renderTree()}</uui-box>\r\n\t\t\t\t${this.#renderActions()}\r\n\t\t\t</umb-body-layout>\r\n\t\t`;\r\n\t}\r\n\t#renderSearch() {\r\n\t\treturn html`\r\n\t\t\t<umb-picker-search-field></umb-picker-search-field>\r\n\t\t\t<umb-picker-search-result .pickableFilter=${this.data?.pickableFilter}></umb-picker-search-result>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderTree() {\r\n\t\tif (this._searchQuery) {\r\n\t\t\treturn nothing;\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-tree\r\n\t\t\t\talias=${ifDefined(this.data?.treeAlias)}\r\n\t\t\t\t.props=${{\r\n\t\t\t\t\thideTreeItemActions: true,\r\n\t\t\t\t\thideTreeRoot: this.data?.hideTreeRoot,\r\n\t\t\t\t\texpandTreeRoot: this.data?.expandTreeRoot,\r\n\t\t\t\t\tselectionConfiguration: this._selectionConfiguration,\r\n\t\t\t\t\tfilter: this.data?.filter,\r\n\t\t\t\t\tselectableFilter: this.data?.pickableFilter,\r\n\t\t\t\t\tstartNode: this.data?.startNode,\r\n\t\t\t\t\tfoldersOnly: this.data?.foldersOnly,\r\n\t\t\t\t\texpansion: this._treeExpansion,\r\n\t\t\t\t}}\r\n\t\t\t\t@selected=${this.#onTreeItemSelected}\r\n\t\t\t\t@deselected=${this.#onTreeItemDeselected}\r\n\t\t\t\t@expansion-change=${this.#onTreeItemExpansionChange}></umb-tree>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderActions() {\r\n\t\treturn html`\r\n\t\t\t<div slot=\"actions\">\r\n\t\t\t\t<uui-button label=${this.localize.term('general_close')} @click=${this._rejectModal}></uui-button>\r\n\t\t\t\t${this._createPath\r\n\t\t\t\t\t? html` <uui-button\r\n\t\t\t\t\t\t\tlabel=${this.localize.string(this._createLabel ?? '#general_create')}\r\n\t\t\t\t\t\t\tlook=\"secondary\"\r\n\t\t\t\t\t\t\thref=${this._createPath}></uui-button>`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tlabel=${this.localize.term('general_choose')}\r\n\t\t\t\t\tlook=\"primary\"\r\n\t\t\t\t\tcolor=\"positive\"\r\n\t\t\t\t\t@click=${this._submitModal}\r\n\t\t\t\t\t?disabled=${!this._hasSelection}></uui-button>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n}\r\n\r\nexport default UmbTreePickerModalElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-tree-picker-modal': UmbTreePickerModalElement<UmbTreeItemModelBase>;\r\n\t}\r\n}\r\n"],"names":["UmbTreeItemPickerExpansionManager","UmbControllerBase","host","args","#manager","UmbEntityExpansionManager","#interactionMemoryUnique","#muteMemoryObservation","#interactionMemoryManager","#observeInteractionMemory","expansion","#setExpansionMemory","#removeExpansionMemory","memory","#applyExpansionInteractionMemory","memoryExpansion","UmbTreeItemPickerContext","UmbPickerContext","_UmbTreePickerModalElement_instances","observePickerSelection_fn","observeSearch_fn","observeExpansion_fn","onTreeItemSelected_fn","onTreeItemDeselected_fn","initCreateAction_fn","onTreeItemExpansionChange_fn","renderSearch_fn","renderTree_fn","renderActions_fn","UmbTreePickerModalElement","UmbPickerModalBaseElement","__privateAdd","hasSelection","__privateMethod","_changedProperties","multiple","selection","html","query","value","event","UmbSelectedEvent","UmbDeselectedEvent","createAction","UmbModalRouteRegistrationController","UMB_WORKSPACE_MODAL","routeBuilder","oldPath","nothing","ifDefined","__decorateClass","state","customElement","UmbTreePickerModalElement$1"],"mappings":"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"}