{"version":3,"file":"variant-id.class-DtPIPk7p.js","sources":["../../../src/packages/core/variant/variant-id.class.ts"],"sourcesContent":["import { UmbDeprecation } from '../utils/index.js';\r\nimport type { UmbObjectWithVariantProperties } from './types.js';\r\n\r\n/**\r\n *\r\n * @param {UmbObjectWithVariantProperties} variant - An object with variant specifying properties to convert to a string.\r\n * @returns {string} A string representation of the variant properties.\r\n * @deprecated Use UmbVariantId to make this conversion. Will ve removed in v.17\r\n */\r\nexport function variantPropertiesObjectToString(variant: UmbObjectWithVariantProperties): string {\r\n\tnew UmbDeprecation({\r\n\t\tdeprecated: 'Method `variantPropertiesObjectToString` is deprecated',\r\n\t\tremoveInVersion: '17',\r\n\t\tsolution: 'Use UmbVariantId to make this conversion',\r\n\t}).warn();\r\n\t// Currently a direct copy of the toString method of variantId.\r\n\treturn (variant.culture || UMB_INVARIANT_CULTURE) + (variant.segment ? `_${variant.segment}` : '');\r\n}\r\n\r\nexport const UMB_INVARIANT_CULTURE = 'invariant';\r\n\r\n/**\r\n * An identifier representing a Variant. This is at current state a culture and a segment.\r\n * The identifier is not specific for ContentType Variants, but is used for many type of identification of a culture and a segment. One case is any property of a ContentType can be resolved into a VariantId depending on their structural settings such as Vary by Culture and Vary by Segmentation.\r\n */\r\nexport class UmbVariantId {\r\n\tpublic static Create(variantData: UmbObjectWithVariantProperties): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(variantData.culture, variantData.segment));\r\n\t}\r\n\r\n\tpublic static CreateFromPartial(variantData: Partial<UmbObjectWithVariantProperties>): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(variantData.culture, variantData.segment));\r\n\t}\r\n\r\n\tpublic static CreateInvariant(): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(null, null));\r\n\t}\r\n\r\n\tpublic static FromString(str: string): UmbVariantId {\r\n\t\tconst firstUnderscoreIndex = str.indexOf('_');\r\n\t\tlet culture: string | null = firstUnderscoreIndex === -1 ? str : str.substring(0, firstUnderscoreIndex);\r\n\t\tculture = culture === UMB_INVARIANT_CULTURE ? null : culture;\r\n\r\n\t\tconst segment = firstUnderscoreIndex === -1 ? null : str.substring(firstUnderscoreIndex + 1) || null;\r\n\r\n\t\treturn Object.freeze(new UmbVariantId(culture, segment));\r\n\t}\r\n\r\n\tpublic readonly culture: string | null = null;\r\n\tpublic readonly segment: string | null = null;\r\n\r\n\tconstructor(culture?: string | null, segment?: string | null) {\r\n\t\tthis.culture = (culture === UMB_INVARIANT_CULTURE ? null : culture) ?? null;\r\n\t\tthis.segment = segment ?? null;\r\n\t}\r\n\r\n\tpublic compare(obj: UmbObjectWithVariantProperties): boolean {\r\n\t\treturn this.equal(new UmbVariantId(obj.culture, obj.segment));\r\n\t}\r\n\r\n\tpublic equal(variantId: UmbVariantId): boolean {\r\n\t\treturn this.culture === variantId.culture && this.segment === variantId.segment;\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\t// Currently a direct copy of the VariantPropertiesObjectToString method const.\r\n\t\treturn (this.culture || UMB_INVARIANT_CULTURE) + (this.segment ? `_${this.segment}` : '');\r\n\t}\r\n\r\n\tpublic toCultureString(): string {\r\n\t\treturn this.culture || UMB_INVARIANT_CULTURE;\r\n\t}\r\n\r\n\tpublic toSegmentString(): string {\r\n\t\treturn this.segment || '';\r\n\t}\r\n\r\n\tpublic isCultureInvariant(): boolean {\r\n\t\treturn this.culture === null;\r\n\t}\r\n\r\n\tpublic isSegmentInvariant(): boolean {\r\n\t\treturn this.segment === null;\r\n\t}\r\n\r\n\tpublic isInvariant(): boolean {\r\n\t\treturn this.culture === null && this.segment === null;\r\n\t}\r\n\r\n\tpublic clone(): UmbVariantId {\r\n\t\treturn new UmbVariantId(null, this.segment);\r\n\t}\r\n\r\n\tpublic toObject(): UmbObjectWithVariantProperties {\r\n\t\treturn { culture: this.culture, segment: this.segment };\r\n\t}\r\n\r\n\tpublic toSegmentInvariant(): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(this.culture, null));\r\n\t}\r\n\tpublic toCultureInvariant(): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(null, this.segment));\r\n\t}\r\n\r\n\tpublic toCulture(culture: string | null): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(culture, this.segment));\r\n\t}\r\n\tpublic toSegment(segment: string | null): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(this.culture, segment));\r\n\t}\r\n\r\n\tpublic toVariant(varyByCulture?: boolean, varyBySegment?: boolean): UmbVariantId {\r\n\t\treturn Object.freeze(new UmbVariantId(varyByCulture ? this.culture : null, varyBySegment ? this.segment : null));\r\n\t}\r\n\r\n\t// TODO: needs localization option:\r\n\t// TODO: Consider if this should be handled else where, it does not seem like the responsibility of this class, since it contains wordings:\r\n\tpublic toDifferencesString(\r\n\t\tvariantId: UmbVariantId,\r\n\t\tinvariantMessage: string = 'Invariant',\r\n\t\tunsegmentedMessage: string = 'Unsegmented',\r\n\t): string {\r\n\t\tlet r = '';\r\n\r\n\t\tif (variantId.culture !== this.culture) {\r\n\t\t\tr = invariantMessage;\r\n\t\t}\r\n\r\n\t\tif (variantId.segment !== this.segment) {\r\n\t\t\tr = (r !== '' ? ' ' : '') + unsegmentedMessage;\r\n\t\t}\r\n\r\n\t\treturn r;\r\n\t}\r\n}\r\n"],"names":["variantPropertiesObjectToString","variant","UmbDeprecation","UMB_INVARIANT_CULTURE","UmbVariantId","culture","segment","variantData","str","firstUnderscoreIndex","obj","variantId","varyByCulture","varyBySegment","invariantMessage","unsegmentedMessage","r"],"mappings":"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"}