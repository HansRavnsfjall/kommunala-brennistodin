{"version":3,"file":"index.js","sources":["../../../src/packages/data-type/components/data-type-input/data-type-input.context.ts","../../../src/packages/data-type/components/data-type-input/data-type-input.element.ts","../../../src/packages/data-type/components/data-type-flow-input/data-type-flow-input.element.ts","../../../src/packages/data-type/components/ref-data-type/ref-data-type.element.ts","../../../src/packages/data-type/components/property-editor-config/property-editor-config.element.ts","../../../src/packages/data-type/workspace/views/details/data-type-details-workspace-property-editor-picker.element.ts","../../../src/packages/data-type/repository/manager/data-type-item-repository-manager.ts"],"sourcesContent":["import { UMB_DATA_TYPE_ITEM_REPOSITORY_ALIAS } from '../../constants.js';\r\nimport type { UmbDataTypeItemModel } from '../../repository/item/types.js';\r\nimport type { UmbDataTypePickerModalData, UmbDataTypePickerModalValue } from '../../modals/constants.js';\r\nimport { UMB_DATA_TYPE_PICKER_MODAL } from '../../modals/constants.js';\r\nimport type { UmbDataTypeTreeItemModel } from '../../tree/types.js';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { UmbPickerInputContext } from '@umbraco-cms/backoffice/picker-input';\r\n\r\nexport class UmbDataTypePickerInputContext extends UmbPickerInputContext<\r\n\tUmbDataTypeItemModel,\r\n\tUmbDataTypeTreeItemModel,\r\n\tUmbDataTypePickerModalData,\r\n\tUmbDataTypePickerModalValue\r\n> {\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_DATA_TYPE_ITEM_REPOSITORY_ALIAS, UMB_DATA_TYPE_PICKER_MODAL);\r\n\t}\r\n}\r\n","import type { UmbDataTypeItemModel } from '../../repository/item/types.js';\r\nimport { UmbDataTypePickerInputContext } from './data-type-input.context.js';\r\nimport { css, html, customElement, nothing, property, repeat, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { splitStringToArray } from '@umbraco-cms/backoffice/utils';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbSorterController } from '@umbraco-cms/backoffice/sorter';\r\nimport { UUIFormControlMixin } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n// TODO: Rename to 'umb-input-data-type'. [LK]\r\n@customElement('umb-data-type-input')\r\nexport class UmbDataTypeInputElement extends UUIFormControlMixin(UmbLitElement, '') {\r\n\t#sorter = new UmbSorterController<string>(this, {\r\n\t\tgetUniqueOfElement: (element) => {\r\n\t\t\treturn element.id;\r\n\t\t},\r\n\t\tgetUniqueOfModel: (modelEntry) => {\r\n\t\t\treturn modelEntry;\r\n\t\t},\r\n\t\tidentifier: 'Umb.SorterIdentifier.InputDataType',\r\n\t\titemSelector: 'uui-ref-node-data-type',\r\n\t\tcontainerSelector: 'uui-ref-list',\r\n\t\tonChange: ({ model }) => {\r\n\t\t\tthis.selection = model;\r\n\t\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t\t},\r\n\t});\r\n\r\n\t/**\r\n\t * This is a minimum amount of selected items in this input.\r\n\t * @type {number}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: Number })\r\n\tpublic set min(value: number) {\r\n\t\tthis.#pickerContext.min = value;\r\n\t}\r\n\tpublic get min(): number {\r\n\t\treturn this.#pickerContext.min;\r\n\t}\r\n\r\n\t/**\r\n\t * Min validation message.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: String, attribute: 'min-message' })\r\n\tminMessage = 'This field need more items';\r\n\r\n\t/**\r\n\t * This is a maximum amount of selected items in this input.\r\n\t * @type {number}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: Number })\r\n\tpublic set max(value: number) {\r\n\t\tthis.#pickerContext.max = value;\r\n\t}\r\n\tpublic get max(): number {\r\n\t\treturn this.#pickerContext.max;\r\n\t}\r\n\r\n\t/**\r\n\t * Max validation message.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: String, attribute: 'min-message' })\r\n\tmaxMessage = 'This field exceeds the allowed amount of items';\r\n\r\n\t@property({ type: Array })\r\n\tpublic set selection(uniques: Array<string>) {\r\n\t\tthis.#pickerContext.setSelection(uniques ?? []);\r\n\t\tthis.#sorter.setModel(uniques);\r\n\t}\r\n\tpublic get selection(): Array<string> {\r\n\t\treturn this.#pickerContext.getSelection();\r\n\t}\r\n\r\n\t@property()\r\n\tpublic override set value(uniques: string) {\r\n\t\tthis.selection = splitStringToArray(uniques);\r\n\t}\r\n\tpublic override get value(): string {\r\n\t\treturn this.selection.join(',');\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _items?: Array<UmbDataTypeItemModel>;\r\n\r\n\t#pickerContext = new UmbDataTypePickerInputContext(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'rangeUnderflow',\r\n\t\t\t() => this.minMessage,\r\n\t\t\t() => !!this.min && this.#pickerContext.getSelection().length < this.min,\r\n\t\t);\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'rangeOverflow',\r\n\t\t\t() => this.maxMessage,\r\n\t\t\t() => !!this.max && this.#pickerContext.getSelection().length > this.max,\r\n\t\t);\r\n\r\n\t\tthis.observe(this.#pickerContext.selection, (selection) => (this.value = selection.join(',')), '_observeSelection');\r\n\t\tthis.observe(this.#pickerContext.selectedItems, (selectedItems) => (this._items = selectedItems), '_observerItems');\r\n\t}\r\n\r\n\tprotected override getFormElement() {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t#openPicker() {\r\n\t\tthis.#pickerContext.openPicker({\r\n\t\t\thideTreeRoot: true,\r\n\t\t});\r\n\t}\r\n\r\n\t#removeItem(item: UmbDataTypeItemModel) {\r\n\t\tthis.#pickerContext.requestRemoveItem(item.unique);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`${this.#renderItems()} ${this.#renderAddButton()}`;\r\n\t}\r\n\r\n\t#renderAddButton() {\r\n\t\tif (this.max > 0 && this.selection.length >= this.max) return nothing;\r\n\t\treturn html`\r\n\t\t\t<uui-button\r\n\t\t\t\tid=\"btn-add\"\r\n\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t@click=${this.#openPicker}\r\n\t\t\t\tlabel=\"${this.localize.term('general_choose')}\"></uui-button>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItems() {\r\n\t\tif (!this._items) return nothing;\r\n\t\treturn html`\r\n\t\t\t<uui-ref-list>\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis._items,\r\n\t\t\t\t\t(item) => item.unique,\r\n\t\t\t\t\t(item) => this.#renderItem(item),\r\n\t\t\t\t)}\r\n\t\t\t</uui-ref-list>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: UmbDataTypeItemModel) {\r\n\t\tif (!item.unique) return;\r\n\t\treturn html`\r\n\t\t\t<uui-ref-node-data-type name=${item.name} id=${item.unique}>\r\n\t\t\t\t<uui-action-bar slot=\"actions\">\r\n\t\t\t\t\t<uui-button @click=${() => this.#removeItem(item)} label=${this.localize.term('general_remove')}></uui-button>\r\n\t\t\t\t</uui-action-bar>\r\n\t\t\t</uui-ref-node-data-type>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#btn-add {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDataTypeInputElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-data-type-input': UmbDataTypeInputElement;\r\n\t}\r\n}\r\n","import { UMB_DATA_TYPE_PICKER_FLOW_MODAL, UMB_DATATYPE_WORKSPACE_MODAL } from '../../constants.js';\r\nimport { css, html, customElement, property, state, type PropertyValueMap } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbModalRouteRegistrationController } from '@umbraco-cms/backoffice/router';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UMB_VALIDATION_EMPTY_LOCALIZATION_KEY, UmbFormControlMixin } from '@umbraco-cms/backoffice/validation';\r\n\r\n// Note: Does only support picking a single data type. But this could be developed later into this same component. To follow other picker input components.\r\n/**\r\n * Form control for picking or creating a data type.\r\n * @element umb-data-type-flow-input\r\n * @fires change - when the value of the input changes\r\n * @fires blur - when the input loses focus\r\n * @fires focus - when the input gains focus\r\n */\r\n@customElement('umb-data-type-flow-input')\r\nexport class UmbInputDataTypeElement extends UmbFormControlMixin(UmbLitElement, '') {\r\n\tprotected override getFormElement() {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _ids?: Array<string>;\r\n\r\n\t/**\r\n\t * @param {string} dataTypeId\r\n\t * @default\r\n\t */\r\n\t@property({ type: String, attribute: false })\r\n\toverride set value(dataTypeId: string) {\r\n\t\tsuper.value = dataTypeId ?? '';\r\n\t\tthis._ids = super.value\r\n\t\t\t.split(',')\r\n\t\t\t.map((tag) => tag.trim())\r\n\t\t\t.filter((id) => id.length !== 0);\r\n\t}\r\n\toverride get value(): string {\r\n\t\treturn super.value?.toString() ?? '';\r\n\t}\r\n\r\n\t#editDataTypeModal;\r\n\r\n\t@state()\r\n\tprivate _createRoute?: string;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.#editDataTypeModal = new UmbModalRouteRegistrationController(this, UMB_DATATYPE_WORKSPACE_MODAL);\r\n\r\n\t\tnew UmbModalRouteRegistrationController(this, UMB_DATA_TYPE_PICKER_FLOW_MODAL)\r\n\t\t\t.onSetup(() => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tdata: {},\r\n\t\t\t\t\tvalue: { selection: this._ids ?? [] },\r\n\t\t\t\t};\r\n\t\t\t})\r\n\t\t\t.onSubmit((submitData) => {\r\n\t\t\t\t// TODO: we maybe should set the alias to null, if no selection?\r\n\t\t\t\tthis.value = submitData?.selection.join(',') ?? '';\r\n\t\t\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis._createRoute = routeBuilder(null);\r\n\t\t\t});\r\n\t}\r\n\r\n\tprotected override firstUpdated(_changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>): void {\r\n\t\tsuper.firstUpdated(_changedProperties);\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'valueMissing',\r\n\t\t\t() => UMB_VALIDATION_EMPTY_LOCALIZATION_KEY,\r\n\t\t\t() => this.hasAttribute('required') && !this.value,\r\n\t\t);\r\n\t}\r\n\r\n\toverride focus() {\r\n\t\tthis.shadowRoot?.querySelector('umb-ref-data-type')?.focus();\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._ids && this._ids.length > 0\r\n\t\t\t? html`\r\n\t\t\t\t\t<umb-ref-data-type\r\n\t\t\t\t\t\tdata-type-id=${this._ids[0]}\r\n\t\t\t\t\t\t@open=${() => {\r\n\t\t\t\t\t\t\t// TODO: Could use something smarter for workspace modals, as I would like to avoid setting the rest of the URL here:\r\n\t\t\t\t\t\t\tthis.#editDataTypeModal?.open({}, 'edit/' + this._ids![0]);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tstandalone>\r\n\t\t\t\t\t\t<uui-action-bar slot=\"actions\">\r\n\t\t\t\t\t\t\t<uui-button label=\"Change\" .href=${this._createRoute}></uui-button>\r\n\t\t\t\t\t\t</uui-action-bar>\r\n\t\t\t\t\t</umb-ref-data-type>\r\n\t\t\t\t`\r\n\t\t\t: html`\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tid=\"empty-state-button\"\r\n\t\t\t\t\t\tlabel=\"Select Property Editor\"\r\n\t\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\t\tcolor=\"default\"\r\n\t\t\t\t\t\t@blur=${() => {\r\n\t\t\t\t\t\t\tthis.pristine = false;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t.href=${this._createRoute}></uui-button>\r\n\t\t\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#empty-state-button {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\t--uui-button-padding-top-factor: 4;\r\n\t\t\t\t--uui-button-padding-bottom-factor: 4;\r\n\t\t\t}\r\n\t\t\t:host(:invalid:not([pristine])) #empty-state-button {\r\n\t\t\t\t--uui-button-border-color: var(--uui-color-invalid);\r\n\t\t\t\t--uui-button-border-width: 2px;\r\n\t\t\t\t--uui-button-contrast: var(--uui-color-invalid);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-data-type-flow-input': UmbInputDataTypeElement;\r\n\t}\r\n}\r\n","import { UmbDataTypeDetailRepository } from '../../repository/detail/data-type-detail.repository.js';\r\nimport { UUIIconRequestEvent, UUIRefNodeElement } from '@umbraco-cms/backoffice/external/uui';\r\nimport { html, customElement, property, state, css } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbElementMixin } from '@umbraco-cms/backoffice/element-api';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\n\r\n/**\r\n *  @element umb-ref-data-type\r\n *  @description - Component for displaying a reference to a Data Type\r\n *  @augments UUIRefNodeElement\r\n */\r\n@customElement('umb-ref-data-type')\r\nexport class UmbRefDataTypeElement extends UmbElementMixin(UUIRefNodeElement) {\r\n\t@state()\r\n\tprotected override fallbackIcon =\r\n\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" fill=\"currentColor\"><path d=\"M255.981 440.734c-4.422 0-8.895-.159-13.293-.471l1.682-23.62c15.395 1.095 31.076-.014 46.053-3.277l5.039 23.137a185.943 185.943 0 0 1-39.481 4.231zm-43.253-5.094a183.61 183.61 0 0 1-49.174-19.657l11.864-20.49a159.927 159.927 0 0 0 42.833 17.123l-5.523 23.024zm111.734-8.02l-8.781-21.991a160.553 160.553 0 0 0 39.949-23.097l14.666 18.593a184.376 184.376 0 0 1-45.834 26.495zm-185.815-28.926a185.575 185.575 0 0 1-35.652-39.114l19.596-13.293a161.956 161.956 0 0 0 31.105 34.125l-15.049 18.282zm253.834-18.216l-17.492-15.96a161.321 161.321 0 0 0 25.924-38.192l21.297 10.353a184.986 184.986 0 0 1-29.729 43.799zM88.097 333.183a183.381 183.381 0 0 1-14.977-50.791l23.438-3.355a159.869 159.869 0 0 0 13.047 44.243l-21.508 9.903zm345.082-24.798l-22.711-6.705c4.355-14.761 6.566-30.131 6.566-45.679h23.678c0 17.818-2.533 35.444-7.533 52.384zM94.96 252.634l-23.672-.483c.365-17.809 3.266-35.378 8.625-52.224l22.566 7.181c-4.671 14.677-7.203 29.996-7.519 45.526zm320.881-16.346a159.854 159.854 0 0 0-12.115-44.503l21.713-9.45a183.696 183.696 0 0 1 13.908 51.088l-23.506 2.865zM112.546 182.67l-21.072-10.798a184.915 184.915 0 0 1 30.633-43.168l17.154 16.319a161.599 161.599 0 0 0-26.715 37.647zm278.68-14.155a161.801 161.801 0 0 0-30.389-34.763l15.426-17.966a185.512 185.512 0 0 1 34.832 39.846l-19.869 12.883zm-232.239-41.101l-14.273-18.894a184.318 184.318 0 0 1 46.375-25.533l8.322 22.169a160.705 160.705 0 0 0-40.424 22.258zm180.444-9.19a160.053 160.053 0 0 0-42.466-18.02l6.009-22.903a183.633 183.633 0 0 1 48.748 20.684l-12.291 20.239zM224.825 97.956l-4.553-23.239a186.147 186.147 0 0 1 35.705-3.45h.004c5.711 0 11.473.266 17.129.786l-2.174 23.58c-15.306-1.414-31.072-.624-46.111 2.323z\"/></svg>`;\r\n\t//icon-circle-dotted.svg\r\n\r\n\t@property({ type: String, attribute: 'data-type-id' })\r\n\tpublic get dataTypeId(): string | undefined {\r\n\t\treturn undefined;\r\n\t}\r\n\tpublic set dataTypeId(value: string | undefined) {\r\n\t\tthis.setDataTypeId(value);\r\n\t}\r\n\r\n\tasync setDataTypeId(value: string | undefined) {\r\n\t\tif (value) {\r\n\t\t\tthis.observe(\r\n\t\t\t\t(await this.repository.requestByUnique(value)).asObservable(),\r\n\t\t\t\t(dataType) => {\r\n\t\t\t\t\tif (dataType) {\r\n\t\t\t\t\t\tthis.name = dataType.name ?? '';\r\n\t\t\t\t\t\tthis.propertyEditorSchemaAlias = dataType.editorAlias ?? '';\r\n\t\t\t\t\t\tif (dataType.editorUiAlias ?? '' !== this.propertyEditorUiAlias) {\r\n\t\t\t\t\t\t\tthis.propertyEditorUiAlias = dataType.editorUiAlias ?? '';\r\n\t\t\t\t\t\t\tthis.#getIconFromUiAlias();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'dataType',\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\tthis.removeUmbControllerByAlias('dataType');\r\n\t\t}\r\n\t}\r\n\r\n\trepository = new UmbDataTypeDetailRepository(this);\r\n\r\n\t/**\r\n\t * Property Editor UI Alias\r\n\t */\r\n\t@state()\r\n\tpropertyEditorUiAlias = '';\r\n\r\n\t/**\r\n\t * Property Editor Model Alias\r\n\t */\r\n\t@state()\r\n\tpropertyEditorSchemaAlias = '';\r\n\r\n\tasync #getIconFromUiAlias() {\r\n\t\tif (!this.propertyEditorUiAlias) return;\r\n\t\tthis.observe(\r\n\t\t\tumbExtensionsRegistry.byTypeAndAlias('propertyEditorUi', this.propertyEditorUiAlias),\r\n\t\t\tasync (manifestPropertyEditorUi) => {\r\n\t\t\t\tconst icon = manifestPropertyEditorUi?.meta.icon;\r\n\t\t\t\t/**\r\n\t\t\t\t * [LI] We have the icon name now, but because this element extends from uui-ref-node, it wants the icon via the icon slot.\r\n\t\t\t\t * From what I can see, this is not possible via this file, but this is the file that have the datatype data....\r\n\t\t\t\t * Instead, overwriting the fallbackIcon property which requires a SVG...\r\n\t\t\t\t */\r\n\t\t\t\tif (icon) {\r\n\t\t\t\t\tthis.#requestIconSVG(icon);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'_observeIcon',\r\n\t\t);\r\n\t}\r\n\r\n\t#requestIconSVG(iconName: string) {\r\n\t\tif (iconName !== '' && iconName !== null) {\r\n\t\t\tconst event = new UUIIconRequestEvent(UUIIconRequestEvent.ICON_REQUEST, {\r\n\t\t\t\tdetail: { iconName: iconName },\r\n\t\t\t});\r\n\t\t\tthis.dispatchEvent(event);\r\n\t\t\tif (event.icon !== null) {\r\n\t\t\t\tevent.icon.then((iconSvg: string) => {\r\n\t\t\t\t\tthis.fallbackIcon = iconSvg;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected override renderDetail() {\r\n\t\tconst details: string[] = [];\r\n\r\n\t\tif (this.propertyEditorUiAlias !== '') {\r\n\t\t\tdetails.push(this.propertyEditorUiAlias);\r\n\t\t} else {\r\n\t\t\tdetails.push('Property Editor UI Missing');\r\n\t\t}\r\n\t\t/*\r\n\t\t// TODO: Revisit if its fine to leave this out:\r\n\t\tif (this.propertyEditorSchemaAlias !== '') {\r\n\t\t\tdetails.push(this.propertyEditorSchemaAlias);\r\n\t\t} else {\r\n\t\t\tdetails.push('Property Editor Model Missing');\r\n\t\t}\r\n\t\t*/\r\n\r\n\t\tif (this.detail !== '') {\r\n\t\t\tdetails.push(this.detail);\r\n\t\t}\r\n\t\treturn html`<small id=\"detail\">${details.join(' | ')}<slot name=\"detail\"></slot></small>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\t...UUIRefNodeElement.styles,\r\n\t\tcss`\r\n\t\t\t#detail {\r\n\t\t\t\tword-break: break-all;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-ref-data-type': UmbRefDataTypeElement;\r\n\t}\r\n}\r\n","import { UMB_DATA_TYPE_WORKSPACE_CONTEXT } from '../../workspace/data-type-workspace.context-token.js';\r\nimport { html, customElement, state, ifDefined, repeat } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { PropertyEditorSettingsProperty } from '@umbraco-cms/backoffice/property-editor';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbDataPathPropertyValueQuery } from '@umbraco-cms/backoffice/validation';\r\n\r\n/**\r\n * @element umb-property-editor-config\r\n * @description - Element for displaying the configuration for a Property Editor based on a Property Editor UI Alias and a Property Editor Model alias.\r\n * This element requires a UMB_DATA_TYPE_WORKSPACE_CONTEXT to be present.\r\n */\r\n@customElement('umb-property-editor-config')\r\nexport class UmbPropertyEditorConfigElement extends UmbLitElement {\r\n\t// TODO: Make this element generic, so its not bound to DATA-TYPEs. This will require moving some functionality of Data-Type-Context to this. and this might need to self provide a variant Context for its inner property editor UIs. [NL]\r\n\t#workspaceContext?: typeof UMB_DATA_TYPE_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\t@state()\r\n\tprivate _properties: Array<PropertyEditorSettingsProperty> = [];\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t// This now connects to the workspace, as the variant does not know about the layout details.\r\n\t\tthis.consumeContext(UMB_DATA_TYPE_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\t\t\tthis.#observeProperties();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeProperties() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext.properties,\r\n\t\t\t(properties) => {\r\n\t\t\t\tthis._properties = properties as Array<PropertyEditorSettingsProperty>;\r\n\t\t\t},\r\n\t\t\t'observeProperties',\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._properties?.length > 0\r\n\t\t\t? repeat(\r\n\t\t\t\t\tthis._properties,\r\n\t\t\t\t\t(property) => property.alias,\r\n\t\t\t\t\t(property) =>\r\n\t\t\t\t\t\thtml`<umb-property\r\n\t\t\t\t\t\t\tdata-path=\"$.values[${UmbDataPathPropertyValueQuery(property)}].value\"\r\n\t\t\t\t\t\t\tlabel=${property.label}\r\n\t\t\t\t\t\t\tdescription=${ifDefined(property.description)}\r\n\t\t\t\t\t\t\talias=${property.alias}\r\n\t\t\t\t\t\t\tproperty-editor-ui-alias=${property.propertyEditorUiAlias}\r\n\t\t\t\t\t\t\t.config=${property.config}></umb-property>`,\r\n\t\t\t\t)\r\n\t\t\t: html`<umb-localize key=\"editdatatype_noConfiguration\"\r\n\t\t\t\t\t>There is no configuration for this property editor.</umb-localize\r\n\t\t\t\t>`;\r\n\t}\r\n\r\n\tstatic override styles = [UmbTextStyles];\r\n}\r\n\r\nexport default UmbPropertyEditorConfigElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-config': UmbPropertyEditorConfigElement;\r\n\t}\r\n}\r\n","import { UMB_DATA_TYPE_WORKSPACE_CONTEXT } from '../../data-type-workspace.context-token.js';\r\nimport { css, customElement, html, nothing, property, ref } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UUIButtonElement } from '@umbraco-cms/backoffice/external/uui';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { umbOpenModal } from '@umbraco-cms/backoffice/modal';\r\nimport {\r\n\tUMB_MISSING_PROPERTY_EDITOR_UI_ALIAS,\r\n\tUMB_PROPERTY_EDITOR_UI_PICKER_MODAL,\r\n} from '@umbraco-cms/backoffice/property-editor';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UmbFormControlMixin } from '@umbraco-cms/backoffice/validation';\r\n\r\n/**\r\n * @internal\r\n */\r\n@customElement('umb-data-type-details-workspace-property-editor-picker')\r\nexport class UmbDataTypeDetailsWorkspacePropertyEditorPickerElement extends UmbFormControlMixin<\r\n\tundefined,\r\n\ttypeof UmbLitElement,\r\n\tundefined\r\n>(UmbLitElement) {\r\n\t@property({ type: String })\r\n\tpropertyEditorUiIcon?: string;\r\n\r\n\t@property({ type: String })\r\n\tpropertyEditorUiName?: string;\r\n\r\n\t@property({ type: String })\r\n\tpropertyEditorUiAlias?: string;\r\n\r\n\t@property({ type: String })\r\n\tpropertyEditorSchemaAlias?: string;\r\n\r\n\t#workspaceContext?: typeof UMB_DATA_TYPE_WORKSPACE_CONTEXT.TYPE;\r\n\t#addButton?: UUIButtonElement;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_DATA_TYPE_WORKSPACE_CONTEXT, (workspaceContext) => {\r\n\t\t\tthis.#workspaceContext = workspaceContext;\r\n\t\t});\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'customError',\r\n\t\t\t() => this.localize.term('missingEditor_dataTypeMissingEditorUiMessage'),\r\n\t\t\t() => !this.propertyEditorUiName,\r\n\t\t);\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'customError',\r\n\t\t\t() => this.localize.term('missingEditor_dataTypeMissingEditorMessage'),\r\n\t\t\t() => this.propertyEditorUiAlias === UMB_MISSING_PROPERTY_EDITOR_UI_ALIAS,\r\n\t\t);\r\n\t}\r\n\r\n\tprotected override getFormElement() {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t#addButtonRefChanged(input?: Element) {\r\n\t\tif (this.#addButton) {\r\n\t\t\tthis.removeFormControlElement(this.#addButton);\r\n\t\t}\r\n\t\tthis.#addButton = input as UUIButtonElement | undefined;\r\n\t\tif (this.#addButton) {\r\n\t\t\tthis.addFormControlElement(this.#addButton);\r\n\t\t}\r\n\t}\r\n\r\n\tasync #openPropertyEditorUIPicker() {\r\n\t\tconst value = await umbOpenModal(this, UMB_PROPERTY_EDITOR_UI_PICKER_MODAL, {\r\n\t\t\tvalue: {\r\n\t\t\t\tselection: this.propertyEditorUiAlias ? [this.propertyEditorUiAlias] : [],\r\n\t\t\t},\r\n\t\t}).catch(() => undefined);\r\n\r\n\t\tif (value) {\r\n\t\t\tthis.#workspaceContext?.setPropertyEditorUiAlias(value.selection[0]);\r\n\t\t}\r\n\t}\r\n\r\n\t#renderPropertyEditorReference() {\r\n\t\tif (!this.propertyEditorUiAlias || !this.propertyEditorSchemaAlias) return nothing;\r\n\r\n\t\tlet name = this.propertyEditorUiName;\r\n\t\tlet alias = this.propertyEditorUiAlias;\r\n\t\tlet error = false;\r\n\r\n\t\tif (!this.propertyEditorUiName) {\r\n\t\t\tname = this.localize.term('missingEditor_dataTypeMissingEditorUi');\r\n\t\t\terror = true;\r\n\t\t}\r\n\r\n\t\tif (this.propertyEditorUiAlias === UMB_MISSING_PROPERTY_EDITOR_UI_ALIAS) {\r\n\t\t\tname = this.localize.term('missingEditor_dataTypeMissingEditor');\r\n\t\t\talias = '';\r\n\t\t\terror = true;\r\n\t\t}\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-ref-property-editor-ui\r\n\t\t\t\tname=${name ?? ''}\r\n\t\t\t\talias=${alias}\r\n\t\t\t\tproperty-editor-schema-alias=${this.propertyEditorSchemaAlias}\r\n\t\t\t\tstandalone\r\n\t\t\t\t?error=${error}\r\n\t\t\t\t@open=${this.#openPropertyEditorUIPicker}>\r\n\t\t\t\t${this.propertyEditorUiIcon\r\n\t\t\t\t\t? html`<umb-icon name=${this.propertyEditorUiIcon} slot=\"icon\"></umb-icon>`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t\t<uui-action-bar slot=\"actions\">\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\tlabel=${this.localize.term('general_change')}\r\n\t\t\t\t\t\t@click=${this.#openPropertyEditorUIPicker}></uui-button>\r\n\t\t\t\t</uui-action-bar>\r\n\t\t\t</umb-ref-property-editor-ui>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderChooseButton() {\r\n\t\treturn html`\r\n\t\t\t<uui-button\r\n\t\t\t\tid=\"btn-add\"\r\n\t\t\t\tlabel=${this.localize.term('propertyEditorPicker_title')}\r\n\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\tcolor=\"default\"\r\n\t\t\t\trequired\r\n\t\t\t\t@click=${this.#openPropertyEditorUIPicker}\r\n\t\t\t\t${ref(this.#addButtonRefChanged)}></uui-button>\r\n\t\t`;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t${this.propertyEditorUiAlias && this.propertyEditorSchemaAlias\r\n\t\t\t\t? this.#renderPropertyEditorReference()\r\n\t\t\t\t: this.#renderChooseButton()}\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t#btn-add {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDataTypeDetailsWorkspacePropertyEditorPickerElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-data-type-details-workspace-property-editor-picker': UmbDataTypeDetailsWorkspacePropertyEditorPickerElement;\r\n\t}\r\n}\r\n","import type { UmbDataTypeItemModel } from '../item/types.js';\r\nimport { UMB_DATA_TYPE_ITEM_REPOSITORY_ALIAS } from '../item/constants.js';\r\nimport { UmbRepositoryItemsManager } from '@umbraco-cms/backoffice/repository';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\n\r\nexport class UmbDataTypeItemRepositoryManager extends UmbRepositoryItemsManager<UmbDataTypeItemModel> {\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_DATA_TYPE_ITEM_REPOSITORY_ALIAS);\r\n\t}\r\n}\r\n"],"names":["UmbDataTypePickerInputContext","UmbPickerInputContext","host","UMB_DATA_TYPE_ITEM_REPOSITORY_ALIAS","UMB_DATA_TYPE_PICKER_MODAL","_sorter","_pickerContext","_UmbDataTypeInputElement_instances","openPicker_fn","removeItem_fn","renderAddButton_fn","renderItems_fn","renderItem_fn","UmbDataTypeInputElement","UUIFormControlMixin","UmbLitElement","__privateAdd","UmbSorterController","element","modelEntry","model","UmbChangeEvent","__privateGet","selection","selectedItems","value","uniques","splitStringToArray","html","__privateMethod","item","nothing","repeat","css","__decorateClass","property","state","customElement","_editDataTypeModal","UmbInputDataTypeElement","UmbFormControlMixin","__privateSet","UmbModalRouteRegistrationController","UMB_DATATYPE_WORKSPACE_MODAL","UMB_DATA_TYPE_PICKER_FLOW_MODAL","submitData","routeBuilder","dataTypeId","tag","id","_changedProperties","UMB_VALIDATION_EMPTY_LOCALIZATION_KEY","_UmbRefDataTypeElement_instances","getIconFromUiAlias_fn","requestIconSVG_fn","UmbRefDataTypeElement","UmbElementMixin","UUIRefNodeElement","UmbDataTypeDetailRepository","dataType","details","umbExtensionsRegistry","manifestPropertyEditorUi","icon","iconName","event","UUIIconRequestEvent","iconSvg","_workspaceContext","_UmbPropertyEditorConfigElement_instances","observeProperties_fn","UmbPropertyEditorConfigElement","UMB_DATA_TYPE_WORKSPACE_CONTEXT","instance","UmbDataPathPropertyValueQuery","ifDefined","properties","UmbTextStyles","_addButton","_UmbDataTypeDetailsWorkspacePropertyEditorPickerElement_instances","addButtonRefChanged_fn","openPropertyEditorUIPicker_fn","renderPropertyEditorReference_fn","renderChooseButton_fn","UmbDataTypeDetailsWorkspacePropertyEditorPickerElement","workspaceContext","UMB_MISSING_PROPERTY_EDITOR_UI_ALIAS","input","umbOpenModal","UMB_PROPERTY_EDITOR_UI_PICKER_MODAL","name","alias","error","ref","UmbDataTypeItemRepositoryManager","UmbRepositoryItemsManager"],"mappings":"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"}