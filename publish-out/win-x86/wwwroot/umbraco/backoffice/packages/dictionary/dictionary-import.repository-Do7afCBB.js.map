{"version":3,"file":"dictionary-import.repository-Do7afCBB.js","sources":["../../../src/packages/dictionary/repository/import/dictionary-import.server.data-source.ts","../../../src/packages/dictionary/repository/import/dictionary-import.repository.ts"],"sourcesContent":["import type { ImportDictionaryRequestModel } from '@umbraco-cms/backoffice/external/backend-api';\r\nimport { DictionaryService } from '@umbraco-cms/backoffice/external/backend-api';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport { tryExecute } from '@umbraco-cms/backoffice/resources';\r\n\r\nexport class UmbDictionaryImportServerDataSource {\r\n\t#host: UmbControllerHost;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tthis.#host = host;\r\n\t}\r\n\r\n\t/**\r\n\t * @description - Import a dictionary\r\n\t * @param {string} temporaryFileUnique\r\n\t * @param {string?} parentUnique\r\n\t * @returns {*}\r\n\t * @memberof UmbDictionaryImportServerDataSource\r\n\t */\r\n\tasync import(temporaryFileUnique: string, parentUnique: string | null) {\r\n\t\tif (!temporaryFileUnique) throw new Error('temporaryFileUnique is required');\r\n\t\tif (parentUnique === undefined) throw new Error('parentUnique is required');\r\n\r\n\t\tconst body: ImportDictionaryRequestModel = {\r\n\t\t\ttemporaryFile: { id: temporaryFileUnique },\r\n\t\t\tparent: parentUnique ? { id: parentUnique } : null,\r\n\t\t};\r\n\r\n\t\treturn tryExecute(\r\n\t\t\tthis.#host,\r\n\t\t\tDictionaryService.postDictionaryImport({\r\n\t\t\t\tbody,\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n}\r\n","import { UmbDictionaryDetailRepository } from '../detail/index.js';\r\nimport { UmbDictionaryImportServerDataSource } from './dictionary-import.server.data-source.js';\r\nimport { UmbRepositoryBase } from '@umbraco-cms/backoffice/repository';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\n\r\nexport class UmbDictionaryImportRepository extends UmbRepositoryBase {\r\n\t#importSource: UmbDictionaryImportServerDataSource;\r\n\t#detailRepository: UmbDictionaryDetailRepository;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host);\r\n\t\tthis.#importSource = new UmbDictionaryImportServerDataSource(host);\r\n\t\tthis.#detailRepository = new UmbDictionaryDetailRepository(host);\r\n\t}\r\n\r\n\t/**\r\n\t * @description - Import a dictionary\r\n\t * @param {string} temporaryFileUnique\r\n\t * @param {string} [parentUnique]\r\n\t * @returns {*}\r\n\t * @memberof UmbDictionaryImportRepository\r\n\t */\r\n\tasync requestImport(temporaryFileUnique: string, parentUnique: string | null) {\r\n\t\tif (!temporaryFileUnique) throw new Error('Temporary file unique is missing');\r\n\t\tif (parentUnique === undefined) throw new Error('Parent unique is missing');\r\n\r\n\t\tconst { data, error } = await this.#importSource.import(temporaryFileUnique, parentUnique);\r\n\r\n\t\tif (data && typeof data === 'string') {\r\n\t\t\t// Request the detail for the imported dictionary. This will also append it to the detail store\r\n\t\t\treturn this.#detailRepository.requestByUnique(data);\r\n\t\t}\r\n\r\n\t\treturn { data, error };\r\n\t}\r\n}\r\n\r\nexport { UmbDictionaryImportRepository as api };\r\n"],"names":["UmbDictionaryImportServerDataSource","#host","host","temporaryFileUnique","parentUnique","body","tryExecute","DictionaryService","UmbDictionaryImportRepository","UmbRepositoryBase","#importSource","#detailRepository","UmbDictionaryDetailRepository","data","error"],"mappings":";;;;;AAKO,MAAMA,EAAoC;AAAA,EAChDC;AAAA,EAEA,YAAYC,GAAyB;AACpC,SAAKD,KAAQC;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,OAAOC,GAA6BC,GAA6B;AACtE,QAAI,CAACD,EAAqB,OAAM,IAAI,MAAM,iCAAiC;AAC3E,QAAIC,MAAiB,OAAW,OAAM,IAAI,MAAM,0BAA0B;AAE1E,UAAMC,IAAqC;AAAA,MAC1C,eAAe,EAAE,IAAIF,EAAA;AAAA,MACrB,QAAQC,IAAe,EAAE,IAAIA,MAAiB;AAAA,IAAA;AAG/C,WAAOE;AAAA,MACN,KAAKL;AAAA,MACLM,EAAkB,qBAAqB;AAAA,QACtC,MAAAF;AAAA,MAAA,CACA;AAAA,IAAA;AAAA,EAEH;AACD;AC9BO,MAAMG,UAAsCC,EAAkB;AAAA,EACpEC;AAAA,EACAC;AAAA,EAEA,YAAYT,GAAyB;AACpC,UAAMA,CAAI,GACV,KAAKQ,KAAgB,IAAIV,EAAoCE,CAAI,GACjE,KAAKS,KAAoB,IAAIC,EAA8BV,CAAI;AAAA,EAChE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASA,MAAM,cAAcC,GAA6BC,GAA6B;AAC7E,QAAI,CAACD,EAAqB,OAAM,IAAI,MAAM,kCAAkC;AAC5E,QAAIC,MAAiB,OAAW,OAAM,IAAI,MAAM,0BAA0B;AAE1E,UAAM,EAAE,MAAAS,GAAM,OAAAC,MAAU,MAAM,KAAKJ,GAAc,OAAOP,GAAqBC,CAAY;AAEzF,WAAIS,KAAQ,OAAOA,KAAS,WAEpB,KAAKF,GAAkB,gBAAgBE,CAAI,IAG5C,EAAE,MAAAA,GAAM,OAAAC,EAAA;AAAA,EAChB;AACD;"}