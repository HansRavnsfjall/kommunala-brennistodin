{"version":3,"file":"document-property-value-user-permission.workspace-context-CRTGkL2D.js","sources":["../../../src/packages/documents/documents/user-permissions/document-property-value/workspace-context/document-property-value-user-permission.workspace-context.ts"],"sourcesContent":["import { UMB_DOCUMENT_WORKSPACE_CONTEXT } from '../../../workspace/constants.js';\r\nimport { UmbPropertyValueUserPermissionWorkspaceContextBase } from './property-value-user-permission-workspace-context-base.js';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\n\r\nexport class UmbDocumentPropertyValueUserPermissionWorkspaceContext extends UmbPropertyValueUserPermissionWorkspaceContextBase {\r\n\t#documentWorkspaceContext?: typeof UMB_DOCUMENT_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host);\r\n\r\n\t\tthis.consumeContext(UMB_DOCUMENT_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis.#documentWorkspaceContext = context;\r\n\r\n\t\t\tthis.#observeDocumentProperties();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeDocumentProperties() {\r\n\t\tif (!this.#documentWorkspaceContext) return;\r\n\r\n\t\tconst owner = this.#documentWorkspaceContext;\r\n\r\n\t\tthis.observe(this.#documentWorkspaceContext.structure.contentTypeProperties, (properties) => {\r\n\t\t\t// TODO: If zero properties I guess we should then clear the state? [NL]\r\n\t\t\tif (properties.length === 0) return;\r\n\r\n\t\t\tthis.#documentWorkspaceContext!.propertyViewGuard.fallbackToNotPermitted();\r\n\t\t\tthis.#documentWorkspaceContext!.propertyWriteGuard.fallbackToNotPermitted();\r\n\t\t\tthis._setPermissions(properties, owner.propertyViewGuard, owner.propertyWriteGuard);\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport { UmbDocumentPropertyValueUserPermissionWorkspaceContext as api };\r\n"],"names":["UmbDocumentPropertyValueUserPermissionWorkspaceContext","UmbPropertyValueUserPermissionWorkspaceContextBase","#documentWorkspaceContext","host","UMB_DOCUMENT_WORKSPACE_CONTEXT","context","#observeDocumentProperties","owner","properties"],"mappings":";;AAIO,MAAMA,UAA+DC,EAAmD;AAAA,EAC9HC;AAAA,EAEA,YAAYC,GAAyB;AACpC,UAAMA,CAAI,GAEV,KAAK,eAAeC,GAAgC,CAACC,MAAY;AAChE,WAAKH,KAA4BG,GAEjC,KAAKC,GAAA;AAAA,IACN,CAAC;AAAA,EACF;AAAA,EAEAA,KAA6B;AAC5B,QAAI,CAAC,KAAKJ,GAA2B;AAErC,UAAMK,IAAQ,KAAKL;AAEnB,SAAK,QAAQ,KAAKA,GAA0B,UAAU,uBAAuB,CAACM,MAAe;AAE5F,MAAIA,EAAW,WAAW,MAE1B,KAAKN,GAA2B,kBAAkB,uBAAA,GAClD,KAAKA,GAA2B,mBAAmB,uBAAA,GACnD,KAAK,gBAAgBM,GAAYD,EAAM,mBAAmBA,EAAM,kBAAkB;AAAA,IACnF,CAAC;AAAA,EACF;AACD;"}