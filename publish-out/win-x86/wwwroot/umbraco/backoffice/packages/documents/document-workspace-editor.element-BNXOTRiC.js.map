{"version":3,"file":"document-workspace-editor.element-BNXOTRiC.js","sources":["../../../src/packages/documents/documents/workspace/document-workspace-split-view-variant-selector.element.ts","../../../src/packages/documents/documents/workspace/document-workspace-split-view.element.ts","../../../src/packages/documents/documents/workspace/document-workspace-editor.element.ts"],"sourcesContent":["import type { UmbDocumentVariantOptionModel } from '../types.js';\r\nimport { sortVariants } from '../utils.js';\r\nimport { UMB_DOCUMENT_PUBLISHING_WORKSPACE_CONTEXT } from '../publishing/index.js';\r\nimport { customElement, html, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { DocumentVariantStateModel } from '@umbraco-cms/backoffice/external/backend-api';\r\nimport { UmbWorkspaceSplitViewVariantSelectorElement } from '@umbraco-cms/backoffice/workspace';\r\n\r\n@customElement('umb-document-workspace-split-view-variant-selector')\r\nexport class UmbDocumentWorkspaceSplitViewVariantSelectorElement extends UmbWorkspaceSplitViewVariantSelectorElement<UmbDocumentVariantOptionModel> {\r\n\tprotected override _variantSorter = sortVariants;\r\n\r\n\t@state()\r\n\tprivate _variantsWithPendingChanges: Array<any> = [];\r\n\r\n\t#documentPublishingWorkspaceContext?: typeof UMB_DOCUMENT_PUBLISHING_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\t#publishStateLocalizationMap = {\r\n\t\t[DocumentVariantStateModel.DRAFT]: 'content_unpublished',\r\n\t\t[DocumentVariantStateModel.PUBLISHED]: 'content_published',\r\n\t\t// TODO: The pending changes state can be removed once the management Api removes this state\r\n\t\t// We only keep it here to make typescript happy\r\n\t\t// We should also make our own state model for this\r\n\t\t[DocumentVariantStateModel.PUBLISHED_PENDING_CHANGES]: 'content_published',\r\n\t\t[DocumentVariantStateModel.NOT_CREATED]: 'content_notCreated',\r\n\t\t[DocumentVariantStateModel.TRASHED]: 'mediaPicker_trashed',\r\n\t};\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.consumeContext(UMB_DOCUMENT_PUBLISHING_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#documentPublishingWorkspaceContext = instance;\r\n\t\t\tthis.#observePendingChanges();\r\n\t\t});\r\n\t}\r\n\r\n\t#observePendingChanges() {\r\n\t\tthis.observe(\r\n\t\t\tthis.#documentPublishingWorkspaceContext?.publishedPendingChanges.variantsWithChanges,\r\n\t\t\t(variants) => {\r\n\t\t\t\tthis._variantsWithPendingChanges = variants || [];\r\n\t\t\t},\r\n\t\t\t'_observePendingChanges',\r\n\t\t);\r\n\t}\r\n\r\n\t#hasPendingChanges(variant: UmbDocumentVariantOptionModel) {\r\n\t\treturn this._variantsWithPendingChanges.some((x) => x.variantId.compare(variant));\r\n\t}\r\n\r\n\t#getVariantState(variantOption: UmbDocumentVariantOptionModel) {\r\n\t\tlet term = this.#publishStateLocalizationMap[variantOption.variant?.state || DocumentVariantStateModel.NOT_CREATED];\r\n\r\n\t\tif (\r\n\t\t\t(variantOption.variant?.state === DocumentVariantStateModel.PUBLISHED ||\r\n\t\t\t\tvariantOption.variant?.state === DocumentVariantStateModel.PUBLISHED_PENDING_CHANGES) &&\r\n\t\t\tthis.#hasPendingChanges(variantOption)\r\n\t\t) {\r\n\t\t\tterm = 'content_publishedPendingChanges';\r\n\t\t}\r\n\r\n\t\treturn this.localize.term(term);\r\n\t}\r\n\r\n\tprotected override _renderVariantDetails(variantOption: UmbDocumentVariantOptionModel) {\r\n\t\treturn html` ${this.#getVariantState(variantOption)}`;\r\n\t}\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-workspace-split-view-variant-selector': UmbDocumentWorkspaceSplitViewVariantSelectorElement;\r\n\t}\r\n}\r\n","import { UMB_DOCUMENT_WORKSPACE_CONTEXT } from './document-workspace.context-token.js';\r\nimport { css, customElement, html, ifDefined, nothing, repeat, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { ManifestWorkspaceView, UmbActiveVariant } from '@umbraco-cms/backoffice/workspace';\r\nimport type { UmbDeepPartialObject } from '@umbraco-cms/backoffice/utils';\r\n\r\nimport './document-workspace-split-view-variant-selector.element.js';\r\n\r\n@customElement('umb-document-workspace-split-view')\r\nexport class UmbDocumentWorkspaceSplitViewElement extends UmbLitElement {\r\n\t// TODO: Refactor: use the split view context token:\r\n\tprivate _workspaceContext?: typeof UMB_DOCUMENT_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\t@state()\r\n\tprivate _variants?: Array<UmbActiveVariant>;\r\n\r\n\t@state()\r\n\tprivate _icon?: string;\r\n\r\n\t@state()\r\n\tprivate _overrides?: Array<UmbDeepPartialObject<ManifestWorkspaceView>>;\r\n\r\n\t@state()\r\n\tprivate _loading = true;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t// TODO: Refactor: use a split view workspace context token: [NL]\r\n\t\tthis.consumeContext(UMB_DOCUMENT_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis._workspaceContext = context;\r\n\t\t\tthis.#observeActiveVariantInfo();\r\n\t\t\tthis.#observeIcon();\r\n\t\t\tthis.#observeLoading();\r\n\t\t\tthis.#observeCollectionOverrides();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeActiveVariantInfo() {\r\n\t\tthis.observe(\r\n\t\t\tthis._workspaceContext?.splitView.activeVariantsInfo,\r\n\t\t\t(variants) => {\r\n\t\t\t\tthis._variants = variants;\r\n\t\t\t},\r\n\t\t\t'_observeActiveVariantsInfo',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeIcon() {\r\n\t\tthis.observe(\r\n\t\t\tthis._workspaceContext?.contentTypeIcon,\r\n\t\t\t(icon) => {\r\n\t\t\t\tthis._icon = icon ?? undefined;\r\n\t\t\t},\r\n\t\t\t'observeIcon',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeLoading() {\r\n\t\tthis.observe(\r\n\t\t\tthis._workspaceContext?.loading.isOn,\r\n\t\t\t(loading) => {\r\n\t\t\t\tthis._loading = loading ?? false;\r\n\t\t\t},\r\n\t\t\t'observeIcon',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeCollectionOverrides() {\r\n\t\tthis.observe(\r\n\t\t\tthis._workspaceContext?.collection.manifestOverrides,\r\n\t\t\t(overrides) => {\r\n\t\t\t\tthis._overrides = overrides ? [overrides] : undefined;\r\n\t\t\t},\r\n\t\t\t'observeCollectionOverrides',\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._variants\r\n\t\t\t? html`<div id=\"splitViews\">\r\n\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\tthis._variants,\r\n\t\t\t\t\t\t\t(view) =>\r\n\t\t\t\t\t\t\t\tview.index + '_' + (view.culture ?? '') + '_' + (view.segment ?? '') + '_' + this._variants!.length,\r\n\t\t\t\t\t\t\t(view) => html`\r\n\t\t\t\t\t\t\t\t<umb-workspace-split-view\r\n\t\t\t\t\t\t\t\t\t.loading=${this._loading}\r\n\t\t\t\t\t\t\t\t\t.displayNavigation=${view.index === this._variants!.length - 1}\r\n\t\t\t\t\t\t\t\t\t.overrides=${this._overrides}\r\n\t\t\t\t\t\t\t\t\t.splitViewIndex=${view.index}>\r\n\t\t\t\t\t\t\t\t\t<umb-icon slot=\"icon\" name=${ifDefined(this._icon)}></umb-icon>\r\n\t\t\t\t\t\t\t\t\t<umb-document-workspace-split-view-variant-selector\r\n\t\t\t\t\t\t\t\t\t\tslot=\"variant-selector\"></umb-document-workspace-split-view-variant-selector>\r\n\t\t\t\t\t\t\t\t</umb-workspace-split-view>\r\n\t\t\t\t\t\t\t`,\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<umb-workspace-footer alias=\"Umb.Workspace.Document\"></umb-workspace-footer>`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\r\n\t\t\t#splitViews {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: calc(100% - var(--umb-footer-layout-height));\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDocumentWorkspaceSplitViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-workspace-split-view': UmbDocumentWorkspaceSplitViewElement;\r\n\t}\r\n}\r\n","import type { UmbDocumentVariantOptionModel } from '../types.js';\r\nimport { UmbDocumentWorkspaceSplitViewElement } from './document-workspace-split-view.element.js';\r\nimport { UMB_DOCUMENT_WORKSPACE_CONTEXT } from './document-workspace.context-token.js';\r\nimport { customElement, state, css, html } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { UmbRoute, UmbRouterSlotInitEvent } from '@umbraco-cms/backoffice/router';\r\nimport { UMB_APP_LANGUAGE_CONTEXT } from '@umbraco-cms/backoffice/language';\r\n\r\n// TODO: This seem fully identical with Media Workspace Editor, so we can refactor this to a generic component. [NL]\r\n@customElement('umb-document-workspace-editor')\r\nexport class UmbDocumentWorkspaceEditorElement extends UmbLitElement {\r\n\t//\r\n\t// TODO: Refactor: when having a split view/variants context token, we can rename the split view/variants component to a generic and make this component generic as well. [NL]\r\n\tprivate _splitViewElement = new UmbDocumentWorkspaceSplitViewElement();\r\n\r\n\t#appLanguage?: typeof UMB_APP_LANGUAGE_CONTEXT.TYPE;\r\n\t#workspaceContext?: typeof UMB_DOCUMENT_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\t#workspaceRoute?: string;\r\n\t#appCulture?: string;\r\n\t#variants?: Array<UmbDocumentVariantOptionModel>;\r\n\t#isForbidden = false;\r\n\r\n\t@state()\r\n\tprivate _routes?: Array<UmbRoute>;\r\n\r\n\t@state()\r\n\tprivate _loading?: boolean = true;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_APP_LANGUAGE_CONTEXT, (instance) => {\r\n\t\t\tthis.#appLanguage = instance;\r\n\t\t\tthis.observe(this.#appLanguage?.appLanguageCulture, (appCulture) => {\r\n\t\t\t\tthis.#appCulture = appCulture;\r\n\t\t\t\tthis.#generateRoutes();\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_DOCUMENT_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.variantOptions,\r\n\t\t\t\t(variants) => {\r\n\t\t\t\t\tthis.#variants = variants;\r\n\t\t\t\t\tthis.#generateRoutes();\r\n\t\t\t\t},\r\n\t\t\t\t'_observeVariants',\r\n\t\t\t);\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.forbidden.isOn,\r\n\t\t\t\t(isForbidden) => {\r\n\t\t\t\t\tthis.#isForbidden = isForbidden ?? false;\r\n\t\t\t\t\tthis.#generateRoutes();\r\n\t\t\t\t},\r\n\t\t\t\t'_observeForbidden',\r\n\t\t\t);\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.loading.isOn,\r\n\t\t\t\t(loading) => {\r\n\t\t\t\t\tthis._loading = loading ?? false;\r\n\t\t\t\t},\r\n\t\t\t\t'_observeLoading',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t#generateRoutes() {\r\n\t\tif (!this.#variants || this.#variants.length === 0 || !this.#appCulture) {\r\n\t\t\tthis._routes = [];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Generate split view routes for all available routes\r\n\t\tconst routes: Array<UmbRoute> = [];\r\n\r\n\t\t// Split view routes:\r\n\t\tthis.#variants.forEach((variantA) => {\r\n\t\t\tthis.#variants!.forEach((variantB) => {\r\n\t\t\t\troutes.push({\r\n\t\t\t\t\t// TODO: When implementing Segments, be aware if using the unique still is URL Safe, cause its most likely not... [NL]\r\n\t\t\t\t\tpath: variantA.unique + '_&_' + variantB.unique,\r\n\t\t\t\t\tcomponent: this._splitViewElement,\r\n\t\t\t\t\tsetup: (_component, info) => {\r\n\t\t\t\t\t\t// Set split view/active info..\r\n\t\t\t\t\t\tthis.#workspaceContext?.splitView.setVariantParts(info.match.fragments.consumed);\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// Single view:\r\n\t\tthis.#variants.forEach((variant) => {\r\n\t\t\troutes.push({\r\n\t\t\t\t// TODO: When implementing Segments, be aware if using the unique still is URL Safe, cause its most likely not... [NL]\r\n\t\t\t\tpath: variant.unique,\r\n\t\t\t\tcomponent: this._splitViewElement,\r\n\t\t\t\tsetup: (_component, info) => {\r\n\t\t\t\t\t// cause we might come from a split-view, we need to reset index 1.\r\n\t\t\t\t\tthis.#workspaceContext?.splitView.removeActiveVariant(1);\r\n\t\t\t\t\tthis.#workspaceContext?.splitView.handleVariantFolderPart(0, info.match.fragments.consumed);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tif (routes.length !== 0) {\r\n\t\t\t// Using first single view as the default route for now (hence the math below):\r\n\t\t\troutes.push({\r\n\t\t\t\tpath: '',\r\n\t\t\t\tpathMatch: 'full',\r\n\t\t\t\tresolve: async () => {\r\n\t\t\t\t\tif (!this.#workspaceContext) {\r\n\t\t\t\t\t\tthrow new Error('Workspace context is not available when resolving the default route.');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst route = routes.find((route) => route.path === this.#appCulture);\r\n\r\n\t\t\t\t\tif (!route) {\r\n\t\t\t\t\t\tconst firstVariantPath = routes.find((route) => route.path === this.#variants?.[0]?.unique)?.path;\r\n\r\n\t\t\t\t\t\tif (firstVariantPath) {\r\n\t\t\t\t\t\t\thistory.replaceState({}, '', `${this.#workspaceRoute}/${firstVariantPath}`);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// TODO: Notice: here is a specific index used for fallback, this could be made more solid [NL]\r\n\t\t\t\t\t\tconst path = `${this.#workspaceRoute}/${routes[routes.length - 3].path}`;\r\n\r\n\t\t\t\t\t\thistory.replaceState({}, '', path);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\thistory.replaceState({}, '', `${this.#workspaceRoute}/${route?.path}`);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\troutes.push({\r\n\t\t\tpath: '**',\r\n\t\t\tcomponent: async () => {\r\n\t\t\t\tconst router = await import('@umbraco-cms/backoffice/router');\r\n\t\t\t\treturn this.#isForbidden ? router.UmbRouteForbiddenElement : router.UmbRouteNotFoundElement;\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tthis._routes = routes;\r\n\t}\r\n\r\n\tprivate _gotWorkspaceRoute = (e: UmbRouterSlotInitEvent) => {\r\n\t\tthis.#workspaceRoute = e.target.absoluteRouterPath;\r\n\t\tthis.#workspaceContext?.splitView.setWorkspaceRoute(this.#workspaceRoute);\r\n\t};\r\n\r\n\toverride render() {\r\n\t\treturn !this._loading && this._routes\r\n\t\t\t? html`<umb-router-slot .routes=${this._routes} @init=${this._gotWorkspaceRoute}></umb-router-slot>`\r\n\t\t\t: html`<umb-view-loader></umb-view-loader>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbDocumentWorkspaceEditorElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-document-workspace-editor': UmbDocumentWorkspaceEditorElement;\r\n\t}\r\n}\r\n"],"names":["_documentPublishingWorkspaceContext","_publishStateLocalizationMap","_UmbDocumentWorkspaceSplitViewVariantSelectorElement_instances","observePendingChanges_fn","hasPendingChanges_fn","getVariantState_fn","UmbDocumentWorkspaceSplitViewVariantSelectorElement","UmbWorkspaceSplitViewVariantSelectorElement","__privateAdd","sortVariants","DocumentVariantStateModel","UMB_DOCUMENT_PUBLISHING_WORKSPACE_CONTEXT","instance","__privateSet","__privateMethod","variantOption","html","__privateGet","variants","variant","x","term","__decorateClass","state","customElement","_UmbDocumentWorkspaceSplitViewElement_instances","observeActiveVariantInfo_fn","observeIcon_fn","observeLoading_fn","observeCollectionOverrides_fn","UmbDocumentWorkspaceSplitViewElement","UmbLitElement","UMB_DOCUMENT_WORKSPACE_CONTEXT","context","repeat","view","ifDefined","nothing","icon","loading","overrides","UmbTextStyles","css","_appLanguage","_workspaceContext","_workspaceRoute","_appCulture","_variants","_isForbidden","_UmbDocumentWorkspaceEditorElement_instances","generateRoutes_fn","UmbDocumentWorkspaceEditorElement","e","UMB_APP_LANGUAGE_CONTEXT","appCulture","isForbidden","routes","variantA","variantB","_component","info","route","firstVariantPath","path","router","UmbDocumentWorkspaceEditorElement$1"],"mappings":"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"}