{"version":3,"file":"property-editor-ui-document-picker.element-CaVj22Re.js","sources":["../../../src/packages/documents/documents/property-editors/document-picker/property-editor-ui-document-picker.element.ts"],"sourcesContent":["import { UMB_DOCUMENT_ENTITY_TYPE } from '../../entity.js';\r\nimport type { UmbInputDocumentElement } from '../../components/input-document/input-document.element.js';\r\nimport { customElement, html, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbPropertyEditorUiInteractionMemoryManager } from '@umbraco-cms/backoffice/property-editor';\r\nimport type { UmbInteractionMemoryModel } from '@umbraco-cms/backoffice/interaction-memory';\r\nimport type { UmbNumberRangeValueType } from '@umbraco-cms/backoffice/models';\r\nimport type {\r\n\tUmbPropertyEditorConfigCollection,\r\n\tUmbPropertyEditorUiElement,\r\n} from '@umbraco-cms/backoffice/property-editor';\r\nimport type { UmbTreeStartNode } from '@umbraco-cms/backoffice/tree';\r\n\r\n@customElement('umb-property-editor-ui-document-picker')\r\nexport class UmbPropertyEditorUIDocumentPickerElement extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n\t@property()\r\n\tpublic value?: string;\r\n\r\n\tpublic set config(config: UmbPropertyEditorConfigCollection | undefined) {\r\n\t\tthis.#interactionMemoryManager.setPropertyEditorConfig(config);\r\n\r\n\t\tif (!config) return;\r\n\r\n\t\tconst minMax = config.getValueByAlias<UmbNumberRangeValueType>('validationLimit');\r\n\t\tif (minMax) {\r\n\t\t\tthis._min = minMax.min && minMax.min > 0 ? minMax.min : 0;\r\n\t\t\tthis._max = minMax.max && minMax.max > 0 ? minMax.max : 1;\r\n\t\t}\r\n\r\n\t\tthis._startNodeId = config.getValueByAlias('startNodeId');\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the input to readonly mode, meaning value cannot be changed but still able to read and select its content.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default false\r\n\t */\r\n\t@property({ type: Boolean, reflect: true })\r\n\treadonly = false;\r\n\r\n\t@state()\r\n\tprivate _min = 0;\r\n\r\n\t// NOTE: The legacy \"Content Picker\" property-editor only supported 1 item,\r\n\t// so that's why it's being enforced here. We'll evolve this in a future version. [LK]\r\n\t@state()\r\n\tprivate _max = 1;\r\n\r\n\t@state()\r\n\tprivate _startNodeId?: string;\r\n\r\n\t@state()\r\n\tprivate _interactionMemories: Array<UmbInteractionMemoryModel> = [];\r\n\r\n\t#interactionMemoryManager = new UmbPropertyEditorUiInteractionMemoryManager(this, {\r\n\t\tmemoryUniquePrefix: 'UmbDocumentPicker',\r\n\t});\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.observe(this.#interactionMemoryManager.memoriesForPropertyEditor, (interactionMemories) => {\r\n\t\t\tthis._interactionMemories = interactionMemories ?? [];\r\n\t\t});\r\n\t}\r\n\r\n\t#onChange(event: CustomEvent & { target: UmbInputDocumentElement }) {\r\n\t\tthis.value = event.target.value;\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\tasync #onInputInteractionMemoriesChange(event: UmbChangeEvent) {\r\n\t\tconst target = event.target as UmbInputDocumentElement;\r\n\t\tconst interactionMemories = target.interactionMemories;\r\n\r\n\t\tif (interactionMemories && interactionMemories.length > 0) {\r\n\t\t\tawait this.#interactionMemoryManager.saveMemoriesForPropertyEditor(interactionMemories);\r\n\t\t} else {\r\n\t\t\tawait this.#interactionMemoryManager.deleteMemoriesForPropertyEditor();\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tconst startNode: UmbTreeStartNode | undefined = this._startNodeId\r\n\t\t\t? { unique: this._startNodeId, entityType: UMB_DOCUMENT_ENTITY_TYPE }\r\n\t\t\t: undefined;\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-input-document\r\n\t\t\t\t.min=${this._min}\r\n\t\t\t\t.max=${this._max}\r\n\t\t\t\t.startNode=${startNode}\r\n\t\t\t\t.value=${this.value}\r\n\t\t\t\t@change=${this.#onChange}\r\n\t\t\t\t?readonly=${this.readonly}\r\n\t\t\t\t.interactionMemories=${this._interactionMemories}\r\n\t\t\t\t@interaction-memories-change=${this.#onInputInteractionMemoriesChange}>\r\n\t\t\t</umb-input-document>\r\n\t\t`;\r\n\t}\r\n}\r\n\r\nexport default UmbPropertyEditorUIDocumentPickerElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-document-picker': UmbPropertyEditorUIDocumentPickerElement;\r\n\t}\r\n}\r\n"],"names":["_interactionMemoryManager","_UmbPropertyEditorUIDocumentPickerElement_instances","onChange_fn","onInputInteractionMemoriesChange_fn","UmbPropertyEditorUIDocumentPickerElement","UmbLitElement","__privateAdd","UmbPropertyEditorUiInteractionMemoryManager","__privateGet","interactionMemories","config","minMax","startNode","UMB_DOCUMENT_ENTITY_TYPE","html","__privateMethod","event","UmbChangeEvent","__decorateClass","property","state","customElement","UmbPropertyEditorUIDocumentPickerElement$1"],"mappings":";;;;;;;;;;;+TAAAA,GAAAC,GAAAC,GAAAC;AAeO,IAAMC,IAAN,cAAuDC,EAAoD;AAAA,EA6CjH,cAAc;AACb,UAAA,GA9CKC,EAAA,MAAAL,CAAA,GAyBN,KAAA,WAAW,IAGX,KAAQ,OAAO,GAKf,KAAQ,OAAO,GAMf,KAAQ,uBAAyD,CAAA,GAEjEK,EAAA,MAAAN,GAA4B,IAAIO,EAA4C,MAAM;AAAA,MACjF,oBAAoB;AAAA,IAAA,CACpB,CAAA,GAKA,KAAK,QAAQC,EAAA,MAAKR,CAAA,EAA0B,2BAA2B,CAACS,MAAwB;AAC/F,WAAK,uBAAuBA,KAAuB,CAAA;AAAA,IACpD,CAAC;AAAA,EACF;AAAA,EA/CA,IAAW,OAAOC,GAAuD;AAGxE,QAFAF,EAAA,MAAKR,CAAA,EAA0B,wBAAwBU,CAAM,GAEzD,CAACA,EAAQ;AAEb,UAAMC,IAASD,EAAO,gBAAyC,iBAAiB;AAChF,IAAIC,MACH,KAAK,OAAOA,EAAO,OAAOA,EAAO,MAAM,IAAIA,EAAO,MAAM,GACxD,KAAK,OAAOA,EAAO,OAAOA,EAAO,MAAM,IAAIA,EAAO,MAAM,IAGzD,KAAK,eAAeD,EAAO,gBAAgB,aAAa;AAAA,EACzD;AAAA,EAqDS,SAAS;AACjB,UAAME,IAA0C,KAAK,eAClD,EAAE,QAAQ,KAAK,cAAc,YAAYC,EAAA,IACzC;AAEH,WAAOC;AAAA;AAAA,WAEE,KAAK,IAAI;AAAA,WACT,KAAK,IAAI;AAAA,iBACHF,CAAS;AAAA,aACb,KAAK,KAAK;AAAA,cACTG,QAAKd,GAAAC,CAAA,CAAS;AAAA,gBACZ,KAAK,QAAQ;AAAA,2BACF,KAAK,oBAAoB;AAAA,mCACjBa,QAAKd,GAAAE,CAAA,CAAiC;AAAA;AAAA;AAAA,EAGxE;AACD;AA9CCH,IAAA,oBAAA,QAAA;AAzCMC,IAAA,oBAAA,QAAA;AAqDNC,IAAS,SAACc,GAA0D;AACnE,OAAK,QAAQA,EAAM,OAAO,OAC1B,KAAK,cAAc,IAAIC,GAAgB;AACxC;AAEMd,IAAiC,eAACa,GAAuB;AAE9D,QAAMP,IADSO,EAAM,OACc;AAEnC,EAAIP,KAAuBA,EAAoB,SAAS,IACvD,MAAMD,EAAA,MAAKR,CAAA,EAA0B,8BAA8BS,CAAmB,IAEtF,MAAMD,EAAA,MAAKR,GAA0B,gCAAA;AAEvC;AAjEOkB,EAAA;AAAA,EADNC,EAAA;AAAS,GADEf,EAEL,WAAA,SAAA,CAAA;AAuBPc,EAAA;AAAA,EADCC,EAAS,EAAE,MAAM,SAAS,SAAS,IAAM;AAAA,GAxB9Bf,EAyBZ,WAAA,YAAA,CAAA;AAGQc,EAAA;AAAA,EADPE,EAAA;AAAM,GA3BKhB,EA4BJ,WAAA,QAAA,CAAA;AAKAc,EAAA;AAAA,EADPE,EAAA;AAAM,GAhCKhB,EAiCJ,WAAA,QAAA,CAAA;AAGAc,EAAA;AAAA,EADPE,EAAA;AAAM,GAnCKhB,EAoCJ,WAAA,gBAAA,CAAA;AAGAc,EAAA;AAAA,EADPE,EAAA;AAAM,GAtCKhB,EAuCJ,WAAA,wBAAA,CAAA;AAvCIA,IAANc,EAAA;AAAA,EADNG,EAAc,wCAAwC;AAAA,GAC1CjB,CAAA;AAyFb,MAAAkB,IAAelB;"}