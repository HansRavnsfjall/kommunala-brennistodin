{"version":3,"file":"imaging.store-Btmn4DA6.js","sources":["../../../src/packages/media/imaging/imaging.store.ts"],"sourcesContent":["import { UMB_IMAGING_STORE_CONTEXT } from './imaging.store.token.js';\r\nimport type { UmbImagingResizeModel } from './types.js';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport type { UmbApi } from '@umbraco-cms/backoffice/extension-api';\r\nimport { UmbContextBase } from '@umbraco-cms/backoffice/class-api';\r\n\r\nexport class UmbImagingStore extends UmbContextBase implements UmbApi {\r\n\t#data = new Map<string, Map<string, string>>();\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_IMAGING_STORE_CONTEXT.toString());\r\n\t}\r\n\r\n\t/**\r\n\t * Gets the data from the store.\r\n\t * @param {string} unique - The media key\r\n\t * @returns {Map<string, string> | undefined} - The data if it exists\r\n\t */\r\n\tgetData(unique: string): Map<string, string> | undefined {\r\n\t\treturn this.#data.get(unique);\r\n\t}\r\n\r\n\t/**\r\n\t * Gets a specific crop if it exists.\r\n\t * @param {string} unique - The media key\r\n\t * @param {string} data - The resize configuration\r\n\t * @returns {string | undefined} - The crop if it exists\r\n\t */\r\n\tgetCrop(unique: string, data?: UmbImagingResizeModel): string | undefined {\r\n\t\treturn this.#data.get(unique)?.get(this.#generateCropKey(data));\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a new crop to the store.\r\n\t * @param {string} unique - The media key\r\n\t * @param {string} urlInfo - The URL of the crop\r\n\t * @param {UmbImagingResizeModel | undefined} data - The resize configuration\r\n\t */\r\n\taddCrop(unique: string, urlInfo: string, data?: UmbImagingResizeModel) {\r\n\t\tif (!this.#data.has(unique)) {\r\n\t\t\tthis.#data.set(unique, new Map());\r\n\t\t}\r\n\t\tthis.#data.get(unique)?.set(this.#generateCropKey(data), urlInfo);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears all crops from the store.\r\n\t */\r\n\tclear() {\r\n\t\tthis.#data.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the crop for a specific unique identifier.\r\n\t * @param {string} unique - The unique identifier for the media item\r\n\t */\r\n\tclearCropByUnique(unique: string) {\r\n\t\tthis.#data.delete(unique);\r\n\t}\r\n\r\n\t/**\r\n\t * Clears the crop for a specific unique identifier and resize configuration.\r\n\t * @param {string} unique - The unique identifier for the media item\r\n\t * @param {UmbImagingResizeModel | undefined} data - The resize configuration\r\n\t */\r\n\tclearCropByConfiguration(unique: string, data?: UmbImagingResizeModel) {\r\n\t\tthis.#data.get(unique)?.delete(this.#generateCropKey(data));\r\n\t}\r\n\r\n\t/**\r\n\t * Generates a unique key for the crop based on the width, height and mode.\r\n\t * @param {UmbImagingResizeModel} data - The resize configuration\r\n\t * @returns {string} - The crop key\r\n\t */\r\n\t#generateCropKey(data?: UmbImagingResizeModel): string {\r\n\t\treturn data ? `${data.width}x${data.height};${data.mode}` : 'generic';\r\n\t}\r\n}\r\n\r\nexport default UmbImagingStore;\r\n"],"names":["UmbImagingStore","UmbContextBase","#data","host","UMB_IMAGING_STORE_CONTEXT","unique","data","#generateCropKey","urlInfo"],"mappings":";;AAMO,MAAMA,UAAwBC,EAAiC;AAAA,EACrEC,yBAAY,IAAA;AAAA,EAEZ,YAAYC,GAAyB;AACpC,UAAMA,GAAMC,EAA0B,UAAU;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,QAAQC,GAAiD;AACxD,WAAO,KAAKH,GAAM,IAAIG,CAAM;AAAA,EAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,QAAQA,GAAgBC,GAAkD;AACzE,WAAO,KAAKJ,GAAM,IAAIG,CAAM,GAAG,IAAI,KAAKE,GAAiBD,CAAI,CAAC;AAAA,EAC/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,QAAQD,GAAgBG,GAAiBF,GAA8B;AACtE,IAAK,KAAKJ,GAAM,IAAIG,CAAM,KACzB,KAAKH,GAAM,IAAIG,GAAQ,oBAAI,KAAK,GAEjC,KAAKH,GAAM,IAAIG,CAAM,GAAG,IAAI,KAAKE,GAAiBD,CAAI,GAAGE,CAAO;AAAA,EACjE;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ;AACP,SAAKN,GAAM,MAAA;AAAA,EACZ;AAAA;AAAA;AAAA;AAAA;AAAA,EAMA,kBAAkBG,GAAgB;AACjC,SAAKH,GAAM,OAAOG,CAAM;AAAA,EACzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOA,yBAAyBA,GAAgBC,GAA8B;AACtE,SAAKJ,GAAM,IAAIG,CAAM,GAAG,OAAO,KAAKE,GAAiBD,CAAI,CAAC;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOAC,GAAiBD,GAAsC;AACtD,WAAOA,IAAO,GAAGA,EAAK,KAAK,IAAIA,EAAK,MAAM,IAAIA,EAAK,IAAI,KAAK;AAAA,EAC7D;AACD;"}