{"version":3,"file":"media-dashboard.element-CVL81ueF.js","sources":["../../../src/packages/media/media/dashboard/media-dashboard.element.ts"],"sourcesContent":["import { UmbMediaCollectionRepository } from '../collection/repository/index.js';\r\nimport { UMB_MEDIA_COLLECTION_ALIAS } from '../constants.js';\r\nimport { UMB_MEDIA_ROOT_ENTITY_TYPE } from '../entity.js';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbDataTypeDetailRepository } from '@umbraco-cms/backoffice/data-type';\r\nimport { UmbEntityContext } from '@umbraco-cms/backoffice/entity';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbPropertyEditorConfigCollection } from '@umbraco-cms/backoffice/property-editor';\r\nimport { UmbCollectionElement } from '@umbraco-cms/backoffice/collection';\r\nimport type { UmbCollectionConfiguration } from '@umbraco-cms/backoffice/collection';\r\nimport type { UmbDataTypeDetailModel } from '@umbraco-cms/backoffice/data-type';\r\nimport type { UmbRoute } from '@umbraco-cms/backoffice/router';\r\n\r\n@customElement('umb-media-dashboard')\r\nexport class UmbMediaDashboardElement extends UmbLitElement {\r\n\t#dataTypeDetailRepository = new UmbDataTypeDetailRepository(this);\r\n\t#entityContext = new UmbEntityContext(this);\r\n\t#mediaCollectionRepository = new UmbMediaCollectionRepository(this);\r\n\r\n\t@state()\r\n\tprivate _routes?: UmbRoute[];\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.#defineRoutes();\r\n\r\n\t\tthis.#entityContext.setEntityType(UMB_MEDIA_ROOT_ENTITY_TYPE);\r\n\t\tthis.#entityContext.setUnique(null);\r\n\t}\r\n\r\n\tasync #defineRoutes() {\r\n\t\tconst config = await this.#mediaCollectionRepository.getDefaultConfiguration();\r\n\r\n\t\tawait this.#dataTypeDetailRepository.requestByUnique(config.defaultDataTypeId);\r\n\r\n\t\tthis.observe(\r\n\t\t\tawait this.#dataTypeDetailRepository.byUnique(config.defaultDataTypeId),\r\n\t\t\t(dataType) => {\r\n\t\t\t\tif (!dataType) return;\r\n\r\n\t\t\t\tconst dataTypeConfig = this.#mapDataTypeConfigToCollectionConfig(dataType);\r\n\r\n\t\t\t\tthis._routes = [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpath: 'collection',\r\n\t\t\t\t\t\tcomponent: () => {\r\n\t\t\t\t\t\t\tconst element = new UmbCollectionElement();\r\n\t\t\t\t\t\t\telement.alias = UMB_MEDIA_COLLECTION_ALIAS;\r\n\t\t\t\t\t\t\telement.config = dataTypeConfig;\r\n\t\t\t\t\t\t\treturn element;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpath: '',\r\n\t\t\t\t\t\tpathMatch: 'full',\r\n\t\t\t\t\t\tredirectTo: 'collection',\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpath: `**`,\r\n\t\t\t\t\t\tcomponent: async () => (await import('@umbraco-cms/backoffice/router')).UmbRouteNotFoundElement,\r\n\t\t\t\t\t},\r\n\t\t\t\t];\r\n\t\t\t},\r\n\t\t\t'_observeConfigDataType',\r\n\t\t);\r\n\t}\r\n\r\n\t#mapDataTypeConfigToCollectionConfig(dataType: UmbDataTypeDetailModel): UmbCollectionConfiguration {\r\n\t\tconst config = new UmbPropertyEditorConfigCollection(dataType.values);\r\n\t\tconst pageSize = Number(config.getValueByAlias('pageSize'));\r\n\t\treturn {\r\n\t\t\tunique: '',\r\n\t\t\tdataTypeId: '',\r\n\t\t\tlayouts: config?.getValueByAlias('layouts'),\r\n\t\t\torderBy: config?.getValueByAlias('orderBy') ?? 'updateDate',\r\n\t\t\torderDirection: config?.getValueByAlias('orderDirection') ?? 'asc',\r\n\t\t\tpageSize: isNaN(pageSize) ? 50 : pageSize,\r\n\t\t\tuserDefinedProperties: config?.getValueByAlias('includeProperties'),\r\n\t\t};\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this._routes) return;\r\n\t\treturn html`<umb-router-slot id=\"router-slot\" .routes=${this._routes}></umb-router-slot>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#router-slot {\r\n\t\t\t\theight: calc(100% - var(--umb-header-layout-height));\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbMediaDashboardElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-media-dashboard': UmbMediaDashboardElement;\r\n\t}\r\n}\r\n"],"names":["_dataTypeDetailRepository","_entityContext","_mediaCollectionRepository","_UmbMediaDashboardElement_instances","defineRoutes_fn","mapDataTypeConfigToCollectionConfig_fn","UmbMediaDashboardElement","UmbLitElement","__privateAdd","UmbDataTypeDetailRepository","UmbEntityContext","UmbMediaCollectionRepository","__privateMethod","__privateGet","UMB_MEDIA_ROOT_ENTITY_TYPE","html","config","dataType","dataTypeConfig","element","UmbCollectionElement","UMB_MEDIA_COLLECTION_ALIAS","UmbPropertyEditorConfigCollection","pageSize","css","__decorateClass","state","customElement","UmbMediaDashboardElement$1"],"mappings":";;;;;;;;;;;;;;;;+TAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAcO,IAAMC,IAAN,cAAuCC,EAAc;AAAA,EAQ3D,cAAc;AACb,UAAA,GATKC,EAAA,MAAAL,CAAA,GACNK,EAAA,MAAAR,GAA4B,IAAIS,EAA4B,IAAI,CAAA,GAChED,EAAA,MAAAP,GAAiB,IAAIS,EAAiB,IAAI,CAAA,GAC1CF,EAAA,MAAAN,GAA6B,IAAIS,EAA6B,IAAI,CAAA,GAQjEC,EAAA,MAAKT,GAAAC,CAAA,EAAL,KAAA,IAAA,GAEAS,EAAA,MAAKZ,CAAA,EAAe,cAAca,CAA0B,GAC5DD,EAAA,MAAKZ,CAAA,EAAe,UAAU,IAAI;AAAA,EACnC;AAAA,EAqDS,SAAS;AACjB,QAAK,KAAK;AACV,aAAOc,8CAAiD,KAAK,OAAO;AAAA,EACrE;AAaD;AAnFCf,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AAHMC,IAAA,oBAAA,QAAA;AAiBAC,IAAa,iBAAG;AACrB,QAAMY,IAAS,MAAMH,EAAA,MAAKX,CAAA,EAA2B,wBAAA;AAErD,QAAMW,EAAA,MAAKb,CAAA,EAA0B,gBAAgBgB,EAAO,iBAAiB,GAE7E,KAAK;AAAA,IACJ,MAAMH,EAAA,MAAKb,CAAA,EAA0B,SAASgB,EAAO,iBAAiB;AAAA,IACtE,CAACC,MAAa;AACb,UAAI,CAACA,EAAU;AAEf,YAAMC,IAAiBN,EAAA,MAAKT,GAAAE,CAAA,EAAL,KAAA,MAA0CY,CAAA;AAEjE,WAAK,UAAU;AAAA,QACd;AAAA,UACC,MAAM;AAAA,UACN,WAAW,MAAM;AAChB,kBAAME,IAAU,IAAIC,EAAA;AACpB,mBAAAD,EAAQ,QAAQE,GAChBF,EAAQ,SAASD,GACVC;AAAA,UACR;AAAA,QAAA;AAAA,QAED;AAAA,UACC,MAAM;AAAA,UACN,WAAW;AAAA,UACX,YAAY;AAAA,QAAA;AAAA,QAEb;AAAA,UACC,MAAM;AAAA,UACN,WAAW,aAAa,MAAM,OAAO,gCAAgC,GAAG;AAAA,QAAA;AAAA,MACzE;AAAA,IAEF;AAAA,IACA;AAAA,EAAA;AAEF;AAEAd,IAAoC,SAACY,GAA8D;AAClG,QAAMD,IAAS,IAAIM,EAAkCL,EAAS,MAAM,GAC9DM,IAAW,OAAOP,EAAO,gBAAgB,UAAU,CAAC;AAC1D,SAAO;AAAA,IACN,QAAQ;AAAA,IACR,YAAY;AAAA,IACZ,SAASA,GAAQ,gBAAgB,SAAS;AAAA,IAC1C,SAASA,GAAQ,gBAAgB,SAAS,KAAK;AAAA,IAC/C,gBAAgBA,GAAQ,gBAAgB,gBAAgB,KAAK;AAAA,IAC7D,UAAU,MAAMO,CAAQ,IAAI,KAAKA;AAAA,IACjC,uBAAuBP,GAAQ,gBAAgB,mBAAmB;AAAA,EAAA;AAEpE;AAlEYV,EAyEI,SAAS;AAAA,EACxBkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASD;AA7EQC,EAAA;AAAA,EADPC,EAAA;AAAM,GALKpB,EAMJ,WAAA,WAAA,CAAA;AANIA,IAANmB,EAAA;AAAA,EADNE,EAAc,qBAAqB;AAAA,GACvBrB,CAAA;AAsFb,MAAAsB,IAAetB;"}