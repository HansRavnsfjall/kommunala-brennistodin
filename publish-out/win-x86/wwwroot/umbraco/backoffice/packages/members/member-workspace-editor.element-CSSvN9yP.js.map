{"version":3,"file":"member-workspace-editor.element-CSSvN9yP.js","sources":["../../../src/packages/members/member/workspace/member/member-workspace-split-view.element.ts","../../../src/packages/members/member/workspace/member/member-workspace-editor.element.ts"],"sourcesContent":["import { UMB_MEMBER_ROOT_WORKSPACE_PATH } from '../../paths.js';\r\nimport { UMB_MEMBER_WORKSPACE_CONTEXT } from './member-workspace.context-token.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { css, html, nothing, customElement, state, repeat, ifDefined } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UmbActiveVariant } from '@umbraco-cms/backoffice/workspace';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\n\r\n@customElement('umb-member-workspace-split-view')\r\nexport class UmbMemberWorkspaceSplitViewElement extends UmbLitElement {\r\n\t// TODO: Refactor: use the split view context token:\r\n\tprivate _workspaceContext?: typeof UMB_MEMBER_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\t@state()\r\n\tprivate _variants?: Array<UmbActiveVariant>;\r\n\r\n\t@state()\r\n\tprivate _icon?: string;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t// TODO: Refactor: use a split view workspace context token:\r\n\t\tthis.consumeContext(UMB_MEMBER_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis._workspaceContext = context;\r\n\t\t\tthis.#observeActiveVariantInfo();\r\n\t\t\tthis.#observeIcon();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeActiveVariantInfo() {\r\n\t\tif (!this._workspaceContext) return;\r\n\t\tthis.observe(\r\n\t\t\tthis._workspaceContext.splitView.activeVariantsInfo,\r\n\t\t\t(variants) => {\r\n\t\t\t\tthis._variants = variants;\r\n\t\t\t},\r\n\t\t\t'_observeActiveVariantsInfo',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeIcon() {\r\n\t\tif (!this._workspaceContext) return;\r\n\t\tthis.observe(this._workspaceContext.contentTypeIcon, (icon) => {\r\n\t\t\tthis._icon = icon ?? undefined;\r\n\t\t});\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn this._variants\r\n\t\t\t? html`<div id=\"splitViews\">\r\n\t\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\t\tthis._variants,\r\n\t\t\t\t\t\t\t(view) =>\r\n\t\t\t\t\t\t\t\tview.index + '_' + (view.culture ?? '') + '_' + (view.segment ?? '') + '_' + this._variants!.length,\r\n\t\t\t\t\t\t\t(view) => html`\r\n\t\t\t\t\t\t\t\t<umb-workspace-split-view\r\n\t\t\t\t\t\t\t\t\tback-path=${UMB_MEMBER_ROOT_WORKSPACE_PATH}\r\n\t\t\t\t\t\t\t\t\t.splitViewIndex=${view.index}\r\n\t\t\t\t\t\t\t\t\t.displayNavigation=${view.index === this._variants!.length - 1}>\r\n\t\t\t\t\t\t\t\t\t<umb-icon slot=\"icon\" name=${ifDefined(this._icon)}></umb-icon>\r\n\t\t\t\t\t\t\t\t</umb-workspace-split-view>\r\n\t\t\t\t\t\t\t`,\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<umb-workspace-footer alias=\"Umb.Workspace.Member\"></umb-workspace-footer>`\r\n\t\t\t: nothing;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t}\r\n\r\n\t\t\t#splitViews {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: calc(100% - var(--umb-footer-layout-height));\r\n\t\t\t}\r\n\r\n\t\t\t#breadcrumbs {\r\n\t\t\t\tmargin: 0 var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbMemberWorkspaceSplitViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-member-workspace-split-view': UmbMemberWorkspaceSplitViewElement;\r\n\t}\r\n}\r\n","import type { UmbMemberVariantOptionModel } from '../../types.js';\r\nimport { UMB_MEMBER_WORKSPACE_CONTEXT } from './member-workspace.context-token.js';\r\nimport { UmbMemberWorkspaceSplitViewElement } from './member-workspace-split-view.element.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { css, html, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbRoute, UmbRouterSlotInitEvent } from '@umbraco-cms/backoffice/router';\r\n\r\n@customElement('umb-member-workspace-editor')\r\nexport class UmbMemberWorkspaceEditorElement extends UmbLitElement {\r\n\t//\r\n\t// TODO: Refactor: when having a split view/variants context token, we can rename the split view/variants component to a generic and make this component generic as well. [NL]\r\n\tprivate _splitViewElement = new UmbMemberWorkspaceSplitViewElement();\r\n\r\n\t#workspaceContext?: typeof UMB_MEMBER_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\t#workspaceRoute?: string;\r\n\r\n\t@state()\r\n\tprivate _isForbidden = false;\r\n\r\n\t@state()\r\n\tprivate _routes?: Array<UmbRoute>;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_MEMBER_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\t\t\tthis.#observeVariants();\r\n\t\t\tthis.#observeForbidden();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeVariants() {\r\n\t\t// TODO: the variantOptions observable is like too broad as this will be triggered then there is any change in the variant options, we need to only update routes when there is a relevant change to them. [NL]\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext?.variantOptions,\r\n\t\t\t(variants) => this.#generateRoutes(variants ?? []),\r\n\t\t\t'_observeVariants',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeForbidden() {\r\n\t\tthis.observe(\r\n\t\t\tthis.#workspaceContext?.forbidden.isOn,\r\n\t\t\t(isForbidden) => (this._isForbidden = isForbidden ?? false),\r\n\t\t\t'_observeForbidden',\r\n\t\t);\r\n\t}\r\n\r\n\t#generateRoutes(variants: Array<UmbMemberVariantOptionModel>) {\r\n\t\t// Generate split view routes for all available routes\r\n\t\tconst routes: Array<UmbRoute> = [];\r\n\r\n\t\t// Split view routes:\r\n\t\tvariants.forEach((variantA) => {\r\n\t\t\tvariants.forEach((variantB) => {\r\n\t\t\t\troutes.push({\r\n\t\t\t\t\t// TODO: When implementing Segments, be aware if using the unique is URL Safe... [NL]\r\n\t\t\t\t\tpath: variantA.unique + '_&_' + variantB.unique,\r\n\t\t\t\t\tcomponent: this._splitViewElement,\r\n\t\t\t\t\tsetup: (_component, info) => {\r\n\t\t\t\t\t\t// Set split view/active info..\r\n\t\t\t\t\t\tthis.#workspaceContext?.splitView.setVariantParts(info.match.fragments.consumed);\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// Single view:\r\n\t\tvariants.forEach((variant) => {\r\n\t\t\troutes.push({\r\n\t\t\t\t// TODO: When implementing Segments, be aware if using the unique is URL Safe... [NL]\r\n\t\t\t\tpath: variant.unique,\r\n\t\t\t\tcomponent: this._splitViewElement,\r\n\t\t\t\tsetup: (_component, info) => {\r\n\t\t\t\t\t// cause we might come from a split-view, we need to reset index 1.\r\n\t\t\t\t\tthis.#workspaceContext?.splitView.removeActiveVariant(1);\r\n\t\t\t\t\tthis.#workspaceContext?.splitView.handleVariantFolderPart(0, info.match.fragments.consumed);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tif (routes.length !== 0) {\r\n\t\t\troutes.push({\r\n\t\t\t\tpath: '',\r\n\t\t\t\tpathMatch: 'full',\r\n\t\t\t\t//redirectTo: routes[variants.length * variants.length]?.path,\r\n\t\t\t\tresolve: async () => {\r\n\t\t\t\t\tif (!this.#workspaceContext) {\r\n\t\t\t\t\t\tthrow new Error('Workspace context is not available when resolving the default route.');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Using first single view as the default route for now (hence the math below):\r\n\t\t\t\t\tconst path = routes[variants.length * variants.length]?.path;\r\n\t\t\t\t\thistory.replaceState({}, '', `${this.#workspaceRoute}/${path}`);\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\troutes.push({\r\n\t\t\tpath: `**`,\r\n\t\t\tcomponent: async () => (await import('@umbraco-cms/backoffice/router')).UmbRouteNotFoundElement,\r\n\t\t});\r\n\r\n\t\tthis._routes = routes;\r\n\t}\r\n\r\n\tprivate _gotWorkspaceRoute = (e: UmbRouterSlotInitEvent) => {\r\n\t\tthis.#workspaceRoute = e.target.absoluteRouterPath;\r\n\t\tthis.#workspaceContext?.splitView.setWorkspaceRoute(this.#workspaceRoute);\r\n\t};\r\n\r\n\toverride render() {\r\n\t\tif (this._isForbidden) {\r\n\t\t\treturn html`<umb-route-forbidden></umb-route-forbidden>`;\r\n\t\t}\r\n\t\treturn this._routes\r\n\t\t\t? html`<umb-router-slot .routes=${this._routes} @init=${this._gotWorkspaceRoute}></umb-router-slot>`\r\n\t\t\t: '';\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbMemberWorkspaceEditorElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-member-workspace-editor': UmbMemberWorkspaceEditorElement;\r\n\t}\r\n}\r\n"],"names":["_UmbMemberWorkspaceSplitViewElement_instances","observeActiveVariantInfo_fn","observeIcon_fn","UmbMemberWorkspaceSplitViewElement","UmbLitElement","__privateAdd","UMB_MEMBER_WORKSPACE_CONTEXT","context","__privateMethod","html","repeat","view","UMB_MEMBER_ROOT_WORKSPACE_PATH","ifDefined","nothing","variants","icon","UmbTextStyles","css","__decorateClass","state","customElement","_workspaceContext","_workspaceRoute","_UmbMemberWorkspaceEditorElement_instances","observeVariants_fn","observeForbidden_fn","generateRoutes_fn","UmbMemberWorkspaceEditorElement","__privateSet","__privateGet","instance","isForbidden","routes","variantA","variantB","_component","info","variant","path","UmbMemberWorkspaceEditorElement$1"],"mappings":"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"}