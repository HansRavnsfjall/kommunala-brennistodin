{"version":3,"file":"input-multi-url.element-9m9lQft9.js","sources":["../../../src/packages/multi-url-picker/components/input-multi-url/input-multi-url.element.ts"],"sourcesContent":["import type { UmbLinkPickerLink } from '../../link-picker-modal/types.js';\r\nimport { UMB_LINK_PICKER_MODAL } from '../../link-picker-modal/link-picker-modal.token.js';\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tifDefined,\r\n\tnothing,\r\n\tproperty,\r\n\trepeat,\r\n\tstate,\r\n\twhen,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { simpleHashCode } from '@umbraco-cms/backoffice/observable-api';\r\nimport { umbConfirmModal } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport {\r\n\tUmbDocumentItemRepository,\r\n\tUmbDocumentUrlRepository,\r\n\tUmbDocumentUrlsDataResolver,\r\n} from '@umbraco-cms/backoffice/document';\r\nimport { UmbMediaItemRepository, UmbMediaUrlRepository } from '@umbraco-cms/backoffice/media';\r\nimport { UmbModalRouteRegistrationController } from '@umbraco-cms/backoffice/router';\r\nimport { UmbSorterController } from '@umbraco-cms/backoffice/sorter';\r\nimport { UUIFormControlMixin } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { UmbModalRouteBuilder } from '@umbraco-cms/backoffice/router';\r\nimport type { UmbVariantId } from '@umbraco-cms/backoffice/variant';\r\nimport type { UUIModalSidebarSize } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n/**\r\n * @element umb-input-multi-url\r\n * @fires change - when the value of the input changes\r\n * @fires blur - when the input loses focus\r\n * @fires focus - when the input gains focus\r\n */\r\n@customElement('umb-input-multi-url')\r\nexport class UmbInputMultiUrlElement extends UUIFormControlMixin(UmbLitElement, '') {\r\n\t#sorter = new UmbSorterController<UmbLinkPickerLink>(this, {\r\n\t\tgetUniqueOfElement: (element) => {\r\n\t\t\treturn element.id;\r\n\t\t},\r\n\t\tgetUniqueOfModel: (modelEntry) => {\r\n\t\t\treturn this.#getUnique(modelEntry);\r\n\t\t},\r\n\t\tidentifier: 'Umb.SorterIdentifier.InputMultiUrl',\r\n\t\titemSelector: 'uui-ref-node',\r\n\t\tcontainerSelector: 'uui-ref-list',\r\n\t\tonChange: ({ model }) => {\r\n\t\t\tthis.urls = model;\r\n\t\t\tthis.#dispatchChangeEvent();\r\n\t\t},\r\n\t});\r\n\r\n\tprotected override getFormElement() {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t@property()\r\n\t/** @deprecated will be removed in v17 */\r\n\tpublic set alias(value: string | undefined) {\r\n\t\t//this.#linkPickerModal.setUniquePathValue('propertyAlias', value);\r\n\t}\r\n\tpublic get alias(): string | undefined {\r\n\t\treturn undefined; //this.#linkPickerModal.getUniquePathValue('propertyAlias');\r\n\t}\r\n\r\n\t@property()\r\n\t/** @deprecated will be removed in v17 */\r\n\tpublic set variantId(value: string | UmbVariantId | undefined) {\r\n\t\t//this.#linkPickerModal.setUniquePathValue('variantId', value?.toString());\r\n\t}\r\n\tpublic get variantId(): string | undefined {\r\n\t\treturn undefined; //this.#linkPickerModal.getUniquePathValue('variantId');\r\n\t}\r\n\r\n\t/**\r\n\t * This is a minimum amount of selected items in this input.\r\n\t * @type {number}\r\n\t * @attr\r\n\t * @default undefined\r\n\t */\r\n\t@property({ type: Number })\r\n\tmin?: number;\r\n\r\n\t/**\r\n\t * Min validation message.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: String, attribute: 'min-message' })\r\n\tminMessage = 'This field needs more items';\r\n\r\n\t/**\r\n\t * This is a maximum amount of selected items in this input.\r\n\t * @type {number}\r\n\t * @attr\r\n\t * @default undefined\r\n\t */\r\n\t@property({ type: Number })\r\n\tmax?: number;\r\n\r\n\t/**\r\n\t * Max validation message.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: String, attribute: 'min-message' })\r\n\tmaxMessage = 'This field exceeds the allowed amount of items';\r\n\r\n\t/**\r\n\t @attr 'hide-anchor'\r\n\t */\r\n\t@property({ type: Boolean, attribute: 'hide-anchor' })\r\n\thideAnchor?: boolean;\r\n\r\n\t/**\r\n\t * @type {UUIModalSidebarSize}\r\n\t * @attr\r\n\t * @default \"small\"\r\n\t */\r\n\t@property()\r\n\toverlaySize?: UUIModalSidebarSize;\r\n\r\n\t/**\r\n\t * @type {Array<UmbLinkPickerLink>}\r\n\t * @default\r\n\t */\r\n\t@property({ attribute: false })\r\n\tset urls(data: Array<UmbLinkPickerLink>) {\r\n\t\tdata ??= [];\r\n\t\tthis.#urls = [...data]; // Unfreeze data coming from State, so we can manipulate it.\r\n\t\tsuper.value = this.#urls.map((x) => x.url).join(',');\r\n\t\tthis.#sorter.setModel(this.#urls);\r\n\t\tthis.#populateLinksNameAndUrl();\r\n\t}\r\n\tget urls(): Array<UmbLinkPickerLink> {\r\n\t\treturn this.#urls;\r\n\t}\r\n\r\n\t#urls: Array<UmbLinkPickerLink> = [];\r\n\r\n\t#documentItemRepository = new UmbDocumentItemRepository(this);\r\n\t#documentUrlRepository = new UmbDocumentUrlRepository(this);\r\n\t#documentUrlsDataResolver = new UmbDocumentUrlsDataResolver(this);\r\n\r\n\t#mediaItemRepository = new UmbMediaItemRepository(this);\r\n\t#mediaUrlRepository = new UmbMediaUrlRepository(this);\r\n\r\n\t/**\r\n\t * Sets the input to readonly mode, meaning value cannot be changed but still able to read and select its content.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default\r\n\t */\r\n\t@property({ type: Boolean, reflect: true })\r\n\tpublic get readonly() {\r\n\t\treturn this.#readonly;\r\n\t}\r\n\tpublic set readonly(value) {\r\n\t\tthis.#readonly = value;\r\n\r\n\t\tif (this.#readonly) {\r\n\t\t\tthis.#sorter.disable();\r\n\t\t} else {\r\n\t\t\tthis.#sorter.enable();\r\n\t\t}\r\n\t}\r\n\t#readonly = false;\r\n\r\n\t@state()\r\n\tprivate _modalRoute?: UmbModalRouteBuilder;\r\n\r\n\t@state()\r\n\tprivate _resolvedLinkNames: Array<{ unique: string; name: string }> = [];\r\n\r\n\t@state()\r\n\tprivate _resolvedLinkUrls: Array<{ unique: string; url: string }> = [];\r\n\r\n\t#linkPickerModal;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'rangeUnderflow',\r\n\t\t\t() => this.minMessage,\r\n\t\t\t() => !!this.min && this.urls.length < this.min,\r\n\t\t);\r\n\t\tthis.addValidator(\r\n\t\t\t'rangeOverflow',\r\n\t\t\t() => this.maxMessage,\r\n\t\t\t() => !!this.max && this.urls.length > this.max,\r\n\t\t);\r\n\r\n\t\tthis.#linkPickerModal = new UmbModalRouteRegistrationController(this, UMB_LINK_PICKER_MODAL)\r\n\t\t\t.addAdditionalPath(`:index`)\r\n\t\t\t.onSetup((params) => {\r\n\t\t\t\t// Get index:\r\n\t\t\t\tconst indexParam = params.index;\r\n\t\t\t\tif (!indexParam) return false;\r\n\t\t\t\tlet index: number | null = parseInt(params.index);\r\n\t\t\t\tif (Number.isNaN(index)) return false;\r\n\r\n\t\t\t\t// Use the index to find data:\r\n\t\t\t\tlet data: UmbLinkPickerLink | null = null;\r\n\t\t\t\tif (index >= 0 && index < this.urls.length) {\r\n\t\t\t\t\tdata = this.#getItemByIndex(index);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// If not then make a new pick:\r\n\t\t\t\t\tindex = null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmodal: {\r\n\t\t\t\t\t\tsize: this.overlaySize || 'small',\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\tisNew: index === null,\r\n\t\t\t\t\t\tconfig: {\r\n\t\t\t\t\t\t\thideAnchor: this.hideAnchor,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tvalue: {\r\n\t\t\t\t\t\tlink: {\r\n\t\t\t\t\t\t\ticon: data?.icon,\r\n\t\t\t\t\t\t\tname: data?.name,\r\n\t\t\t\t\t\t\tpublished: data?.published,\r\n\t\t\t\t\t\t\tqueryString: data?.queryString,\r\n\t\t\t\t\t\t\ttarget: data?.target,\r\n\t\t\t\t\t\t\ttrashed: data?.trashed,\r\n\t\t\t\t\t\t\ttype: data?.type,\r\n\t\t\t\t\t\t\tunique: data?.unique,\r\n\t\t\t\t\t\t\turl: data?.url,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t})\r\n\t\t\t.onSubmit((value) => {\r\n\t\t\t\tif (!value) return;\r\n\t\t\t\tthis.#setSelection(value.link, this.#linkPickerModal.modalContext?.data.index ?? null);\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis._modalRoute = routeBuilder;\r\n\t\t\t});\r\n\t}\r\n\r\n\t#populateLinksNameAndUrl() {\r\n\t\tthis._resolvedLinkNames = [];\r\n\t\tthis._resolvedLinkUrls = [];\r\n\r\n\t\t// Documents and media have URLs saved in the local link format.\r\n\t\t// Display the actual URL to align with what the user sees when they selected it initially.\r\n\t\tthis.#urls.forEach(async (link) => {\r\n\t\t\tif (!link.unique) return;\r\n\r\n\t\t\tlet name: string | undefined = undefined;\r\n\t\t\tlet url: string | undefined = undefined;\r\n\r\n\t\t\tswitch (link.type) {\r\n\t\t\t\tcase 'document': {\r\n\t\t\t\t\tif (!link.name || link.name.length === 0) {\r\n\t\t\t\t\t\tname = await this.#getNameForDocument(link.unique);\r\n\t\t\t\t\t}\r\n\t\t\t\t\turl = await this.#getUrlForDocument(link.unique);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcase 'media': {\r\n\t\t\t\t\tif (!link.name || link.name.length === 0) {\r\n\t\t\t\t\t\tname = await this.#getNameForMedia(link.unique);\r\n\t\t\t\t\t}\r\n\t\t\t\t\turl = await this.#getUrlForMedia(link.unique);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (name) {\r\n\t\t\t\tconst resolvedName = { unique: link.unique, name };\r\n\t\t\t\tthis._resolvedLinkNames = [...this._resolvedLinkNames, resolvedName];\r\n\t\t\t}\r\n\r\n\t\t\tif (url) {\r\n\t\t\t\tconst resolvedUrl = { unique: link.unique, url };\r\n\t\t\t\tthis._resolvedLinkUrls = [...this._resolvedLinkUrls, resolvedUrl];\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tasync #getUrlForDocument(unique: string) {\r\n\t\tconst { data: data } = await this.#documentUrlRepository.requestItems([unique]);\r\n\r\n\t\tthis.#documentUrlsDataResolver.setData(data?.[0]?.urls);\r\n\r\n\t\tconst resolvedUrls = await this.#documentUrlsDataResolver.getUrls();\r\n\t\treturn resolvedUrls?.[0]?.url ?? '';\r\n\t}\r\n\r\n\tasync #getUrlForMedia(unique: string) {\r\n\t\tconst { data } = await this.#mediaUrlRepository.requestItems([unique]);\r\n\t\treturn data?.[0].url ?? '';\r\n\t}\r\n\r\n\tasync #getNameForDocument(unique: string) {\r\n\t\tconst { data } = await this.#documentItemRepository.requestItems([unique]);\r\n\t\treturn data?.[0]?.name ?? '';\r\n\t}\r\n\r\n\tasync #getNameForMedia(unique: string) {\r\n\t\tconst { data } = await this.#mediaItemRepository.requestItems([unique]);\r\n\t\treturn data?.[0]?.name ?? '';\r\n\t}\r\n\r\n\tasync #requestRemoveItem(index: number, name?: string) {\r\n\t\tconst item = this.#urls[index];\r\n\t\tif (!item) throw new Error('Could not find item at index: ' + index);\r\n\r\n\t\tawait umbConfirmModal(this, {\r\n\t\t\tcolor: 'danger',\r\n\t\t\theadline: `Remove ${name || item.name || 'item'}?`,\r\n\t\t\tcontent: 'Are you sure you want to remove this item?',\r\n\t\t\tconfirmLabel: '#general_remove',\r\n\t\t});\r\n\r\n\t\tthis.#removeItem(index);\r\n\t}\r\n\r\n\t#removeItem(index: number) {\r\n\t\tthis.urls.splice(index, 1);\r\n\t\tthis.#dispatchChangeEvent();\r\n\t}\r\n\r\n\t#getItemByIndex(index: number) {\r\n\t\treturn this.urls[index];\r\n\t}\r\n\r\n\t#getUnique(link: UmbLinkPickerLink): string {\r\n\t\treturn 'x' + simpleHashCode(JSON.stringify(link)).toString(16);\r\n\t}\r\n\r\n\t#setSelection(selection: UmbLinkPickerLink, index: number | null) {\r\n\t\tif (index !== null && index >= 0) {\r\n\t\t\tthis.urls[index] = selection;\r\n\t\t} else {\r\n\t\t\tthis.urls.push(selection);\r\n\t\t}\r\n\r\n\t\tthis.#dispatchChangeEvent();\r\n\t}\r\n\r\n\t#dispatchChangeEvent() {\r\n\t\tthis.requestUpdate();\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\t#getResolvedItemName(link: UmbLinkPickerLink): string {\r\n\t\treturn (link.name || this._resolvedLinkNames.find((name) => name.unique === link.unique)?.name) ?? '';\r\n\t}\r\n\r\n\t#getResolvedItemUrl(link: UmbLinkPickerLink): string {\r\n\t\treturn (\r\n\t\t\t(this._resolvedLinkUrls.find((url) => url.unique === link.unique)?.url ?? link.url ?? '') +\r\n\t\t\t(link.queryString || '')\r\n\t\t);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`${this.#renderItems()} ${this.#renderAddButton()}`;\r\n\t}\r\n\r\n\t#renderAddButton() {\r\n\t\tif (this.max === 1 && this.urls && this.urls.length >= this.max) return nothing;\r\n\t\tif (this.readonly && this.urls.length > 0) {\r\n\t\t\treturn nothing;\r\n\t\t} else {\r\n\t\t\treturn html`\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tid=\"btn-add\"\r\n\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\tlabel=${this.localize.term('general_add')}\r\n\t\t\t\t\t.href=${this._modalRoute?.({ index: -1 })}\r\n\t\t\t\t\t?disabled=${this.readonly}></uui-button>\r\n\t\t\t`;\r\n\t\t}\r\n\t}\r\n\r\n\t#renderItems() {\r\n\t\tif (!this.urls) return;\r\n\t\treturn html`\r\n\t\t\t<uui-ref-list>\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis.urls,\r\n\t\t\t\t\t(link) => link.unique,\r\n\t\t\t\t\t(link, index) => this.#renderItem(link, index),\r\n\t\t\t\t)}\r\n\t\t\t</uui-ref-list>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(link: UmbLinkPickerLink, index: number) {\r\n\t\tconst unique = this.#getUnique(link);\r\n\t\tconst href = this.readonly ? undefined : (this._modalRoute?.({ index }) ?? undefined);\r\n\t\tconst name = this.#getResolvedItemName(link);\r\n\t\tconst url = this.#getResolvedItemUrl(link);\r\n\r\n\t\treturn html`\r\n\t\t\t<uui-ref-node\r\n\t\t\t\tid=${unique}\r\n\t\t\t\thref=${ifDefined(href)}\r\n\t\t\t\tname=${name || url}\r\n\t\t\t\tdetail=${ifDefined(name ? url : undefined)}\r\n\t\t\t\t?readonly=${this.readonly}>\r\n\t\t\t\t<umb-icon slot=\"icon\" name=${link.icon || 'icon-link'}></umb-icon>\r\n\t\t\t\t${when(\r\n\t\t\t\t\t!this.readonly,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-action-bar slot=\"actions\">\r\n\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\tlabel=${this.localize.term('general_remove')}\r\n\t\t\t\t\t\t\t\t@click=${() => this.#requestRemoveItem(index, name)}></uui-button>\r\n\t\t\t\t\t\t</uui-action-bar>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t</uui-ref-node>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#btn-add {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-input-multi-url': UmbInputMultiUrlElement;\r\n\t}\r\n}\r\n"],"names":["_sorter","_urls","_documentItemRepository","_documentUrlRepository","_documentUrlsDataResolver","_mediaItemRepository","_mediaUrlRepository","_readonly","_linkPickerModal","_UmbInputMultiUrlElement_instances","populateLinksNameAndUrl_fn","getUrlForDocument_fn","getUrlForMedia_fn","getNameForDocument_fn","getNameForMedia_fn","requestRemoveItem_fn","removeItem_fn","getItemByIndex_fn","getUnique_fn","setSelection_fn","dispatchChangeEvent_fn","getResolvedItemName_fn","getResolvedItemUrl_fn","renderAddButton_fn","renderItems_fn","renderItem_fn","UmbInputMultiUrlElement","UUIFormControlMixin","UmbLitElement","__privateAdd","UmbSorterController","element","modelEntry","__privateMethod","model","UmbDocumentItemRepository","UmbDocumentUrlRepository","UmbDocumentUrlsDataResolver","UmbMediaItemRepository","UmbMediaUrlRepository","__privateSet","UmbModalRouteRegistrationController","UMB_LINK_PICKER_MODAL","params","index","data","value","__privateGet","routeBuilder","x","html","link","name","url","resolvedName","resolvedUrl","unique","item","umbConfirmModal","simpleHashCode","selection","UmbChangeEvent","nothing","repeat","href","ifDefined","when","css","__decorateClass","property","state","customElement"],"mappings":"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"}