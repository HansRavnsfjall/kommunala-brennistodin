{"version":3,"file":"packages-created-overview.element-BQkmKaH3.js","sources":["../../../src/packages/packages/package-section/views/created/packages-created-overview.element.ts"],"sourcesContent":["import type { UmbCreatedPackage } from '../../../types.js';\r\nimport { html, css, nothing, customElement, state, repeat, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { umbConfirmModal } from '@umbraco-cms/backoffice/modal';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbPackageRepository } from '@umbraco-cms/backoffice/package';\r\nimport type { UUIPaginationEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-packages-created-overview')\r\nexport class UmbPackagesCreatedOverviewElement extends UmbLitElement {\r\n\t#take = 10;\r\n\r\n\t@state()\r\n\tprivate _loading = true;\r\n\r\n\t@state()\r\n\tprivate _createdPackages: Array<UmbCreatedPackage> = [];\r\n\r\n\t@state()\r\n\tprivate _currentPage = 1;\r\n\r\n\t@state()\r\n\tprivate _total?: number;\r\n\r\n\t#packageRepository = new UmbPackageRepository(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.#getPackages();\r\n\t}\r\n\r\n\tasync #getPackages() {\r\n\t\tconst skip = this._currentPage * this.#take - this.#take;\r\n\t\tconst data = await this.#packageRepository.getCreatedPackages({ skip, take: this.#take });\r\n\r\n\t\tif (data) {\r\n\t\t\tthis._createdPackages = data.items;\r\n\t\t\tthis._total = data.total;\r\n\t\t}\r\n\r\n\t\tthis._loading = false;\r\n\t}\r\n\r\n\t#onPageChange(event: UUIPaginationEvent) {\r\n\t\tif (this._currentPage === event.target.current) return;\r\n\t\tthis._currentPage = event.target.current;\r\n\t\tthis.#getPackages();\r\n\t}\r\n\r\n\tasync #deletePackage(pkg: UmbCreatedPackage) {\r\n\t\tif (!pkg.unique) return;\r\n\r\n\t\tawait umbConfirmModal(this, {\r\n\t\t\tcolor: 'danger',\r\n\t\t\theadline: `Remove ${pkg.name}?`,\r\n\t\t\tcontent: 'Are you sure you want to delete this package',\r\n\t\t\tconfirmLabel: this.localize.term('general_delete'),\r\n\t\t});\r\n\r\n\t\tconst success = await this.#packageRepository.deleteCreatedPackage(pkg.unique);\r\n\t\tif (!success) return;\r\n\r\n\t\tconst index = this._createdPackages.findIndex((x) => x.unique === pkg.unique);\r\n\t\tthis._createdPackages.splice(index, 1);\r\n\t\tthis.requestUpdate();\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<uui-button\r\n\t\t\t\tlook=\"primary\"\r\n\t\t\t\thref=\"section/packages/view/created/package-builder\"\r\n\t\t\t\tlabel=${this.localize.term('packager_createPackage')}></uui-button>\r\n\t\t\t${when(\r\n\t\t\t\tthis._loading,\r\n\t\t\t\t() => html`<div class=\"container\"><uui-loader></uui-loader></div>`,\r\n\t\t\t\t() => this.#renderCreatedPackages(),\r\n\t\t\t)}\r\n\t\t\t${this.#renderPagination()}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderCreatedPackages() {\r\n\t\tif (!this._createdPackages.length) return this.#renderNoPackages();\r\n\t\treturn html`\r\n\t\t\t<uui-box headline=\"Created packages\" style=\"--uui-box-default-padding:0;\">\r\n\t\t\t\t<uui-ref-list>\r\n\t\t\t\t\t${repeat(\r\n\t\t\t\t\t\tthis._createdPackages,\r\n\t\t\t\t\t\t(item) => item.unique,\r\n\t\t\t\t\t\t(item) => this.#renderItem(item),\r\n\t\t\t\t\t)}\r\n\t\t\t\t</uui-ref-list>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderNoPackages() {\r\n\t\treturn html`<h2 class=\"no-packages\">${this.localize.term('packager_noPackagesCreated')}</h2>`;\r\n\t}\r\n\r\n\t#renderItem(pkg: UmbCreatedPackage) {\r\n\t\treturn html`\r\n\t\t\t<uui-ref-node-package name=${pkg.name} @open=${() => this.#packageBuilder(pkg)}>\r\n\t\t\t\t<uui-action-bar slot=\"actions\">\r\n\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t@click=${() => this.#deletePackage(pkg)}\r\n\t\t\t\t\t\tlabel=${this.localize.term('general_delete')}></uui-button>\r\n\t\t\t\t</uui-action-bar>\r\n\t\t\t</uui-ref-node-package>\r\n\t\t`;\r\n\t}\r\n\r\n\t#packageBuilder(pkg: UmbCreatedPackage) {\r\n\t\tif (!pkg.unique) return;\r\n\t\twindow.history.pushState({}, '', `section/packages/view/created/package-builder/${pkg.unique}`);\r\n\t}\r\n\r\n\t#renderPagination() {\r\n\t\tif (!this._total) return nothing;\r\n\t\tconst totalPages = Math.ceil(this._total / this.#take);\r\n\t\tif (totalPages <= 1) return nothing;\r\n\t\treturn html`\r\n\t\t\t<div class=\"container\">\r\n\t\t\t\t<uui-pagination\r\n\t\t\t\t\t.total=${totalPages}\r\n\t\t\t\t\tfirstlabel=${this.localize.term('general_first')}\r\n\t\t\t\t\tpreviouslabel=${this.localize.term('general_previous')}\r\n\t\t\t\t\tnextlabel=${this.localize.term('general_next')}\r\n\t\t\t\t\tlastlabel=${this.localize.term('general_last')}\r\n\t\t\t\t\t@change=${this.#onPageChange}></uui-pagination>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tpadding: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\t\t\tuui-box {\r\n\t\t\t\tmargin: var(--uui-size-space-5) 0;\r\n\t\t\t\tpadding-bottom: var(--uui-size-space-1);\r\n\t\t\t}\r\n\r\n\t\t\t.no-packages {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-around;\r\n\t\t\t}\r\n\t\t\tuui-pagination {\r\n\t\t\t\tdisplay: inline-block;\r\n\t\t\t}\r\n\r\n\t\t\t.container {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbPackagesCreatedOverviewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-packages-created-overview': UmbPackagesCreatedOverviewElement;\r\n\t}\r\n}\r\n"],"names":["_take","_packageRepository","_UmbPackagesCreatedOverviewElement_instances","getPackages_fn","onPageChange_fn","deletePackage_fn","renderCreatedPackages_fn","renderNoPackages_fn","renderItem_fn","packageBuilder_fn","renderPagination_fn","UmbPackagesCreatedOverviewElement","UmbLitElement","__privateAdd","UmbPackageRepository","__privateMethod","html","when","skip","__privateGet","data","event","pkg","umbConfirmModal","index","x","repeat","item","nothing","totalPages","css","__decorateClass","state","customElement","UmbPackagesCreatedOverviewElement$1"],"mappings":"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"}