{"version":3,"file":"dynamic-root.repository-DO0J7Qvd.js","sources":["../../../src/packages/property-editors/content-picker/dynamic-root/repository/dynamic-root.server.data.ts","../../../src/packages/property-editors/content-picker/dynamic-root/repository/dynamic-root.repository.ts"],"sourcesContent":["import { DynamicRootService } from '@umbraco-cms/backoffice/external/backend-api';\r\nimport { tryExecute } from '@umbraco-cms/backoffice/resources';\r\nimport type { DynamicRootRequestModel, DynamicRootResponseModel } from '@umbraco-cms/backoffice/external/backend-api';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\n\r\n/**\r\n * UmbContentPickerDynamicRootServerDataSource\r\n * @class UmbContentPickerDynamicRootServerDataSource\r\n */\r\nexport class UmbContentPickerDynamicRootServerDataSource {\r\n\t#host: UmbControllerHost;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tthis.#host = host;\r\n\t}\r\n\r\n\t/**\r\n\t * Get dynamic root\r\n\t * @param {DynamicRootRequestModel} args\r\n\t * @returns {*}  {(Promise<DynamicRootResponseModel | undefined>)}\r\n\t * @memberof UmbContentPickerDynamicRootServerDataSource\r\n\t */\r\n\tasync getRoot(args: DynamicRootRequestModel): Promise<DynamicRootResponseModel | undefined> {\r\n\t\tif (!args.context) throw new Error('Dynamic Root context is missing');\r\n\t\tif (!args.query) throw new Error('Dynamic Root query is missing');\r\n\r\n\t\tconst body: DynamicRootRequestModel = {\r\n\t\t\tcontext: args.context,\r\n\t\t\tquery: args.query,\r\n\t\t};\r\n\r\n\t\tconst { data } = await tryExecute(this.#host, DynamicRootService.postDynamicRootQuery({ body }));\r\n\r\n\t\treturn data;\r\n\t}\r\n}\r\n","import type { UmbContentPickerDynamicRoot } from '../../types.js';\r\nimport { UmbContentPickerDynamicRootServerDataSource } from './dynamic-root.server.data.js';\r\nimport { UmbControllerBase } from '@umbraco-cms/backoffice/class-api';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport type { DynamicRootRequestModel } from '@umbraco-cms/backoffice/external/backend-api';\r\n\r\nconst GUID_EMPTY: string = '00000000-0000-0000-0000-000000000000';\r\n\r\n/**\r\n * UmbContentPickerDynamicRootRepository\r\n * @class UmbContentPickerDynamicRootRepository\r\n * @augments {UmbControllerBase}\r\n */\r\nexport class UmbContentPickerDynamicRootRepository extends UmbControllerBase {\r\n\t#dataSource: UmbContentPickerDynamicRootServerDataSource;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host);\r\n\r\n\t\tthis.#dataSource = new UmbContentPickerDynamicRootServerDataSource(host);\r\n\t}\r\n\r\n\t/**\r\n\t * Request dynamic root\r\n\t * @param {UmbContentPickerDynamicRoot} query\r\n\t * @param {string} entityUnique\r\n\t * @param {string} [parentUnique]\r\n\t * @returns {*}\r\n\t * @memberof UmbContentPickerDynamicRootRepository\r\n\t */\r\n\tasync requestRoot(query: UmbContentPickerDynamicRoot, entityUnique: string | null, parentUnique?: string | null) {\r\n\t\tconst model: DynamicRootRequestModel = {\r\n\t\t\tcontext: {\r\n\t\t\t\tid: entityUnique ?? null,\r\n\t\t\t\tparent: { id: parentUnique ?? GUID_EMPTY },\r\n\t\t\t},\r\n\t\t\tquery: {\r\n\t\t\t\torigin: {\r\n\t\t\t\t\talias: query.originAlias,\r\n\t\t\t\t\tid: query.originKey,\r\n\t\t\t\t},\r\n\t\t\t\tsteps:\r\n\t\t\t\t\tquery.querySteps?.map((step) => {\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\talias: step.alias!,\r\n\t\t\t\t\t\t\tdocumentTypeIds: step.anyOfDocTypeKeys!,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}) || [],\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\tconst result = await this.#dataSource.getRoot(model);\r\n\r\n\t\treturn result?.roots;\r\n\t}\r\n}\r\n"],"names":["UmbContentPickerDynamicRootServerDataSource","#host","host","args","body","data","tryExecute","DynamicRootService","GUID_EMPTY","UmbContentPickerDynamicRootRepository","UmbControllerBase","#dataSource","query","entityUnique","parentUnique","model","step"],"mappings":";;;AASO,MAAMA,EAA4C;AAAA,EACxDC;AAAA,EAEA,YAAYC,GAAyB;AACpC,SAAKD,KAAQC;AAAA,EACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,MAAM,QAAQC,GAA8E;AAC3F,QAAI,CAACA,EAAK,QAAS,OAAM,IAAI,MAAM,iCAAiC;AACpE,QAAI,CAACA,EAAK,MAAO,OAAM,IAAI,MAAM,+BAA+B;AAEhE,UAAMC,IAAgC;AAAA,MACrC,SAASD,EAAK;AAAA,MACd,OAAOA,EAAK;AAAA,IAAA,GAGP,EAAE,MAAAE,EAAA,IAAS,MAAMC,EAAW,KAAKL,IAAOM,EAAmB,qBAAqB,EAAE,MAAAH,EAAA,CAAM,CAAC;AAE/F,WAAOC;AAAA,EACR;AACD;AC7BA,MAAMG,IAAqB;AAOpB,MAAMC,UAA8CC,EAAkB;AAAA,EAC5EC;AAAA,EAEA,YAAYT,GAAyB;AACpC,UAAMA,CAAI,GAEV,KAAKS,KAAc,IAAIX,EAA4CE,CAAI;AAAA,EACxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,MAAM,YAAYU,GAAoCC,GAA6BC,GAA8B;AAChH,UAAMC,IAAiC;AAAA,MACtC,SAAS;AAAA,QACR,IAAIF,KAAgB;AAAA,QACpB,QAAQ,EAAE,IAAIC,KAAgBN,EAAA;AAAA,MAAW;AAAA,MAE1C,OAAO;AAAA,QACN,QAAQ;AAAA,UACP,OAAOI,EAAM;AAAA,UACb,IAAIA,EAAM;AAAA,QAAA;AAAA,QAEX,OACCA,EAAM,YAAY,IAAI,CAACI,OACf;AAAA,UACN,OAAOA,EAAK;AAAA,UACZ,iBAAiBA,EAAK;AAAA,QAAA,EAEvB,KAAK,CAAA;AAAA,MAAC;AAAA,IACT;AAKD,YAFe,MAAM,KAAKL,GAAY,QAAQI,CAAK,IAEpC;AAAA,EAChB;AACD;"}