{"version":3,"file":"property-editor-ui-select.element-DO8p-OsS.js","sources":["../../../src/packages/property-editors/select/property-editor-ui-select.element.ts"],"sourcesContent":["import { updateItemsSelectedState } from '../utils/property-editor-ui-state-manager.js';\r\nimport { customElement, html, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type {\r\n\tUmbPropertyEditorConfigCollection,\r\n\tUmbPropertyEditorUiElement,\r\n} from '@umbraco-cms/backoffice/property-editor';\r\nimport type { UUISelectEvent } from '@umbraco-cms/backoffice/external/uui';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\n\r\n/**\r\n * @element umb-property-editor-ui-select\r\n */\r\n@customElement('umb-property-editor-ui-select')\r\nexport class UmbPropertyEditorUISelectElement extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n\tprivate _value: string = '';\r\n\r\n\t// Update the selected state of existing options when value changes\r\n\t@property()\r\n\tpublic set value(newValue: string | undefined) {\r\n\t\tthis._value = newValue || '';\r\n\t\tthis.#updateSelectedState();\r\n\t}\r\n\tpublic get value(): string {\r\n\t\treturn this._value;\r\n\t}\r\n\r\n\tpublic set config(config: UmbPropertyEditorConfigCollection | undefined) {\r\n\t\tif (!config) return;\r\n\r\n\t\tconst items = config.getValueByAlias('items');\r\n\r\n\t\tif (Array.isArray(items) && items.length > 0) {\r\n\t\t\tthis._options =\r\n\t\t\t\ttypeof items[0] === 'string'\r\n\t\t\t\t\t? items.map((item) => ({ name: item, value: item, selected: item === this._value }))\r\n\t\t\t\t\t: items.map((item) => ({ name: item.name, value: item.value, selected: item.value === this._value }));\r\n\t\t}\r\n\t}\r\n\r\n\t@state()\r\n\tprivate _options: Array<Option> = [];\r\n\r\n\t#onChange(event: UUISelectEvent) {\r\n\t\tthis.value = event.target.value as string;\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the selected state of all options based on current value.\r\n\t * This fixes the issue where UI doesn't update when values are set programmatically.\r\n\t */\r\n\t#updateSelectedState() {\r\n\t\t// Only update if we have options loaded\r\n\t\tif (this._options.length > 0) {\r\n\t\t\t// Update state only if changes are needed\r\n\t\t\tconst updatedOptions = updateItemsSelectedState(this._options, [this._value], 'selected');\r\n\t\t\tif (updatedOptions !== this._options) {\r\n\t\t\t\tthis._options = updatedOptions;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`<uui-select .options=${this._options} @change=${this.#onChange}></uui-select>`;\r\n\t}\r\n}\r\n\r\nexport default UmbPropertyEditorUISelectElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-select': UmbPropertyEditorUISelectElement;\r\n\t}\r\n}\r\n"],"names":["_UmbPropertyEditorUISelectElement_instances","onChange_fn","updateSelectedState_fn","UmbPropertyEditorUISelectElement","UmbLitElement","__privateAdd","newValue","__privateMethod","config","items","item","html","event","UmbChangeEvent","updatedOptions","updateItemsSelectedState","__decorateClass","property","state","customElement","UmbPropertyEditorUISelectElement$1"],"mappings":";;;;;;;;;;8OAAAA,GAAAC,GAAAC;AAcO,IAAMC,IAAN,cAA+CC,EAAoD;AAAA,EAAnG,cAAA;AAAA,UAAA,GAAA,SAAA,GAAAC,EAAA,MAAAL,CAAA,GACN,KAAQ,SAAiB,IA0BzB,KAAQ,WAA0B,CAAA;AAAA,EAAC;AAAA,EAtBnC,IAAW,MAAMM,GAA8B;AAC9C,SAAK,SAASA,KAAY,IAC1BC,EAAA,MAAKP,GAAAE,CAAA,EAAL,KAAA,IAAA;AAAA,EACD;AAAA,EACA,IAAW,QAAgB;AAC1B,WAAO,KAAK;AAAA,EACb;AAAA,EAEA,IAAW,OAAOM,GAAuD;AACxE,QAAI,CAACA,EAAQ;AAEb,UAAMC,IAAQD,EAAO,gBAAgB,OAAO;AAE5C,IAAI,MAAM,QAAQC,CAAK,KAAKA,EAAM,SAAS,MAC1C,KAAK,WACJ,OAAOA,EAAM,CAAC,KAAM,WACjBA,EAAM,IAAI,CAACC,OAAU,EAAE,MAAMA,GAAM,OAAOA,GAAM,UAAUA,MAAS,KAAK,OAAA,EAAS,IACjFD,EAAM,IAAI,CAACC,OAAU,EAAE,MAAMA,EAAK,MAAM,OAAOA,EAAK,OAAO,UAAUA,EAAK,UAAU,KAAK,SAAS;AAAA,EAExG;AAAA,EAyBS,SAAS;AACjB,WAAOC,yBAA4B,KAAK,QAAQ,YAAYJ,QAAKP,GAAAC,CAAA,CAAS;AAAA,EAC3E;AACD;AApDOD,IAAA,oBAAA,QAAA;AA6BNC,IAAS,SAACW,GAAuB;AAChC,OAAK,QAAQA,EAAM,OAAO,OAC1B,KAAK,cAAc,IAAIC,GAAgB;AACxC;AAMAX,IAAoB,WAAG;AAEtB,MAAI,KAAK,SAAS,SAAS,GAAG;AAE7B,UAAMY,IAAiBC,EAAyB,KAAK,UAAU,CAAC,KAAK,MAAM,GAAG,UAAU;AACxF,IAAID,MAAmB,KAAK,aAC3B,KAAK,WAAWA;AAAA,EAElB;AACD;AA1CWE,EAAA;AAAA,EADVC,EAAA;AAAS,GAJEd,EAKD,WAAA,SAAA,CAAA;AAsBHa,EAAA;AAAA,EADPE,EAAA;AAAM,GA1BKf,EA2BJ,WAAA,YAAA,CAAA;AA3BIA,IAANa,EAAA;AAAA,EADNG,EAAc,+BAA+B;AAAA,GACjChB,CAAA;AAsDb,MAAAiB,IAAejB;"}