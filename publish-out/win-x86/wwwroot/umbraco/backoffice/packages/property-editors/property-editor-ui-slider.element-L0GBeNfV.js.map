{"version":3,"file":"property-editor-ui-slider.element-L0GBeNfV.js","sources":["../../../src/packages/property-editors/slider/property-editor-ui-slider.element.ts"],"sourcesContent":["import type { UmbSliderPropertyEditorUiValue, UmbSliderPropertyEditorUiValueObject } from './types.js';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport type { UmbInputSliderElement } from '@umbraco-cms/backoffice/components';\r\nimport { customElement, html, property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UMB_PROPERTY_CONTEXT } from '@umbraco-cms/backoffice/property';\r\nimport type {\r\n\tUmbPropertyEditorConfigCollection,\r\n\tUmbPropertyEditorUiElement,\r\n} from '@umbraco-cms/backoffice/property-editor';\r\nimport { UmbFormControlMixin } from '@umbraco-cms/backoffice/validation';\r\n\r\nfunction stringToValueObject(value: string | undefined): Partial<UmbSliderPropertyEditorUiValueObject> {\r\n\tconst [from, to] = (value ?? ',').split(',');\r\n\tconst fromNumber = makeNumberOrUndefined(from);\r\n\treturn { from: fromNumber, to: makeNumberOrUndefined(to, fromNumber) };\r\n}\r\n\r\nfunction makeNumberOrUndefined(value: string | undefined, fallback?: undefined | number) {\r\n\tif (value === undefined) {\r\n\t\treturn fallback;\r\n\t}\r\n\tconst n = Number(value);\r\n\tif (isNaN(n)) {\r\n\t\treturn fallback;\r\n\t}\r\n\treturn n;\r\n}\r\n\r\nfunction undefinedFallback(value: number | undefined, fallback: number) {\r\n\treturn value === undefined ? fallback : value;\r\n}\r\n\r\n/**\r\n * @element umb-property-editor-ui-slider\r\n */\r\n@customElement('umb-property-editor-ui-slider')\r\nexport class UmbPropertyEditorUISliderElement\r\n\textends UmbFormControlMixin<UmbSliderPropertyEditorUiValue, typeof UmbLitElement>(UmbLitElement)\r\n\timplements UmbPropertyEditorUiElement\r\n{\r\n\t/**\r\n\t * Sets the input to readonly mode, meaning value cannot be changed but still able to read and select its content.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default false\r\n\t */\r\n\t@property({ type: Boolean, reflect: true })\r\n\treadonly = false;\r\n\r\n\t@state()\r\n\tprivate _enableRange = false;\r\n\r\n\t@state()\r\n\tprivate _initVal1: number = 0;\r\n\r\n\t@state()\r\n\tprivate _initVal2: number = 1;\r\n\r\n\t@state()\r\n\tprivate _label?: string;\r\n\r\n\t@state()\r\n\tprivate _step = 1;\r\n\r\n\t@state()\r\n\tprivate _min = 0;\r\n\r\n\t@state()\r\n\tprivate _max = 100;\r\n\r\n\tpublic set config(config: UmbPropertyEditorConfigCollection | undefined) {\r\n\t\tif (!config) return;\r\n\r\n\t\tthis._enableRange = Boolean(config.getValueByAlias('enableRange'));\r\n\r\n\t\t// Make sure that step is higher than 0 (decimals ok).\r\n\t\tconst step = (config.getValueByAlias('step') ?? 1) as number;\r\n\t\tthis._step = step > 0 ? step : 1;\r\n\r\n\t\tconst initVal1 = Number(config.getValueByAlias('initVal1'));\r\n\t\tthis._initVal1 = isNaN(initVal1) ? 0 : initVal1;\r\n\r\n\t\tconst initVal2 = Number(config.getValueByAlias('initVal2'));\r\n\t\tthis._initVal2 = isNaN(initVal2) ? this._initVal1 + this._step : initVal2;\r\n\r\n\t\tthis._min = this.#parseInt(config.getValueByAlias('minVal')) || 0;\r\n\t\tthis._max = this.#parseInt(config.getValueByAlias('maxVal')) || 100;\r\n\r\n\t\tif (this._min === this._max) {\r\n\t\t\tthis._max = this._min + 100;\r\n\t\t\tconsole.warn(\r\n\t\t\t\t`Property Editor (Slider) has been misconfigured, 'min' and 'max' are equal values. Please correct your data type configuration. To render the slider correctly, we changed this slider to: min = ${this._min}, max = ${this._max}`,\r\n\t\t\t\tthis,\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.consumeContext(UMB_PROPERTY_CONTEXT, (context) => {\r\n\t\t\tthis._label = context?.getLabel();\r\n\t\t});\r\n\t}\r\n\r\n\tprotected override firstUpdated() {\r\n\t\tthis.addFormControlElement(this.shadowRoot!.querySelector('umb-input-slider')!);\r\n\t\tif (this._min && this._max && this._min > this._max) {\r\n\t\t\tconsole.warn(\r\n\t\t\t\t`Property '${this._label}' (Slider) has been misconfigured, 'min' is greater than 'max'. Please correct your data type configuration.`,\r\n\t\t\t\tthis,\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\t#parseInt(input: unknown): number | undefined {\r\n\t\tconst num = Number(input);\r\n\t\treturn Number.isNaN(num) ? undefined : num;\r\n\t}\r\n\r\n\t#onChange(event: CustomEvent & { target: UmbInputSliderElement }) {\r\n\t\tconst partialValue = stringToValueObject(event.target.value as string);\r\n\t\tconst handledFrom = undefinedFallback(partialValue.from, this._initVal1);\r\n\t\tthis.value = {\r\n\t\t\tfrom: handledFrom,\r\n\t\t\tto: this._enableRange ? undefinedFallback(partialValue.to, this._initVal2) : handledFrom,\r\n\t\t};\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-input-slider\r\n\t\t\t\t.label=${this._label ?? 'Slider'}\r\n\t\t\t\t.valueLow=${undefinedFallback(this.value?.from, this._initVal1)}\r\n\t\t\t\t.valueHigh=${undefinedFallback(this.value?.to, this._initVal2)}\r\n\t\t\t\t.step=${this._step}\r\n\t\t\t\t.min=${this._min}\r\n\t\t\t\t.max=${this._max}\r\n\t\t\t\t?enable-range=${this._enableRange}\r\n\t\t\t\t@change=${this.#onChange}\r\n\t\t\t\t?readonly=${this.readonly}>\r\n\t\t\t</umb-input-slider>\r\n\t\t`;\r\n\t}\r\n}\r\n\r\nexport default UmbPropertyEditorUISliderElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-property-editor-ui-slider': UmbPropertyEditorUISliderElement;\r\n\t}\r\n}\r\n"],"names":["_UmbPropertyEditorUISliderElement_instances","parseInt_fn","onChange_fn","stringToValueObject","value","from","to","fromNumber","makeNumberOrUndefined","fallback","n","undefinedFallback","UmbPropertyEditorUISliderElement","UmbFormControlMixin","UmbLitElement","__privateAdd","UMB_PROPERTY_CONTEXT","context","config","step","initVal1","initVal2","__privateMethod","html","input","num","event","partialValue","handledFrom","UmbChangeEvent","__decorateClass","property","state","customElement","UmbPropertyEditorUISliderElement$1"],"mappings":"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"}