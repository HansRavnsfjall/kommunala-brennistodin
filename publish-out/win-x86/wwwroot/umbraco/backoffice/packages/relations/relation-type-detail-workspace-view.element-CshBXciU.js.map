{"version":3,"file":"relation-type-detail-workspace-view.element-CshBXciU.js","sources":["../../../src/packages/relations/relation-types/workspace/relation-type/views/relation-type-detail-workspace-view.element.ts"],"sourcesContent":["import { UMB_RELATION_TYPE_WORKSPACE_CONTEXT } from '../relation-type-workspace.context-token.js';\r\nimport type { UmbRelationTypeDetailModel } from '../../../types.js';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { css, html, customElement, state, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { UmbTableColumn, UmbTableConfig, UmbTableItem } from '@umbraco-cms/backoffice/components';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbWorkspaceViewElement } from '@umbraco-cms/backoffice/workspace';\r\nimport type { UmbRelationDetailModel } from '@umbraco-cms/backoffice/relations';\r\nimport { UmbRelationCollectionRepository } from '@umbraco-cms/backoffice/relations';\r\nimport { observeMultiple } from '@umbraco-cms/backoffice/observable-api';\r\nimport { UmbPaginationManager } from '@umbraco-cms/backoffice/utils';\r\nimport type { UUIPaginationEvent } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-relation-type-detail-workspace-view')\r\nexport class UmbRelationTypeDetailWorkspaceViewElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t@state()\r\n\tprivate _relations: Array<UmbRelationDetailModel> = [];\r\n\r\n\t@state()\r\n\tprivate _parent?: UmbRelationTypeDetailModel['parent'];\r\n\r\n\t@state()\r\n\tprivate _child?: UmbRelationTypeDetailModel['child'];\r\n\r\n\t@state()\r\n\tprivate _isBidirectional?: UmbRelationTypeDetailModel['isBidirectional'];\r\n\r\n\t@state()\r\n\tprivate _isDependency?: UmbRelationTypeDetailModel['isDependency'];\r\n\r\n\t@state()\r\n\tprivate _currentPageNumber = 1;\r\n\r\n\t@state()\r\n\tprivate _totalPages = 1;\r\n\r\n\t@state()\r\n\tprivate _loading = false;\r\n\r\n\t#workspaceContext?: typeof UMB_RELATION_TYPE_WORKSPACE_CONTEXT.TYPE;\r\n\t#relationCollectionRepository = new UmbRelationCollectionRepository(this);\r\n\t#paginationManager = new UmbPaginationManager();\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.#paginationManager.setPageSize(50);\r\n\r\n\t\tthis.observe(this.#paginationManager.currentPage, (number) => (this._currentPageNumber = number));\r\n\t\tthis.observe(this.#paginationManager.totalPages, (number) => (this._totalPages = number));\r\n\r\n\t\tthis.consumeContext(UMB_RELATION_TYPE_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\t\t\tthis.#requestRelations();\r\n\t\t\tthis.#observeDetails();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeDetails() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\r\n\t\tthis.observe(\r\n\t\t\tobserveMultiple([\r\n\t\t\t\tthis.#workspaceContext.parent,\r\n\t\t\t\tthis.#workspaceContext.child,\r\n\t\t\t\tthis.#workspaceContext.isBidirectional,\r\n\t\t\t\tthis.#workspaceContext.isDependency,\r\n\t\t\t]),\r\n\t\t\t([parent, child, isBidirectional, isDependency]) => {\r\n\t\t\t\tthis._parent = parent;\r\n\t\t\t\tthis._child = child;\r\n\t\t\t\tthis._isBidirectional = isBidirectional;\r\n\t\t\t\tthis._isDependency = isDependency;\r\n\t\t\t},\r\n\t\t);\r\n\t}\r\n\r\n\tasync #requestRelations() {\r\n\t\tthis._loading = true;\r\n\r\n\t\tconst relationTypeUnique = this.#workspaceContext?.getUnique();\r\n\t\tif (!relationTypeUnique) throw new Error('Relation type unique is required');\r\n\r\n\t\tconst { data } = await this.#relationCollectionRepository.requestCollection({\r\n\t\t\trelationType: {\r\n\t\t\t\tunique: relationTypeUnique,\r\n\t\t\t},\r\n\t\t\tskip: this.#paginationManager.getSkip(),\r\n\t\t\ttake: this.#paginationManager.getPageSize(),\r\n\t\t});\r\n\r\n\t\tif (data) {\r\n\t\t\tthis._relations = data.items;\r\n\t\t\tthis.#paginationManager.setTotalItems(data.total);\r\n\t\t\tthis._loading = false;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _tableConfig: UmbTableConfig = {\r\n\t\tallowSelection: false,\r\n\t\thideIcon: true,\r\n\t};\r\n\r\n\tprivate _tableColumns: Array<UmbTableColumn> = [\r\n\t\t{\r\n\t\t\tname: 'Parent',\r\n\t\t\talias: 'parent',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Child',\r\n\t\t\talias: 'child',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Created',\r\n\t\t\talias: 'created',\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'Comment',\r\n\t\t\talias: 'comment',\r\n\t\t},\r\n\t];\r\n\r\n\tprivate get _tableItems(): UmbTableItem[] {\r\n\t\tif (this._relations.length === 0) {\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tid: 'no-relations',\r\n\t\t\t\t\tdata: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcolumnAlias: 'parent',\r\n\t\t\t\t\t\t\tvalue: 'No relations found',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t],\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\treturn this._relations.map((relation) => {\r\n\t\t\treturn {\r\n\t\t\t\tid: relation.unique,\r\n\t\t\t\tdata: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'parent',\r\n\t\t\t\t\t\tvalue: relation.parent.name,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'child',\r\n\t\t\t\t\t\tvalue: relation.child.name,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'created',\r\n\t\t\t\t\t\tvalue: this.localize.date(relation.createDate, { dateStyle: 'long', timeStyle: 'medium' }),\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcolumnAlias: 'comment',\r\n\t\t\t\t\t\tvalue: relation.comment,\r\n\t\t\t\t\t},\r\n\t\t\t\t],\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t#onPageChange(event: UUIPaginationEvent) {\r\n\t\tthis.#paginationManager.setCurrentPageNumber(event.target?.current);\r\n\t\tthis.#requestRelations();\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`${this.#renderRelations()}${this.#renderDetails()}`;\r\n\t}\r\n\r\n\t#renderRelations() {\r\n\t\tif (this._loading) return html`<uui-loader></uui-loader>`;\r\n\t\treturn html`\r\n\t\t\t<div>\r\n\t\t\t\t<umb-table .config=${this._tableConfig} .columns=${this._tableColumns} .items=${this._tableItems}></umb-table>\r\n\r\n\t\t\t\t${this._totalPages > 1\r\n\t\t\t\t\t? html`\r\n\t\t\t\t\t\t\t<uui-pagination\r\n\t\t\t\t\t\t\t\t.current=${this._currentPageNumber}\r\n\t\t\t\t\t\t\t\t.total=${this._totalPages}\r\n\t\t\t\t\t\t\t\tfirstlabel=${this.localize.term('general_first')}\r\n\t\t\t\t\t\t\t\tpreviouslabel=${this.localize.term('general_previous')}\r\n\t\t\t\t\t\t\t\tnextlabel=${this.localize.term('general_next')}\r\n\t\t\t\t\t\t\t\tlastlabel=${this.localize.term('general_last')}\r\n\t\t\t\t\t\t\t\t@change=${this.#onPageChange}></uui-pagination>\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderDetails() {\r\n\t\treturn html`<uui-box>\r\n\t\t\t<umb-property-layout label=\"Parent Type\" orientation=\"vertical\"\r\n\t\t\t\t><div slot=\"editor\">${this._parent?.objectType.name}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t\t<umb-property-layout label=\"Child Type\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">${this._child?.objectType.name}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t\t<umb-property-layout label=\"Bidirectional\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">${this._isBidirectional}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t\t<umb-property-layout label=\"Dependency\" orientation=\"vertical\">\r\n\t\t\t\t<div slot=\"editor\">${this._isDependency}</div>\r\n\t\t\t</umb-property-layout>\r\n\t\t</uui-box>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: var(--uui-size-layout-1);\r\n\t\t\t\tpadding: var(--uui-size-layout-1);\r\n\t\t\t\tgrid-template-columns: 1fr 350px;\r\n\t\t\t}\r\n\r\n\t\t\tuui-loader {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}\r\n\r\n\t\t\tuui-pagination {\r\n\t\t\t\tmargin-top: var(--uui-size-layout-1);\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbRelationTypeDetailWorkspaceViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-relation-type-detail-workspace-view': UmbRelationTypeDetailWorkspaceViewElement;\r\n\t}\r\n}\r\n"],"names":["_workspaceContext","_relationCollectionRepository","_paginationManager","_UmbRelationTypeDetailWorkspaceViewElement_instances","observeDetails_fn","requestRelations_fn","onPageChange_fn","renderRelations_fn","renderDetails_fn","UmbRelationTypeDetailWorkspaceViewElement","UmbLitElement","__privateAdd","UmbRelationCollectionRepository","UmbPaginationManager","__privateGet","number","UMB_RELATION_TYPE_WORKSPACE_CONTEXT","instance","__privateSet","__privateMethod","relation","html","observeMultiple","parent","child","isBidirectional","isDependency","relationTypeUnique","data","event","nothing","UmbTextStyles","css","__decorateClass","state","customElement","UmbRelationTypeDetailWorkspaceViewElement$1"],"mappings":"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"}