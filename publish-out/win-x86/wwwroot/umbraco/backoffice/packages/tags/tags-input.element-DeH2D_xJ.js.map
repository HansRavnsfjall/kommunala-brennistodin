{"version":3,"file":"tags-input.element-DeH2D_xJ.js","sources":["../../../src/packages/tags/components/tags-input/tags-input.element.ts"],"sourcesContent":["import { UmbTagRepository } from '../../repository/tag.repository.js';\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tnothing,\r\n\tproperty,\r\n\tquery,\r\n\tqueryAll,\r\n\trepeat,\r\n\tstate,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UUIFormControlMixin } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { TagResponseModel } from '@umbraco-cms/backoffice/external/backend-api';\r\nimport type { UUIInputElement, UUIInputEvent, UUITagElement } from '@umbraco-cms/backoffice/external/uui';\r\n\r\n@customElement('umb-tags-input')\r\nexport class UmbTagsInputElement extends UUIFormControlMixin(UmbLitElement, '') {\r\n\t@property({ type: String })\r\n\tgroup?: string;\r\n\r\n\t@property({ type: String })\r\n\tculture?: string | null;\r\n\r\n\t@property({ type: Array })\r\n\tpublic set items(newTags: string[]) {\r\n\t\tconst newItems = newTags.filter((x) => x !== '');\r\n\t\tthis.#items = newItems;\r\n\t\tsuper.value = this.#items.join(',');\r\n\t}\r\n\tpublic get items(): string[] {\r\n\t\treturn this.#items;\r\n\t}\r\n\t#items: string[] = [];\r\n\r\n\t/**\r\n\t * Sets the input to readonly mode, meaning value cannot be changed but still able to read and select its content.\r\n\t * @type {boolean}\r\n\t * @attr\r\n\t * @default false\r\n\t */\r\n\t@property({ type: Boolean, reflect: true })\r\n\treadonly = false;\r\n\r\n\t@state()\r\n\tprivate _matches: Array<TagResponseModel> = [];\r\n\r\n\t@state()\r\n\tprivate _currentInput = '';\r\n\r\n\t@query('#main-tag')\r\n\tprivate _mainTag!: UUITagElement;\r\n\r\n\t@query('#tag-input')\r\n\tprivate _tagInput!: UUIInputElement;\r\n\r\n\t@query('#input-width-tracker')\r\n\tprivate _widthTracker!: HTMLElement;\r\n\r\n\t@queryAll('.options')\r\n\tprivate _optionCollection?: HTMLCollectionOf<HTMLInputElement>;\r\n\r\n\t@queryAll('.tag')\r\n\tprivate _tagEls?: NodeListOf<HTMLElement>;\r\n\r\n\t#repository = new UmbTagRepository(this);\r\n\r\n\tpublic override focus() {\r\n\t\tthis._tagInput.focus();\r\n\t}\r\n\r\n\tprotected override getFormElement() {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tasync #getExistingTags(query: string) {\r\n\t\tif (!this.group || !query) return;\r\n\t\tconst { data } = await this.#repository.queryTags(this.group, this.culture ?? null, query);\r\n\t\tif (!data) return;\r\n\t\tthis._matches = data.items;\r\n\t}\r\n\r\n\t#onInputKeydown(e: KeyboardEvent) {\r\n\t\tconst inputLength = (this._tagInput.value as string).trim().length;\r\n\r\n\t\t//Prevent tab away if there is a text in the input.\r\n\t\tif (e.key === 'Tab' && inputLength && !this._matches.length) {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis.#createTag();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//If the input is empty we can navigate out of it using tab\r\n\t\tif (e.key === 'Tab' && !inputLength) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//Create a new tag when enter to the input\r\n\t\tif (e.key === 'Enter') {\r\n\t\t\tthis.#createTag();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//This one to show option collection if there is any\r\n\t\tif (e.key === 'ArrowDown') {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis._currentInput = this._optionCollection?.item(0)?.value ?? this._currentInput;\r\n\t\t\tthis._optionCollection?.item(0)?.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.#inputError(false);\r\n\t}\r\n\r\n\t#focusTag(index: number) {\r\n\t\tconst tag = this._tagEls?.[index];\r\n\t\tif (!tag) return;\r\n\r\n\t\t// Find the current element with the class .tab and tabindex=0 (will be the previous tag)\r\n\t\tconst active = this.renderRoot.querySelector<HTMLElement>('.tag[tabindex=\"0\"]');\r\n\r\n\t\t// Return it is tabindex to -1\r\n\t\tactive?.setAttribute('tabindex', '-1');\r\n\r\n\t\t// Set the tabindex to 0 in the current target\r\n\t\ttag.setAttribute('tabindex', '0');\r\n\r\n\t\ttag.focus();\r\n\t}\r\n\r\n\t#onTagsWrapperKeydown(e: KeyboardEvent) {\r\n\t\tif ((e.key === 'Enter' || e.key === 'ArrowDown') && this.items.length) {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis.#focusTag(0);\r\n\t\t}\r\n\t}\r\n\r\n\t#onTagKeydown(e: KeyboardEvent, idx: number) {\r\n\t\tif (e.key === 'ArrowRight') {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (idx < this.items.length - 1) {\r\n\t\t\t\tthis.#focusTag(idx + 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (e.key === 'ArrowLeft') {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (idx > 0) {\r\n\t\t\t\tthis.#focusTag(idx - 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (e.key === 'Backspace' || e.key === 'Delete') {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (this.#items.length - 1 === idx) {\r\n\t\t\t\tthis.#focusTag(idx - 1);\r\n\t\t\t}\r\n\t\t\tthis.#delete(this.#items[idx]);\r\n\t\t\tthis.#focusTag(idx + 1);\r\n\t\t}\r\n\t}\r\n\r\n\t#onInput(e: UUIInputEvent) {\r\n\t\tthis._currentInput = e.target.value as string;\r\n\t\tif (!this._currentInput || !this._currentInput.length) {\r\n\t\t\tthis._matches = [];\r\n\t\t} else {\r\n\t\t\tthis.#getExistingTags(this._currentInput);\r\n\t\t}\r\n\t}\r\n\r\n\tprotected override updated(): void {\r\n\t\tthis._mainTag.style.width = `${this._widthTracker.offsetWidth - 4}px`;\r\n\t}\r\n\r\n\t#onBlur() {\r\n\t\tif (this._matches.length) return;\r\n\t\telse this.#createTag();\r\n\t}\r\n\r\n\t#createTag() {\r\n\t\tthis.#inputError(false);\r\n\t\tconst newTag = (this._tagInput.value as string).trim();\r\n\t\tif (!newTag) return;\r\n\r\n\t\tconst tagExists = this.items.find((tag) => tag === newTag);\r\n\t\tif (tagExists) return this.#inputError(true);\r\n\r\n\t\tthis.#inputError(false);\r\n\t\tthis.items = [...this.items, newTag];\r\n\t\tthis._tagInput.value = '';\r\n\t\tthis._currentInput = '';\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\t#inputError(error: boolean) {\r\n\t\tif (error) {\r\n\t\t\tthis._mainTag.style.border = '1px solid var(--uui-color-danger)';\r\n\t\t\tthis._tagInput.style.color = 'var(--uui-color-danger)';\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._mainTag.style.border = '';\r\n\t\tthis._tagInput.style.color = '';\r\n\t}\r\n\r\n\t#delete(tag: string) {\r\n\t\tconst currentItems = [...this.items];\r\n\t\tconst index = currentItems.findIndex((x) => x === tag);\r\n\t\tcurrentItems.splice(index, 1);\r\n\t\tif (currentItems.length) {\r\n\t\t\tthis.items = currentItems;\r\n\t\t} else {\r\n\t\t\tthis.items = [];\r\n\t\t}\r\n\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t}\r\n\r\n\t/** Dropdown */\r\n\r\n\t#optionClick(index: number) {\r\n\t\tthis._tagInput.value = this._optionCollection?.item(index)?.value ?? '';\r\n\t\tthis.#createTag();\r\n\t\tthis.focus();\r\n\t\treturn;\r\n\t}\r\n\r\n\t#optionKeydown(e: KeyboardEvent, index: number) {\r\n\t\tif (e.key === 'Enter' || e.key === 'Tab') {\r\n\t\t\te.preventDefault();\r\n\t\t\tthis._currentInput = this._optionCollection?.item(index)?.value ?? '';\r\n\t\t\tthis.#createTag();\r\n\t\t\tthis.focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (e.key === 'ArrowDown') {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (!this._optionCollection?.item(index + 1)) return;\r\n\t\t\tthis._optionCollection?.item(index + 1)?.focus();\r\n\t\t\tthis._currentInput = this._optionCollection?.item(index + 1)?.value ?? '';\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (e.key === 'ArrowUp') {\r\n\t\t\te.preventDefault();\r\n\t\t\tif (!this._optionCollection?.item(index - 1)) return;\r\n\t\t\tthis._optionCollection?.item(index - 1)?.focus();\r\n\t\t\tthis._currentInput = this._optionCollection?.item(index - 1)?.value ?? '';\r\n\t\t}\r\n\r\n\t\tif (e.key === 'Backspace') {\r\n\t\t\tthis.focus();\r\n\t\t}\r\n\t}\r\n\r\n\t/** Render */\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"wrapper\">\r\n\t\t\t\t${this.#renderTags()}\r\n\t\t\t\t<span id=\"main-tag-wrapper\">\r\n\t\t\t\t\t<uui-tag id=\"input-width-tracker\" aria-hidden=\"true\" style=\"visibility:hidden;opacity:0;position:absolute;\">\r\n\t\t\t\t\t\t${this._currentInput}\r\n\t\t\t\t\t</uui-tag>\r\n\t\t\t\t\t${this.#renderAddButton()}\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderTags() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"tags\" tabindex=\"0\" @keydown=${this.#onTagsWrapperKeydown}>\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis.items,\r\n\t\t\t\t\t(tag) => tag,\r\n\t\t\t\t\t(tag, index) => html`\r\n\t\t\t\t\t\t<uui-tag class=\"tag\" @keydown=${(e: KeyboardEvent) => this.#onTagKeydown(e, index)}>\r\n\t\t\t\t\t\t\t<span>${tag}</span>\r\n\t\t\t\t\t\t\t${this.#renderRemoveButton(tag)}\r\n\t\t\t\t\t\t</uui-tag>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderTagOptions() {\r\n\t\tif (!this._matches.length) return nothing;\r\n\t\tconst matchfilter = this._matches.filter((tag) => tag.text !== this.#items.find((x) => x === tag.text));\r\n\t\tif (!matchfilter.length) return;\r\n\t\treturn html`\r\n\t\t\t<div id=\"matchlist\">\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tmatchfilter.slice(0, 5),\r\n\t\t\t\t\t(tag: TagResponseModel) => tag.id,\r\n\t\t\t\t\t(tag: TagResponseModel, index: number) => {\r\n\t\t\t\t\t\treturn html`<input\r\n\t\t\t\t\t\t\t\tclass=\"options\"\r\n\t\t\t\t\t\t\t\tid=\"tag-${tag.id}\"\r\n\t\t\t\t\t\t\t\ttype=\"radio\"\r\n\t\t\t\t\t\t\t\tname=\"${tag.group ?? ''}\"\r\n\t\t\t\t\t\t\t\t@click=\"${() => this.#optionClick(index)}\"\r\n\t\t\t\t\t\t\t\t@keydown=\"${(e: KeyboardEvent) => this.#optionKeydown(e, index)}\"\r\n\t\t\t\t\t\t\t\tvalue=\"${tag.text ?? ''}\"\r\n\t\t\t\t\t\t\t\t?readonly=${this.readonly} />\r\n\t\t\t\t\t\t\t<label for=\"tag-${tag.id}\"> ${tag.text} </label>`;\r\n\t\t\t\t\t},\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderAddButton() {\r\n\t\tif (this.readonly) return nothing;\r\n\t\treturn html`\r\n\t\t\t<uui-tag look=\"outline\" id=\"main-tag\" @click=\"${this.focus}\" slot=\"trigger\">\r\n\t\t\t\t<input\r\n\t\t\t\t\tid=\"tag-input\"\r\n\t\t\t\t\taria-label=\"tag input\"\r\n\t\t\t\t\tautocomplete=\"off\"\r\n\t\t\t\t\tplaceholder=\"Enter tag\"\r\n\t\t\t\t\t.value=\"${this._currentInput ?? undefined}\"\r\n\t\t\t\t\t@keydown=\"${this.#onInputKeydown}\"\r\n\t\t\t\t\t@input=\"${this.#onInput}\"\r\n\t\t\t\t\t@blur=\"${this.#onBlur}\" />\r\n\t\t\t\t<uui-icon id=\"icon-add\" name=\"icon-add\"></uui-icon>\r\n\t\t\t\t${this.#renderTagOptions()}\r\n\t\t\t</uui-tag>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderRemoveButton(tag: string) {\r\n\t\tif (this.readonly) return nothing;\r\n\t\treturn html`<uui-icon name=\"icon-wrong\" @click=\"${() => this.#delete(tag)}\"></uui-icon>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t#wrapper {\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tpadding: var(--uui-size-space-2);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tbackground-color: var(--uui-input-background-color, var(--uui-color-surface));\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tmin-height: 40px;\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag-wrapper {\r\n\t\t\t\tposition: relative;\r\n\t\t\t}\r\n\r\n\t\t\t/** Tags */\r\n\t\t\t#tags {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\tborder-radius: var(--uui-size-1);\r\n\r\n\t\t\t\t&:focus {\r\n\t\t\t\t\toutline: var(--uui-size-1) solid var(--uui-color-focus);\r\n\t\t\t\t\toutline-offset: var(--uui-size-1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tuui-tag {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tmax-width: 200px;\r\n\t\t\t}\r\n\r\n\t\t\tuui-tag uui-icon {\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tmin-width: 12.8px !important;\r\n\t\t\t}\r\n\r\n\t\t\tuui-tag span {\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\r\n\t\t\t/** Existing tags */\r\n\t\t\t.tag {\r\n\t\t\t\t&:focus {\r\n\t\t\t\t\toutline: var(--uui-size-1) solid var(--uui-color-focus);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tuui-icon {\r\n\t\t\t\t\tmargin-left: var(--uui-size-space-2);\r\n\r\n\t\t\t\t\t&:hover,\r\n\t\t\t\t\t&:active {\r\n\t\t\t\t\t\tcolor: var(--uui-color-selected-contrast);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t/** Main tag */\r\n\r\n\t\t\t#main-tag {\r\n\t\t\t\tpadding: 3px;\r\n\t\t\t\tbackground-color: var(--uui-color-selected-contrast);\r\n\t\t\t\tmin-width: 20px;\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tborder-radius: var(--uui-size-5, 12px);\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag uui-icon {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\ttop: 50%;\r\n\t\t\t\tleft: 50%;\r\n\t\t\t\ttransform: translate(-50%, -50%);\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag:hover uui-icon,\r\n\t\t\t#main-tag:active uui-icon {\r\n\t\t\t\tcolor: var(--uui-color-selected);\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag #tag-input:focus ~ uui-icon,\r\n\t\t\t#main-tag #tag-input:not(:placeholder-shown) ~ uui-icon {\r\n\t\t\t\tdisplay: none;\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag:has(*:hover),\r\n\t\t\t#main-tag:has(*:active),\r\n\t\t\t#main-tag:has(*:focus) {\r\n\t\t\t\tborder: 1px solid var(--uui-color-selected-emphasis);\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag:has(#tag-input:not(:focus)):hover {\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tborder: 1px solid var(--uui-color-selected-emphasis);\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag:not(:focus-within) #tag-input:placeholder-shown {\r\n\t\t\t\topacity: 0;\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag:has(#tag-input:focus),\r\n\t\t\t#main-tag:has(#tag-input:not(:placeholder-shown)) {\r\n\t\t\t\tmin-width: 65px;\r\n\t\t\t}\r\n\r\n\t\t\t#main-tag #tag-input {\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tmax-height: 25.8px;\r\n\t\t\t\tbackground: none;\r\n\t\t\t\tfont: inherit;\r\n\t\t\t\tcolor: var(--uui-color-selected);\r\n\t\t\t\tline-height: reset;\r\n\t\t\t\tpadding: 0 var(--uui-size-space-2);\r\n\t\t\t\tmargin: 0.5px 0 -0.5px;\r\n\t\t\t\tborder: none;\r\n\t\t\t\toutline: none;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t/** Dropdown matchlist */\r\n\r\n\t\t\t#matchlist input[type='radio'] {\r\n\t\t\t\t-webkit-appearance: none;\r\n\t\t\t\tappearance: none;\r\n\t\t\t\t/* For iOS < 15 to remove gradient background */\r\n\t\t\t\tbackground-color: transparent;\r\n\t\t\t\t/* Not removed via appearance */\r\n\t\t\t\tmargin: 0;\r\n\t\t\t}\r\n\r\n\t\t\tuui-tag:focus-within #matchlist {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t}\r\n\r\n\t\t\t#matchlist {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tbackground-color: var(--uui-color-surface);\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\twidth: 150px;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\ttop: var(--uui-size-space-6);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\t\tz-index: 10;\r\n\t\t\t}\r\n\r\n\t\t\t#matchlist label {\r\n\t\t\t\tdisplay: none;\r\n\t\t\t\tcursor: pointer;\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tbackground: none;\r\n\t\t\t\tborder: none;\r\n\t\t\t\ttext-align: left;\r\n\t\t\t\tpadding: 10px 12px;\r\n\r\n\t\t\t\t/** Overflow */\r\n\t\t\t\toverflow: hidden;\r\n\t\t\t\ttext-overflow: ellipsis;\r\n\t\t\t\twhite-space: nowrap;\r\n\t\t\t}\r\n\r\n\t\t\t#matchlist label:hover,\r\n\t\t\t#matchlist label:focus,\r\n\t\t\t#matchlist label:focus-within,\r\n\t\t\t#matchlist input[type='radio']:focus + label {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tbackground-color: var(--uui-color-focus);\r\n\t\t\t\tcolor: var(--uui-color-selected-contrast);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbTagsInputElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-tags-input': UmbTagsInputElement;\r\n\t}\r\n}\r\n"],"names":["_items","_repository","_UmbTagsInputElement_instances","getExistingTags_fn","onInputKeydown_fn","focusTag_fn","onTagsWrapperKeydown_fn","onTagKeydown_fn","onInput_fn","onBlur_fn","createTag_fn","inputError_fn","delete_fn","optionClick_fn","optionKeydown_fn","renderTags_fn","renderTagOptions_fn","renderAddButton_fn","renderRemoveButton_fn","UmbTagsInputElement","UUIFormControlMixin","UmbLitElement","__privateAdd","UmbTagRepository","newTags","newItems","x","__privateSet","__privateGet","html","__privateMethod","query","data","e","inputLength","index","tag","idx","newTag","UmbChangeEvent","error","currentItems","repeat","nothing","matchfilter","css","__decorateClass","property","state","queryAll","customElement"],"mappings":"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"}