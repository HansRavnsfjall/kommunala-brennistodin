{"version":3,"file":"cascading-menu-popover.element-Ce2vE90e.js","sources":["../../../src/packages/tiptap/components/cascading-menu-popover/cascading-menu-popover.element.ts"],"sourcesContent":["import { css, customElement, html, ifDefined, property, repeat, when } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbElementMixin } from '@umbraco-cms/backoffice/element-api';\r\nimport { UUIPopoverContainerElement } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { ManifestMenu } from '@umbraco-cms/backoffice/menu';\r\n\r\nexport type UmbCascadingMenuItem = {\r\n\tlabel: string;\r\n\ticon?: string;\r\n\titems?: Array<UmbCascadingMenuItem>;\r\n\telement?: HTMLElement;\r\n\tmenu?: string;\r\n\tseparatorAfter?: boolean;\r\n\tstyle?: string;\r\n\tisActive?: () => boolean | undefined;\r\n\texecute?: () => void;\r\n};\r\n\r\n@customElement('umb-cascading-menu-popover')\r\nexport class UmbCascadingMenuPopoverElement extends UmbElementMixin(UUIPopoverContainerElement) {\r\n\t@property({ type: Array })\r\n\titems?: Array<UmbCascadingMenuItem>;\r\n\r\n\t#getPopoverById(popoverId: string): UUIPopoverContainerElement | null | undefined {\r\n\t\treturn this.shadowRoot?.querySelector(`#${popoverId}`) as UUIPopoverContainerElement;\r\n\t}\r\n\r\n\t#isMenuActive(items?: UmbCascadingMenuItem[]): boolean {\r\n\t\treturn !!items?.some((item) => item.isActive?.() || this.#isMenuActive(item.items));\r\n\t}\r\n\r\n\t#onMouseEnter(item: UmbCascadingMenuItem, popoverId?: string) {\r\n\t\tif (!(item.items?.length || item.menu) || !popoverId) return;\r\n\r\n\t\tconst popover = this.#getPopoverById(popoverId);\r\n\t\tif (!popover) return;\r\n\r\n\t\t// TODO: This ignorer is just neede for JSON SCHEMA TO WORK, As its not updated with latest TS jet.\r\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n\t\t// @ts-ignore\r\n\t\tpopover.showPopover();\r\n\t}\r\n\r\n\t#onMouseLeave(item: UmbCascadingMenuItem, popoverId?: string) {\r\n\t\tif (!popoverId) return;\r\n\r\n\t\tconst popover = this.#getPopoverById(popoverId);\r\n\t\tif (!popover) return;\r\n\r\n\t\t// TODO: This ignorer is just neede for JSON SCHEMA TO WORK, As its not updated with latest TS jet.\r\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n\t\t// @ts-ignore\r\n\t\tpopover.hidePopover();\r\n\t}\r\n\r\n\t#onClick(item: UmbCascadingMenuItem, popoverId?: string) {\r\n\t\titem.execute?.();\r\n\r\n\t\tif (!popoverId) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\tthis.hidePopover();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<uui-scroll-container>\r\n\t\t\t\t${when(this.items?.length, () => repeat(this.items!, (item, index) => this.#renderItem(item, index)))}\r\n\t\t\t\t${super.render()}\r\n\t\t\t</uui-scroll-container>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderItem(item: UmbCascadingMenuItem, index: number) {\r\n\t\tconst hasChildMenu = item.items?.length || !!item.menu;\r\n\r\n\t\tconst popoverId = hasChildMenu ? `menu-${index}` : undefined;\r\n\r\n\t\tconst element = item.element;\r\n\t\tif (element && popoverId) {\r\n\t\t\telement.setAttribute('popovertarget', popoverId);\r\n\t\t}\r\n\r\n\t\tconst label = this.localize.string(item.label);\r\n\t\tconst isActive = item.isActive?.() || this.#isMenuActive(item.items) || false;\r\n\r\n\t\treturn html`\r\n\t\t\t<div\r\n\t\t\t\t@mouseenter=${() => this.#onMouseEnter(item, popoverId)}\r\n\t\t\t\t@mouseleave=${() => this.#onMouseLeave(item, popoverId)}>\r\n\t\t\t\t${when(\r\n\t\t\t\t\telement,\r\n\t\t\t\t\t() => element,\r\n\t\t\t\t\t() => html`\r\n\t\t\t\t\t\t<uui-menu-item\r\n\t\t\t\t\t\t\tclass=${item.separatorAfter ? 'separator' : ''}\r\n\t\t\t\t\t\t\tlabel=${label}\r\n\t\t\t\t\t\t\tpopovertarget=${ifDefined(popoverId)}\r\n\t\t\t\t\t\t\tselect-mode=\"highlight\"\r\n\t\t\t\t\t\t\t?selected=${isActive}\r\n\t\t\t\t\t\t\t@click-label=${() => this.#onClick(item, popoverId)}>\r\n\t\t\t\t\t\t\t${when(item.icon, (icon) => html`<uui-icon slot=\"icon\" name=${icon}></uui-icon>`)}\r\n\t\t\t\t\t\t\t<div slot=\"label\" class=\"menu-item\">\r\n\t\t\t\t\t\t\t\t<span style=${ifDefined(item.style)}>${label}</span>\r\n\t\t\t\t\t\t\t\t${when(hasChildMenu, () => html`<uui-symbol-expand></uui-symbol-expand>`)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</uui-menu-item>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t\t${when(\r\n\t\t\t\t\tpopoverId,\r\n\t\t\t\t\t(popoverId) => html`\r\n\t\t\t\t\t\t<umb-cascading-menu-popover id=${popoverId} placement=\"right-start\" .items=${item.items}>\r\n\t\t\t\t\t\t\t${when(\r\n\t\t\t\t\t\t\t\titem.menu,\r\n\t\t\t\t\t\t\t\t(menuAlias) => html`\r\n\t\t\t\t\t\t\t\t\t<umb-extension-slot\r\n\t\t\t\t\t\t\t\t\t\ttype=\"menu\"\r\n\t\t\t\t\t\t\t\t\t\tdefault-element=\"umb-tiptap-menu\"\r\n\t\t\t\t\t\t\t\t\t\tsingle\r\n\t\t\t\t\t\t\t\t\t\t.filter=${(menu: ManifestMenu) => menu.alias === menuAlias}></umb-extension-slot>\r\n\t\t\t\t\t\t\t\t`,\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</umb-cascading-menu-popover>\r\n\t\t\t\t\t`,\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override readonly styles = [\r\n\t\t...UUIPopoverContainerElement.styles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\t--uui-menu-item-flat-structure: 1;\r\n\r\n\t\t\t\tbackground-color: var(--uui-color-surface);\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tbox-shadow: var(--uui-shadow-depth-3);\r\n\t\t\t\tpadding: var(--uui-size-space-1);\r\n\t\t\t}\r\n\r\n\t\t\t.menu-item {\r\n\t\t\t\tflex: 1;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t}\r\n\r\n\t\t\t.separator::after {\r\n\t\t\t\tcontent: '';\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-border);\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\tuui-scroll-container {\r\n\t\t\t\tmax-height: 500px;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbCascadingMenuPopoverElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-cascading-menu-popover': UmbCascadingMenuPopoverElement;\r\n\t}\r\n}\r\n"],"names":["_UmbCascadingMenuPopoverElement_instances","getPopoverById_fn","isMenuActive_fn","onMouseEnter_fn","onMouseLeave_fn","onClick_fn","renderItem_fn","UmbCascadingMenuPopoverElement","UmbElementMixin","UUIPopoverContainerElement","__privateAdd","html","when","repeat","item","index","__privateMethod","popoverId","items","popover","hasChildMenu","element","label","isActive","ifDefined","icon","menuAlias","menu","css","__decorateClass","property","customElement"],"mappings":"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"}