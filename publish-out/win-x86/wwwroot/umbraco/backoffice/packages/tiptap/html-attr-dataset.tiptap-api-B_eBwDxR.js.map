{"version":3,"file":"html-attr-dataset.tiptap-api-B_eBwDxR.js","sources":["../../../src/packages/tiptap/extensions/html-attr-dataset/html-attr-dataset.tiptap-api.ts"],"sourcesContent":["import { UmbTiptapExtensionApiBase } from '../tiptap-extension-api-base.js';\r\nimport { Extension } from '@umbraco-cms/backoffice/external/tiptap';\r\nimport type { Attributes } from '@umbraco-cms/backoffice/external/tiptap';\r\n\r\ndeclare module '@tiptap/core' {\r\n\tinterface Commands<ReturnType> {\r\n\t\thtmlDatasetAttributes: {\r\n\t\t\tsetId: (id?: string, type?: string) => ReturnType;\r\n\t\t\ttoggleId: (id?: string, type?: string) => ReturnType;\r\n\t\t\tunsetId: (type?: string) => ReturnType;\r\n\t\t};\r\n\t}\r\n}\r\n\r\n/**\r\n * Converts camelCase to kebab-case.\r\n * @param {string} str - The string to convert.\r\n * @returns {string} The converted string.\r\n */\r\nfunction camelCaseToKebabCase(str: string): string {\r\n\treturn str.replace(/[A-Z]+(?![a-z])|[A-Z]/g, ($, ofs) => (ofs ? '-' : '') + $.toLowerCase());\r\n}\r\n\r\ninterface HtmlDatasetAttributesOptions {\r\n\ttypes: Array<string>;\r\n}\r\n\r\nconst HtmlDatasetAttributes = Extension.create<HtmlDatasetAttributesOptions>({\r\n\tname: 'htmlDatasetAttributes',\r\n\r\n\taddOptions() {\r\n\t\treturn { types: [] };\r\n\t},\r\n\r\n\taddGlobalAttributes() {\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\ttypes: this.options.types,\r\n\t\t\t\tattributes: {\r\n\t\t\t\t\tdataset: {\r\n\t\t\t\t\t\tparseHTML: (element) => element.dataset,\r\n\t\t\t\t\t\trenderHTML: (attributes) => {\r\n\t\t\t\t\t\t\tconst keys = attributes.dataset ? Object.keys(attributes.dataset) : [];\r\n\t\t\t\t\t\t\tif (!keys.length) return {};\r\n\t\t\t\t\t\t\tconst dataAtrrs: Record<string, string> = {};\r\n\t\t\t\t\t\t\tkeys.forEach((key) => {\r\n\t\t\t\t\t\t\t\tdataAtrrs['data-' + camelCaseToKebabCase(key)] = attributes.dataset[key];\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn dataAtrrs;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t} as Attributes,\r\n\t\t\t},\r\n\t\t];\r\n\t},\r\n\r\n\taddCommands() {\r\n\t\treturn {\r\n\t\t\tsetId:\r\n\t\t\t\t(id, type) =>\r\n\t\t\t\t({ commands }) => {\r\n\t\t\t\t\tif (!id) return false;\r\n\t\t\t\t\tconst types = type ? [type] : this.options.types;\r\n\t\t\t\t\treturn types.map((type) => commands.updateAttributes(type, { id })).every((response) => response);\r\n\t\t\t\t},\r\n\t\t\ttoggleId:\r\n\t\t\t\t(id, type) =>\r\n\t\t\t\t({ commands, editor }) => {\r\n\t\t\t\t\tif (!id) return false;\r\n\t\t\t\t\tconst types = type ? [type] : this.options.types;\r\n\t\t\t\t\tconst existing = types.map((type) => editor.getAttributes(type)?.id as string).filter((x) => x);\r\n\t\t\t\t\treturn existing.length ? commands.unsetId(type) : commands.setId(id, type);\r\n\t\t\t\t},\r\n\t\t\tunsetId:\r\n\t\t\t\t(type) =>\r\n\t\t\t\t({ commands }) => {\r\n\t\t\t\t\tconst types = type ? [type] : this.options.types;\r\n\t\t\t\t\treturn types.map((type) => commands.resetAttributes(type, 'id')).every((response) => response);\r\n\t\t\t\t},\r\n\t\t};\r\n\t},\r\n});\r\n\r\nexport default class UmbTiptapHtmlAttributeDatasetExtensionApi extends UmbTiptapExtensionApiBase {\r\n\tgetTiptapExtensions = () => [\r\n\t\tHtmlDatasetAttributes.configure({\r\n\t\t\ttypes: [\r\n\t\t\t\t'bold',\r\n\t\t\t\t'blockquote',\r\n\t\t\t\t'bulletList',\r\n\t\t\t\t'codeBlock',\r\n\t\t\t\t'div',\r\n\t\t\t\t'figcaption',\r\n\t\t\t\t'figure',\r\n\t\t\t\t'heading',\r\n\t\t\t\t'horizontalRule',\r\n\t\t\t\t'italic',\r\n\t\t\t\t'image',\r\n\t\t\t\t'link',\r\n\t\t\t\t'orderedList',\r\n\t\t\t\t'paragraph',\r\n\t\t\t\t'span',\r\n\t\t\t\t'strike',\r\n\t\t\t\t'subscript',\r\n\t\t\t\t'superscript',\r\n\t\t\t\t'table',\r\n\t\t\t\t'tableHeader',\r\n\t\t\t\t'tableRow',\r\n\t\t\t\t'tableCell',\r\n\t\t\t\t'underline',\r\n\t\t\t\t'umbLink',\r\n\t\t\t],\r\n\t\t}),\r\n\t];\r\n}\r\n"],"names":["camelCaseToKebabCase","str","$","ofs","HtmlDatasetAttributes","Extension","element","attributes","keys","dataAtrrs","key","id","type","commands","response","editor","x","UmbTiptapHtmlAttributeDatasetExtensionApi","UmbTiptapExtensionApiBase"],"mappings":";;AAmBA,SAASA,EAAqBC,GAAqB;AAClD,SAAOA,EAAI,QAAQ,0BAA0B,CAACC,GAAGC,OAASA,IAAM,MAAM,MAAMD,EAAE,YAAA,CAAa;AAC5F;AAMA,MAAME,IAAwBC,EAAU,OAAqC;AAAA,EAC5E,MAAM;AAAA,EAEN,aAAa;AACZ,WAAO,EAAE,OAAO,GAAC;AAAA,EAClB;AAAA,EAEA,sBAAsB;AACrB,WAAO;AAAA,MACN;AAAA,QACC,OAAO,KAAK,QAAQ;AAAA,QACpB,YAAY;AAAA,UACX,SAAS;AAAA,YACR,WAAW,CAACC,MAAYA,EAAQ;AAAA,YAChC,YAAY,CAACC,MAAe;AAC3B,oBAAMC,IAAOD,EAAW,UAAU,OAAO,KAAKA,EAAW,OAAO,IAAI,CAAA;AACpE,kBAAI,CAACC,EAAK,OAAQ,QAAO,CAAA;AACzB,oBAAMC,IAAoC,CAAA;AAC1C,qBAAAD,EAAK,QAAQ,CAACE,MAAQ;AACrB,gBAAAD,EAAU,UAAUT,EAAqBU,CAAG,CAAC,IAAIH,EAAW,QAAQG,CAAG;AAAA,cACxE,CAAC,GACMD;AAAA,YACR;AAAA,UAAA;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA,EAEF;AAAA,EAEA,cAAc;AACb,WAAO;AAAA,MACN,OACC,CAACE,GAAIC,MACL,CAAC,EAAE,UAAAC,QACGF,KACSC,IAAO,CAACA,CAAI,IAAI,KAAK,QAAQ,OAC9B,IAAI,CAACA,MAASC,EAAS,iBAAiBD,GAAM,EAAE,IAAAD,EAAA,CAAI,CAAC,EAAE,MAAM,CAACG,MAAaA,CAAQ,IAFhF;AAAA,MAIlB,UACC,CAACH,GAAIC,MACL,CAAC,EAAE,UAAAC,GAAU,QAAAE,QACPJ,KACSC,IAAO,CAACA,CAAI,IAAI,KAAK,QAAQ,OACpB,IAAI,CAACA,MAASG,EAAO,cAAcH,CAAI,GAAG,EAAY,EAAE,OAAO,CAACI,MAAMA,CAAC,EAC9E,SAASH,EAAS,QAAQD,CAAI,IAAIC,EAAS,MAAMF,GAAIC,CAAI,IAHzD;AAAA,MAKlB,SACC,CAACA,MACD,CAAC,EAAE,UAAAC,SACYD,IAAO,CAACA,CAAI,IAAI,KAAK,QAAQ,OAC9B,IAAI,CAACA,MAASC,EAAS,gBAAgBD,GAAM,IAAI,CAAC,EAAE,MAAM,CAACE,MAAaA,CAAQ;AAAA,IAC9F;AAAA,EAEH;AACD,CAAC;AAED,MAAqBG,UAAkDC,EAA0B;AAAA,EAAjG,cAAA;AAAA,UAAA,GAAA,SAAA,GACC,KAAA,sBAAsB,MAAM;AAAA,MAC3Bd,EAAsB,UAAU;AAAA,QAC/B,OAAO;AAAA,UACN;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,QAAA;AAAA,MACD,CACA;AAAA,IAAA;AAAA,EACF;AACD;"}