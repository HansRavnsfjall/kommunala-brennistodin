{"version":3,"file":"input-tiptap.element-BYRfK4rc.js","sources":["../../../src/packages/tiptap/contexts/tiptap-rte.context.ts","../../../src/packages/tiptap/components/toolbar/tiptap-toolbar.element.ts","../../../src/packages/tiptap/components/statusbar/tiptap-statusbar.element.ts","../../../src/packages/tiptap/components/input-tiptap/input-tiptap.element.ts"],"sourcesContent":["import { UMB_TIPTAP_RTE_CONTEXT } from './tiptap-rte.context-token.js';\r\nimport { UmbContextBase } from '@umbraco-cms/backoffice/class-api';\r\nimport type { Editor } from '@umbraco-cms/backoffice/external/tiptap';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\n\r\nexport class UmbTiptapRteContext extends UmbContextBase {\r\n\t#editor?: Editor;\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, UMB_TIPTAP_RTE_CONTEXT);\r\n\t}\r\n\r\n\tpublic getEditor(): Editor | undefined {\r\n\t\treturn this.#editor;\r\n\t}\r\n\r\n\tpublic setEditor(editor?: Editor) {\r\n\t\tthis.#editor = editor;\r\n\t}\r\n}\r\n","import type { UmbTiptapToolbarValue } from '../types.js';\r\nimport { css, customElement, html, nothing, property, repeat } from '@umbraco-cms/backoffice/external/lit';\r\nimport { debounce } from '@umbraco-cms/backoffice/utils';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UmbExtensionsElementAndApiInitializer } from '@umbraco-cms/backoffice/extension-api';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { Editor } from '@umbraco-cms/backoffice/external/tiptap';\r\nimport type { UmbPropertyEditorConfigCollection } from '@umbraco-cms/backoffice/property-editor';\r\n\r\nimport '../cascading-menu-popover/cascading-menu-popover.element.js';\r\n\r\n/**\r\n * Provides a sticky toolbar for the {@link UmbInputTiptapElement}\r\n * @element umb-tiptap-toolbar\r\n * @cssprop --umb-tiptap-edge-border-color - Defines the edge border color\r\n * @cssprop --umb-tiptap-top - Defines the top value for the sticky toolbar\r\n */\r\n@customElement('umb-tiptap-toolbar')\r\nexport class UmbTiptapToolbarElement extends UmbLitElement {\r\n\t#attached = false;\r\n\r\n\t#debouncer = debounce(() => this.requestUpdate(), 100);\r\n\r\n\t#extensionsController?: UmbExtensionsElementAndApiInitializer;\r\n\r\n\t#lookup: Map<string, unknown> = new Map();\r\n\r\n\t@property({ type: Boolean, reflect: true })\r\n\treadonly = false;\r\n\r\n\t@property({ attribute: false })\r\n\teditor?: Editor;\r\n\r\n\t@property({ attribute: false })\r\n\tconfiguration?: UmbPropertyEditorConfigCollection;\r\n\r\n\t@property({ attribute: false })\r\n\ttoolbar: UmbTiptapToolbarValue = [[[]]];\r\n\r\n\toverride connectedCallback(): void {\r\n\t\tsuper.connectedCallback();\r\n\t\tthis.#attached = true;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\r\n\toverride disconnectedCallback(): void {\r\n\t\tthis.#attached = false;\r\n\t\tthis.#extensionsController?.destroy();\r\n\t\tthis.#extensionsController = undefined;\r\n\t\tsuper.disconnectedCallback();\r\n\t}\r\n\r\n\t#observeExtensions(): void {\r\n\t\tif (!this.#attached) return;\r\n\t\tthis.#extensionsController?.destroy();\r\n\r\n\t\tthis.#extensionsController = new UmbExtensionsElementAndApiInitializer(\r\n\t\t\tthis,\r\n\t\t\tumbExtensionsRegistry,\r\n\t\t\t'tiptapToolbarExtension',\r\n\t\t\t[],\r\n\t\t\t(manifest) => this.toolbar.flat(2).includes(manifest.alias),\r\n\t\t\t(extensionControllers) => {\r\n\t\t\t\textensionControllers.forEach((ext) => {\r\n\t\t\t\t\tif (!this.#lookup.has(ext.alias)) {\r\n\t\t\t\t\t\t(ext.component as HTMLElement)?.setAttribute('data-mark', `action:tiptap-toolbar:${ext.alias}`);\r\n\t\t\t\t\t\tthis.#lookup.set(ext.alias, ext.component);\r\n\t\t\t\t\t\tthis.#debouncer();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tundefined,\r\n\t\t\tundefined,\r\n\t\t\t() => import('../../extensions/default-tiptap-toolbar-api.js'),\r\n\t\t);\r\n\r\n\t\tthis.#extensionsController.apiProperties = { configuration: this.configuration };\r\n\t\tthis.#extensionsController.elementProperties = { editor: this.editor, configuration: this.configuration };\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this.toolbar.flat(2).length) return nothing;\r\n\t\treturn this.#renderRows(this.toolbar);\r\n\t}\r\n\r\n\t#renderRows(rows: UmbTiptapToolbarValue) {\r\n\t\treturn repeat(rows, (row) => html`<div class=\"row\">${this.#renderGroups(row)}</div>`);\r\n\t}\r\n\r\n\t#renderGroups(groups: Array<Array<string>>) {\r\n\t\treturn repeat(groups, (group) => html`<div class=\"group\">${this.#renderActions(group)}</div>`);\r\n\t}\r\n\r\n\t#renderActions(aliases: Array<string>) {\r\n\t\treturn repeat(aliases, (alias) => this.#lookup?.get(alias) ?? this.#renderActionPlaceholder(alias));\r\n\t}\r\n\r\n\t#renderActionPlaceholder(alias: string) {\r\n\t\treturn html`<span class=\"skeleton\" role=\"none\" title=\"Loading '${alias}'\"></span>`;\r\n\t}\r\n\r\n\tstatic override readonly styles = css`\r\n\t\t:host([readonly]) {\r\n\t\t\tpointer-events: none;\r\n\t\t\tbackground-color: var(--uui-color-surface-alt);\r\n\t\t}\r\n\r\n\t\t:host {\r\n\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\tborder: 1px solid var(--uui-color-border);\r\n\t\t\tborder-bottom-left-radius: 0;\r\n\t\t\tborder-bottom-right-radius: 0;\r\n\r\n\t\t\tborder-top-color: var(--umb-tiptap-edge-border-color, var(--uui-color-border));\r\n\t\t\tborder-left-color: var(--umb-tiptap-edge-border-color, var(--uui-color-border));\r\n\t\t\tborder-right-color: var(--umb-tiptap-edge-border-color, var(--uui-color-border));\r\n\t\t\tbox-sizing: border-box;\r\n\r\n\t\t\tbackground-color: var(--uui-color-surface);\r\n\t\t\tcolor: var(--color-text);\r\n\t\t\tfont-size: var(--uui-type-default-size);\r\n\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\r\n\t\t\tposition: sticky;\r\n\t\t\ttop: var(--umb-tiptap-top, -25px);\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t\tpadding: var(--uui-size-3);\r\n\t\t\tz-index: 9999999;\r\n\r\n\t\t\tbox-shadow:\r\n\t\t\t\t0 2px 2px -2px rgba(34, 47, 62, 0.1),\r\n\t\t\t\t0 8px 8px -4px rgba(34, 47, 62, 0.07);\r\n\t\t}\r\n\r\n\t\t.row {\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: row;\r\n\t\t\tflex-wrap: wrap;\r\n\r\n\t\t\tmin-height: var(--uui-size-12, 36px);\r\n\r\n\t\t\t.group {\r\n\t\t\t\tdisplay: inline-flex;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\talign-items: stretch;\r\n\r\n\t\t\t\tmin-height: var(--uui-size-12, 36px);\r\n\r\n\t\t\t\t&:not(:last-child)::after {\r\n\t\t\t\t\tcontent: '';\r\n\t\t\t\t\tbackground-color: var(--uui-color-border);\r\n\t\t\t\t\twidth: 1px;\r\n\t\t\t\t\tplace-self: center;\r\n\t\t\t\t\theight: var(--uui-size-7, 21px);\r\n\t\t\t\t\tmargin: 0 var(--uui-size-3);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.skeleton {\r\n\t\t\tbackground-color: var(--uui-color-background);\r\n\t\t\theight: var(--uui-size-12, 36px);\r\n\t\t\twidth: var(--uui-size-10, 30px);\r\n\t\t\tmargin-left: 1px;\r\n\t\t}\r\n\t`;\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-tiptap-toolbar': UmbTiptapToolbarElement;\r\n\t}\r\n}\r\n","import type { UmbTiptapStatusbarValue } from '../types.js';\r\nimport { css, customElement, html, nothing, property, repeat } from '@umbraco-cms/backoffice/external/lit';\r\nimport { debounce } from '@umbraco-cms/backoffice/utils';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbExtensionsElementInitializer } from '@umbraco-cms/backoffice/extension-api';\r\nimport type { Editor } from '@umbraco-cms/backoffice/external/tiptap';\r\nimport type { UmbPropertyEditorConfigCollection } from '@umbraco-cms/backoffice/property-editor';\r\n\r\n/**\r\n * Provides a status bar for the {@link UmbInputTiptapElement}\r\n * @element umb-tiptap-statusbar\r\n * @cssprop --umb-tiptap-edge-border-color - Defines the edge border color\r\n */\r\n@customElement('umb-tiptap-statusbar')\r\nexport class UmbTiptapStatusbarElement extends UmbLitElement {\r\n\t#attached = false;\r\n\r\n\t#debouncer = debounce(() => this.requestUpdate(), 100);\r\n\r\n\t#extensionsController?: UmbExtensionsElementInitializer;\r\n\r\n\t#lookup: Map<string, unknown> = new Map();\r\n\r\n\t@property({ type: Boolean, reflect: true })\r\n\treadonly = false;\r\n\r\n\t@property({ attribute: false })\r\n\teditor?: Editor;\r\n\r\n\t@property({ attribute: false })\r\n\tconfiguration?: UmbPropertyEditorConfigCollection;\r\n\r\n\t@property({ attribute: false })\r\n\tpublic set statusbar(value: UmbTiptapStatusbarValue) {\r\n\t\tif (typeof value === 'string') {\r\n\t\t\tvalue = [[], [value]];\r\n\t\t} else if (Array.isArray(value) && value.length === 1) {\r\n\t\t\tvalue = [[], value[0]];\r\n\t\t}\r\n\r\n\t\tthis.#statusbar = value;\r\n\t}\r\n\tpublic get statusbar(): UmbTiptapStatusbarValue {\r\n\t\treturn this.#statusbar;\r\n\t}\r\n\t#statusbar: UmbTiptapStatusbarValue = [[], []];\r\n\r\n\toverride connectedCallback() {\r\n\t\tsuper.connectedCallback();\r\n\t\tthis.#attached = true;\r\n\t\tthis.#observeExtensions();\r\n\t}\r\n\r\n\toverride disconnectedCallback() {\r\n\t\tthis.#attached = false;\r\n\t\tthis.#extensionsController?.destroy();\r\n\t\tthis.#extensionsController = undefined;\r\n\t\tsuper.disconnectedCallback();\r\n\t}\r\n\r\n\t#observeExtensions() {\r\n\t\tif (!this.#attached) return;\r\n\t\tthis.#extensionsController?.destroy();\r\n\r\n\t\tthis.#extensionsController = new UmbExtensionsElementInitializer(\r\n\t\t\tthis,\r\n\t\t\tumbExtensionsRegistry,\r\n\t\t\t'tiptapStatusbarExtension',\r\n\t\t\t(manifest) => this.statusbar.flat().includes(manifest.alias),\r\n\t\t\t(extensionControllers) => {\r\n\t\t\t\textensionControllers.forEach((ext) => {\r\n\t\t\t\t\tif (!this.#lookup.has(ext.alias)) {\r\n\t\t\t\t\t\t(ext.component as HTMLElement)?.setAttribute('data-mark', `action:tiptap-statusbar:${ext.alias}`);\r\n\t\t\t\t\t\tthis.#lookup.set(ext.alias, ext.component);\r\n\t\t\t\t\t\tthis.#debouncer();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t);\r\n\r\n\t\tthis.#extensionsController.properties = { editor: this.editor, configuration: this.configuration };\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this.statusbar.flat().length) return nothing;\r\n\t\treturn this.#renderAreas(this.statusbar);\r\n\t}\r\n\r\n\t#renderAreas(statusbar: UmbTiptapStatusbarValue) {\r\n\t\treturn repeat(statusbar, (area) => html`<div class=\"area\">${this.#renderActions(area)}</div>`);\r\n\t}\r\n\r\n\t#renderActions(aliases: Array<string>) {\r\n\t\treturn repeat(aliases, (alias) => this.#lookup?.get(alias) ?? nothing);\r\n\t}\r\n\r\n\tstatic override readonly styles = css`\r\n\t\t:host([readonly]) {\r\n\t\t\tdisplay: none;\r\n\t\t}\r\n\r\n\t\t:host {\r\n\t\t\t--uui-button-height: var(--uui-size-layout-2);\r\n\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-wrap: wrap;\r\n\t\t\talign-items: center;\r\n\t\t\tjustify-content: space-between;\r\n\r\n\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\tborder: 1px solid var(--umb-tiptap-edge-border-color, var(--uui-color-border));\r\n\t\t\tborder-top-left-radius: 0;\r\n\t\t\tborder-top-right-radius: 0;\r\n\t\t\tborder-top: 0;\r\n\t\t\tbox-sizing: border-box;\r\n\r\n\t\t\tmin-height: var(--uui-size-layout-1);\r\n\t\t\tmax-height: calc(var(--uui-size-layout-2) + var(--uui-size-1));\r\n\r\n\t\t\tpadding: 0 var(--uui-size-3);\r\n\r\n\t\t\t> p {\r\n\t\t\t\tmargin: 0;\r\n\t\t\t}\r\n\r\n\t\t\t.area {\r\n\t\t\t\tdisplay: inline-flex;\r\n\t\t\t\tflex-wrap: wrap;\r\n\t\t\t\talign-items: stretch;\r\n\t\t\t}\r\n\t\t}\r\n\t`;\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-tiptap-statusbar': UmbTiptapStatusbarElement;\r\n\t}\r\n}\r\n","import { UmbTiptapRteContext } from '../../contexts/tiptap-rte.context.js';\r\nimport type { UmbTiptapExtensionApi } from '../../extensions/types.js';\r\nimport type { UmbTiptapStatusbarValue, UmbTiptapToolbarValue } from '../types.js';\r\nimport {\r\n\tcss,\r\n\tcustomElement,\r\n\thtml,\r\n\tproperty,\r\n\trepeat,\r\n\tstate,\r\n\tunsafeCSS,\r\n\twhen,\r\n} from '@umbraco-cms/backoffice/external/lit';\r\nimport { loadManifestApi } from '@umbraco-cms/backoffice/extension-api';\r\nimport { umbExtensionsRegistry } from '@umbraco-cms/backoffice/extension-registry';\r\nimport { Editor } from '@umbraco-cms/backoffice/external/tiptap';\r\nimport { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbFormControlMixin } from '@umbraco-cms/backoffice/validation';\r\nimport type { CSSResultGroup } from '@umbraco-cms/backoffice/external/lit';\r\nimport type { Extensions } from '@umbraco-cms/backoffice/external/tiptap';\r\nimport type { UmbPropertyEditorConfigCollection } from '@umbraco-cms/backoffice/property-editor';\r\n\r\nimport '../toolbar/tiptap-toolbar.element.js';\r\nimport '../statusbar/tiptap-statusbar.element.js';\r\n\r\nconst TIPTAP_CORE_EXTENSION_ALIAS = 'Umb.Tiptap.RichTextEssentials';\r\n\r\n/**\r\n * The root path for the stylesheets on the server.\r\n * This is used to load the stylesheets from the server as a workaround until the server supports virtual paths.\r\n */\r\nconst STYLESHEET_ROOT_PATH = '/css';\r\n\r\n@customElement('umb-input-tiptap')\r\nexport class UmbInputTiptapElement extends UmbFormControlMixin<string, typeof UmbLitElement, string>(UmbLitElement) {\r\n\t#context = new UmbTiptapRteContext(this);\r\n\r\n\t#stylesheets = new Set(['/umbraco/backoffice/css/rte-content.css']);\r\n\r\n\t@property({ type: String })\r\n\toverride set value(value: string) {\r\n\t\tif (value === this.#value) return;\r\n\t\tthis.#value = value;\r\n\r\n\t\t// Try to set the value to the editor if it is ready.\r\n\t\tif (this._editor) {\r\n\t\t\tthis._editor.commands.setContent(value);\r\n\t\t}\r\n\t}\r\n\toverride get value() {\r\n\t\treturn this.#value;\r\n\t}\r\n\t#value = '';\r\n\r\n\t@property({ attribute: false })\r\n\tconfiguration?: UmbPropertyEditorConfigCollection;\r\n\r\n\t@property()\r\n\tlabel?: string;\r\n\r\n\t/**\r\n\t * Sets the input to required, meaning validation will fail if the value is empty.\r\n\t * @type {boolean}\r\n\t */\r\n\t@property({ type: Boolean })\r\n\trequired?: boolean;\r\n\r\n\t@property({ type: String })\r\n\trequiredMessage?: string;\r\n\r\n\t/**\r\n\t * Sets the input to readonly mode, meaning value cannot be changed but still able to read and select its content.\r\n\t */\r\n\t@property({ type: Boolean, reflect: true })\r\n\treadonly = false;\r\n\r\n\t@state()\r\n\tprivate _editor?: Editor;\r\n\r\n\t@state()\r\n\tprivate readonly _extensions: Array<UmbTiptapExtensionApi> = [];\r\n\r\n\t@state()\r\n\tprivate _styles: Array<CSSResultGroup> = [];\r\n\r\n\t@state()\r\n\tprivate _toolbar: UmbTiptapToolbarValue = [[[]]];\r\n\r\n\t@state()\r\n\tprivate _statusbar: UmbTiptapStatusbarValue = [[], []];\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.addValidator(\r\n\t\t\t'valueMissing',\r\n\t\t\t() => this.requiredMessage ?? 'Value is required',\r\n\t\t\t() => !!this.required && this.isEmpty(),\r\n\t\t);\r\n\t}\r\n\r\n\tprotected override async firstUpdated() {\r\n\t\tawait Promise.all([await this.#loadExtensions(), await this.#loadEditor()]);\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the editor is empty.\r\n\t * @returns {boolean} returns true if the editor contains no markup\r\n\t */\r\n\tpublic isEmpty(): boolean {\r\n\t\treturn this._editor?.isEmpty ?? false;\r\n\t}\r\n\r\n\tasync #loadExtensions() {\r\n\t\tconst enabledExtensions = this.configuration?.getValueByAlias<string[]>('extensions') ?? [];\r\n\r\n\t\t// Ensures that the \"Rich Text Essentials\" extension is always enabled. [LK]\r\n\t\tif (!enabledExtensions.includes(TIPTAP_CORE_EXTENSION_ALIAS)) {\r\n\t\t\tconst { default: api } = await import('../../extensions/core/rich-text-essentials.tiptap-api.js');\r\n\t\t\tthis._extensions.push(new api(this));\r\n\t\t}\r\n\r\n\t\tawait new Promise<void>((resolve) => {\r\n\t\t\tthis.observe(umbExtensionsRegistry.byTypeAndAliases('tiptapExtension', enabledExtensions), async (manifests) => {\r\n\t\t\t\tfor (const manifest of manifests) {\r\n\t\t\t\t\tif (manifest.api) {\r\n\t\t\t\t\t\tconst extension = await loadManifestApi(manifest.api);\r\n\t\t\t\t\t\tif (extension) {\r\n\t\t\t\t\t\t\tconst ext = new extension(this);\r\n\t\t\t\t\t\t\text.manifest = manifest;\r\n\t\t\t\t\t\t\tthis._extensions.push(ext);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tresolve();\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tasync #loadEditor() {\r\n\t\tconst element = this.shadowRoot?.querySelector('#editor');\r\n\t\tif (!element) return;\r\n\r\n\t\tconst stylesheets = this.configuration?.getValueByAlias<Array<string>>('stylesheets');\r\n\t\tif (stylesheets?.length) {\r\n\t\t\tstylesheets.forEach((stylesheet) => {\r\n\t\t\t\tconst linkHref =\r\n\t\t\t\t\tstylesheet.startsWith('http') || stylesheet.startsWith(STYLESHEET_ROOT_PATH)\r\n\t\t\t\t\t\t? stylesheet\r\n\t\t\t\t\t\t: `${STYLESHEET_ROOT_PATH}${stylesheet}`;\r\n\t\t\t\tthis.#stylesheets.add(linkHref);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis._toolbar = this.configuration?.getValueByAlias<UmbTiptapToolbarValue>('toolbar') ?? [[[]]];\r\n\t\tthis._statusbar = this.configuration?.getValueByAlias<UmbTiptapStatusbarValue>('statusbar') ?? [];\r\n\r\n\t\tconst tiptapExtensions: Extensions = [];\r\n\r\n\t\tthis._extensions.forEach((ext) => {\r\n\t\t\tconst tiptapExt = ext.getTiptapExtensions({ configuration: this.configuration });\r\n\t\t\tif (tiptapExt?.length) {\r\n\t\t\t\ttiptapExtensions.push(...tiptapExt);\r\n\t\t\t}\r\n\r\n\t\t\tconst styles = ext.getStyles();\r\n\t\t\tif (styles) {\r\n\t\t\t\tthis._styles.push(styles);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._editor = new Editor({\r\n\t\t\telement: element,\r\n\t\t\teditable: !this.readonly,\r\n\t\t\teditorProps: {\r\n\t\t\t\tattributes: {\r\n\t\t\t\t\t'aria-label': this.label || this.localize.term('rte_label'),\r\n\t\t\t\t\t'aria-required': this.required ? 'true' : 'false',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\textensions: tiptapExtensions,\r\n\t\t\tcontent: this.#value,\r\n\t\t\tinjectCSS: false, // Prevents injecting CSS into `window.document`, as it never applies to the shadow DOM. [LK]\r\n\t\t\t//enableContentCheck: true,\r\n\t\t\tonBeforeCreate: ({ editor }) => {\r\n\t\t\t\tthis._extensions.forEach((ext) => ext.setEditor(editor));\r\n\t\t\t},\r\n\t\t\tonContentError: ({ error }) => {\r\n\t\t\t\tconsole.error('contentError', [error.message, error.cause]);\r\n\t\t\t},\r\n\t\t\tonUpdate: ({ editor }) => {\r\n\t\t\t\tthis.#value = editor.getHTML();\r\n\t\t\t\tthis._runValidators();\r\n\t\t\t\tthis.dispatchEvent(new UmbChangeEvent());\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tthis.#context.setEditor(this._editor);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tconst loading = !this._editor && !this._extensions?.length;\r\n\t\treturn html`\r\n\t\t\t${when(loading, () => html`<div id=\"loader\"><uui-loader></uui-loader></div>`)}\r\n\t\t\t${when(!loading, () => html`${this.#renderStyles()}${this.#renderToolbar()}`)}\r\n\t\t\t<div id=\"editor\" data-mark=\"input:tiptap-rte\" ?data-loaded=${!loading}></div>\r\n\t\t\t${when(!loading, () => this.#renderStatusbar())}\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderStyles() {\r\n\t\tif (!this._styles?.length) return;\r\n\t\treturn html`\r\n\t\t\t${repeat(\r\n\t\t\t\tthis.#stylesheets,\r\n\t\t\t\t(stylesheet) => stylesheet,\r\n\t\t\t\t(stylesheet) => html`<link rel=\"stylesheet\" href=${stylesheet} />`,\r\n\t\t\t)}\r\n\t\t\t<style>\r\n\t\t\t\t${this._styles.map((style) => unsafeCSS(style))}\r\n\t\t\t</style>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderToolbar() {\r\n\t\tif (!this._toolbar.flat(2).length) return;\r\n\t\treturn html`\r\n\t\t\t<umb-tiptap-toolbar\r\n\t\t\t\tdata-mark=\"tiptap-toolbar\"\r\n\t\t\t\t.toolbar=${this._toolbar}\r\n\t\t\t\t.editor=${this._editor}\r\n\t\t\t\t.configuration=${this.configuration}\r\n\t\t\t\t?readonly=${this.readonly}>\r\n\t\t\t</umb-tiptap-toolbar>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderStatusbar() {\r\n\t\tif (!this._statusbar.flat().length) return;\r\n\t\treturn html`\r\n\t\t\t<umb-tiptap-statusbar\r\n\t\t\t\tdata-mark=\"tiptap-statusbar\"\r\n\t\t\t\t.statusbar=${this._statusbar}\r\n\t\t\t\t.editor=${this._editor}\r\n\t\t\t\t.configuration=${this.configuration}\r\n\t\t\t\t?readonly=${this.readonly}>\r\n\t\t\t</umb-tiptap-statusbar>\r\n\t\t`;\r\n\t}\r\n\r\n\toverride destroy(): void {\r\n\t\tthis._editor?.destroy();\r\n\t\tthis._editor = undefined;\r\n\t}\r\n\r\n\tstatic override readonly styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tz-index: 0;\r\n\r\n\t\t\t\twidth: var(--umb-rte-width, unset);\r\n\t\t\t\tmin-width: var(--umb-rte-min-width, unset);\r\n\t\t\t\tmax-width: var(--umb-rte-max-width, 100%);\r\n\t\t\t}\r\n\r\n\t\t\t:host(:hover) {\r\n\t\t\t\t--umb-tiptap-edge-border-color: var(--uui-color-border-standalone);\r\n\t\t\t}\r\n\r\n\t\t\t:host(:focus),\r\n\t\t\t:host(:focus-within) {\r\n\t\t\t\t--umb-tiptap-edge-border-color: var(--uui-color-border-emphasis);\r\n\t\t\t}\r\n\r\n\t\t\t:host([readonly]) {\r\n\t\t\t\tpointer-events: none;\r\n\r\n\t\t\t\t#editor {\r\n\t\t\t\t\tbackground-color: var(--uui-color-surface-alt);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t#loader {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t}\r\n\r\n\t\t\t:host(:invalid:not([pristine])),\r\n\t\t\t/* polyfill support */\r\n\t\t\t:host(:not([pristine])[internals-invalid]) {\r\n\t\t\t\t--umb-tiptap-edge-border-color: var(--uui-color-invalid);\r\n\t\t\t\t#editor {\r\n\t\t\t\t\tborder-color: var(--uui-color-invalid);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t#editor {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\toverflow: auto;\r\n\t\t\t\tborder-radius: var(--uui-border-radius);\r\n\t\t\t\tborder: 1px solid transparent;\r\n\t\t\t\tpadding: 1rem;\r\n\t\t\t\tbox-sizing: border-box;\r\n\r\n\t\t\t\theight: var(--umb-rte-height, 100%);\r\n\t\t\t\tmin-height: var(--umb-rte-min-height, 100%);\r\n\t\t\t\tmax-height: var(--umb-rte-max-height, 100%);\r\n\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tmax-width: 100%;\r\n\r\n\t\t\t\t&[data-loaded] {\r\n\t\t\t\t\tborder-color: var(--umb-tiptap-edge-border-color, var(--uui-color-border));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t> .tiptap {\r\n\t\t\t\t\theight: 100%;\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\toutline: none;\r\n\t\t\t\t\twhite-space: wrap;\r\n\t\t\t\t\tmin-width: 0;\r\n\r\n\t\t\t\t\tp:first-of-type {\r\n\t\t\t\t\t\tmargin-top: 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t.is-editor-empty:first-child::before {\r\n\t\t\t\t\t\tcolor: var(--uui-color-text);\r\n\t\t\t\t\t\topacity: 0.55;\r\n\t\t\t\t\t\tcontent: attr(data-placeholder);\r\n\t\t\t\t\t\tfloat: left;\r\n\t\t\t\t\t\theight: 0;\r\n\t\t\t\t\t\tpointer-events: none;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t&:has(+ umb-tiptap-statusbar) {\r\n\t\t\t\t\tborder-bottom-left-radius: 0;\r\n\t\t\t\t\tborder-bottom-right-radius: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t#editor,\r\n\t\t\tumb-tiptap-toolbar,\r\n\t\t\tumb-tiptap-statusbar {\r\n\t\t\t\ttransition: border-color 120ms ease-out;\r\n\t\t\t}\r\n\r\n\t\t\tumb-tiptap-toolbar + #editor {\r\n\t\t\t\tborder-top: 0;\r\n\t\t\t\tborder-top-left-radius: 0;\r\n\t\t\t\tborder-top-right-radius: 0;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-input-tiptap': UmbInputTiptapElement;\r\n\t}\r\n}\r\n"],"names":["UmbTiptapRteContext","UmbContextBase","#editor","host","UMB_TIPTAP_RTE_CONTEXT","editor","_attached","_debouncer","_extensionsController","_lookup","_UmbTiptapToolbarElement_instances","observeExtensions_fn","renderRows_fn","renderGroups_fn","renderActions_fn","renderActionPlaceholder_fn","UmbTiptapToolbarElement","UmbLitElement","__privateAdd","debounce","__privateSet","__privateMethod","__privateGet","nothing","UmbExtensionsElementAndApiInitializer","umbExtensionsRegistry","manifest","extensionControllers","ext","rows","repeat","row","html","groups","group","aliases","alias","css","__decorateClass","property","customElement","_statusbar","_UmbTiptapStatusbarElement_instances","renderAreas_fn","UmbTiptapStatusbarElement","value","UmbExtensionsElementInitializer","statusbar","area","_context","_stylesheets","_value","_UmbInputTiptapElement_instances","loadExtensions_fn","loadEditor_fn","renderStyles_fn","renderToolbar_fn","renderStatusbar_fn","TIPTAP_CORE_EXTENSION_ALIAS","STYLESHEET_ROOT_PATH","UmbInputTiptapElement","UmbFormControlMixin","loading","when","enabledExtensions","api","resolve","manifests","extension","loadManifestApi","element","stylesheets","stylesheet","linkHref","tiptapExtensions","tiptapExt","styles","Editor","error","UmbChangeEvent","style","unsafeCSS","state"],"mappings":"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"}