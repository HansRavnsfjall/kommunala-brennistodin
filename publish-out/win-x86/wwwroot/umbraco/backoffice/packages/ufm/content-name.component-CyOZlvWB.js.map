{"version":3,"file":"content-name.component-CyOZlvWB.js","sources":["../../../src/packages/ufm/components/content-name/content-name.element.ts","../../../src/packages/ufm/components/content-name/content-name.component.ts"],"sourcesContent":["import { UmbUfmElementBase } from '../ufm-element-base.js';\r\nimport { UMB_UFM_RENDER_CONTEXT } from '../ufm-render/ufm-render.context.js';\r\nimport { customElement, property } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbDocumentItemRepository, UMB_DOCUMENT_ENTITY_TYPE } from '@umbraco-cms/backoffice/document';\r\nimport { UmbId } from '@umbraco-cms/backoffice/id';\r\nimport { UmbMediaItemRepository, UMB_MEDIA_ENTITY_TYPE } from '@umbraco-cms/backoffice/media';\r\nimport { UmbMemberItemRepository, UMB_MEMBER_ENTITY_TYPE } from '@umbraco-cms/backoffice/member';\r\n\r\n@customElement('ufm-content-name')\r\nexport class UmbUfmContentNameElement extends UmbUfmElementBase {\r\n\t@property()\r\n\talias?: string;\r\n\r\n\t#documentRepository?: UmbDocumentItemRepository;\r\n\t#mediaRepository?: UmbMediaItemRepository;\r\n\t#memberRepository?: UmbMemberItemRepository;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_UFM_RENDER_CONTEXT, (context) => {\r\n\t\t\tthis.observe(\r\n\t\t\t\tcontext?.value,\r\n\t\t\t\tasync (value) => {\r\n\t\t\t\t\tconst temp =\r\n\t\t\t\t\t\tthis.alias && typeof value === 'object'\r\n\t\t\t\t\t\t\t? (value as Record<string, unknown>)[this.alias]\r\n\t\t\t\t\t\t\t: (value as unknown);\r\n\r\n\t\t\t\t\tif (!temp) return;\r\n\r\n\t\t\t\t\tconst entityType = this.#getEntityType(temp);\r\n\t\t\t\t\tconst uniques = this.#getUniques(temp);\r\n\r\n\t\t\t\t\tthis.value = await this.#getNames(entityType, uniques);\r\n\t\t\t\t},\r\n\t\t\t\t'observeValue',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t#getEntityType(value: unknown) {\r\n\t\tif (Array.isArray(value) && value.length > 0) {\r\n\t\t\tconst item = value[0];\r\n\t\t\tif (item.type) return item.type;\r\n\t\t\tif (item.mediaKey) return UMB_MEDIA_ENTITY_TYPE;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t#getUniques(value: unknown) {\r\n\t\tif (Array.isArray(value)) {\r\n\t\t\treturn value.map((x) => x.unique ?? x.mediaKey ?? x).filter((x) => UmbId.validate(x));\r\n\t\t}\r\n\r\n\t\treturn typeof value === 'string' && UmbId.validate(value) ? [value] : [];\r\n\t}\r\n\r\n\tasync #getNames(entityType: string, uniques?: Array<string>) {\r\n\t\tif (uniques?.length) {\r\n\t\t\tconst repository = this.#getRepository(entityType);\r\n\t\t\tif (repository) {\r\n\t\t\t\tconst { data } = await repository.requestItems(uniques);\r\n\t\t\t\tif (Array.isArray(data) && data.length > 0) {\r\n\t\t\t\t\treturn data.map((item) => item.name).join(', ');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn '';\r\n\t}\r\n\r\n\t#getRepository(entityType?: string | null) {\r\n\t\tswitch (entityType) {\r\n\t\t\tcase UMB_MEDIA_ENTITY_TYPE:\r\n\t\t\t\tif (!this.#mediaRepository) this.#mediaRepository = new UmbMediaItemRepository(this);\r\n\t\t\t\treturn this.#mediaRepository;\r\n\r\n\t\t\tcase UMB_MEMBER_ENTITY_TYPE:\r\n\t\t\t\tif (!this.#memberRepository) this.#memberRepository = new UmbMemberItemRepository(this);\r\n\t\t\t\treturn this.#memberRepository;\r\n\r\n\t\t\tcase UMB_DOCUMENT_ENTITY_TYPE:\r\n\t\t\tdefault:\r\n\t\t\t\tif (!this.#documentRepository) this.#documentRepository = new UmbDocumentItemRepository(this);\r\n\t\t\t\treturn this.#documentRepository;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport { UmbUfmContentNameElement as element };\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'ufm-content-name': UmbUfmContentNameElement;\r\n\t}\r\n}\r\n","import type { UfmToken } from '../../plugins/types.js';\r\nimport { UmbUfmComponentBase } from '../ufm-component-base.js';\r\n\r\nimport './content-name.element.js';\r\n\r\nexport class UmbUfmContentNameComponent extends UmbUfmComponentBase {\r\n\trender(token: UfmToken) {\r\n\t\tif (!token.text) return;\r\n\r\n\t\tif (token.prefix === '~') {\r\n\t\t\t/*\r\n\t\t\t * @deprecated since version 15.0-rc3\r\n\t\t\t */\r\n\t\t\tconsole.warn(`Please update your UFM syntax from \\`${token.raw}\\` to \\`{umbContentName:${token.text}}\\`.`);\r\n\t\t}\r\n\r\n\t\tconst attributes = super.getAttributes(token.text);\r\n\t\treturn `<ufm-content-name ${attributes}></ufm-content-name>`;\r\n\t}\r\n}\r\n\r\nexport { UmbUfmContentNameComponent as api };\r\n"],"names":["_documentRepository","_mediaRepository","_memberRepository","_UmbUfmContentNameElement_instances","getEntityType_fn","getUniques_fn","getNames_fn","getRepository_fn","UmbUfmContentNameElement","UmbUfmElementBase","__privateAdd","UMB_UFM_RENDER_CONTEXT","context","value","temp","entityType","__privateMethod","uniques","item","UMB_MEDIA_ENTITY_TYPE","x","UmbId","repository","data","__privateGet","UmbMediaItemRepository","UMB_MEMBER_ENTITY_TYPE","UmbMemberItemRepository","UMB_DOCUMENT_ENTITY_TYPE","UmbDocumentItemRepository","__decorateClass","property","customElement","UmbUfmContentNameComponent","UmbUfmComponentBase","token"],"mappings":";;;;;;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AASO,IAAMC,IAAN,cAAuCC,EAAkB;AAAA,EAQ/D,cAAc;AACb,UAAA,GATKC,EAAA,MAAAP,CAAA,GAINO,EAAA,MAAAV,CAAA,GACAU,EAAA,MAAAT,CAAA,GACAS,EAAA,MAAAR,CAAA,GAKC,KAAK,eAAeS,GAAwB,CAACC,MAAY;AACxD,WAAK;AAAA,QACJA,GAAS;AAAA,QACT,OAAOC,MAAU;AAChB,gBAAMC,IACL,KAAK,SAAS,OAAOD,KAAU,WAC3BA,EAAkC,KAAK,KAAK,IAC5CA;AAEL,cAAI,CAACC,EAAM;AAEX,gBAAMC,IAAaC,EAAA,MAAKb,GAAAC,CAAA,EAAL,KAAA,MAAoBU,CAAA,GACjCG,IAAUD,EAAA,MAAKb,GAAAE,CAAA,EAAL,KAAA,MAAiBS,CAAA;AAEjC,eAAK,QAAQ,MAAME,EAAA,MAAKb,GAAAG,CAAA,EAAL,WAAeS,GAAYE,CAAA;AAAA,QAC/C;AAAA,QACA;AAAA,MAAA;AAAA,IAEF,CAAC;AAAA,EACF;AAkDD;AA5ECjB,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AANMC,IAAA,oBAAA,QAAA;AAgCNC,IAAc,SAACS,GAAgB;AAC9B,MAAI,MAAM,QAAQA,CAAK,KAAKA,EAAM,SAAS,GAAG;AAC7C,UAAMK,IAAOL,EAAM,CAAC;AACpB,QAAIK,EAAK,KAAM,QAAOA,EAAK;AAC3B,QAAIA,EAAK,SAAU,QAAOC;AAAA,EAC3B;AAEA,SAAO;AACR;AAEAd,IAAW,SAACQ,GAAgB;AAC3B,SAAI,MAAM,QAAQA,CAAK,IACfA,EAAM,IAAI,CAACO,MAAMA,EAAE,UAAUA,EAAE,YAAYA,CAAC,EAAE,OAAO,CAACA,MAAMC,EAAM,SAASD,CAAC,CAAC,IAG9E,OAAOP,KAAU,YAAYQ,EAAM,SAASR,CAAK,IAAI,CAACA,CAAK,IAAI,CAAA;AACvE;AAEMP,IAAS,eAACS,GAAoBE,GAAyB;AAC5D,MAAIA,GAAS,QAAQ;AACpB,UAAMK,IAAaN,EAAA,MAAKb,GAAAI,CAAA,EAAL,KAAA,MAAoBQ,CAAA;AACvC,QAAIO,GAAY;AACf,YAAM,EAAE,MAAAC,EAAA,IAAS,MAAMD,EAAW,aAAaL,CAAO;AACtD,UAAI,MAAM,QAAQM,CAAI,KAAKA,EAAK,SAAS;AACxC,eAAOA,EAAK,IAAI,CAACL,MAASA,EAAK,IAAI,EAAE,KAAK,IAAI;AAAA,IAEhD;AAAA,EACD;AAEA,SAAO;AACR;AAEAX,IAAc,SAACQ,GAA4B;AAC1C,UAAQA,GAAA;AAAA,IACP,KAAKI;AACJ,aAAKK,EAAA,MAAKvB,CAAA,aAAuBA,GAAmB,IAAIwB,EAAuB,IAAI,CAAA,GAC5ED,EAAA,MAAKvB,CAAA;AAAA,IAEb,KAAKyB;AACJ,aAAKF,EAAA,MAAKtB,CAAA,aAAwBA,GAAoB,IAAIyB,EAAwB,IAAI,CAAA,GAC/EH,EAAA,MAAKtB,CAAA;AAAA,IAEb,KAAK0B;AAAA,IACL;AACC,aAAKJ,EAAA,MAAKxB,CAAA,aAA0BA,GAAsB,IAAI6B,EAA0B,IAAI,CAAA,GACrFL,EAAA,MAAKxB,CAAA;AAAA,EAAA;AAEf;AA7EA8B,EAAA;AAAA,EADCC,EAAA;AAAS,GADEvB,EAEZ,WAAA,SAAA,CAAA;AAFYA,IAANsB,EAAA;AAAA,EADNE,EAAc,kBAAkB;AAAA,GACpBxB,CAAA;ACJN,MAAMyB,UAAmCC,EAAoB;AAAA,EACnE,OAAOC,GAAiB;AACvB,WAAKA,EAAM,QAEPA,EAAM,WAAW,OAIpB,QAAQ,KAAK,wCAAwCA,EAAM,GAAG,2BAA2BA,EAAM,IAAI,MAAM,GAInG,qBADY,MAAM,cAAcA,EAAM,IAAI,CACX,0BAVrB;AAAA,EAWlB;AACD;"}