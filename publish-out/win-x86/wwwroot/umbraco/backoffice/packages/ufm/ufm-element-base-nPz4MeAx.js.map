{"version":3,"file":"ufm-element-base-nPz4MeAx.js","sources":["../../../src/packages/ufm/components/ufm-component-base.ts","../../../src/packages/ufm/components/ufm-element-base.ts"],"sourcesContent":["import type { UfmToken } from '../plugins/types.js';\r\nimport type { UmbUfmComponentApi } from '../extensions/ufm-component.extension.js';\r\n\r\nexport abstract class UmbUfmComponentBase implements UmbUfmComponentApi {\r\n\tprotected getAttributes(text: string): string | null {\r\n\t\tif (!text) return null;\r\n\r\n\t\tconst pipeIndex = text.indexOf('|');\r\n\r\n\t\tif (pipeIndex === -1) {\r\n\t\t\treturn `alias=\"${text.trim()}\"`;\r\n\t\t}\r\n\r\n\t\tconst alias = text.substring(0, pipeIndex).trim();\r\n\t\tconst filters = text.substring(pipeIndex + 1).trim();\r\n\r\n\t\treturn Object.entries({ alias, filters })\r\n\t\t\t.map(([key, value]) => (value ? `${key}=\"${value.trim()}\"` : null))\r\n\t\t\t.join(' ');\r\n\t}\r\n\r\n\tabstract render(token: UfmToken): string | undefined;\r\n\r\n\tdestroy() {}\r\n}\r\n","import { UMB_UFM_CONTEXT } from '../contexts/ufm.context.js';\r\nimport { property, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\n\r\nexport abstract class UmbUfmElementBase extends UmbLitElement {\r\n\t#filterFuncArgs?: Array<{ alias: string; args: Array<string> }>;\r\n\r\n\t#ufmContext?: typeof UMB_UFM_CONTEXT.TYPE;\r\n\r\n\t@property()\r\n\tpublic set filters(value: string | undefined) {\r\n\t\tthis.#filters = value;\r\n\r\n\t\tthis.#filterFuncArgs = value\r\n\t\t\t?.split('|')\r\n\t\t\t.filter((item) => item)\r\n\t\t\t.map((item) => {\r\n\t\t\t\tconst [alias, ...args] = item.split(':').map((x) => x.trim());\r\n\t\t\t\treturn { alias, args };\r\n\t\t\t});\r\n\t}\r\n\tpublic get filters(): string | undefined {\r\n\t\treturn this.#filters;\r\n\t}\r\n\t#filters?: string;\r\n\r\n\t@state()\r\n\tvalue?: unknown;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_UFM_CONTEXT, (ufmContext) => {\r\n\t\t\tthis.#ufmContext = ufmContext;\r\n\t\t});\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tlet values = Array.isArray(this.value) ? this.value : [this.value];\r\n\r\n\t\tif (this.#filterFuncArgs) {\r\n\t\t\tconst missing = new Set<string>();\r\n\r\n\t\t\tfor (const item of this.#filterFuncArgs) {\r\n\t\t\t\tconst filter = this.#ufmContext?.getFilterByAlias(item.alias);\r\n\t\t\t\tif (filter) {\r\n\t\t\t\t\tvalues = values.map((value) => filter(value, ...item.args));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmissing.add(item.alias);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (missing.size > 0) {\r\n\t\t\t\tconsole.warn(`UFM filters with aliases \"${Array.from(missing).join('\", \"')}\" were not found.`);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn values.join(', ');\r\n\t}\r\n}\r\n"],"names":["UmbUfmComponentBase","text","pipeIndex","alias","filters","key","value","UmbUfmElementBase","UmbLitElement","#filterFuncArgs","#ufmContext","#filters","item","args","x","UMB_UFM_CONTEXT","ufmContext","values","missing","filter","__decorateClass","property","state"],"mappings":";;;AAGO,MAAeA,EAAkD;AAAA,EAC7D,cAAcC,GAA6B;AACpD,QAAI,CAACA,EAAM,QAAO;AAElB,UAAMC,IAAYD,EAAK,QAAQ,GAAG;AAElC,QAAIC,MAAc;AACjB,aAAO,UAAUD,EAAK,KAAA,CAAM;AAG7B,UAAME,IAAQF,EAAK,UAAU,GAAGC,CAAS,EAAE,KAAA,GACrCE,IAAUH,EAAK,UAAUC,IAAY,CAAC,EAAE,KAAA;AAE9C,WAAO,OAAO,QAAQ,EAAE,OAAAC,GAAO,SAAAC,GAAS,EACtC,IAAI,CAAC,CAACC,GAAKC,CAAK,MAAOA,IAAQ,GAAGD,CAAG,KAAKC,EAAM,KAAA,CAAM,MAAM,IAAK,EACjE,KAAK,GAAG;AAAA,EACX;AAAA,EAIA,UAAU;AAAA,EAAC;AACZ;;;;;;ACpBO,MAAeC,UAA0BC,EAAc;AAAA,EAC7DC;AAAA,EAEAC;AAAA,EAGA,IAAW,QAAQJ,GAA2B;AAC7C,SAAKK,KAAWL,GAEhB,KAAKG,KAAkBH,GACpB,MAAM,GAAG,EACV,OAAO,CAACM,MAASA,CAAI,EACrB,IAAI,CAACA,MAAS;AACd,YAAM,CAACT,GAAO,GAAGU,CAAI,IAAID,EAAK,MAAM,GAAG,EAAE,IAAI,CAACE,MAAMA,EAAE,MAAM;AAC5D,aAAO,EAAE,OAAAX,GAAO,MAAAU,EAAA;AAAA,IACjB,CAAC;AAAA,EACH;AAAA,EACA,IAAW,UAA8B;AACxC,WAAO,KAAKF;AAAA,EACb;AAAA,EACAA;AAAA,EAKA,cAAc;AACb,UAAA,GAEA,KAAK,eAAeI,GAAiB,CAACC,MAAe;AACpD,WAAKN,KAAcM;AAAA,IACpB,CAAC;AAAA,EACF;AAAA,EAES,SAAS;AACjB,QAAIC,IAAS,MAAM,QAAQ,KAAK,KAAK,IAAI,KAAK,QAAQ,CAAC,KAAK,KAAK;AAEjE,QAAI,KAAKR,IAAiB;AACzB,YAAMS,wBAAc,IAAA;AAEpB,iBAAWN,KAAQ,KAAKH,IAAiB;AACxC,cAAMU,IAAS,KAAKT,IAAa,iBAAiBE,EAAK,KAAK;AAC5D,QAAIO,IACHF,IAASA,EAAO,IAAI,CAACX,MAAUa,EAAOb,GAAO,GAAGM,EAAK,IAAI,CAAC,IAE1DM,EAAQ,IAAIN,EAAK,KAAK;AAAA,MAExB;AAEA,MAAIM,EAAQ,OAAO,KAClB,QAAQ,KAAK,6BAA6B,MAAM,KAAKA,CAAO,EAAE,KAAK,MAAM,CAAC,mBAAmB;AAAA,IAE/F;AAEA,WAAOD,EAAO,KAAK,IAAI;AAAA,EACxB;AACD;AAjDYG,EAAA;AAAA,EADVC,EAAA;AAAS,GALWd,EAMV,WAAA,WAAA,CAAA;AAiBXa,EAAA;AAAA,EADCE,EAAA;AAAM,GAtBcf,EAuBrB,WAAA,SAAA,CAAA;"}