{"version":3,"file":"user-workspace.context-C4jEzfhd.js","sources":["../../../src/packages/user/user/workspace/user/components/user-workspace-profile-settings/user-workspace-profile-settings.element.ts","../../../src/packages/user/user/workspace/user/components/user-workspace-assign-access/user-workspace-assign-access.element.ts","../../../src/packages/user/user/workspace/user/components/user-workspace-access/user-workspace-access.element.ts","../../../src/packages/user/user/workspace/user/components/user-workspace-info/user-workspace-info.element.ts","../../../src/packages/user/user/workspace/user/components/user-workspace-avatar/user-workspace-avatar.element.ts","../../../src/packages/user/user/workspace/user/components/user-workspace-client-credentials/user-workspace-client-credentials.element.ts","../../../src/packages/user/user/workspace/user/user-workspace-editor.element.ts","../../../src/packages/user/user/workspace/user/user-workspace.context.ts"],"sourcesContent":["import { UmbUserKind } from '../../../../utils/index.js';\r\nimport { UMB_USER_WORKSPACE_CONTEXT } from '../../user-workspace.context-token.js';\r\nimport type { UmbUserDetailModel } from '../../../../types.js';\r\nimport { html, customElement, state, ifDefined, css, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { umbBindToValidation } from '@umbraco-cms/backoffice/validation';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport type { UmbChangeEvent } from '@umbraco-cms/backoffice/event';\r\nimport type { UmbUiCultureInputElement } from '@umbraco-cms/backoffice/localization';\r\n\r\n@customElement('umb-user-workspace-profile-settings')\r\nexport class UmbUserWorkspaceProfileSettingsElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _user?: UmbUserDetailModel;\r\n\r\n\t@state()\r\n\tprivate _usernameIsEmail = true;\r\n\r\n\t#userWorkspaceContext?: typeof UMB_USER_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_USER_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#userWorkspaceContext = instance;\r\n\t\t\tthis.observe(this.#userWorkspaceContext?.data, (user) => (this._user = user), 'umbUserObserver');\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#userWorkspaceContext?.configRepository.part('usernameIsEmail'),\r\n\t\t\t\t(usernameIsEmail) => (this._usernameIsEmail = usernameIsEmail === undefined ? true : usernameIsEmail),\r\n\t\t\t\t'umbUsernameIsEmailObserver',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t#onEmailChange(event: UmbChangeEvent) {\r\n\t\tconst target = event.target as HTMLInputElement;\r\n\r\n\t\tif (typeof target?.value === 'string') {\r\n\t\t\tthis.#userWorkspaceContext?.updateProperty('email', target.value);\r\n\r\n\t\t\tif (this._usernameIsEmail) {\r\n\t\t\t\tthis.#userWorkspaceContext?.updateProperty('userName', target.value);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t#onUsernameChange(event: UmbChangeEvent) {\r\n\t\tconst target = event.target as HTMLInputElement;\r\n\r\n\t\tif (typeof target?.value === 'string') {\r\n\t\t\tthis.#userWorkspaceContext?.updateProperty('userName', target.value);\r\n\t\t}\r\n\t}\r\n\r\n\t#onLanguageChange(event: UmbChangeEvent) {\r\n\t\tconst target = event.target as UmbUiCultureInputElement;\r\n\r\n\t\tif (typeof target?.value === 'string') {\r\n\t\t\tthis.#userWorkspaceContext?.updateProperty('languageIsoCode', target.value);\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<uui-box>\r\n\t\t\t\t<div slot=\"headline\"><umb-localize key=\"user_profile\">Profile</umb-localize></div>\r\n\t\t\t\t${this.#renderEmailProperty()} ${this.#renderUsernameProperty()} ${this.#renderUILanguageProperty()}\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderEmailProperty() {\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tmandatory\r\n\t\t\t\tlabel=${this.localize.term('general_email')}\r\n\t\t\t\tdescription=${this.localize.term('user_emailDescription', this._usernameIsEmail)}>\r\n\t\t\t\t<uui-input\r\n\t\t\t\t\tslot=\"editor\"\r\n\t\t\t\t\tname=\"email\"\r\n\t\t\t\t\tlabel=${this.localize.term('general_email')}\r\n\t\t\t\t\trequired\r\n\t\t\t\t\trequired-message=${this.localize.term('user_emailRequired')}\r\n\t\t\t\t\tvalue=${ifDefined(this._user?.email)}\r\n\t\t\t\t\t@change=${this.#onEmailChange}\r\n\t\t\t\t\t${umbBindToValidation(this)}>\r\n\t\t\t\t</uui-input>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderUsernameProperty() {\r\n\t\tif (this._usernameIsEmail) return nothing;\r\n\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tmandatory\r\n\t\t\t\tlabel=${this.localize.term('user_loginname')}\r\n\t\t\t\tdescription=${this.localize.term('user_loginnameDescription')}>\r\n\t\t\t\t<uui-input\r\n\t\t\t\t\tslot=\"editor\"\r\n\t\t\t\t\tname=\"username\"\r\n\t\t\t\t\tautocomplete=\"off\"\r\n\t\t\t\t\tlabel=${this.localize.term('user_loginname')}\r\n\t\t\t\t\trequired\r\n\t\t\t\t\trequired-message=${this.localize.term('user_loginnameRequired')}\r\n\t\t\t\t\tvalue=${ifDefined(this._user?.userName)}\r\n\t\t\t\t\t@change=${this.#onUsernameChange}>\r\n\t\t\t\t</uui-input>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderUILanguageProperty() {\r\n\t\tif (this._user?.kind === UmbUserKind.API) return nothing;\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tlabel=${this.localize.term('user_language')}\r\n\t\t\t\tdescription=${this.localize.term('user_languageHelp')}>\r\n\t\t\t\t<umb-ui-culture-input\r\n\t\t\t\t\tslot=\"editor\"\r\n\t\t\t\t\tname=\"language\"\r\n\t\t\t\t\tlabel=${this.localize.term('user_language')}\r\n\t\t\t\t\tvalue=${ifDefined(this._user?.languageIsoCode ?? undefined)}\r\n\t\t\t\t\t@change=${this.#onLanguageChange}>\r\n\t\t\t\t</umb-ui-culture-input>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\tuui-input {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbUserWorkspaceProfileSettingsElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-user-workspace-profile-settings': UmbUserWorkspaceProfileSettingsElement;\r\n\t}\r\n}\r\n","import { UMB_USER_WORKSPACE_CONTEXT } from '../../user-workspace.context-token.js';\r\nimport type { UmbUserDetailModel } from '../../../../types.js';\r\nimport { html, customElement, state, nothing, css } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport type { UmbUserGroupInputElement } from '@umbraco-cms/backoffice/user-group';\r\nimport type { UUIBooleanInputEvent } from '@umbraco-cms/backoffice/external/uui';\r\nimport type { UmbReferenceByUnique } from '@umbraco-cms/backoffice/models';\r\n\r\nconst elementName = 'umb-user-workspace-assign-access';\r\n@customElement(elementName)\r\nexport class UmbUserWorkspaceAssignAccessElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _userGroupUniques: UmbUserDetailModel['userGroupUniques'] = [];\r\n\r\n\t@state()\r\n\tprivate _documentStartNodeUniques: UmbUserDetailModel['documentStartNodeUniques'] = [];\r\n\r\n\t@state()\r\n\tprivate _documentRootAccess: UmbUserDetailModel['hasDocumentRootAccess'] = false;\r\n\r\n\t@state()\r\n\tprivate _mediaStartNodeUniques: UmbUserDetailModel['documentStartNodeUniques'] = [];\r\n\r\n\t@state()\r\n\tprivate _mediaRootAccess: UmbUserDetailModel['hasMediaRootAccess'] = false;\r\n\r\n\t#workspaceContext?: typeof UMB_USER_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_USER_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.userGroupUniques,\r\n\t\t\t\t(value) => (this._userGroupUniques = value ?? []),\r\n\t\t\t\t'_observeUserGroupAccess',\r\n\t\t\t);\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.hasDocumentRootAccess,\r\n\t\t\t\t(value) => (this._documentRootAccess = value ?? false),\r\n\t\t\t\t'_observeDocumentRootAccess',\r\n\t\t\t);\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.documentStartNodeUniques,\r\n\t\t\t\t(value) => (this._documentStartNodeUniques = value ?? []),\r\n\t\t\t\t'_observeDocumentStartNode',\r\n\t\t\t);\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.hasMediaRootAccess,\r\n\t\t\t\t(value) => (this._mediaRootAccess = value ?? false),\r\n\t\t\t\t'_observeMediaRootAccess',\r\n\t\t\t);\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#workspaceContext?.mediaStartNodeUniques,\r\n\t\t\t\t(value) => (this._mediaStartNodeUniques = value ?? []),\r\n\t\t\t\t'_observeMediaStartNode',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t#onUserGroupsChange(event: CustomEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tconst target = event.target as UmbUserGroupInputElement;\r\n\t\tconst selection: Array<UmbReferenceByUnique> = target.selection.map((unique) => {\r\n\t\t\treturn { unique };\r\n\t\t});\r\n\t\t// TODO make contexts method\r\n\t\tthis.#workspaceContext?.updateProperty('userGroupUniques', selection);\r\n\t}\r\n\r\n\t#onAllowAllDocumentsChange(event: UUIBooleanInputEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tconst target = event.target;\r\n\t\t// TODO make contexts method\r\n\t\tthis.#workspaceContext?.updateProperty('hasDocumentRootAccess', target.checked);\r\n\t\tthis.#workspaceContext?.updateProperty('documentStartNodeUniques', []);\r\n\t}\r\n\r\n\t#onDocumentStartNodeChange(event: CustomEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\t// TODO: get back to this when media have been decoupled from users.\r\n\t\t// The event target is deliberately set to any to avoid an import cycle with media.\r\n\t\tconst target = event.target as any;\r\n\t\tconst selection: Array<UmbReferenceByUnique> = target.selection.map((unique: string) => {\r\n\t\t\treturn { unique };\r\n\t\t});\r\n\t\t// TODO make contexts method\r\n\t\tthis.#workspaceContext?.updateProperty('documentStartNodeUniques', selection);\r\n\t}\r\n\r\n\t#onAllowAllMediaChange(event: UUIBooleanInputEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\tconst target = event.target;\r\n\t\t// TODO make contexts method\r\n\t\tthis.#workspaceContext?.updateProperty('hasMediaRootAccess', target.checked);\r\n\t\tthis.#workspaceContext?.updateProperty('mediaStartNodeUniques', []);\r\n\t}\r\n\r\n\t#onMediaStartNodeChange(event: CustomEvent) {\r\n\t\tevent.stopPropagation();\r\n\t\t// TODO: get back to this when media have been decoupled from users.\r\n\t\t// The event target is deliberately set to any to avoid an import cycle with media.\r\n\t\tconst target = event.target as any;\r\n\t\tconst selection: Array<UmbReferenceByUnique> = target.selection.map((unique: string) => {\r\n\t\t\treturn { unique };\r\n\t\t});\r\n\t\t// TODO make contexts method\r\n\t\tthis.#workspaceContext?.updateProperty('mediaStartNodeUniques', selection);\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<uui-box>\r\n\t\t\t\t<div slot=\"headline\"><umb-localize key=\"user_assignAccess\">Assign Access</umb-localize></div>\r\n\t\t\t\t<div id=\"assign-access\">\r\n\t\t\t\t\t${this.#renderGroupAccess()} ${this.#renderDocumentAccess()} ${this.#renderMediaAccess()}\r\n\t\t\t\t</div>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderGroupAccess() {\r\n\t\treturn html`<umb-property-layout\r\n\t\t\tlabel=\"${this.localize.term('general_groups')}\"\r\n\t\t\tdescription=\"${this.localize.term('user_groupsHelp')}\">\r\n\t\t\t<umb-user-group-input\r\n\t\t\t\tslot=\"editor\"\r\n\t\t\t\t.selection=${this._userGroupUniques.map((reference) => reference.unique)}\r\n\t\t\t\t@change=${this.#onUserGroupsChange}></umb-user-group-input>\r\n\t\t</umb-property-layout>`;\r\n\t}\r\n\r\n\t#renderDocumentAccess() {\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tlabel=${this.localize.term('user_startnodes')}\r\n\t\t\t\tdescription=${this.localize.term('user_startnodeshelp')}>\r\n\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t<uui-toggle\r\n\t\t\t\t\t\tstyle=\"margin-bottom: var(--uui-size-space-3);\"\r\n\t\t\t\t\t\tlabel=\"${this.localize.term('user_allowAccessToAllDocuments')}\"\r\n\t\t\t\t\t\t.checked=${this._documentRootAccess}\r\n\t\t\t\t\t\t@change=${this.#onAllowAllDocumentsChange}></uui-toggle>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t${this._documentRootAccess === false\r\n\t\t\t\t\t? html`\r\n\t\t\t\t\t\t\t<umb-input-document\r\n\t\t\t\t\t\t\t\tslot=\"editor\"\r\n\t\t\t\t\t\t\t\t.selection=${this._documentStartNodeUniques.map((reference) => reference.unique)}\r\n\t\t\t\t\t\t\t\t@change=${this.#onDocumentStartNodeChange}></umb-input-document>\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderMediaAccess() {\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tlabel=${this.localize.term('defaultdialogs_selectMediaStartNode')}\r\n\t\t\t\tdescription=${this.localize.term('user_mediastartnodehelp')}>\r\n\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t<uui-toggle\r\n\t\t\t\t\t\tstyle=\"margin-bottom: var(--uui-size-space-3);\"\r\n\t\t\t\t\t\tlabel=\"${this.localize.term('user_allowAccessToAllMedia')}\"\r\n\t\t\t\t\t\t.checked=${this._mediaRootAccess}\r\n\t\t\t\t\t\t@change=${this.#onAllowAllMediaChange}></uui-toggle>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t${this._mediaRootAccess === false\r\n\t\t\t\t\t? html`\r\n\t\t\t\t\t\t\t<umb-input-media\r\n\t\t\t\t\t\t\t\tslot=\"editor\"\r\n\t\t\t\t\t\t\t\t.selection=${this._mediaStartNodeUniques.map((reference) => reference.unique)}\r\n\t\t\t\t\t\t\t\t@change=${this.#onMediaStartNodeChange}></umb-input-media>\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t[elementName]: UmbUserWorkspaceAssignAccessElement;\r\n\t}\r\n}\r\n","import { UMB_USER_WORKSPACE_CONTEXT } from '../../user-workspace.context-token.js';\r\nimport type { UmbUserStartNodesModel } from '../../../../types.js';\r\nimport { html, customElement, state, css } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\nimport '../user-workspace-assign-access/user-workspace-assign-access.element.js';\r\n\r\nconst elementName = 'umb-user-workspace-access';\r\n@customElement(elementName)\r\nexport class UmbUserWorkspaceAccessElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _calculatedStartNodes?: UmbUserStartNodesModel;\r\n\r\n\t#userWorkspaceContext?: typeof UMB_USER_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_USER_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#userWorkspaceContext = instance;\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#userWorkspaceContext?.calculatedStartNodes,\r\n\t\t\t\t(calculatedStartNodes) => (this._calculatedStartNodes = calculatedStartNodes),\r\n\t\t\t\t'umbUserObserver',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html` <uui-box headline=${this.localize.term('user_access')}>\r\n\t\t\t<div slot=\"header\" class=\"faded-text\">\r\n\t\t\t\t<umb-localize key=\"user_accessHelp\"\r\n\t\t\t\t\t>Based on the assigned groups and start nodes, the user has access to the following nodes</umb-localize\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\r\n\t\t\t${this.#renderDocumentStartNodes()}\r\n\t\t\t<hr />\r\n\t\t\t${this.#renderMediaStartNodes()}\r\n\t\t</uui-box>`;\r\n\t}\r\n\r\n\t#renderDocumentStartNodes() {\r\n\t\treturn html` <b><umb-localize key=\"sections_content\">Content</umb-localize></b>\r\n\t\t\t<umb-user-document-start-node\r\n\t\t\t\treadonly\r\n\t\t\t\t.uniques=${this._calculatedStartNodes?.documentStartNodeUniques.map((reference) => reference.unique) ||\r\n\t\t\t\t[]}></umb-user-document-start-node>`;\r\n\t}\r\n\r\n\t#renderMediaStartNodes() {\r\n\t\treturn html` <b><umb-localize key=\"sections_media\">Media</umb-localize></b>\r\n\t\t\t<umb-user-media-start-node\r\n\t\t\t\treadonly\r\n\t\t\t\t.uniques=${this._calculatedStartNodes?.mediaStartNodeUniques.map((reference) => reference.unique) ||\r\n\t\t\t\t[]}></umb-user-media-start-node>`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\thr {\r\n\t\t\t\tborder: none;\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-divider);\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\t\t\t.faded-text {\r\n\t\t\t\tcolor: var(--uui-color-text-alt);\r\n\t\t\t\tfont-size: 0.8rem;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbUserWorkspaceAccessElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t[elementName]: UmbUserWorkspaceAccessElement;\r\n\t}\r\n}\r\n","import type { UmbUserDisplayStatus } from '../../../../utils.js';\r\nimport { TimeFormatOptions, getDisplayStateFromUserStatus } from '../../../../utils.js';\r\nimport { UMB_USER_WORKSPACE_CONTEXT } from '../../user-workspace.context-token.js';\r\nimport type { UmbUserDetailModel } from '../../../../types.js';\r\nimport { UmbUserKind } from '../../../../utils/index.js';\r\nimport { html, customElement, state, css, repeat, ifDefined, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\ntype UmbUserWorkspaceInfoItem = { labelKey: string; value: string | number | undefined };\r\n\r\n@customElement('umb-user-workspace-info')\r\nexport class UmbUserWorkspaceInfoElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _userInfo: Array<UmbUserWorkspaceInfoItem> = [];\r\n\r\n\t@state()\r\n\tprivate _userDisplayState: UmbUserDisplayStatus | null = null;\r\n\r\n\t#userWorkspaceContext?: typeof UMB_USER_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_USER_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#userWorkspaceContext = instance;\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#userWorkspaceContext?.data,\r\n\t\t\t\tasync (user) => {\r\n\t\t\t\t\tif (!user) return;\r\n\t\t\t\t\tthis.#setUserInfoItems(user);\r\n\t\t\t\t\tthis._userDisplayState = user.state ? getDisplayStateFromUserStatus(user.state) : null;\r\n\t\t\t\t},\r\n\t\t\t\t'umbUserObserver',\r\n\t\t\t);\r\n\t\t});\r\n\t}\r\n\r\n\t#setUserInfoItems = (user: UmbUserDetailModel | undefined) => {\r\n\t\tif (!user) {\r\n\t\t\tthis._userInfo = [];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._userInfo = [\r\n\t\t\t{\r\n\t\t\t\tlabelKey: 'user_kind',\r\n\t\t\t\tvalue:\r\n\t\t\t\t\tuser.kind === UmbUserKind.API\r\n\t\t\t\t\t\t? this.localize.term('user_userKindApi')\r\n\t\t\t\t\t\t: this.localize.term('user_userKindDefault'),\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabelKey: 'user_lastLogin',\r\n\t\t\t\tvalue: user.lastLoginDate\r\n\t\t\t\t\t? this.localize.date(user.lastLoginDate, TimeFormatOptions)\r\n\t\t\t\t\t: `${user.name} ${this.localize.term('user_noLogin')}`,\r\n\t\t\t},\r\n\t\t\t{ labelKey: 'user_failedPasswordAttempts', value: user.failedLoginAttempts },\r\n\t\t\t{\r\n\t\t\t\tlabelKey: 'user_lastLockoutDate',\r\n\t\t\t\tvalue: user.lastLockoutDate\r\n\t\t\t\t\t? this.localize.date(user.lastLockoutDate, TimeFormatOptions)\r\n\t\t\t\t\t: `${user.name} ${this.localize.term('user_noLockouts')}`,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabelKey: 'user_lastPasswordChangeDate',\r\n\t\t\t\tvalue: user.lastPasswordChangeDate\r\n\t\t\t\t\t? this.localize.date(user.lastPasswordChangeDate, TimeFormatOptions)\r\n\t\t\t\t\t: `${user.name} ${this.localize.term('user_noPasswordChange')}`,\r\n\t\t\t},\r\n\t\t\t{ labelKey: 'user_createDate', value: this.localize.date(user.createDate!, TimeFormatOptions) },\r\n\t\t\t{ labelKey: 'user_updateDate', value: this.localize.date(user.updateDate!, TimeFormatOptions) },\r\n\t\t\t{ labelKey: 'general_id', value: user.unique },\r\n\t\t];\r\n\r\n\t\tif (user.kind === UmbUserKind.API) {\r\n\t\t\tconst include = ['user_kind', 'user_createDate', 'user_updateDate', 'general_id'];\r\n\t\t\tthis._userInfo = this._userInfo.filter((item) => include.includes(item.labelKey));\r\n\t\t}\r\n\t};\r\n\r\n\toverride render() {\r\n\t\tif (this._userInfo.length === 0) return nothing;\r\n\t\treturn html`<uui-box id=\"user-info\">${this.#renderState()} ${this.#renderInfoList()} </uui-box>`;\r\n\t}\r\n\r\n\t#renderState() {\r\n\t\treturn html`\r\n\t\t\t<div id=\"state\" class=\"user-info-item\">\r\n\t\t\t\t<uui-tag look=\"${ifDefined(this._userDisplayState?.look)}\" color=\"${ifDefined(this._userDisplayState?.color)}\">\r\n\t\t\t\t\t${this.localize.term('user_' + this._userDisplayState?.key)}\r\n\t\t\t\t</uui-tag>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderInfoList() {\r\n\t\treturn html`\r\n\t\t\t<umb-stack look=\"compact\">\r\n\t\t\t\t${repeat(\r\n\t\t\t\t\tthis._userInfo,\r\n\t\t\t\t\t(item) => item.labelKey,\r\n\t\t\t\t\t(item) => this.#renderInfoItem(item.labelKey, item.value),\r\n\t\t\t\t)}\r\n\t\t\t</umb-stack>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderInfoItem(labelKey: string, value?: string | number) {\r\n\t\treturn html`\r\n\t\t\t<div>\r\n\t\t\t\t<h4><umb-localize key=${labelKey}></umb-localize></h4>\r\n\t\t\t\t<span>${value}</span>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\tuui-tag {\r\n\t\t\t\twidth: fit-content;\r\n\t\t\t}\r\n\r\n\t\t\th4 {\r\n\t\t\t\tmargin: 0;\r\n\t\t\t}\r\n\r\n\t\t\t#state {\r\n\t\t\t\tborder-bottom: 1px solid var(--uui-color-divider);\r\n\t\t\t\tpadding-bottom: var(--uui-size-space-4);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbUserWorkspaceInfoElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-user-workspace-info': UmbUserWorkspaceInfoElement;\r\n\t}\r\n}\r\n","import type { UmbUserDetailModel } from '../../../../types.js';\r\nimport { UMB_USER_WORKSPACE_CONTEXT } from '../../user-workspace.context-token.js';\r\nimport { css, html, customElement, query, nothing, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTemporaryFileConfigRepository } from '@umbraco-cms/backoffice/temporary-file';\r\n\r\n@customElement('umb-user-workspace-avatar')\r\nexport class UmbUserAvatarElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _user?: UmbUserDetailModel;\r\n\r\n\t@state()\r\n\tprivate _allowedFileTypes = 'image/*';\r\n\r\n\t@query('#AvatarFileField')\r\n\tprivate _avatarFileField?: HTMLInputElement;\r\n\r\n\t@query('uui-combobox')\r\n\tprivate _selectElement!: HTMLInputElement;\r\n\r\n\t#userWorkspaceContext?: typeof UMB_USER_WORKSPACE_CONTEXT.TYPE;\r\n\r\n\t#temporaryFileConfigRepository = new UmbTemporaryFileConfigRepository(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_USER_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#userWorkspaceContext = instance;\r\n\t\t\tif (!this.#userWorkspaceContext) return;\r\n\t\t\tthis.#observeUser();\r\n\t\t});\r\n\r\n\t\tthis.#observeAllowedFileTypes();\r\n\t}\r\n\r\n\tprotected getFormElement() {\r\n\t\treturn this._selectElement;\r\n\t}\r\n\r\n\tasync #observeAllowedFileTypes() {\r\n\t\tawait this.#temporaryFileConfigRepository.initialized;\r\n\t\tthis.observe(\r\n\t\t\tthis.#temporaryFileConfigRepository.part('imageFileTypes'),\r\n\t\t\t(fileTypes) => {\r\n\t\t\t\tif (fileTypes.length) {\r\n\t\t\t\t\tthis._allowedFileTypes = fileTypes.map((t) => `.${t}`).join(',');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._allowedFileTypes = 'image/*';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'_imageFileTypes',\r\n\t\t);\r\n\t}\r\n\r\n\t#observeUser = () => {\r\n\t\tthis.observe(\r\n\t\t\tthis.#userWorkspaceContext!.data,\r\n\t\t\tasync (user) => {\r\n\t\t\t\tthis._user = user;\r\n\t\t\t},\r\n\t\t\t'umbUserObserver',\r\n\t\t);\r\n\t};\r\n\r\n\t#uploadAvatar = async () => {\r\n\t\ttry {\r\n\t\t\tconst selectedFile = await this.#selectAvatar();\r\n\t\t\tthis.#userWorkspaceContext?.uploadAvatar(selectedFile);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(error);\r\n\t\t}\r\n\t};\r\n\r\n\t#selectAvatar() {\r\n\t\treturn new Promise<File>((resolve, reject) => {\r\n\t\t\tif (!this._avatarFileField) {\r\n\t\t\t\treject(\"Can't find avatar file field\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._avatarFileField.addEventListener('change', (event) => {\r\n\t\t\t\tconst target = event?.target as HTMLInputElement;\r\n\t\t\t\tconst file = target.files?.[0] as File;\r\n\t\t\t\tif (!file) {\r\n\t\t\t\t\treject(\"Can't find avatar file\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresolve(file);\r\n\t\t\t});\r\n\r\n\t\t\tthis._avatarFileField.click();\r\n\t\t});\r\n\t}\r\n\r\n\t#deleteAvatar = async () => {\r\n\t\tif (!this.#userWorkspaceContext) return;\r\n\t\tthis.#userWorkspaceContext.deleteAvatar();\r\n\t};\r\n\r\n\t#hasAvatar() {\r\n\t\tif (!this._user) return false;\r\n\t\treturn this._user.avatarUrls.length > 0;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (!this._user) return nothing;\r\n\t\treturn html`\r\n\t\t\t<uui-box>\r\n\t\t\t\t<form id=\"AvatarUploadForm\" novalidate>\r\n\t\t\t\t\t<umb-user-avatar\r\n\t\t\t\t\t\tid=\"Avatar\"\r\n\t\t\t\t\t\t.name=${this._user.name}\r\n\t\t\t\t\t\t.kind=${this._user.kind}\r\n\t\t\t\t\t\t.imgUrls=${this._user.avatarUrls ?? []}></umb-user-avatar>\r\n\t\t\t\t\t<input id=\"AvatarFileField\" type=\"file\" name=\"avatarFile\" accept=${this._allowedFileTypes} required hidden />\r\n\t\t\t\t\t<uui-button label=\"${this.localize.term('user_changePhoto')}\" @click=${this.#uploadAvatar}></uui-button>\r\n\t\t\t\t\t${this.#hasAvatar()\r\n\t\t\t\t\t\t? html`\r\n\t\t\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tlabel=${this.localize.term('user_removePhoto')}\r\n\t\t\t\t\t\t\t\t\t@click=${this.#deleteAvatar}></uui-button>\r\n\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t</form>\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\t#Avatar {\r\n\t\t\t\tfont-size: 75px;\r\n\t\t\t\tplace-self: center;\r\n\t\t\t}\r\n\r\n\t\t\tform {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-2);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbUserAvatarElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-user-workspace-avatar': UmbUserAvatarElement;\r\n\t}\r\n}\r\n","import { UMB_USER_WORKSPACE_CONTEXT } from '../../user-workspace.context-token.js';\r\nimport type {\r\n\tUmbDeleteUserClientCredentialRequestArgs,\r\n\tUmbUserClientCredentialModel,\r\n} from '../../../../client-credential/index.js';\r\nimport { UmbUserClientCredentialRepository } from '../../../../client-credential/index.js';\r\nimport { UMB_CREATE_USER_CLIENT_CREDENTIAL_MODAL } from '../../../../client-credential/create/modal/create-user-client-credential-modal.token.js';\r\nimport { UmbUserKind } from '../../../../utils/index.js';\r\nimport { html, customElement, state, css, nothing } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\nimport { UMB_MODAL_MANAGER_CONTEXT, umbConfirmModal } from '@umbraco-cms/backoffice/modal';\r\n\r\nconst elementName = 'umb-user-workspace-client-credentials';\r\n@customElement(elementName)\r\nexport class UmbUserWorkspaceClientCredentialsElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _userUnique?: string;\r\n\r\n\t@state()\r\n\tprivate _userKind?: string;\r\n\r\n\t@state()\r\n\tprivate _clientCredentials: UmbUserClientCredentialModel[] = [];\r\n\r\n\t#userWorkspaceContext?: typeof UMB_USER_WORKSPACE_CONTEXT.TYPE;\r\n\t#modalManagerContext? = UMB_MODAL_MANAGER_CONTEXT.TYPE;\r\n\t#userClientCredentialRepository = new UmbUserClientCredentialRepository(this);\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_USER_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#userWorkspaceContext = instance;\r\n\r\n\t\t\tthis.observe(this.#userWorkspaceContext?.kind, (kind) => (this._userKind = kind), 'umbUserKindObserver');\r\n\r\n\t\t\tthis.observe(\r\n\t\t\t\tthis.#userWorkspaceContext?.unique,\r\n\t\t\t\tasync (unique) => {\r\n\t\t\t\t\tif (unique) {\r\n\t\t\t\t\t\tthis.#onUserUniqueChange(unique);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t'umbUserUniqueObserver',\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\tthis.consumeContext(UMB_MODAL_MANAGER_CONTEXT, (instance) => {\r\n\t\t\tthis.#modalManagerContext = instance;\r\n\t\t});\r\n\t}\r\n\r\n\t#onUserUniqueChange(unique: string | undefined) {\r\n\t\tif (unique && this._userUnique !== unique) {\r\n\t\t\tthis._userUnique = unique;\r\n\t\t\tthis.#loadClientCredentials();\r\n\t\t}\r\n\r\n\t\tif (!unique) {\r\n\t\t\tthis._userUnique = undefined;\r\n\t\t\tthis._clientCredentials = [];\r\n\t\t}\r\n\t}\r\n\r\n\tasync #loadClientCredentials() {\r\n\t\tif (!this._userUnique) throw new Error('User unique not available');\r\n\r\n\t\tconst { data } = await this.#userClientCredentialRepository.requestClientCredentials({\r\n\t\t\tuser: { unique: this._userUnique },\r\n\t\t});\r\n\r\n\t\tthis._clientCredentials = data ?? [];\r\n\t}\r\n\r\n\t#onAdd(event: Event) {\r\n\t\tevent.stopPropagation();\r\n\t\tif (!this.#modalManagerContext) throw new Error('Modal Manager Context not available');\r\n\t\tif (!this._userUnique) throw new Error('User unique not available');\r\n\r\n\t\tconst modalContext = this.#modalManagerContext.open(this, UMB_CREATE_USER_CLIENT_CREDENTIAL_MODAL, {\r\n\t\t\tdata: {\r\n\t\t\t\tuser: {\r\n\t\t\t\t\tunique: this._userUnique,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tmodalContext.onSubmit().then(() => this.#loadClientCredentials());\r\n\t}\r\n\r\n\tasync #onDelete(event: Event, client: UmbUserClientCredentialModel) {\r\n\t\tevent.stopPropagation();\r\n\t\tif (!this._userUnique) throw new Error('User unique not available');\r\n\r\n\t\tawait umbConfirmModal(this, {\r\n\t\t\theadline: `Delete ${client.unique}`,\r\n\t\t\tcontent: `Are you sure you want to delete ${client.unique}?`,\r\n\t\t\tconfirmLabel: 'Delete',\r\n\t\t\tcolor: 'danger',\r\n\t\t});\r\n\r\n\t\tconst payload: UmbDeleteUserClientCredentialRequestArgs = {\r\n\t\t\tuser: { unique: this._userUnique },\r\n\t\t\tclient: { unique: client.unique },\r\n\t\t};\r\n\r\n\t\tconst { error } = await this.#userClientCredentialRepository.requestDelete(payload);\r\n\r\n\t\tif (!error) {\r\n\t\t\tthis.#loadClientCredentials();\r\n\t\t}\r\n\t}\r\n\r\n\toverride render() {\r\n\t\tif (this._userKind !== UmbUserKind.API) return nothing;\r\n\r\n\t\treturn html`<uui-box>\r\n\t\t\t<div slot=\"headline\">Client Credentials</div>\r\n\t\t\t<uui-ref-list>${this._clientCredentials.map((client) => html` ${this.#renderItem(client)} `)}</uui-ref-list>\r\n\t\t\t<uui-button\r\n\t\t\t\tid=\"add-button\"\r\n\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\tlabel=${this.localize.term('general_add')}\r\n\t\t\t\t@click=${this.#onAdd}></uui-button>\r\n\t\t</uui-box>`;\r\n\t}\r\n\r\n\t#renderItem(client: UmbUserClientCredentialModel) {\r\n\t\treturn html`\r\n\t\t\t<uui-ref-node name=${client.unique} readonly>\r\n\t\t\t\t<uui-icon slot=\"icon\" name=\"icon-key\"></uui-icon>\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tslot=\"actions\"\r\n\t\t\t\t\t@click=${(event: Event) => this.#onDelete(event, client)}\r\n\t\t\t\t\tlabel=\"Delete ${client.unique}\"\r\n\t\t\t\t\tcompact\r\n\t\t\t\t\t><uui-icon name=\"icon-trash\" look=\"danger\"></uui-icon\r\n\t\t\t\t></uui-button>\r\n\t\t\t</uui-ref-node>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t}\r\n\r\n\t\t\tuui-input {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#add-button {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t[elementName]: UmbUserWorkspaceClientCredentialsElement;\r\n\t}\r\n}\r\n","import type { UmbUserDetailModel } from '../../index.js';\r\nimport { UMB_USER_ROOT_WORKSPACE_PATH } from '../../paths.js';\r\nimport type { UmbUserWorkspaceContext } from './user-workspace.context.js';\r\nimport { UMB_USER_WORKSPACE_CONTEXT } from './user-workspace.context-token.js';\r\nimport { css, html, nothing, customElement, state } from '@umbraco-cms/backoffice/external/lit';\r\nimport { UmbLitElement } from '@umbraco-cms/backoffice/lit-element';\r\nimport { UmbTextStyles } from '@umbraco-cms/backoffice/style';\r\n\r\n// import local components. Theses are not meant to be used outside of this component.\r\nimport './components/user-workspace-profile-settings/user-workspace-profile-settings.element.js';\r\nimport './components/user-workspace-access/user-workspace-access.element.js';\r\nimport './components/user-workspace-info/user-workspace-info.element.js';\r\nimport './components/user-workspace-avatar/user-workspace-avatar.element.js';\r\nimport './components/user-workspace-client-credentials/user-workspace-client-credentials.element.js';\r\n\r\n@customElement('umb-user-workspace-editor')\r\nexport class UmbUserWorkspaceEditorElement extends UmbLitElement {\r\n\t@state()\r\n\tprivate _user?: UmbUserDetailModel;\r\n\r\n\t#workspaceContext?: UmbUserWorkspaceContext;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_USER_WORKSPACE_CONTEXT, (context) => {\r\n\t\t\tthis.#workspaceContext = context;\r\n\t\t\tthis.#observeUser();\r\n\t\t});\r\n\t}\r\n\r\n\t#observeUser() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\t\tthis.observe(this.#workspaceContext.data, (user) => (this._user = user), 'umbUserObserver');\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<umb-entity-detail-workspace-editor class=\"uui-text\" .backPath=${UMB_USER_ROOT_WORKSPACE_PATH}>\r\n\t\t\t\t<umb-workspace-header-name-editable slot=\"header\"></umb-workspace-header-name-editable>\r\n\t\t\t\t${this._user\r\n\t\t\t\t\t? html`<div id=\"main\">\r\n\t\t\t\t\t\t\t<div id=\"left-column\">${this.#renderLeftColumn()}</div>\r\n\t\t\t\t\t\t\t<div id=\"right-column\">${this.#renderRightColumn()}</div>\r\n\t\t\t\t\t\t</div>`\r\n\t\t\t\t\t: nothing}\r\n\t\t\t</umb-entity-detail-workspace-editor>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderLeftColumn() {\r\n\t\treturn html`\r\n\t\t\t<umb-stack>\r\n\t\t\t\t<umb-user-workspace-profile-settings></umb-user-workspace-profile-settings>\r\n\t\t\t\t<umb-user-workspace-assign-access></umb-user-workspace-assign-access>\r\n\t\t\t\t<umb-user-workspace-access></umb-user-workspace-access>\r\n\t\t\t</umb-stack>\r\n\t\t`;\r\n\t}\r\n\r\n\t#renderRightColumn() {\r\n\t\treturn html`\r\n\t\t\t<umb-stack look=\"compact\">\r\n\t\t\t\t<umb-user-workspace-avatar></umb-user-workspace-avatar>\r\n\t\t\t\t<umb-user-workspace-info></umb-user-workspace-info>\r\n\t\t\t\t<umb-user-workspace-client-credentials></umb-user-workspace-client-credentials>\r\n\t\t\t</umb-stack>\r\n\t\t`;\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\r\n\t\t\t#main {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgrid-template-columns: 1fr 350px;\r\n\t\t\t\tgap: var(--uui-size-layout-1);\r\n\t\t\t\tpadding: var(--uui-size-layout-1);\r\n\t\t\t}\r\n\r\n\t\t\t#left-column {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tgap: var(--uui-size-space-4);\r\n\t\t\t}\r\n\t\t`,\r\n\t];\r\n}\r\n\r\nexport default UmbUserWorkspaceEditorElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'umb-user-workspace-editor': UmbUserWorkspaceEditorElement;\r\n\t}\r\n}\r\n","import type { UmbUserDetailModel, UmbUserStartNodesModel, UmbUserStateEnum } from '../../types.js';\r\nimport type { UmbUserDetailRepository } from '../../repository/index.js';\r\nimport { UMB_USER_DETAIL_REPOSITORY_ALIAS } from '../../repository/index.js';\r\nimport { UMB_USER_ENTITY_TYPE } from '../../entity.js';\r\nimport { UmbUserAvatarRepository } from '../../repository/avatar/index.js';\r\nimport { UmbUserConfigRepository } from '../../repository/config/index.js';\r\nimport { UmbUserWorkspaceEditorElement } from './user-workspace-editor.element.js';\r\nimport { UMB_USER_WORKSPACE_ALIAS } from './constants.js';\r\nimport { UmbEntityNamedDetailWorkspaceContextBase } from '@umbraco-cms/backoffice/workspace';\r\nimport { UmbObjectState } from '@umbraco-cms/backoffice/observable-api';\r\nimport type { UmbControllerHost } from '@umbraco-cms/backoffice/controller-api';\r\nimport type { UmbRepositoryResponseWithAsObservable } from '@umbraco-cms/backoffice/repository';\r\nimport type { UmbSubmittableWorkspaceContext } from '@umbraco-cms/backoffice/workspace';\r\n\r\ntype EntityType = UmbUserDetailModel;\r\n\r\nexport class UmbUserWorkspaceContext\r\n\textends UmbEntityNamedDetailWorkspaceContextBase<EntityType, UmbUserDetailRepository>\r\n\timplements UmbSubmittableWorkspaceContext\r\n{\r\n\tpublic readonly avatarRepository: UmbUserAvatarRepository = new UmbUserAvatarRepository(this);\r\n\tpublic readonly configRepository = new UmbUserConfigRepository(this);\r\n\r\n\treadonly state = this._data.createObservablePartOfCurrent((x) => x?.state);\r\n\treadonly kind = this._data.createObservablePartOfCurrent((x) => x?.kind);\r\n\treadonly userGroupUniques = this._data.createObservablePartOfCurrent((x) => x?.userGroupUniques || []);\r\n\treadonly documentStartNodeUniques = this._data.createObservablePartOfCurrent(\r\n\t\t(data) => data?.documentStartNodeUniques || [],\r\n\t);\r\n\treadonly hasDocumentRootAccess = this._data.createObservablePartOfCurrent(\r\n\t\t(data) => data?.hasDocumentRootAccess || false,\r\n\t);\r\n\treadonly mediaStartNodeUniques = this._data.createObservablePartOfCurrent(\r\n\t\t(data) => data?.mediaStartNodeUniques || [],\r\n\t);\r\n\treadonly hasMediaRootAccess = this._data.createObservablePartOfCurrent((data) => data?.hasMediaRootAccess || false);\r\n\r\n\t#calculatedStartNodes = new UmbObjectState<UmbUserStartNodesModel | undefined>(undefined);\r\n\treadonly calculatedStartNodes = this.#calculatedStartNodes.asObservable();\r\n\r\n\tconstructor(host: UmbControllerHost) {\r\n\t\tsuper(host, {\r\n\t\t\tworkspaceAlias: UMB_USER_WORKSPACE_ALIAS,\r\n\t\t\tentityType: UMB_USER_ENTITY_TYPE,\r\n\t\t\tdetailRepositoryAlias: UMB_USER_DETAIL_REPOSITORY_ALIAS,\r\n\t\t});\r\n\r\n\t\tthis.routes.setRoutes([\r\n\t\t\t{\r\n\t\t\t\tpath: 'edit/:id',\r\n\t\t\t\tcomponent: UmbUserWorkspaceEditorElement,\r\n\t\t\t\tsetup: (_component, info) => {\r\n\t\t\t\t\tconst id = info.match.params.id;\r\n\t\t\t\t\tthis.load(id);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t]);\r\n\t}\r\n\r\n\toverride async load(unique: string) {\r\n\t\tconst response = await super.load(unique);\r\n\r\n\t\tif (!response.data) {\r\n\t\t\t// Return early if there is no user\tdata\r\n\t\t\tthis.removeUmbControllerByAlias('umbUserStoreObserver');\r\n\t\t\treturn response;\r\n\t\t}\r\n\r\n\t\tthis.observe(\r\n\t\t\t(response as UmbRepositoryResponseWithAsObservable<EntityType>).asObservable?.(),\r\n\t\t\t(user) => this.onUserStoreChanges(user),\r\n\t\t\t'umbUserStoreObserver',\r\n\t\t);\r\n\r\n\t\tif (!this._detailRepository) {\r\n\t\t\tthrow new Error('Detail repository is missing');\r\n\t\t}\r\n\r\n\t\t// Get the calculated start nodes\r\n\t\tconst { data: calculatedStartNodes } = await this._detailRepository.requestCalculateStartNodes(unique);\r\n\t\tthis.#calculatedStartNodes.setValue(calculatedStartNodes);\r\n\r\n\t\treturn response;\r\n\t}\r\n\r\n\t/* TODO: some properties are allowed to update without saving.\r\n\t\tFor a user properties like state will be updated when one of the entity actions are executed.\r\n\t\tTherefore we have to subscribe to the user store to update the state in the workspace data.\r\n\t\tThere might be a less manual way to do this.\r\n\t*/\r\n\tonUserStoreChanges(user: EntityType | undefined) {\r\n\t\tif (user) {\r\n\t\t\tthis._data.updateCurrent({ state: user.state, avatarUrls: user.avatarUrls });\r\n\t\t}\r\n\t}\r\n\r\n\tgetState(): UmbUserStateEnum | null | undefined {\r\n\t\treturn this._data.getCurrent()?.state;\r\n\t}\r\n\r\n\tupdateProperty<PropertyName extends keyof EntityType>(propertyName: PropertyName, value: EntityType[PropertyName]) {\r\n\t\tthis._data.updateCurrent({ [propertyName]: value });\r\n\t}\r\n\r\n\t// TODO: implement upload progress\r\n\tuploadAvatar(file: File) {\r\n\t\tconst unique = this.getUnique();\r\n\t\tif (!unique) throw new Error('Id is missing');\r\n\t\treturn this.avatarRepository.uploadAvatar(unique, file);\r\n\t}\r\n\r\n\tdeleteAvatar() {\r\n\t\tconst unique = this.getUnique();\r\n\t\tif (!unique) throw new Error('Id is missing');\r\n\t\treturn this.avatarRepository.deleteAvatar(unique);\r\n\t}\r\n\r\n\toverride destroy(): void {\r\n\t\tthis.avatarRepository.destroy();\r\n\t\tsuper.destroy();\r\n\t}\r\n}\r\n\r\nexport { UmbUserWorkspaceContext as api };\r\n"],"names":["_userWorkspaceContext","_UmbUserWorkspaceProfileSettingsElement_instances","onEmailChange_fn","onUsernameChange_fn","onLanguageChange_fn","renderEmailProperty_fn","renderUsernameProperty_fn","renderUILanguageProperty_fn","UmbUserWorkspaceProfileSettingsElement","UmbLitElement","__privateAdd","UMB_USER_WORKSPACE_CONTEXT","instance","__privateSet","__privateGet","user","usernameIsEmail","html","__privateMethod","event","target","ifDefined","umbBindToValidation","nothing","UmbUserKind","css","__decorateClass","state","customElement","_workspaceContext","_UmbUserWorkspaceAssignAccessElement_instances","onUserGroupsChange_fn","onAllowAllDocumentsChange_fn","onDocumentStartNodeChange_fn","onAllowAllMediaChange_fn","onMediaStartNodeChange_fn","renderGroupAccess_fn","renderDocumentAccess_fn","renderMediaAccess_fn","elementName","UmbUserWorkspaceAssignAccessElement","value","selection","unique","reference","UmbTextStyles","_UmbUserWorkspaceAccessElement_instances","renderDocumentStartNodes_fn","renderMediaStartNodes_fn","UmbUserWorkspaceAccessElement","calculatedStartNodes","_setUserInfoItems","_UmbUserWorkspaceInfoElement_instances","renderState_fn","renderInfoList_fn","renderInfoItem_fn","UmbUserWorkspaceInfoElement","TimeFormatOptions","include","item","getDisplayStateFromUserStatus","repeat","labelKey","_temporaryFileConfigRepository","_UmbUserAvatarElement_instances","observeAllowedFileTypes_fn","_observeUser","_uploadAvatar","selectAvatar_fn","_deleteAvatar","hasAvatar_fn","UmbUserAvatarElement","UmbTemporaryFileConfigRepository","selectedFile","error","fileTypes","resolve","reject","file","query","_modalManagerContext","_userClientCredentialRepository","_UmbUserWorkspaceClientCredentialsElement_instances","onUserUniqueChange_fn","loadClientCredentials_fn","onAdd_fn","onDelete_fn","renderItem_fn","UmbUserWorkspaceClientCredentialsElement","UMB_MODAL_MANAGER_CONTEXT","UmbUserClientCredentialRepository","kind","client","data","UMB_CREATE_USER_CLIENT_CREDENTIAL_MODAL","umbConfirmModal","payload","_UmbUserWorkspaceEditorElement_instances","observeUser_fn","renderLeftColumn_fn","renderRightColumn_fn","UmbUserWorkspaceEditorElement","context","UMB_USER_ROOT_WORKSPACE_PATH","UmbUserWorkspaceContext","UmbEntityNamedDetailWorkspaceContextBase","host","UMB_USER_WORKSPACE_ALIAS","UMB_USER_ENTITY_TYPE","UMB_USER_DETAIL_REPOSITORY_ALIAS","UmbUserAvatarRepository","UmbUserConfigRepository","x","#calculatedStartNodes","UmbObjectState","_component","info","id","response","propertyName"],"mappings":"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"}